var YT=Object.defineProperty;var XT=(t,e,n)=>e in t?YT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var hr=(t,e,n)=>XT(t,typeof e!="symbol"?e+"":e,n);function JT(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ps(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var s1={exports:{}},nd={},o1={exports:{}},ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _l=Symbol.for("react.element"),ZT=Symbol.for("react.portal"),eS=Symbol.for("react.fragment"),tS=Symbol.for("react.strict_mode"),nS=Symbol.for("react.profiler"),rS=Symbol.for("react.provider"),iS=Symbol.for("react.context"),sS=Symbol.for("react.forward_ref"),oS=Symbol.for("react.suspense"),aS=Symbol.for("react.memo"),lS=Symbol.for("react.lazy"),n_=Symbol.iterator;function uS(t){return t===null||typeof t!="object"?null:(t=n_&&t[n_]||t["@@iterator"],typeof t=="function"?t:null)}var a1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l1=Object.assign,u1={};function Eo(t,e,n){this.props=t,this.context=e,this.refs=u1,this.updater=n||a1}Eo.prototype.isReactComponent={};Eo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c1(){}c1.prototype=Eo.prototype;function am(t,e,n){this.props=t,this.context=e,this.refs=u1,this.updater=n||a1}var lm=am.prototype=new c1;lm.constructor=am;l1(lm,Eo.prototype);lm.isPureReactComponent=!0;var r_=Array.isArray,d1=Object.prototype.hasOwnProperty,um={current:null},p1={key:!0,ref:!0,__self:!0,__source:!0};function h1(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)d1.call(e,r)&&!p1.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:_l,type:t,key:s,ref:o,props:i,_owner:um.current}}function cS(t,e){return{$$typeof:_l,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cm(t){return typeof t=="object"&&t!==null&&t.$$typeof===_l}function dS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var i_=/\/+/g;function up(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dS(""+t.key):e.toString(36)}function Pu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _l:case ZT:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+up(o,0):r,r_(i)?(n="",t!=null&&(n=t.replace(i_,"$&/")+"/"),Pu(i,e,n,"",function(u){return u})):i!=null&&(cm(i)&&(i=cS(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(i_,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",r_(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+up(s,a);o+=Pu(s,e,n,l,i)}else if(l=uS(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+up(s,a++),o+=Pu(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Jl(t,e,n){if(t==null)return t;var r=[],i=0;return Pu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function pS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bt={current:null},Ru={transition:null},hS={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Ru,ReactCurrentOwner:um};function f1(){throw Error("act(...) is not supported in production builds of React.")}ve.Children={map:Jl,forEach:function(t,e,n){Jl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jl(t,function(){e++}),e},toArray:function(t){return Jl(t,function(e){return e})||[]},only:function(t){if(!cm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ve.Component=Eo;ve.Fragment=eS;ve.Profiler=nS;ve.PureComponent=am;ve.StrictMode=tS;ve.Suspense=oS;ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hS;ve.act=f1;ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=l1({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=um.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)d1.call(e,l)&&!p1.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:_l,type:t.type,key:i,ref:s,props:r,_owner:o}};ve.createContext=function(t){return t={$$typeof:iS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:rS,_context:t},t.Consumer=t};ve.createElement=h1;ve.createFactory=function(t){var e=h1.bind(null,t);return e.type=t,e};ve.createRef=function(){return{current:null}};ve.forwardRef=function(t){return{$$typeof:sS,render:t}};ve.isValidElement=cm;ve.lazy=function(t){return{$$typeof:lS,_payload:{_status:-1,_result:t},_init:pS}};ve.memo=function(t,e){return{$$typeof:aS,type:t,compare:e===void 0?null:e}};ve.startTransition=function(t){var e=Ru.transition;Ru.transition={};try{t()}finally{Ru.transition=e}};ve.unstable_act=f1;ve.useCallback=function(t,e){return Bt.current.useCallback(t,e)};ve.useContext=function(t){return Bt.current.useContext(t)};ve.useDebugValue=function(){};ve.useDeferredValue=function(t){return Bt.current.useDeferredValue(t)};ve.useEffect=function(t,e){return Bt.current.useEffect(t,e)};ve.useId=function(){return Bt.current.useId()};ve.useImperativeHandle=function(t,e,n){return Bt.current.useImperativeHandle(t,e,n)};ve.useInsertionEffect=function(t,e){return Bt.current.useInsertionEffect(t,e)};ve.useLayoutEffect=function(t,e){return Bt.current.useLayoutEffect(t,e)};ve.useMemo=function(t,e){return Bt.current.useMemo(t,e)};ve.useReducer=function(t,e,n){return Bt.current.useReducer(t,e,n)};ve.useRef=function(t){return Bt.current.useRef(t)};ve.useState=function(t){return Bt.current.useState(t)};ve.useSyncExternalStore=function(t,e,n){return Bt.current.useSyncExternalStore(t,e,n)};ve.useTransition=function(){return Bt.current.useTransition()};ve.version="18.3.1";o1.exports=ve;var z=o1.exports;const _t=ps(z),fS=JT({__proto__:null,default:_t},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mS=z,gS=Symbol.for("react.element"),yS=Symbol.for("react.fragment"),_S=Object.prototype.hasOwnProperty,xS=mS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vS={key:!0,ref:!0,__self:!0,__source:!0};function m1(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_S.call(e,r)&&!vS.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:gS,type:t,key:s,ref:o,props:i,_owner:xS.current}}nd.Fragment=yS;nd.jsx=m1;nd.jsxs=m1;s1.exports=nd;var h=s1.exports,bh={},g1={exports:{}},dn={},y1={exports:{}},_1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,ee){var R=W.length;W.push(ee);e:for(;0<R;){var Z=R-1>>>1,re=W[Z];if(0<i(re,ee))W[Z]=ee,W[R]=re,R=Z;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var ee=W[0],R=W.pop();if(R!==ee){W[0]=R;e:for(var Z=0,re=W.length,L=re>>>1;Z<L;){var he=2*(Z+1)-1,Ae=W[he],Ee=he+1,He=W[Ee];if(0>i(Ae,R))Ee<re&&0>i(He,Ae)?(W[Z]=He,W[Ee]=R,Z=Ee):(W[Z]=Ae,W[he]=R,Z=he);else if(Ee<re&&0>i(He,R))W[Z]=He,W[Ee]=R,Z=Ee;else break e}}return ee}function i(W,ee){var R=W.sortIndex-ee.sortIndex;return R!==0?R:W.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,p=null,f=3,g=!1,_=!1,k=!1,I=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var ee=n(u);ee!==null;){if(ee.callback===null)r(u);else if(ee.startTime<=W)r(u),ee.sortIndex=ee.expirationTime,e(l,ee);else break;ee=n(u)}}function M(W){if(k=!1,w(W),!_)if(n(l)!==null)_=!0,ae(O);else{var ee=n(u);ee!==null&&ye(M,ee.startTime-W)}}function O(W,ee){_=!1,k&&(k=!1,x(E),E=-1),g=!0;var R=f;try{for(w(ee),p=n(l);p!==null&&(!(p.expirationTime>ee)||W&&!A());){var Z=p.callback;if(typeof Z=="function"){p.callback=null,f=p.priorityLevel;var re=Z(p.expirationTime<=ee);ee=t.unstable_now(),typeof re=="function"?p.callback=re:p===n(l)&&r(l),w(ee)}else r(l);p=n(l)}if(p!==null)var L=!0;else{var he=n(u);he!==null&&ye(M,he.startTime-ee),L=!1}return L}finally{p=null,f=R,g=!1}}var D=!1,S=null,E=-1,C=5,b=-1;function A(){return!(t.unstable_now()-b<C)}function N(){if(S!==null){var W=t.unstable_now();b=W;var ee=!0;try{ee=S(!0,W)}finally{ee?P():(D=!1,S=null)}}else D=!1}var P;if(typeof v=="function")P=function(){v(N)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,$=se.port2;se.port1.onmessage=N,P=function(){$.postMessage(null)}}else P=function(){I(N,0)};function ae(W){S=W,D||(D=!0,P())}function ye(W,ee){E=I(function(){W(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){_||g||(_=!0,ae(O))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(f){case 1:case 2:case 3:var ee=3;break;default:ee=f}var R=f;f=ee;try{return W()}finally{f=R}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var R=f;f=W;try{return ee()}finally{f=R}},t.unstable_scheduleCallback=function(W,ee,R){var Z=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?Z+R:Z):R=Z,W){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=R+re,W={id:d++,callback:ee,priorityLevel:W,startTime:R,expirationTime:re,sortIndex:-1},R>Z?(W.sortIndex=R,e(u,W),n(l)===null&&W===n(u)&&(k?(x(E),E=-1):k=!0,ye(M,R-Z))):(W.sortIndex=re,e(l,W),_||g||(_=!0,ae(O))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var ee=f;return function(){var R=f;f=ee;try{return W.apply(this,arguments)}finally{f=R}}}})(_1);y1.exports=_1;var bS=y1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wS=z,un=bS;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var x1=new Set,Ua={};function hs(t,e){oo(t,e),oo(t+"Capture",e)}function oo(t,e){for(Ua[t]=e,t=0;t<e.length;t++)x1.add(e[t])}var kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wh=Object.prototype.hasOwnProperty,kS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s_={},o_={};function ES(t){return wh.call(o_,t)?!0:wh.call(s_,t)?!1:kS.test(t)?o_[t]=!0:(s_[t]=!0,!1)}function TS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SS(t,e,n,r){if(e===null||typeof e>"u"||TS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Et[t]=new Wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Et[e]=new Wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Et[t]=new Wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Et[t]=new Wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Et[t]=new Wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Et[t]=new Wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Et[t]=new Wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Et[t]=new Wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Et[t]=new Wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var dm=/[\-:]([a-z])/g;function pm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dm,pm);Et[e]=new Wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dm,pm);Et[e]=new Wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dm,pm);Et[e]=new Wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Et[t]=new Wt(t,1,!1,t.toLowerCase(),null,!1,!1)});Et.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Et[t]=new Wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function hm(t,e,n,r){var i=Et.hasOwnProperty(e)?Et[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SS(e,n,i,r)&&(n=null),r||i===null?ES(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Rr=wS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),Ns=Symbol.for("react.portal"),Ls=Symbol.for("react.fragment"),fm=Symbol.for("react.strict_mode"),kh=Symbol.for("react.profiler"),v1=Symbol.for("react.provider"),b1=Symbol.for("react.context"),mm=Symbol.for("react.forward_ref"),Eh=Symbol.for("react.suspense"),Th=Symbol.for("react.suspense_list"),gm=Symbol.for("react.memo"),Br=Symbol.for("react.lazy"),w1=Symbol.for("react.offscreen"),a_=Symbol.iterator;function Jo(t){return t===null||typeof t!="object"?null:(t=a_&&t[a_]||t["@@iterator"],typeof t=="function"?t:null)}var Qe=Object.assign,cp;function pa(t){if(cp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cp=e&&e[1]||""}return`
`+cp+t}var dp=!1;function pp(t,e){if(!t||dp)return"";dp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{dp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?pa(t):""}function CS(t){switch(t.tag){case 5:return pa(t.type);case 16:return pa("Lazy");case 13:return pa("Suspense");case 19:return pa("SuspenseList");case 0:case 2:case 15:return t=pp(t.type,!1),t;case 11:return t=pp(t.type.render,!1),t;case 1:return t=pp(t.type,!0),t;default:return""}}function Sh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ls:return"Fragment";case Ns:return"Portal";case kh:return"Profiler";case fm:return"StrictMode";case Eh:return"Suspense";case Th:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case b1:return(t.displayName||"Context")+".Consumer";case v1:return(t._context.displayName||"Context")+".Provider";case mm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gm:return e=t.displayName||null,e!==null?e:Sh(t.type)||"Memo";case Br:e=t._payload,t=t._init;try{return Sh(t(e))}catch{}}return null}function IS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sh(e);case 8:return e===fm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function k1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AS(t){var e=k1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function eu(t){t._valueTracker||(t._valueTracker=AS(t))}function E1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=k1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ch(t,e){var n=e.checked;return Qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function l_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=yi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function T1(t,e){e=e.checked,e!=null&&hm(t,"checked",e,!1)}function Ih(t,e){T1(t,e);var n=yi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ah(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ah(t,e.type,yi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function u_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ah(t,e,n){(e!=="number"||sc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ha=Array.isArray;function Hs(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ph(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function c_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(ha(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:yi(n)}}function S1(t,e){var n=yi(e.value),r=yi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function d_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function C1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?C1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tu,I1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tu=tu||document.createElement("div"),tu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PS=["Webkit","ms","Moz","O"];Object.keys(ba).forEach(function(t){PS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ba[e]=ba[t]})});function A1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ba.hasOwnProperty(t)&&ba[t]?(""+e).trim():e+"px"}function P1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=A1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var RS=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nh(t,e){if(e){if(RS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Lh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dh=null;function ym(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Oh=null,$s=null,Ks=null;function p_(t){if(t=bl(t)){if(typeof Oh!="function")throw Error(H(280));var e=t.stateNode;e&&(e=ad(e),Oh(t.stateNode,t.type,e))}}function R1(t){$s?Ks?Ks.push(t):Ks=[t]:$s=t}function N1(){if($s){var t=$s,e=Ks;if(Ks=$s=null,p_(t),e)for(t=0;t<e.length;t++)p_(e[t])}}function L1(t,e){return t(e)}function D1(){}var hp=!1;function O1(t,e,n){if(hp)return t(e,n);hp=!0;try{return L1(t,e,n)}finally{hp=!1,($s!==null||Ks!==null)&&(D1(),N1())}}function Ba(t,e){var n=t.stateNode;if(n===null)return null;var r=ad(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var zh=!1;if(kr)try{var Zo={};Object.defineProperty(Zo,"passive",{get:function(){zh=!0}}),window.addEventListener("test",Zo,Zo),window.removeEventListener("test",Zo,Zo)}catch{zh=!1}function NS(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var wa=!1,oc=null,ac=!1,Mh=null,LS={onError:function(t){wa=!0,oc=t}};function DS(t,e,n,r,i,s,o,a,l){wa=!1,oc=null,NS.apply(LS,arguments)}function OS(t,e,n,r,i,s,o,a,l){if(DS.apply(this,arguments),wa){if(wa){var u=oc;wa=!1,oc=null}else throw Error(H(198));ac||(ac=!0,Mh=u)}}function fs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function z1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function h_(t){if(fs(t)!==t)throw Error(H(188))}function zS(t){var e=t.alternate;if(!e){if(e=fs(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return h_(i),t;if(s===r)return h_(i),e;s=s.sibling}throw Error(H(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function M1(t){return t=zS(t),t!==null?j1(t):null}function j1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=j1(t);if(e!==null)return e;t=t.sibling}return null}var V1=un.unstable_scheduleCallback,f_=un.unstable_cancelCallback,MS=un.unstable_shouldYield,jS=un.unstable_requestPaint,tt=un.unstable_now,VS=un.unstable_getCurrentPriorityLevel,_m=un.unstable_ImmediatePriority,F1=un.unstable_UserBlockingPriority,lc=un.unstable_NormalPriority,FS=un.unstable_LowPriority,U1=un.unstable_IdlePriority,rd=null,Zn=null;function US(t){if(Zn&&typeof Zn.onCommitFiberRoot=="function")try{Zn.onCommitFiberRoot(rd,t,void 0,(t.current.flags&128)===128)}catch{}}var Vn=Math.clz32?Math.clz32:WS,qS=Math.log,BS=Math.LN2;function WS(t){return t>>>=0,t===0?32:31-(qS(t)/BS|0)|0}var nu=64,ru=4194304;function fa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function uc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=fa(a):(s&=o,s!==0&&(r=fa(s)))}else o=n&~i,o!==0?r=fa(o):s!==0&&(r=fa(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vn(e),i=1<<n,r|=t[n],e&=~i;return r}function HS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $S(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Vn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=HS(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function jh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function q1(){var t=nu;return nu<<=1,!(nu&4194240)&&(nu=64),t}function fp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vn(e),t[e]=n}function KS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Vn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function xm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Le=0;function B1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var W1,vm,H1,$1,K1,Vh=!1,iu=[],ti=null,ni=null,ri=null,Wa=new Map,Ha=new Map,Hr=[],QS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function m_(t,e){switch(t){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":Wa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ha.delete(e.pointerId)}}function ea(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=bl(e),e!==null&&vm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function GS(t,e,n,r,i){switch(e){case"focusin":return ti=ea(ti,t,e,n,r,i),!0;case"dragenter":return ni=ea(ni,t,e,n,r,i),!0;case"mouseover":return ri=ea(ri,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Wa.set(s,ea(Wa.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ha.set(s,ea(Ha.get(s)||null,t,e,n,r,i)),!0}return!1}function Q1(t){var e=Bi(t.target);if(e!==null){var n=fs(e);if(n!==null){if(e=n.tag,e===13){if(e=z1(n),e!==null){t.blockedOn=e,K1(t.priority,function(){H1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Dh=r,n.target.dispatchEvent(r),Dh=null}else return e=bl(n),e!==null&&vm(e),t.blockedOn=n,!1;e.shift()}return!0}function g_(t,e,n){Nu(t)&&n.delete(e)}function YS(){Vh=!1,ti!==null&&Nu(ti)&&(ti=null),ni!==null&&Nu(ni)&&(ni=null),ri!==null&&Nu(ri)&&(ri=null),Wa.forEach(g_),Ha.forEach(g_)}function ta(t,e){t.blockedOn===e&&(t.blockedOn=null,Vh||(Vh=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,YS)))}function $a(t){function e(i){return ta(i,t)}if(0<iu.length){ta(iu[0],t);for(var n=1;n<iu.length;n++){var r=iu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ti!==null&&ta(ti,t),ni!==null&&ta(ni,t),ri!==null&&ta(ri,t),Wa.forEach(e),Ha.forEach(e),n=0;n<Hr.length;n++)r=Hr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hr.length&&(n=Hr[0],n.blockedOn===null);)Q1(n),n.blockedOn===null&&Hr.shift()}var Qs=Rr.ReactCurrentBatchConfig,cc=!0;function XS(t,e,n,r){var i=Le,s=Qs.transition;Qs.transition=null;try{Le=1,bm(t,e,n,r)}finally{Le=i,Qs.transition=s}}function JS(t,e,n,r){var i=Le,s=Qs.transition;Qs.transition=null;try{Le=4,bm(t,e,n,r)}finally{Le=i,Qs.transition=s}}function bm(t,e,n,r){if(cc){var i=Fh(t,e,n,r);if(i===null)Ep(t,e,r,dc,n),m_(t,r);else if(GS(i,t,e,n,r))r.stopPropagation();else if(m_(t,r),e&4&&-1<QS.indexOf(t)){for(;i!==null;){var s=bl(i);if(s!==null&&W1(s),s=Fh(t,e,n,r),s===null&&Ep(t,e,r,dc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ep(t,e,r,null,n)}}var dc=null;function Fh(t,e,n,r){if(dc=null,t=ym(r),t=Bi(t),t!==null)if(e=fs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=z1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dc=t,null}function G1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VS()){case _m:return 1;case F1:return 4;case lc:case FS:return 16;case U1:return 536870912;default:return 16}default:return 16}}var Yr=null,wm=null,Lu=null;function Y1(){if(Lu)return Lu;var t,e=wm,n=e.length,r,i="value"in Yr?Yr.value:Yr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Lu=i.slice(t,1<r?1-r:void 0)}function Du(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function su(){return!0}function y_(){return!1}function pn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?su:y_,this.isPropagationStopped=y_,this}return Qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=su)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=su)},persist:function(){},isPersistent:su}),e}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},km=pn(To),vl=Qe({},To,{view:0,detail:0}),ZS=pn(vl),mp,gp,na,id=Qe({},vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Em,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==na&&(na&&t.type==="mousemove"?(mp=t.screenX-na.screenX,gp=t.screenY-na.screenY):gp=mp=0,na=t),mp)},movementY:function(t){return"movementY"in t?t.movementY:gp}}),__=pn(id),eC=Qe({},id,{dataTransfer:0}),tC=pn(eC),nC=Qe({},vl,{relatedTarget:0}),yp=pn(nC),rC=Qe({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),iC=pn(rC),sC=Qe({},To,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oC=pn(sC),aC=Qe({},To,{data:0}),x_=pn(aC),lC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cC[t])?!!e[t]:!1}function Em(){return dC}var pC=Qe({},vl,{key:function(t){if(t.key){var e=lC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Du(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Em,charCode:function(t){return t.type==="keypress"?Du(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Du(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hC=pn(pC),fC=Qe({},id,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),v_=pn(fC),mC=Qe({},vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Em}),gC=pn(mC),yC=Qe({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),_C=pn(yC),xC=Qe({},id,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vC=pn(xC),bC=[9,13,27,32],Tm=kr&&"CompositionEvent"in window,ka=null;kr&&"documentMode"in document&&(ka=document.documentMode);var wC=kr&&"TextEvent"in window&&!ka,X1=kr&&(!Tm||ka&&8<ka&&11>=ka),b_=" ",w_=!1;function J1(t,e){switch(t){case"keyup":return bC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ds=!1;function kC(t,e){switch(t){case"compositionend":return Z1(e);case"keypress":return e.which!==32?null:(w_=!0,b_);case"textInput":return t=e.data,t===b_&&w_?null:t;default:return null}}function EC(t,e){if(Ds)return t==="compositionend"||!Tm&&J1(t,e)?(t=Y1(),Lu=wm=Yr=null,Ds=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return X1&&e.locale!=="ko"?null:e.data;default:return null}}var TC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TC[t.type]:e==="textarea"}function eb(t,e,n,r){R1(r),e=pc(e,"onChange"),0<e.length&&(n=new km("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ea=null,Ka=null;function SC(t){db(t,0)}function sd(t){var e=Ms(t);if(E1(e))return t}function CC(t,e){if(t==="change")return e}var tb=!1;if(kr){var _p;if(kr){var xp="oninput"in document;if(!xp){var E_=document.createElement("div");E_.setAttribute("oninput","return;"),xp=typeof E_.oninput=="function"}_p=xp}else _p=!1;tb=_p&&(!document.documentMode||9<document.documentMode)}function T_(){Ea&&(Ea.detachEvent("onpropertychange",nb),Ka=Ea=null)}function nb(t){if(t.propertyName==="value"&&sd(Ka)){var e=[];eb(e,Ka,t,ym(t)),O1(SC,e)}}function IC(t,e,n){t==="focusin"?(T_(),Ea=e,Ka=n,Ea.attachEvent("onpropertychange",nb)):t==="focusout"&&T_()}function AC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sd(Ka)}function PC(t,e){if(t==="click")return sd(e)}function RC(t,e){if(t==="input"||t==="change")return sd(e)}function NC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wn=typeof Object.is=="function"?Object.is:NC;function Qa(t,e){if(Wn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!wh.call(e,i)||!Wn(t[i],e[i]))return!1}return!0}function S_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function C_(t,e){var n=S_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=S_(n)}}function rb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ib(){for(var t=window,e=sc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sc(t.document)}return e}function Sm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LC(t){var e=ib(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rb(n.ownerDocument.documentElement,n)){if(r!==null&&Sm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=C_(n,s);var o=C_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DC=kr&&"documentMode"in document&&11>=document.documentMode,Os=null,Uh=null,Ta=null,qh=!1;function I_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qh||Os==null||Os!==sc(r)||(r=Os,"selectionStart"in r&&Sm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ta&&Qa(Ta,r)||(Ta=r,r=pc(Uh,"onSelect"),0<r.length&&(e=new km("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Os)))}function ou(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var zs={animationend:ou("Animation","AnimationEnd"),animationiteration:ou("Animation","AnimationIteration"),animationstart:ou("Animation","AnimationStart"),transitionend:ou("Transition","TransitionEnd")},vp={},sb={};kr&&(sb=document.createElement("div").style,"AnimationEvent"in window||(delete zs.animationend.animation,delete zs.animationiteration.animation,delete zs.animationstart.animation),"TransitionEvent"in window||delete zs.transitionend.transition);function od(t){if(vp[t])return vp[t];if(!zs[t])return t;var e=zs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sb)return vp[t]=e[n];return t}var ob=od("animationend"),ab=od("animationiteration"),lb=od("animationstart"),ub=od("transitionend"),cb=new Map,A_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ti(t,e){cb.set(t,e),hs(e,[t])}for(var bp=0;bp<A_.length;bp++){var wp=A_[bp],OC=wp.toLowerCase(),zC=wp[0].toUpperCase()+wp.slice(1);Ti(OC,"on"+zC)}Ti(ob,"onAnimationEnd");Ti(ab,"onAnimationIteration");Ti(lb,"onAnimationStart");Ti("dblclick","onDoubleClick");Ti("focusin","onFocus");Ti("focusout","onBlur");Ti(ub,"onTransitionEnd");oo("onMouseEnter",["mouseout","mouseover"]);oo("onMouseLeave",["mouseout","mouseover"]);oo("onPointerEnter",["pointerout","pointerover"]);oo("onPointerLeave",["pointerout","pointerover"]);hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MC=new Set("cancel close invalid load scroll toggle".split(" ").concat(ma));function P_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,OS(r,e,void 0,t),t.currentTarget=null}function db(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;P_(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;P_(i,a,u),s=l}}}if(ac)throw t=Mh,ac=!1,Mh=null,t}function Fe(t,e){var n=e[Kh];n===void 0&&(n=e[Kh]=new Set);var r=t+"__bubble";n.has(r)||(pb(e,t,2,!1),n.add(r))}function kp(t,e,n){var r=0;e&&(r|=4),pb(n,t,r,e)}var au="_reactListening"+Math.random().toString(36).slice(2);function Ga(t){if(!t[au]){t[au]=!0,x1.forEach(function(n){n!=="selectionchange"&&(MC.has(n)||kp(n,!1,t),kp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[au]||(e[au]=!0,kp("selectionchange",!1,e))}}function pb(t,e,n,r){switch(G1(e)){case 1:var i=XS;break;case 4:i=JS;break;default:i=bm}n=i.bind(null,e,n,t),i=void 0,!zh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ep(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Bi(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}O1(function(){var u=s,d=ym(n),p=[];e:{var f=cb.get(t);if(f!==void 0){var g=km,_=t;switch(t){case"keypress":if(Du(n)===0)break e;case"keydown":case"keyup":g=hC;break;case"focusin":_="focus",g=yp;break;case"focusout":_="blur",g=yp;break;case"beforeblur":case"afterblur":g=yp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=__;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=tC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=gC;break;case ob:case ab:case lb:g=iC;break;case ub:g=_C;break;case"scroll":g=ZS;break;case"wheel":g=vC;break;case"copy":case"cut":case"paste":g=oC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=v_}var k=(e&4)!==0,I=!k&&t==="scroll",x=k?f!==null?f+"Capture":null:f;k=[];for(var v=u,w;v!==null;){w=v;var M=w.stateNode;if(w.tag===5&&M!==null&&(w=M,x!==null&&(M=Ba(v,x),M!=null&&k.push(Ya(v,M,w)))),I)break;v=v.return}0<k.length&&(f=new g(f,_,null,n,d),p.push({event:f,listeners:k}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==Dh&&(_=n.relatedTarget||n.fromElement)&&(Bi(_)||_[Er]))break e;if((g||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,g?(_=n.relatedTarget||n.toElement,g=u,_=_?Bi(_):null,_!==null&&(I=fs(_),_!==I||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=u),g!==_)){if(k=__,M="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(k=v_,M="onPointerLeave",x="onPointerEnter",v="pointer"),I=g==null?f:Ms(g),w=_==null?f:Ms(_),f=new k(M,v+"leave",g,n,d),f.target=I,f.relatedTarget=w,M=null,Bi(d)===u&&(k=new k(x,v+"enter",_,n,d),k.target=w,k.relatedTarget=I,M=k),I=M,g&&_)t:{for(k=g,x=_,v=0,w=k;w;w=Es(w))v++;for(w=0,M=x;M;M=Es(M))w++;for(;0<v-w;)k=Es(k),v--;for(;0<w-v;)x=Es(x),w--;for(;v--;){if(k===x||x!==null&&k===x.alternate)break t;k=Es(k),x=Es(x)}k=null}else k=null;g!==null&&R_(p,f,g,k,!1),_!==null&&I!==null&&R_(p,I,_,k,!0)}}e:{if(f=u?Ms(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var O=CC;else if(k_(f))if(tb)O=RC;else{O=AC;var D=IC}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=PC);if(O&&(O=O(t,u))){eb(p,O,n,d);break e}D&&D(t,f,u),t==="focusout"&&(D=f._wrapperState)&&D.controlled&&f.type==="number"&&Ah(f,"number",f.value)}switch(D=u?Ms(u):window,t){case"focusin":(k_(D)||D.contentEditable==="true")&&(Os=D,Uh=u,Ta=null);break;case"focusout":Ta=Uh=Os=null;break;case"mousedown":qh=!0;break;case"contextmenu":case"mouseup":case"dragend":qh=!1,I_(p,n,d);break;case"selectionchange":if(DC)break;case"keydown":case"keyup":I_(p,n,d)}var S;if(Tm)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ds?J1(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(X1&&n.locale!=="ko"&&(Ds||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ds&&(S=Y1()):(Yr=d,wm="value"in Yr?Yr.value:Yr.textContent,Ds=!0)),D=pc(u,E),0<D.length&&(E=new x_(E,t,null,n,d),p.push({event:E,listeners:D}),S?E.data=S:(S=Z1(n),S!==null&&(E.data=S)))),(S=wC?kC(t,n):EC(t,n))&&(u=pc(u,"onBeforeInput"),0<u.length&&(d=new x_("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=S))}db(p,e)})}function Ya(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ba(t,n),s!=null&&r.unshift(Ya(t,s,i)),s=Ba(t,e),s!=null&&r.push(Ya(t,s,i))),t=t.return}return r}function Es(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function R_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Ba(n,s),l!=null&&o.unshift(Ya(n,l,a))):i||(l=Ba(n,s),l!=null&&o.push(Ya(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jC=/\r\n?/g,VC=/\u0000|\uFFFD/g;function N_(t){return(typeof t=="string"?t:""+t).replace(jC,`
`).replace(VC,"")}function lu(t,e,n){if(e=N_(e),N_(t)!==e&&n)throw Error(H(425))}function hc(){}var Bh=null,Wh=null;function Hh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $h=typeof setTimeout=="function"?setTimeout:void 0,FC=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,UC=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(t){return L_.resolve(null).then(t).catch(qC)}:$h;function qC(t){setTimeout(function(){throw t})}function Tp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),$a(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$a(e)}function ii(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function D_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var So=Math.random().toString(36).slice(2),Jn="__reactFiber$"+So,Xa="__reactProps$"+So,Er="__reactContainer$"+So,Kh="__reactEvents$"+So,BC="__reactListeners$"+So,WC="__reactHandles$"+So;function Bi(t){var e=t[Jn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Er]||n[Jn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=D_(t);t!==null;){if(n=t[Jn])return n;t=D_(t)}return e}t=n,n=t.parentNode}return null}function bl(t){return t=t[Jn]||t[Er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ms(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function ad(t){return t[Xa]||null}var Qh=[],js=-1;function Si(t){return{current:t}}function Be(t){0>js||(t.current=Qh[js],Qh[js]=null,js--)}function je(t,e){js++,Qh[js]=t.current,t.current=e}var _i={},Dt=Si(_i),Xt=Si(!1),Zi=_i;function ao(t,e){var n=t.type.contextTypes;if(!n)return _i;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Jt(t){return t=t.childContextTypes,t!=null}function fc(){Be(Xt),Be(Dt)}function O_(t,e,n){if(Dt.current!==_i)throw Error(H(168));je(Dt,e),je(Xt,n)}function hb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(H(108,IS(t)||"Unknown",i));return Qe({},n,r)}function mc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_i,Zi=Dt.current,je(Dt,t),je(Xt,Xt.current),!0}function z_(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=hb(t,e,Zi),r.__reactInternalMemoizedMergedChildContext=t,Be(Xt),Be(Dt),je(Dt,t)):Be(Xt),je(Xt,n)}var gr=null,ld=!1,Sp=!1;function fb(t){gr===null?gr=[t]:gr.push(t)}function HC(t){ld=!0,fb(t)}function Ci(){if(!Sp&&gr!==null){Sp=!0;var t=0,e=Le;try{var n=gr;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}gr=null,ld=!1}catch(i){throw gr!==null&&(gr=gr.slice(t+1)),V1(_m,Ci),i}finally{Le=e,Sp=!1}}return null}var Vs=[],Fs=0,gc=null,yc=0,gn=[],yn=0,es=null,_r=1,xr="";function Mi(t,e){Vs[Fs++]=yc,Vs[Fs++]=gc,gc=t,yc=e}function mb(t,e,n){gn[yn++]=_r,gn[yn++]=xr,gn[yn++]=es,es=t;var r=_r;t=xr;var i=32-Vn(r)-1;r&=~(1<<i),n+=1;var s=32-Vn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,_r=1<<32-Vn(e)+i|n<<i|r,xr=s+t}else _r=1<<s|n<<i|r,xr=t}function Cm(t){t.return!==null&&(Mi(t,1),mb(t,1,0))}function Im(t){for(;t===gc;)gc=Vs[--Fs],Vs[Fs]=null,yc=Vs[--Fs],Vs[Fs]=null;for(;t===es;)es=gn[--yn],gn[yn]=null,xr=gn[--yn],gn[yn]=null,_r=gn[--yn],gn[yn]=null}var an=null,on=null,We=!1,Dn=null;function gb(t,e){var n=bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function M_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,an=t,on=ii(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,an=t,on=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=es!==null?{id:_r,overflow:xr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,an=t,on=null,!0):!1;default:return!1}}function Gh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Yh(t){if(We){var e=on;if(e){var n=e;if(!M_(t,e)){if(Gh(t))throw Error(H(418));e=ii(n.nextSibling);var r=an;e&&M_(t,e)?gb(r,n):(t.flags=t.flags&-4097|2,We=!1,an=t)}}else{if(Gh(t))throw Error(H(418));t.flags=t.flags&-4097|2,We=!1,an=t}}}function j_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;an=t}function uu(t){if(t!==an)return!1;if(!We)return j_(t),We=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Hh(t.type,t.memoizedProps)),e&&(e=on)){if(Gh(t))throw yb(),Error(H(418));for(;e;)gb(t,e),e=ii(e.nextSibling)}if(j_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){on=ii(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}on=null}}else on=an?ii(t.stateNode.nextSibling):null;return!0}function yb(){for(var t=on;t;)t=ii(t.nextSibling)}function lo(){on=an=null,We=!1}function Am(t){Dn===null?Dn=[t]:Dn.push(t)}var $C=Rr.ReactCurrentBatchConfig;function ra(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function cu(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function V_(t){var e=t._init;return e(t._payload)}function _b(t){function e(x,v){if(t){var w=x.deletions;w===null?(x.deletions=[v],x.flags|=16):w.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function i(x,v){return x=li(x,v),x.index=0,x.sibling=null,x}function s(x,v,w){return x.index=w,t?(w=x.alternate,w!==null?(w=w.index,w<v?(x.flags|=2,v):w):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,v,w,M){return v===null||v.tag!==6?(v=Lp(w,x.mode,M),v.return=x,v):(v=i(v,w),v.return=x,v)}function l(x,v,w,M){var O=w.type;return O===Ls?d(x,v,w.props.children,M,w.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Br&&V_(O)===v.type)?(M=i(v,w.props),M.ref=ra(x,v,w),M.return=x,M):(M=Uu(w.type,w.key,w.props,null,x.mode,M),M.ref=ra(x,v,w),M.return=x,M)}function u(x,v,w,M){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Dp(w,x.mode,M),v.return=x,v):(v=i(v,w.children||[]),v.return=x,v)}function d(x,v,w,M,O){return v===null||v.tag!==7?(v=Yi(w,x.mode,M,O),v.return=x,v):(v=i(v,w),v.return=x,v)}function p(x,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lp(""+v,x.mode,w),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Zl:return w=Uu(v.type,v.key,v.props,null,x.mode,w),w.ref=ra(x,null,v),w.return=x,w;case Ns:return v=Dp(v,x.mode,w),v.return=x,v;case Br:var M=v._init;return p(x,M(v._payload),w)}if(ha(v)||Jo(v))return v=Yi(v,x.mode,w,null),v.return=x,v;cu(x,v)}return null}function f(x,v,w,M){var O=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return O!==null?null:a(x,v,""+w,M);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Zl:return w.key===O?l(x,v,w,M):null;case Ns:return w.key===O?u(x,v,w,M):null;case Br:return O=w._init,f(x,v,O(w._payload),M)}if(ha(w)||Jo(w))return O!==null?null:d(x,v,w,M,null);cu(x,w)}return null}function g(x,v,w,M,O){if(typeof M=="string"&&M!==""||typeof M=="number")return x=x.get(w)||null,a(v,x,""+M,O);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Zl:return x=x.get(M.key===null?w:M.key)||null,l(v,x,M,O);case Ns:return x=x.get(M.key===null?w:M.key)||null,u(v,x,M,O);case Br:var D=M._init;return g(x,v,w,D(M._payload),O)}if(ha(M)||Jo(M))return x=x.get(w)||null,d(v,x,M,O,null);cu(v,M)}return null}function _(x,v,w,M){for(var O=null,D=null,S=v,E=v=0,C=null;S!==null&&E<w.length;E++){S.index>E?(C=S,S=null):C=S.sibling;var b=f(x,S,w[E],M);if(b===null){S===null&&(S=C);break}t&&S&&b.alternate===null&&e(x,S),v=s(b,v,E),D===null?O=b:D.sibling=b,D=b,S=C}if(E===w.length)return n(x,S),We&&Mi(x,E),O;if(S===null){for(;E<w.length;E++)S=p(x,w[E],M),S!==null&&(v=s(S,v,E),D===null?O=S:D.sibling=S,D=S);return We&&Mi(x,E),O}for(S=r(x,S);E<w.length;E++)C=g(S,x,E,w[E],M),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?E:C.key),v=s(C,v,E),D===null?O=C:D.sibling=C,D=C);return t&&S.forEach(function(A){return e(x,A)}),We&&Mi(x,E),O}function k(x,v,w,M){var O=Jo(w);if(typeof O!="function")throw Error(H(150));if(w=O.call(w),w==null)throw Error(H(151));for(var D=O=null,S=v,E=v=0,C=null,b=w.next();S!==null&&!b.done;E++,b=w.next()){S.index>E?(C=S,S=null):C=S.sibling;var A=f(x,S,b.value,M);if(A===null){S===null&&(S=C);break}t&&S&&A.alternate===null&&e(x,S),v=s(A,v,E),D===null?O=A:D.sibling=A,D=A,S=C}if(b.done)return n(x,S),We&&Mi(x,E),O;if(S===null){for(;!b.done;E++,b=w.next())b=p(x,b.value,M),b!==null&&(v=s(b,v,E),D===null?O=b:D.sibling=b,D=b);return We&&Mi(x,E),O}for(S=r(x,S);!b.done;E++,b=w.next())b=g(S,x,E,b.value,M),b!==null&&(t&&b.alternate!==null&&S.delete(b.key===null?E:b.key),v=s(b,v,E),D===null?O=b:D.sibling=b,D=b);return t&&S.forEach(function(N){return e(x,N)}),We&&Mi(x,E),O}function I(x,v,w,M){if(typeof w=="object"&&w!==null&&w.type===Ls&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Zl:e:{for(var O=w.key,D=v;D!==null;){if(D.key===O){if(O=w.type,O===Ls){if(D.tag===7){n(x,D.sibling),v=i(D,w.props.children),v.return=x,x=v;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Br&&V_(O)===D.type){n(x,D.sibling),v=i(D,w.props),v.ref=ra(x,D,w),v.return=x,x=v;break e}n(x,D);break}else e(x,D);D=D.sibling}w.type===Ls?(v=Yi(w.props.children,x.mode,M,w.key),v.return=x,x=v):(M=Uu(w.type,w.key,w.props,null,x.mode,M),M.ref=ra(x,v,w),M.return=x,x=M)}return o(x);case Ns:e:{for(D=w.key;v!==null;){if(v.key===D)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(x,v.sibling),v=i(v,w.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=Dp(w,x.mode,M),v.return=x,x=v}return o(x);case Br:return D=w._init,I(x,v,D(w._payload),M)}if(ha(w))return _(x,v,w,M);if(Jo(w))return k(x,v,w,M);cu(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(x,v.sibling),v=i(v,w),v.return=x,x=v):(n(x,v),v=Lp(w,x.mode,M),v.return=x,x=v),o(x)):n(x,v)}return I}var uo=_b(!0),xb=_b(!1),_c=Si(null),xc=null,Us=null,Pm=null;function Rm(){Pm=Us=xc=null}function Nm(t){var e=_c.current;Be(_c),t._currentValue=e}function Xh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Gs(t,e){xc=t,Pm=Us=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yt=!0),t.firstContext=null)}function kn(t){var e=t._currentValue;if(Pm!==t)if(t={context:t,memoizedValue:e,next:null},Us===null){if(xc===null)throw Error(H(308));Us=t,xc.dependencies={lanes:0,firstContext:t}}else Us=Us.next=t;return e}var Wi=null;function Lm(t){Wi===null?Wi=[t]:Wi.push(t)}function vb(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Lm(e)):(n.next=i.next,i.next=n),e.interleaved=n,Tr(t,r)}function Tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wr=!1;function Dm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function wr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function si(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ce&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Tr(t,n)}return i=r.interleaved,i===null?(e.next=e,Lm(r)):(e.next=i.next,i.next=e),r.interleaved=e,Tr(t,n)}function Ou(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xm(t,n)}}function F_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vc(t,e,n,r){var i=t.updateQueue;Wr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,d=u=l=null,a=s;do{var f=a.lane,g=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,k=a;switch(f=e,g=n,k.tag){case 1:if(_=k.payload,typeof _=="function"){p=_.call(g,p,f);break e}p=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=k.payload,f=typeof _=="function"?_.call(g,p,f):_,f==null)break e;p=Qe({},p,f);break e;case 2:Wr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=g,l=p):d=d.next=g,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ns|=o,t.lanes=o,t.memoizedState=p}}function U_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(H(191,i));i.call(r)}}}var wl={},er=Si(wl),Ja=Si(wl),Za=Si(wl);function Hi(t){if(t===wl)throw Error(H(174));return t}function Om(t,e){switch(je(Za,e),je(Ja,t),je(er,wl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Rh(e,t)}Be(er),je(er,e)}function co(){Be(er),Be(Ja),Be(Za)}function wb(t){Hi(Za.current);var e=Hi(er.current),n=Rh(e,t.type);e!==n&&(je(Ja,t),je(er,n))}function zm(t){Ja.current===t&&(Be(er),Be(Ja))}var $e=Si(0);function bc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cp=[];function Mm(){for(var t=0;t<Cp.length;t++)Cp[t]._workInProgressVersionPrimary=null;Cp.length=0}var zu=Rr.ReactCurrentDispatcher,Ip=Rr.ReactCurrentBatchConfig,ts=0,Ke=null,ut=null,yt=null,wc=!1,Sa=!1,el=0,KC=0;function St(){throw Error(H(321))}function jm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wn(t[n],e[n]))return!1;return!0}function Vm(t,e,n,r,i,s){if(ts=s,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zu.current=t===null||t.memoizedState===null?XC:JC,t=n(r,i),Sa){s=0;do{if(Sa=!1,el=0,25<=s)throw Error(H(301));s+=1,yt=ut=null,e.updateQueue=null,zu.current=ZC,t=n(r,i)}while(Sa)}if(zu.current=kc,e=ut!==null&&ut.next!==null,ts=0,yt=ut=Ke=null,wc=!1,e)throw Error(H(300));return t}function Fm(){var t=el!==0;return el=0,t}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?Ke.memoizedState=yt=t:yt=yt.next=t,yt}function En(){if(ut===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=ut.next;var e=yt===null?Ke.memoizedState:yt.next;if(e!==null)yt=e,ut=t;else{if(t===null)throw Error(H(310));ut=t,t={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},yt===null?Ke.memoizedState=yt=t:yt=yt.next=t}return yt}function tl(t,e){return typeof e=="function"?e(t):e}function Ap(t){var e=En(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=ut,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((ts&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,Ke.lanes|=d,ns|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Wn(r,e.memoizedState)||(Yt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ke.lanes|=s,ns|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Pp(t){var e=En(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Wn(s,e.memoizedState)||(Yt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function kb(){}function Eb(t,e){var n=Ke,r=En(),i=e(),s=!Wn(r.memoizedState,i);if(s&&(r.memoizedState=i,Yt=!0),r=r.queue,Um(Cb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||yt!==null&&yt.memoizedState.tag&1){if(n.flags|=2048,nl(9,Sb.bind(null,n,r,i,e),void 0,null),xt===null)throw Error(H(349));ts&30||Tb(n,e,i)}return i}function Tb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Sb(t,e,n,r){e.value=n,e.getSnapshot=r,Ib(e)&&Ab(t)}function Cb(t,e,n){return n(function(){Ib(e)&&Ab(t)})}function Ib(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wn(t,n)}catch{return!0}}function Ab(t){var e=Tr(t,1);e!==null&&Fn(e,t,1,-1)}function q_(t){var e=Gn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:t},e.queue=t,t=t.dispatch=YC.bind(null,Ke,t),[e.memoizedState,t]}function nl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Pb(){return En().memoizedState}function Mu(t,e,n,r){var i=Gn();Ke.flags|=t,i.memoizedState=nl(1|e,n,void 0,r===void 0?null:r)}function ud(t,e,n,r){var i=En();r=r===void 0?null:r;var s=void 0;if(ut!==null){var o=ut.memoizedState;if(s=o.destroy,r!==null&&jm(r,o.deps)){i.memoizedState=nl(e,n,s,r);return}}Ke.flags|=t,i.memoizedState=nl(1|e,n,s,r)}function B_(t,e){return Mu(8390656,8,t,e)}function Um(t,e){return ud(2048,8,t,e)}function Rb(t,e){return ud(4,2,t,e)}function Nb(t,e){return ud(4,4,t,e)}function Lb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Db(t,e,n){return n=n!=null?n.concat([t]):null,ud(4,4,Lb.bind(null,e,t),n)}function qm(){}function Ob(t,e){var n=En();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jm(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function zb(t,e){var n=En();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jm(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Mb(t,e,n){return ts&21?(Wn(n,e)||(n=q1(),Ke.lanes|=n,ns|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yt=!0),t.memoizedState=n)}function QC(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=Ip.transition;Ip.transition={};try{t(!1),e()}finally{Le=n,Ip.transition=r}}function jb(){return En().memoizedState}function GC(t,e,n){var r=ai(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Vb(t))Fb(e,n);else if(n=vb(t,e,n,r),n!==null){var i=qt();Fn(n,t,r,i),Ub(n,e,r)}}function YC(t,e,n){var r=ai(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vb(t))Fb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Wn(a,o)){var l=e.interleaved;l===null?(i.next=i,Lm(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=vb(t,e,i,r),n!==null&&(i=qt(),Fn(n,t,r,i),Ub(n,e,r))}}function Vb(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function Fb(t,e){Sa=wc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ub(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xm(t,n)}}var kc={readContext:kn,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},XC={readContext:kn,useCallback:function(t,e){return Gn().memoizedState=[t,e===void 0?null:e],t},useContext:kn,useEffect:B_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4194308,4,Lb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mu(4,2,t,e)},useMemo:function(t,e){var n=Gn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=GC.bind(null,Ke,t),[r.memoizedState,t]},useRef:function(t){var e=Gn();return t={current:t},e.memoizedState=t},useState:q_,useDebugValue:qm,useDeferredValue:function(t){return Gn().memoizedState=t},useTransition:function(){var t=q_(!1),e=t[0];return t=QC.bind(null,t[1]),Gn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ke,i=Gn();if(We){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),xt===null)throw Error(H(349));ts&30||Tb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,B_(Cb.bind(null,r,s,t),[t]),r.flags|=2048,nl(9,Sb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Gn(),e=xt.identifierPrefix;if(We){var n=xr,r=_r;n=(r&~(1<<32-Vn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=el++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=KC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},JC={readContext:kn,useCallback:Ob,useContext:kn,useEffect:Um,useImperativeHandle:Db,useInsertionEffect:Rb,useLayoutEffect:Nb,useMemo:zb,useReducer:Ap,useRef:Pb,useState:function(){return Ap(tl)},useDebugValue:qm,useDeferredValue:function(t){var e=En();return Mb(e,ut.memoizedState,t)},useTransition:function(){var t=Ap(tl)[0],e=En().memoizedState;return[t,e]},useMutableSource:kb,useSyncExternalStore:Eb,useId:jb,unstable_isNewReconciler:!1},ZC={readContext:kn,useCallback:Ob,useContext:kn,useEffect:Um,useImperativeHandle:Db,useInsertionEffect:Rb,useLayoutEffect:Nb,useMemo:zb,useReducer:Pp,useRef:Pb,useState:function(){return Pp(tl)},useDebugValue:qm,useDeferredValue:function(t){var e=En();return ut===null?e.memoizedState=t:Mb(e,ut.memoizedState,t)},useTransition:function(){var t=Pp(tl)[0],e=En().memoizedState;return[t,e]},useMutableSource:kb,useSyncExternalStore:Eb,useId:jb,unstable_isNewReconciler:!1};function Nn(t,e){if(t&&t.defaultProps){e=Qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Jh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cd={isMounted:function(t){return(t=t._reactInternals)?fs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=qt(),i=ai(t),s=wr(r,i);s.payload=e,n!=null&&(s.callback=n),e=si(t,s,i),e!==null&&(Fn(e,t,i,r),Ou(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=qt(),i=ai(t),s=wr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=si(t,s,i),e!==null&&(Fn(e,t,i,r),Ou(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=qt(),r=ai(t),i=wr(n,r);i.tag=2,e!=null&&(i.callback=e),e=si(t,i,r),e!==null&&(Fn(e,t,r,n),Ou(e,t,r))}};function W_(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Qa(n,r)||!Qa(i,s):!0}function qb(t,e,n){var r=!1,i=_i,s=e.contextType;return typeof s=="object"&&s!==null?s=kn(s):(i=Jt(e)?Zi:Dt.current,r=e.contextTypes,s=(r=r!=null)?ao(t,i):_i),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function H_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cd.enqueueReplaceState(e,e.state,null)}function Zh(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Dm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=kn(s):(s=Jt(e)?Zi:Dt.current,i.context=ao(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Jh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cd.enqueueReplaceState(i,i.state,null),vc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function po(t,e){try{var n="",r=e;do n+=CS(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Rp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ef(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var eI=typeof WeakMap=="function"?WeakMap:Map;function Bb(t,e,n){n=wr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Tc||(Tc=!0,df=r),ef(t,e)},n}function Wb(t,e,n){n=wr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ef(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ef(t,e),typeof r!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function $_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new eI;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=fI.bind(null,t,e,n),e.then(t,t))}function K_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Q_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=wr(-1,1),e.tag=2,si(n,e,1))),n.lanes|=1),t)}var tI=Rr.ReactCurrentOwner,Yt=!1;function Vt(t,e,n,r){e.child=t===null?xb(e,null,n,r):uo(e,t.child,n,r)}function G_(t,e,n,r,i){n=n.render;var s=e.ref;return Gs(e,i),r=Vm(t,e,n,r,s,i),n=Fm(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Sr(t,e,i)):(We&&n&&Cm(e),e.flags|=1,Vt(t,e,r,i),e.child)}function Y_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ym(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Hb(t,e,s,r,i)):(t=Uu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Qa,n(o,r)&&t.ref===e.ref)return Sr(t,e,i)}return e.flags|=1,t=li(s,r),t.ref=e.ref,t.return=e,e.child=t}function Hb(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Qa(s,r)&&t.ref===e.ref)if(Yt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Yt=!0);else return e.lanes=t.lanes,Sr(t,e,i)}return tf(t,e,n,r,i)}function $b(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Bs,rn),rn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,je(Bs,rn),rn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,je(Bs,rn),rn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,je(Bs,rn),rn|=r;return Vt(t,e,i,n),e.child}function Kb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function tf(t,e,n,r,i){var s=Jt(n)?Zi:Dt.current;return s=ao(e,s),Gs(e,i),n=Vm(t,e,n,r,s,i),r=Fm(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Sr(t,e,i)):(We&&r&&Cm(e),e.flags|=1,Vt(t,e,n,i),e.child)}function X_(t,e,n,r,i){if(Jt(n)){var s=!0;mc(e)}else s=!1;if(Gs(e,i),e.stateNode===null)ju(t,e),qb(e,n,r),Zh(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=kn(u):(u=Jt(n)?Zi:Dt.current,u=ao(e,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&H_(e,o,r,u),Wr=!1;var f=e.memoizedState;o.state=f,vc(e,r,o,i),l=e.memoizedState,a!==r||f!==l||Xt.current||Wr?(typeof d=="function"&&(Jh(e,n,d,r),l=e.memoizedState),(a=Wr||W_(e,n,a,r,f,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,bb(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Nn(e.type,a),o.props=u,p=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=kn(l):(l=Jt(n)?Zi:Dt.current,l=ao(e,l));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||f!==l)&&H_(e,o,r,l),Wr=!1,f=e.memoizedState,o.state=f,vc(e,r,o,i);var _=e.memoizedState;a!==p||f!==_||Xt.current||Wr?(typeof g=="function"&&(Jh(e,n,g,r),_=e.memoizedState),(u=Wr||W_(e,n,u,r,f,_,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return nf(t,e,n,r,s,i)}function nf(t,e,n,r,i,s){Kb(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&z_(e,n,!1),Sr(t,e,s);r=e.stateNode,tI.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=uo(e,t.child,null,s),e.child=uo(e,null,a,s)):Vt(t,e,a,s),e.memoizedState=r.state,i&&z_(e,n,!0),e.child}function Qb(t){var e=t.stateNode;e.pendingContext?O_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&O_(t,e.context,!1),Om(t,e.containerInfo)}function J_(t,e,n,r,i){return lo(),Am(i),e.flags|=256,Vt(t,e,n,r),e.child}var rf={dehydrated:null,treeContext:null,retryLane:0};function sf(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gb(t,e,n){var r=e.pendingProps,i=$e.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),je($e,i&1),t===null)return Yh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=hd(o,r,0,null),t=Yi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=sf(n),e.memoizedState=rf,t):Bm(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return nI(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=li(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=li(a,s):(s=Yi(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?sf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=rf,r}return s=t.child,t=s.sibling,r=li(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bm(t,e){return e=hd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function du(t,e,n,r){return r!==null&&Am(r),uo(e,t.child,null,n),t=Bm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nI(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Rp(Error(H(422))),du(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=hd({mode:"visible",children:r.children},i,0,null),s=Yi(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&uo(e,t.child,null,o),e.child.memoizedState=sf(o),e.memoizedState=rf,s);if(!(e.mode&1))return du(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(H(419)),r=Rp(s,r,void 0),du(t,e,o,r)}if(a=(o&t.childLanes)!==0,Yt||a){if(r=xt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Tr(t,i),Fn(r,t,i,-1))}return Gm(),r=Rp(Error(H(421))),du(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=mI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,on=ii(i.nextSibling),an=e,We=!0,Dn=null,t!==null&&(gn[yn++]=_r,gn[yn++]=xr,gn[yn++]=es,_r=t.id,xr=t.overflow,es=e),e=Bm(e,r.children),e.flags|=4096,e)}function Z_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Xh(t.return,e,n)}function Np(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Yb(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Vt(t,e,r.children,n),r=$e.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Z_(t,n,e);else if(t.tag===19)Z_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(je($e,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&bc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Np(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&bc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Np(e,!0,n,null,s);break;case"together":Np(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ju(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ns|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=li(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=li(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function rI(t,e,n){switch(e.tag){case 3:Qb(e),lo();break;case 5:wb(e);break;case 1:Jt(e.type)&&mc(e);break;case 4:Om(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;je(_c,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(je($e,$e.current&1),e.flags|=128,null):n&e.child.childLanes?Gb(t,e,n):(je($e,$e.current&1),t=Sr(t,e,n),t!==null?t.sibling:null);je($e,$e.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Yb(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),je($e,$e.current),r)break;return null;case 22:case 23:return e.lanes=0,$b(t,e,n)}return Sr(t,e,n)}var Xb,of,Jb,Zb;Xb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};of=function(){};Jb=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Hi(er.current);var s=null;switch(n){case"input":i=Ch(t,i),r=Ch(t,r),s=[];break;case"select":i=Qe({},i,{value:void 0}),r=Qe({},r,{value:void 0}),s=[];break;case"textarea":i=Ph(t,i),r=Ph(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hc)}Nh(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ua.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ua.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Fe("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Zb=function(t,e,n,r){n!==r&&(e.flags|=4)};function ia(t,e){if(!We)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function iI(t,e,n){var r=e.pendingProps;switch(Im(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return Jt(e.type)&&fc(),Ct(e),null;case 3:return r=e.stateNode,co(),Be(Xt),Be(Dt),Mm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Dn!==null&&(ff(Dn),Dn=null))),of(t,e),Ct(e),null;case 5:zm(e);var i=Hi(Za.current);if(n=e.type,t!==null&&e.stateNode!=null)Jb(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Ct(e),null}if(t=Hi(er.current),uu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Jn]=e,r[Xa]=s,t=(e.mode&1)!==0,n){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(i=0;i<ma.length;i++)Fe(ma[i],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":l_(r,s),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Fe("invalid",r);break;case"textarea":c_(r,s),Fe("invalid",r)}Nh(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&lu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&lu(r.textContent,a,t),i=["children",""+a]):Ua.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Fe("scroll",r)}switch(n){case"input":eu(r),u_(r,s,!0);break;case"textarea":eu(r),d_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=C1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Jn]=e,t[Xa]=r,Xb(t,e,!1,!1),e.stateNode=t;e:{switch(o=Lh(n,r),n){case"dialog":Fe("cancel",t),Fe("close",t),i=r;break;case"iframe":case"object":case"embed":Fe("load",t),i=r;break;case"video":case"audio":for(i=0;i<ma.length;i++)Fe(ma[i],t);i=r;break;case"source":Fe("error",t),i=r;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),i=r;break;case"details":Fe("toggle",t),i=r;break;case"input":l_(t,r),i=Ch(t,r),Fe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Qe({},r,{value:void 0}),Fe("invalid",t);break;case"textarea":c_(t,r),i=Ph(t,r),Fe("invalid",t);break;default:i=r}Nh(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?P1(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&I1(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&qa(t,l):typeof l=="number"&&qa(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ua.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Fe("scroll",t):l!=null&&hm(t,s,l,o))}switch(n){case"input":eu(t),u_(t,r,!1);break;case"textarea":eu(t),d_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+yi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Hs(t,!!r.multiple,s,!1):r.defaultValue!=null&&Hs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)Zb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=Hi(Za.current),Hi(er.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Jn]=e,(s=r.nodeValue!==n)&&(t=an,t!==null))switch(t.tag){case 3:lu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&lu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Jn]=e,e.stateNode=r}return Ct(e),null;case 13:if(Be($e),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(We&&on!==null&&e.mode&1&&!(e.flags&128))yb(),lo(),e.flags|=98560,s=!1;else if(s=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(H(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(H(317));s[Jn]=e}else lo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),s=!1}else Dn!==null&&(ff(Dn),Dn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$e.current&1?dt===0&&(dt=3):Gm())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return co(),of(t,e),t===null&&Ga(e.stateNode.containerInfo),Ct(e),null;case 10:return Nm(e.type._context),Ct(e),null;case 17:return Jt(e.type)&&fc(),Ct(e),null;case 19:if(Be($e),s=e.memoizedState,s===null)return Ct(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ia(s,!1);else{if(dt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=bc(t),o!==null){for(e.flags|=128,ia(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return je($e,$e.current&1|2),e.child}t=t.sibling}s.tail!==null&&tt()>ho&&(e.flags|=128,r=!0,ia(s,!1),e.lanes=4194304)}else{if(!r)if(t=bc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ia(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!We)return Ct(e),null}else 2*tt()-s.renderingStartTime>ho&&n!==1073741824&&(e.flags|=128,r=!0,ia(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=tt(),e.sibling=null,n=$e.current,je($e,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return Qm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?rn&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function sI(t,e){switch(Im(e),e.tag){case 1:return Jt(e.type)&&fc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return co(),Be(Xt),Be(Dt),Mm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return zm(e),null;case 13:if(Be($e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));lo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be($e),null;case 4:return co(),null;case 10:return Nm(e.type._context),null;case 22:case 23:return Qm(),null;case 24:return null;default:return null}}var pu=!1,Rt=!1,oI=typeof WeakSet=="function"?WeakSet:Set,ne=null;function qs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function af(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var e0=!1;function aI(t,e){if(Bh=cc,t=ib(),Sm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,p=t,f=null;t:for(;;){for(var g;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(g=p.firstChild)!==null;)f=p,p=g;for(;;){if(p===t)break t;if(f===n&&++u===i&&(a=o),f===s&&++d===r&&(l=o),(g=p.nextSibling)!==null)break;p=f,f=p.parentNode}p=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wh={focusedElem:t,selectionRange:n},cc=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var k=_.memoizedProps,I=_.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?k:Nn(e.type,k),I);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(M){Xe(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return _=e0,e0=!1,_}function Ca(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&af(e,n,s)}i=i.next}while(i!==r)}}function dd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function lf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ew(t){var e=t.alternate;e!==null&&(t.alternate=null,ew(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Jn],delete e[Xa],delete e[Kh],delete e[BC],delete e[WC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tw(t){return t.tag===5||t.tag===3||t.tag===4}function t0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function uf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hc));else if(r!==4&&(t=t.child,t!==null))for(uf(t,e,n),t=t.sibling;t!==null;)uf(t,e,n),t=t.sibling}function cf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(cf(t,e,n),t=t.sibling;t!==null;)cf(t,e,n),t=t.sibling}var vt=null,Ln=!1;function Fr(t,e,n){for(n=n.child;n!==null;)nw(t,e,n),n=n.sibling}function nw(t,e,n){if(Zn&&typeof Zn.onCommitFiberUnmount=="function")try{Zn.onCommitFiberUnmount(rd,n)}catch{}switch(n.tag){case 5:Rt||qs(n,e);case 6:var r=vt,i=Ln;vt=null,Fr(t,e,n),vt=r,Ln=i,vt!==null&&(Ln?(t=vt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(Ln?(t=vt,n=n.stateNode,t.nodeType===8?Tp(t.parentNode,n):t.nodeType===1&&Tp(t,n),$a(t)):Tp(vt,n.stateNode));break;case 4:r=vt,i=Ln,vt=n.stateNode.containerInfo,Ln=!0,Fr(t,e,n),vt=r,Ln=i;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&af(n,e,o),i=i.next}while(i!==r)}Fr(t,e,n);break;case 1:if(!Rt&&(qs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Xe(n,e,a)}Fr(t,e,n);break;case 21:Fr(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,Fr(t,e,n),Rt=r):Fr(t,e,n);break;default:Fr(t,e,n)}}function n0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new oI),e.forEach(function(r){var i=gI.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Cn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,Ln=!1;break e;case 3:vt=a.stateNode.containerInfo,Ln=!0;break e;case 4:vt=a.stateNode.containerInfo,Ln=!0;break e}a=a.return}if(vt===null)throw Error(H(160));nw(s,o,i),vt=null,Ln=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Xe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rw(e,t),e=e.sibling}function rw(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Cn(e,t),Qn(t),r&4){try{Ca(3,t,t.return),dd(3,t)}catch(k){Xe(t,t.return,k)}try{Ca(5,t,t.return)}catch(k){Xe(t,t.return,k)}}break;case 1:Cn(e,t),Qn(t),r&512&&n!==null&&qs(n,n.return);break;case 5:if(Cn(e,t),Qn(t),r&512&&n!==null&&qs(n,n.return),t.flags&32){var i=t.stateNode;try{qa(i,"")}catch(k){Xe(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&T1(i,s),Lh(a,o);var u=Lh(a,s);for(o=0;o<l.length;o+=2){var d=l[o],p=l[o+1];d==="style"?P1(i,p):d==="dangerouslySetInnerHTML"?I1(i,p):d==="children"?qa(i,p):hm(i,d,p,u)}switch(a){case"input":Ih(i,s);break;case"textarea":S1(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Hs(i,!!s.multiple,g,!1):f!==!!s.multiple&&(s.defaultValue!=null?Hs(i,!!s.multiple,s.defaultValue,!0):Hs(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xa]=s}catch(k){Xe(t,t.return,k)}}break;case 6:if(Cn(e,t),Qn(t),r&4){if(t.stateNode===null)throw Error(H(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(k){Xe(t,t.return,k)}}break;case 3:if(Cn(e,t),Qn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$a(e.containerInfo)}catch(k){Xe(t,t.return,k)}break;case 4:Cn(e,t),Qn(t);break;case 13:Cn(e,t),Qn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||($m=tt())),r&4&&n0(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(u=Rt)||d,Cn(e,t),Rt=u):Cn(e,t),Qn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ne=t,d=t.child;d!==null;){for(p=ne=d;ne!==null;){switch(f=ne,g=f.child,f.tag){case 0:case 11:case 14:case 15:Ca(4,f,f.return);break;case 1:qs(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(k){Xe(r,n,k)}}break;case 5:qs(f,f.return);break;case 22:if(f.memoizedState!==null){i0(p);continue}}g!==null?(g.return=f,ne=g):i0(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=A1("display",o))}catch(k){Xe(t,t.return,k)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(k){Xe(t,t.return,k)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Cn(e,t),Qn(t),r&4&&n0(t);break;case 21:break;default:Cn(e,t),Qn(t)}}function Qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tw(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qa(i,""),r.flags&=-33);var s=t0(t);cf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=t0(t);uf(t,a,o);break;default:throw Error(H(161))}}catch(l){Xe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lI(t,e,n){ne=t,iw(t)}function iw(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var i=ne,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||pu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Rt;a=pu;var u=Rt;if(pu=o,(Rt=l)&&!u)for(ne=i;ne!==null;)o=ne,l=o.child,o.tag===22&&o.memoizedState!==null?s0(i):l!==null?(l.return=o,ne=l):s0(i);for(;s!==null;)ne=s,iw(s),s=s.sibling;ne=i,pu=a,Rt=u}r0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ne=s):r0(t)}}function r0(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||dd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Nn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&U_(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}U_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&$a(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Rt||e.flags&512&&lf(e)}catch(f){Xe(e,e.return,f)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function i0(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function s0(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{dd(4,e)}catch(l){Xe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Xe(e,i,l)}}var s=e.return;try{lf(e)}catch(l){Xe(e,s,l)}break;case 5:var o=e.return;try{lf(e)}catch(l){Xe(e,o,l)}}}catch(l){Xe(e,e.return,l)}if(e===t){ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ne=a;break}ne=e.return}}var uI=Math.ceil,Ec=Rr.ReactCurrentDispatcher,Wm=Rr.ReactCurrentOwner,wn=Rr.ReactCurrentBatchConfig,Ce=0,xt=null,st=null,kt=0,rn=0,Bs=Si(0),dt=0,rl=null,ns=0,pd=0,Hm=0,Ia=null,Gt=null,$m=0,ho=1/0,mr=null,Tc=!1,df=null,oi=null,hu=!1,Xr=null,Sc=0,Aa=0,pf=null,Vu=-1,Fu=0;function qt(){return Ce&6?tt():Vu!==-1?Vu:Vu=tt()}function ai(t){return t.mode&1?Ce&2&&kt!==0?kt&-kt:$C.transition!==null?(Fu===0&&(Fu=q1()),Fu):(t=Le,t!==0||(t=window.event,t=t===void 0?16:G1(t.type)),t):1}function Fn(t,e,n,r){if(50<Aa)throw Aa=0,pf=null,Error(H(185));xl(t,n,r),(!(Ce&2)||t!==xt)&&(t===xt&&(!(Ce&2)&&(pd|=n),dt===4&&$r(t,kt)),Zt(t,r),n===1&&Ce===0&&!(e.mode&1)&&(ho=tt()+500,ld&&Ci()))}function Zt(t,e){var n=t.callbackNode;$S(t,e);var r=uc(t,t===xt?kt:0);if(r===0)n!==null&&f_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&f_(n),e===1)t.tag===0?HC(o0.bind(null,t)):fb(o0.bind(null,t)),UC(function(){!(Ce&6)&&Ci()}),n=null;else{switch(B1(r)){case 1:n=_m;break;case 4:n=F1;break;case 16:n=lc;break;case 536870912:n=U1;break;default:n=lc}n=pw(n,sw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sw(t,e){if(Vu=-1,Fu=0,Ce&6)throw Error(H(327));var n=t.callbackNode;if(Ys()&&t.callbackNode!==n)return null;var r=uc(t,t===xt?kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cc(t,r);else{e=r;var i=Ce;Ce|=2;var s=aw();(xt!==t||kt!==e)&&(mr=null,ho=tt()+500,Gi(t,e));do try{pI();break}catch(a){ow(t,a)}while(!0);Rm(),Ec.current=s,Ce=i,st!==null?e=0:(xt=null,kt=0,e=dt)}if(e!==0){if(e===2&&(i=jh(t),i!==0&&(r=i,e=hf(t,i))),e===1)throw n=rl,Gi(t,0),$r(t,r),Zt(t,tt()),n;if(e===6)$r(t,r);else{if(i=t.current.alternate,!(r&30)&&!cI(i)&&(e=Cc(t,r),e===2&&(s=jh(t),s!==0&&(r=s,e=hf(t,s))),e===1))throw n=rl,Gi(t,0),$r(t,r),Zt(t,tt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:ji(t,Gt,mr);break;case 3:if($r(t,r),(r&130023424)===r&&(e=$m+500-tt(),10<e)){if(uc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){qt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$h(ji.bind(null,t,Gt,mr),e);break}ji(t,Gt,mr);break;case 4:if($r(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Vn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uI(r/1960))-r,10<r){t.timeoutHandle=$h(ji.bind(null,t,Gt,mr),r);break}ji(t,Gt,mr);break;case 5:ji(t,Gt,mr);break;default:throw Error(H(329))}}}return Zt(t,tt()),t.callbackNode===n?sw.bind(null,t):null}function hf(t,e){var n=Ia;return t.current.memoizedState.isDehydrated&&(Gi(t,e).flags|=256),t=Cc(t,e),t!==2&&(e=Gt,Gt=n,e!==null&&ff(e)),t}function ff(t){Gt===null?Gt=t:Gt.push.apply(Gt,t)}function cI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Wn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function $r(t,e){for(e&=~Hm,e&=~pd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vn(e),r=1<<n;t[n]=-1,e&=~r}}function o0(t){if(Ce&6)throw Error(H(327));Ys();var e=uc(t,0);if(!(e&1))return Zt(t,tt()),null;var n=Cc(t,e);if(t.tag!==0&&n===2){var r=jh(t);r!==0&&(e=r,n=hf(t,r))}if(n===1)throw n=rl,Gi(t,0),$r(t,e),Zt(t,tt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ji(t,Gt,mr),Zt(t,tt()),null}function Km(t,e){var n=Ce;Ce|=1;try{return t(e)}finally{Ce=n,Ce===0&&(ho=tt()+500,ld&&Ci())}}function rs(t){Xr!==null&&Xr.tag===0&&!(Ce&6)&&Ys();var e=Ce;Ce|=1;var n=wn.transition,r=Le;try{if(wn.transition=null,Le=1,t)return t()}finally{Le=r,wn.transition=n,Ce=e,!(Ce&6)&&Ci()}}function Qm(){rn=Bs.current,Be(Bs)}function Gi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,FC(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(Im(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fc();break;case 3:co(),Be(Xt),Be(Dt),Mm();break;case 5:zm(r);break;case 4:co();break;case 13:Be($e);break;case 19:Be($e);break;case 10:Nm(r.type._context);break;case 22:case 23:Qm()}n=n.return}if(xt=t,st=t=li(t.current,null),kt=rn=e,dt=0,rl=null,Hm=pd=ns=0,Gt=Ia=null,Wi!==null){for(e=0;e<Wi.length;e++)if(n=Wi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Wi=null}return t}function ow(t,e){do{var n=st;try{if(Rm(),zu.current=kc,wc){for(var r=Ke.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wc=!1}if(ts=0,yt=ut=Ke=null,Sa=!1,el=0,Wm.current=null,n===null||n.return===null){dt=1,rl=e,st=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=kt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=K_(o);if(g!==null){g.flags&=-257,Q_(g,o,a,s,e),g.mode&1&&$_(s,u,e),e=g,l=u;var _=e.updateQueue;if(_===null){var k=new Set;k.add(l),e.updateQueue=k}else _.add(l);break e}else{if(!(e&1)){$_(s,u,e),Gm();break e}l=Error(H(426))}}else if(We&&a.mode&1){var I=K_(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),Q_(I,o,a,s,e),Am(po(l,a));break e}}s=l=po(l,a),dt!==4&&(dt=2),Ia===null?Ia=[s]:Ia.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=Bb(s,l,e);F_(s,x);break e;case 1:a=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(oi===null||!oi.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=Wb(s,a,e);F_(s,M);break e}}s=s.return}while(s!==null)}uw(n)}catch(O){e=O,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function aw(){var t=Ec.current;return Ec.current=kc,t===null?kc:t}function Gm(){(dt===0||dt===3||dt===2)&&(dt=4),xt===null||!(ns&268435455)&&!(pd&268435455)||$r(xt,kt)}function Cc(t,e){var n=Ce;Ce|=2;var r=aw();(xt!==t||kt!==e)&&(mr=null,Gi(t,e));do try{dI();break}catch(i){ow(t,i)}while(!0);if(Rm(),Ce=n,Ec.current=r,st!==null)throw Error(H(261));return xt=null,kt=0,dt}function dI(){for(;st!==null;)lw(st)}function pI(){for(;st!==null&&!MS();)lw(st)}function lw(t){var e=dw(t.alternate,t,rn);t.memoizedProps=t.pendingProps,e===null?uw(t):st=e,Wm.current=null}function uw(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=sI(n,e),n!==null){n.flags&=32767,st=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dt=6,st=null;return}}else if(n=iI(n,e,rn),n!==null){st=n;return}if(e=e.sibling,e!==null){st=e;return}st=e=t}while(e!==null);dt===0&&(dt=5)}function ji(t,e,n){var r=Le,i=wn.transition;try{wn.transition=null,Le=1,hI(t,e,n,r)}finally{wn.transition=i,Le=r}return null}function hI(t,e,n,r){do Ys();while(Xr!==null);if(Ce&6)throw Error(H(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(KS(t,s),t===xt&&(st=xt=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hu||(hu=!0,pw(lc,function(){return Ys(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=wn.transition,wn.transition=null;var o=Le;Le=1;var a=Ce;Ce|=4,Wm.current=null,aI(t,n),rw(n,t),LC(Wh),cc=!!Bh,Wh=Bh=null,t.current=n,lI(n),jS(),Ce=a,Le=o,wn.transition=s}else t.current=n;if(hu&&(hu=!1,Xr=t,Sc=i),s=t.pendingLanes,s===0&&(oi=null),US(n.stateNode),Zt(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Tc)throw Tc=!1,t=df,df=null,t;return Sc&1&&t.tag!==0&&Ys(),s=t.pendingLanes,s&1?t===pf?Aa++:(Aa=0,pf=t):Aa=0,Ci(),null}function Ys(){if(Xr!==null){var t=B1(Sc),e=wn.transition,n=Le;try{if(wn.transition=null,Le=16>t?16:t,Xr===null)var r=!1;else{if(t=Xr,Xr=null,Sc=0,Ce&6)throw Error(H(331));var i=Ce;for(Ce|=4,ne=t.current;ne!==null;){var s=ne,o=s.child;if(ne.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ne=u;ne!==null;){var d=ne;switch(d.tag){case 0:case 11:case 15:Ca(8,d,s)}var p=d.child;if(p!==null)p.return=d,ne=p;else for(;ne!==null;){d=ne;var f=d.sibling,g=d.return;if(ew(d),d===u){ne=null;break}if(f!==null){f.return=g,ne=f;break}ne=g}}}var _=s.alternate;if(_!==null){var k=_.child;if(k!==null){_.child=null;do{var I=k.sibling;k.sibling=null,k=I}while(k!==null)}}ne=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ne=o;else e:for(;ne!==null;){if(s=ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ca(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ne=x;break e}ne=s.return}}var v=t.current;for(ne=v;ne!==null;){o=ne;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ne=w;else e:for(o=v;ne!==null;){if(a=ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:dd(9,a)}}catch(O){Xe(a,a.return,O)}if(a===o){ne=null;break e}var M=a.sibling;if(M!==null){M.return=a.return,ne=M;break e}ne=a.return}}if(Ce=i,Ci(),Zn&&typeof Zn.onPostCommitFiberRoot=="function")try{Zn.onPostCommitFiberRoot(rd,t)}catch{}r=!0}return r}finally{Le=n,wn.transition=e}}return!1}function a0(t,e,n){e=po(n,e),e=Bb(t,e,1),t=si(t,e,1),e=qt(),t!==null&&(xl(t,1,e),Zt(t,e))}function Xe(t,e,n){if(t.tag===3)a0(t,t,n);else for(;e!==null;){if(e.tag===3){a0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oi===null||!oi.has(r))){t=po(n,t),t=Wb(e,t,1),e=si(e,t,1),t=qt(),e!==null&&(xl(e,1,t),Zt(e,t));break}}e=e.return}}function fI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=qt(),t.pingedLanes|=t.suspendedLanes&n,xt===t&&(kt&n)===n&&(dt===4||dt===3&&(kt&130023424)===kt&&500>tt()-$m?Gi(t,0):Hm|=n),Zt(t,e)}function cw(t,e){e===0&&(t.mode&1?(e=ru,ru<<=1,!(ru&130023424)&&(ru=4194304)):e=1);var n=qt();t=Tr(t,e),t!==null&&(xl(t,e,n),Zt(t,n))}function mI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cw(t,n)}function gI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),cw(t,n)}var dw;dw=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xt.current)Yt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yt=!1,rI(t,e,n);Yt=!!(t.flags&131072)}else Yt=!1,We&&e.flags&1048576&&mb(e,yc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ju(t,e),t=e.pendingProps;var i=ao(e,Dt.current);Gs(e,n),i=Vm(null,e,r,t,i,n);var s=Fm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jt(r)?(s=!0,mc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dm(e),i.updater=cd,e.stateNode=i,i._reactInternals=e,Zh(e,r,t,n),e=nf(null,e,r,!0,s,n)):(e.tag=0,We&&s&&Cm(e),Vt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ju(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=_I(r),t=Nn(r,t),i){case 0:e=tf(null,e,r,t,n);break e;case 1:e=X_(null,e,r,t,n);break e;case 11:e=G_(null,e,r,t,n);break e;case 14:e=Y_(null,e,r,Nn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nn(r,i),tf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nn(r,i),X_(t,e,r,i,n);case 3:e:{if(Qb(e),t===null)throw Error(H(387));r=e.pendingProps,s=e.memoizedState,i=s.element,bb(t,e),vc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=po(Error(H(423)),e),e=J_(t,e,r,n,i);break e}else if(r!==i){i=po(Error(H(424)),e),e=J_(t,e,r,n,i);break e}else for(on=ii(e.stateNode.containerInfo.firstChild),an=e,We=!0,Dn=null,n=xb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lo(),r===i){e=Sr(t,e,n);break e}Vt(t,e,r,n)}e=e.child}return e;case 5:return wb(e),t===null&&Yh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Hh(r,i)?o=null:s!==null&&Hh(r,s)&&(e.flags|=32),Kb(t,e),Vt(t,e,o,n),e.child;case 6:return t===null&&Yh(e),null;case 13:return Gb(t,e,n);case 4:return Om(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=uo(e,null,r,n):Vt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nn(r,i),G_(t,e,r,i,n);case 7:return Vt(t,e,e.pendingProps,n),e.child;case 8:return Vt(t,e,e.pendingProps.children,n),e.child;case 12:return Vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,je(_c,r._currentValue),r._currentValue=o,s!==null)if(Wn(s.value,o)){if(s.children===i.children&&!Xt.current){e=Sr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=wr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Xh(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Xh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Vt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Gs(e,n),i=kn(i),r=r(i),e.flags|=1,Vt(t,e,r,n),e.child;case 14:return r=e.type,i=Nn(r,e.pendingProps),i=Nn(r.type,i),Y_(t,e,r,i,n);case 15:return Hb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nn(r,i),ju(t,e),e.tag=1,Jt(r)?(t=!0,mc(e)):t=!1,Gs(e,n),qb(e,r,i),Zh(e,r,i,n),nf(null,e,r,!0,t,n);case 19:return Yb(t,e,n);case 22:return $b(t,e,n)}throw Error(H(156,e.tag))};function pw(t,e){return V1(t,e)}function yI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(t,e,n,r){return new yI(t,e,n,r)}function Ym(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _I(t){if(typeof t=="function")return Ym(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mm)return 11;if(t===gm)return 14}return 2}function li(t,e){var n=t.alternate;return n===null?(n=bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Uu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ym(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ls:return Yi(n.children,i,s,e);case fm:o=8,i|=8;break;case kh:return t=bn(12,n,e,i|2),t.elementType=kh,t.lanes=s,t;case Eh:return t=bn(13,n,e,i),t.elementType=Eh,t.lanes=s,t;case Th:return t=bn(19,n,e,i),t.elementType=Th,t.lanes=s,t;case w1:return hd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v1:o=10;break e;case b1:o=9;break e;case mm:o=11;break e;case gm:o=14;break e;case Br:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=bn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Yi(t,e,n,r){return t=bn(7,t,r,e),t.lanes=n,t}function hd(t,e,n,r){return t=bn(22,t,r,e),t.elementType=w1,t.lanes=n,t.stateNode={isHidden:!1},t}function Lp(t,e,n){return t=bn(6,t,null,e),t.lanes=n,t}function Dp(t,e,n){return e=bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fp(0),this.expirationTimes=fp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xm(t,e,n,r,i,s,o,a,l){return t=new xI(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=bn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dm(s),t}function vI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ns,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hw(t){if(!t)return _i;t=t._reactInternals;e:{if(fs(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Jt(n))return hb(t,n,e)}return e}function fw(t,e,n,r,i,s,o,a,l){return t=Xm(n,r,!0,t,i,s,o,a,l),t.context=hw(null),n=t.current,r=qt(),i=ai(n),s=wr(r,i),s.callback=e??null,si(n,s,i),t.current.lanes=i,xl(t,i,r),Zt(t,r),t}function fd(t,e,n,r){var i=e.current,s=qt(),o=ai(i);return n=hw(n),e.context===null?e.context=n:e.pendingContext=n,e=wr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=si(i,e,o),t!==null&&(Fn(t,i,o,s),Ou(t,i,o)),o}function Ic(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function l0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jm(t,e){l0(t,e),(t=t.alternate)&&l0(t,e)}function bI(){return null}var mw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zm(t){this._internalRoot=t}md.prototype.render=Zm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));fd(t,e,null,null)};md.prototype.unmount=Zm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;rs(function(){fd(null,t,null,null)}),e[Er]=null}};function md(t){this._internalRoot=t}md.prototype.unstable_scheduleHydration=function(t){if(t){var e=$1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hr.length&&e!==0&&e<Hr[n].priority;n++);Hr.splice(n,0,t),n===0&&Q1(t)}};function eg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function u0(){}function wI(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Ic(o);s.call(u)}}var o=fw(e,r,t,0,null,!1,!1,"",u0);return t._reactRootContainer=o,t[Er]=o.current,Ga(t.nodeType===8?t.parentNode:t),rs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Ic(l);a.call(u)}}var l=Xm(t,0,!1,null,null,!1,!1,"",u0);return t._reactRootContainer=l,t[Er]=l.current,Ga(t.nodeType===8?t.parentNode:t),rs(function(){fd(e,l,n,r)}),l}function yd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ic(o);a.call(l)}}fd(e,o,t,i)}else o=wI(n,e,t,i,r);return Ic(o)}W1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fa(e.pendingLanes);n!==0&&(xm(e,n|1),Zt(e,tt()),!(Ce&6)&&(ho=tt()+500,Ci()))}break;case 13:rs(function(){var r=Tr(t,1);if(r!==null){var i=qt();Fn(r,t,1,i)}}),Jm(t,1)}};vm=function(t){if(t.tag===13){var e=Tr(t,134217728);if(e!==null){var n=qt();Fn(e,t,134217728,n)}Jm(t,134217728)}};H1=function(t){if(t.tag===13){var e=ai(t),n=Tr(t,e);if(n!==null){var r=qt();Fn(n,t,e,r)}Jm(t,e)}};$1=function(){return Le};K1=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};Oh=function(t,e,n){switch(e){case"input":if(Ih(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ad(r);if(!i)throw Error(H(90));E1(r),Ih(r,i)}}}break;case"textarea":S1(t,n);break;case"select":e=n.value,e!=null&&Hs(t,!!n.multiple,e,!1)}};L1=Km;D1=rs;var kI={usingClientEntryPoint:!1,Events:[bl,Ms,ad,R1,N1,Km]},sa={findFiberByHostInstance:Bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EI={bundleType:sa.bundleType,version:sa.version,rendererPackageName:sa.rendererPackageName,rendererConfig:sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=M1(t),t===null?null:t.stateNode},findFiberByHostInstance:sa.findFiberByHostInstance||bI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fu.isDisabled&&fu.supportsFiber)try{rd=fu.inject(EI),Zn=fu}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kI;dn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eg(e))throw Error(H(200));return vI(t,e,null,n)};dn.createRoot=function(t,e){if(!eg(t))throw Error(H(299));var n=!1,r="",i=mw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xm(t,1,!1,null,null,n,!1,r,i),t[Er]=e.current,Ga(t.nodeType===8?t.parentNode:t),new Zm(e)};dn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=M1(e),t=t===null?null:t.stateNode,t};dn.flushSync=function(t){return rs(t)};dn.hydrate=function(t,e,n){if(!gd(e))throw Error(H(200));return yd(null,t,e,!0,n)};dn.hydrateRoot=function(t,e,n){if(!eg(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=mw;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fw(e,null,t,1,n??null,i,!1,s,o),t[Er]=e.current,Ga(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new md(e)};dn.render=function(t,e,n){if(!gd(e))throw Error(H(200));return yd(null,t,e,!1,n)};dn.unmountComponentAtNode=function(t){if(!gd(t))throw Error(H(40));return t._reactRootContainer?(rs(function(){yd(null,null,t,!1,function(){t._reactRootContainer=null,t[Er]=null})}),!0):!1};dn.unstable_batchedUpdates=Km;dn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gd(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return yd(t,e,n,!1,r)};dn.version="18.3.1-next-f1338f8080-20240426";function gw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gw)}catch(t){console.error(t)}}gw(),g1.exports=dn;var TI=g1.exports,c0=TI;bh.createRoot=c0.createRoot,bh.hydrateRoot=c0.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function il(){return il=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},il.apply(this,arguments)}var Jr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Jr||(Jr={}));const d0="popstate";function SI(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return mf("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Ac(i)}return II(e,n,null,t)}function Je(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CI(){return Math.random().toString(36).substr(2,8)}function p0(t,e){return{usr:t.state,key:t.key,idx:e}}function mf(t,e,n,r){return n===void 0&&(n=null),il({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Co(e):e,{state:n,key:e&&e.key||r||CI()})}function Ac(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Co(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function II(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Jr.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(il({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){a=Jr.Pop;let I=d(),x=I==null?null:I-u;u=I,l&&l({action:a,location:k.location,delta:x})}function f(I,x){a=Jr.Push;let v=mf(k.location,I,x);u=d()+1;let w=p0(v,u),M=k.createHref(v);try{o.pushState(w,"",M)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(M)}s&&l&&l({action:a,location:k.location,delta:1})}function g(I,x){a=Jr.Replace;let v=mf(k.location,I,x);u=d();let w=p0(v,u),M=k.createHref(v);o.replaceState(w,"",M),s&&l&&l({action:a,location:k.location,delta:0})}function _(I){let x=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof I=="string"?I:Ac(I);return v=v.replace(/ $/,"%20"),Je(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let k={get action(){return a},get location(){return t(i,o)},listen(I){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(d0,p),l=I,()=>{i.removeEventListener(d0,p),l=null}},createHref(I){return e(i,I)},createURL:_,encodeLocation(I){let x=_(I);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:g,go(I){return o.go(I)}};return k}var h0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(h0||(h0={}));function AI(t,e,n){return n===void 0&&(n="/"),PI(t,e,n)}function PI(t,e,n,r){let i=typeof e=="string"?Co(e):e,s=fo(i.pathname||"/",n);if(s==null)return null;let o=yw(t);RI(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=qI(s);a=FI(o[l],u)}return a}function yw(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Je(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=ui([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(Je(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yw(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:jI(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of _w(s.path))i(s,o,l)}),e}function _w(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=_w(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function RI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:VI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const NI=/^:[\w-]+$/,LI=3,DI=2,OI=1,zI=10,MI=-2,f0=t=>t==="*";function jI(t,e){let n=t.split("/"),r=n.length;return n.some(f0)&&(r+=MI),e&&(r+=DI),n.filter(i=>!f0(i)).reduce((i,s)=>i+(NI.test(s)?LI:s===""?OI:zI),r)}function VI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function FI(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=gf({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:ui([s,p.pathname]),pathnameBase:KI(ui([s,p.pathnameBase])),route:f}),p.pathnameBase!=="/"&&(s=ui([s,p.pathnameBase]))}return o}function gf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=UI(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:f,isOptional:g}=d;if(f==="*"){let k=a[p]||"";o=s.slice(0,s.length-k.length).replace(/(.)\/+$/,"$1")}const _=a[p];return g&&!_?u[f]=void 0:u[f]=(_||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function UI(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),tg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function qI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function fo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const BI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,WI=t=>BI.test(t);function HI(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Co(t):t,s;if(n)if(WI(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),tg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?s=m0(n.substring(1),"/"):s=m0(n,e)}else s=e;return{pathname:s,search:QI(r),hash:GI(i)}}function m0(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Op(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $I(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function xw(t,e){let n=$I(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function vw(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Co(t):(i=il({},t),Je(!i.pathname||!i.pathname.includes("?"),Op("?","pathname","search",i)),Je(!i.pathname||!i.pathname.includes("#"),Op("#","pathname","hash",i)),Je(!i.search||!i.search.includes("#"),Op("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),p-=1;i.pathname=f.join("/")}a=p>=0?e[p]:"/"}let l=HI(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const ui=t=>t.join("/").replace(/\/\/+/g,"/"),KI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),QI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,GI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function YI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const bw=["post","put","patch","delete"];new Set(bw);const XI=["get",...bw];new Set(XI);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sl(){return sl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sl.apply(this,arguments)}const _d=z.createContext(null),ww=z.createContext(null),Ii=z.createContext(null),xd=z.createContext(null),Ai=z.createContext({outlet:null,matches:[],isDataRoute:!1}),kw=z.createContext(null);function JI(t,e){let{relative:n}=e===void 0?{}:e;kl()||Je(!1);let{basename:r,navigator:i}=z.useContext(Ii),{hash:s,pathname:o,search:a}=vd(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:ui([r,o])),i.createHref({pathname:l,search:a,hash:s})}function kl(){return z.useContext(xd)!=null}function El(){return kl()||Je(!1),z.useContext(xd).location}function Ew(t){z.useContext(Ii).static||z.useLayoutEffect(t)}function ZI(){let{isDataRoute:t}=z.useContext(Ai);return t?pA():eA()}function eA(){kl()||Je(!1);let t=z.useContext(_d),{basename:e,future:n,navigator:r}=z.useContext(Ii),{matches:i}=z.useContext(Ai),{pathname:s}=El(),o=JSON.stringify(xw(i,n.v7_relativeSplatPath)),a=z.useRef(!1);return Ew(()=>{a.current=!0}),z.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let p=vw(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ui([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,o,s,t])}function Tw(){let{matches:t}=z.useContext(Ai),e=t[t.length-1];return e?e.params:{}}function vd(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=z.useContext(Ii),{matches:i}=z.useContext(Ai),{pathname:s}=El(),o=JSON.stringify(xw(i,r.v7_relativeSplatPath));return z.useMemo(()=>vw(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function tA(t,e){return nA(t,e)}function nA(t,e,n,r){kl()||Je(!1);let{navigator:i}=z.useContext(Ii),{matches:s}=z.useContext(Ai),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=El(),d;if(e){var p;let I=typeof e=="string"?Co(e):e;l==="/"||(p=I.pathname)!=null&&p.startsWith(l)||Je(!1),d=I}else d=u;let f=d.pathname||"/",g=f;if(l!=="/"){let I=l.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(I.length).join("/")}let _=AI(t,{pathname:g}),k=aA(_&&_.map(I=>Object.assign({},I,{params:Object.assign({},a,I.params),pathname:ui([l,i.encodeLocation?i.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?l:ui([l,i.encodeLocation?i.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),s,n,r);return e&&k?z.createElement(xd.Provider,{value:{location:sl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Jr.Pop}},k):k}function rA(){let t=dA(),e=YI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},e),n?z.createElement("pre",{style:i},n):null,null)}const iA=z.createElement(rA,null);class sA extends z.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?z.createElement(Ai.Provider,{value:this.props.routeContext},z.createElement(kw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oA(t){let{routeContext:e,match:n,children:r}=t,i=z.useContext(_d);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),z.createElement(Ai.Provider,{value:e},r)}function aA(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);d>=0||Je(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:f,errors:g}=n,_=p.route.loader&&f[p.route.id]===void 0&&(!g||g[p.route.id]===void 0);if(p.route.lazy||_){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,f)=>{let g,_=!1,k=null,I=null;n&&(g=a&&p.route.id?a[p.route.id]:void 0,k=p.route.errorElement||iA,l&&(u<0&&f===0?(hA("route-fallback"),_=!0,I=null):u===f&&(_=!0,I=p.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,f+1)),v=()=>{let w;return g?w=k:_?w=I:p.route.Component?w=z.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=d,z.createElement(oA,{match:p,routeContext:{outlet:d,matches:x,isDataRoute:n!=null},children:w})};return n&&(p.route.ErrorBoundary||p.route.errorElement||f===0)?z.createElement(sA,{location:n.location,revalidation:n.revalidation,component:k,error:g,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var Sw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Sw||{}),Cw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Cw||{});function lA(t){let e=z.useContext(_d);return e||Je(!1),e}function uA(t){let e=z.useContext(ww);return e||Je(!1),e}function cA(t){let e=z.useContext(Ai);return e||Je(!1),e}function Iw(t){let e=cA(),n=e.matches[e.matches.length-1];return n.route.id||Je(!1),n.route.id}function dA(){var t;let e=z.useContext(kw),n=uA(),r=Iw();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function pA(){let{router:t}=lA(Sw.UseNavigateStable),e=Iw(Cw.UseNavigateStable),n=z.useRef(!1);return Ew(()=>{n.current=!0}),z.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,sl({fromRouteId:e},s)))},[t,e])}const g0={};function hA(t,e,n){g0[t]||(g0[t]=!0)}function fA(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Vi(t){Je(!1)}function mA(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Jr.Pop,navigator:s,static:o=!1,future:a}=t;kl()&&Je(!1);let l=e.replace(/^\/*/,"/"),u=z.useMemo(()=>({basename:l,navigator:s,static:o,future:sl({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=Co(r));let{pathname:d="/",search:p="",hash:f="",state:g=null,key:_="default"}=r,k=z.useMemo(()=>{let I=fo(d,l);return I==null?null:{location:{pathname:I,search:p,hash:f,state:g,key:_},navigationType:i}},[l,d,p,f,g,_,i]);return k==null?null:z.createElement(Ii.Provider,{value:u},z.createElement(xd.Provider,{children:n,value:k}))}function gA(t){let{children:e,location:n}=t;return tA(yf(e),n)}new Promise(()=>{});function yf(t,e){e===void 0&&(e=[]);let n=[];return z.Children.forEach(t,(r,i)=>{if(!z.isValidElement(r))return;let s=[...e,i];if(r.type===z.Fragment){n.push.apply(n,yf(r.props.children,s));return}r.type!==Vi&&Je(!1),!r.props.index||!r.props.children||Je(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=yf(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pc(){return Pc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pc.apply(this,arguments)}function Aw(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function yA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function _A(t,e){return t.button===0&&(!e||e==="_self")&&!yA(t)}const xA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],vA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],bA="6";try{window.__reactRouterVersion=bA}catch{}const wA=z.createContext({isTransitioning:!1}),kA="startTransition",y0=fS[kA];function EA(t){let{basename:e,children:n,future:r,window:i}=t,s=z.useRef();s.current==null&&(s.current=SI({window:i,v5Compat:!0}));let o=s.current,[a,l]=z.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=z.useCallback(p=>{u&&y0?y0(()=>l(p)):l(p)},[l,u]);return z.useLayoutEffect(()=>o.listen(d),[o,d]),z.useEffect(()=>fA(r),[r]),z.createElement(mA,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const TA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ft=z.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:p}=e,f=Aw(e,xA),{basename:g}=z.useContext(Ii),_,k=!1;if(typeof u=="string"&&SA.test(u)&&(_=u,TA))try{let w=new URL(window.location.href),M=u.startsWith("//")?new URL(w.protocol+u):new URL(u),O=fo(M.pathname,g);M.origin===w.origin&&O!=null?u=O+M.search+M.hash:k=!0}catch{}let I=JI(u,{relative:i}),x=AA(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:p});function v(w){r&&r(w),w.defaultPrevented||x(w)}return z.createElement("a",Pc({},f,{href:_||I,onClick:k||s?r:v,ref:n,target:l}))}),CA=z.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:u,children:d}=e,p=Aw(e,vA),f=vd(l,{relative:p.relative}),g=El(),_=z.useContext(ww),{navigator:k,basename:I}=z.useContext(Ii),x=_!=null&&PA(f)&&u===!0,v=k.encodeLocation?k.encodeLocation(f).pathname:f.pathname,w=g.pathname,M=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;i||(w=w.toLowerCase(),M=M?M.toLowerCase():null,v=v.toLowerCase()),M&&I&&(M=fo(M,I)||M);const O=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let D=w===v||!o&&w.startsWith(v)&&w.charAt(O)==="/",S=M!=null&&(M===v||!o&&M.startsWith(v)&&M.charAt(v.length)==="/"),E={isActive:D,isPending:S,isTransitioning:x},C=D?r:void 0,b;typeof s=="function"?b=s(E):b=[s,D?"active":null,S?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let A=typeof a=="function"?a(E):a;return z.createElement(Ft,Pc({},p,{"aria-current":C,className:b,ref:n,style:A,to:l,viewTransition:u}),typeof d=="function"?d(E):d)});var _f;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(_f||(_f={}));var _0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(_0||(_0={}));function IA(t){let e=z.useContext(_d);return e||Je(!1),e}function AA(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=ZI(),u=El(),d=vd(t,{relative:o});return z.useCallback(p=>{if(_A(p,n)){p.preventDefault();let f=r!==void 0?r:Ac(u)===Ac(d);l(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,d,r,i,n,t,s,o,a])}function PA(t,e){e===void 0&&(e={});let n=z.useContext(wA);n==null&&Je(!1);let{basename:r}=IA(_f.useViewTransitionState),i=vd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=fo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=fo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return gf(i.pathname,o)!=null||gf(i.pathname,s)!=null}var RA=typeof Element<"u",NA=typeof Map=="function",LA=typeof Set=="function",DA=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function qu(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,r,i;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!qu(t[r],e[r]))return!1;return!0}var s;if(NA&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(s=t.entries();!(r=s.next()).done;)if(!e.has(r.value[0]))return!1;for(s=t.entries();!(r=s.next()).done;)if(!qu(r.value[1],e.get(r.value[0])))return!1;return!0}if(LA&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(s=t.entries();!(r=s.next()).done;)if(!e.has(r.value[0]))return!1;return!0}if(DA&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(t[r]!==e[r])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;if(RA&&t instanceof Element)return!1;for(r=n;r--!==0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&t.$$typeof)&&!qu(t[i[r]],e[i[r]]))return!1;return!0}return t!==t&&e!==e}var OA=function(e,n){try{return qu(e,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const zA=ps(OA);var MA=function(t,e,n,r,i,s,o,a){if(!t){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,s,o,a],d=0;l=new Error(e.replace(/%s/g,function(){return u[d++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},jA=MA;const x0=ps(jA);var VA=function(e,n,r,i){var s=r?r.call(i,e,n):void 0;if(s!==void 0)return!!s;if(e===n)return!0;if(typeof e!="object"||!e||typeof n!="object"||!n)return!1;var o=Object.keys(e),a=Object.keys(n);if(o.length!==a.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(n),u=0;u<o.length;u++){var d=o[u];if(!l(d))return!1;var p=e[d],f=n[d];if(s=r?r.call(i,p,f,d):void 0,s===!1||s===void 0&&p!==f)return!1}return!0};const FA=ps(VA);var Pw=(t=>(t.BASE="base",t.BODY="body",t.HEAD="head",t.HTML="html",t.LINK="link",t.META="meta",t.NOSCRIPT="noscript",t.SCRIPT="script",t.STYLE="style",t.TITLE="title",t.FRAGMENT="Symbol(react.fragment)",t))(Pw||{}),zp={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},v0=Object.values(Pw),ng={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},UA=Object.entries(ng).reduce((t,[e,n])=>(t[n]=e,t),{}),zn="data-rh",Xs={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},Js=(t,e)=>{for(let n=t.length-1;n>=0;n-=1){const r=t[n];if(Object.prototype.hasOwnProperty.call(r,e))return r[e]}return null},qA=t=>{let e=Js(t,"title");const n=Js(t,Xs.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),n&&e)return n.replace(/%s/g,()=>e);const r=Js(t,Xs.DEFAULT_TITLE);return e||r||void 0},BA=t=>Js(t,Xs.ON_CHANGE_CLIENT_STATE)||(()=>{}),Mp=(t,e)=>e.filter(n=>typeof n[t]<"u").map(n=>n[t]).reduce((n,r)=>({...n,...r}),{}),WA=(t,e)=>e.filter(n=>typeof n.base<"u").map(n=>n.base).reverse().reduce((n,r)=>{if(!n.length){const i=Object.keys(r);for(let s=0;s<i.length;s+=1){const a=i[s].toLowerCase();if(t.indexOf(a)!==-1&&r[a])return n.concat(r)}}return n},[]),HA=t=>console&&typeof console.warn=="function"&&console.warn(t),oa=(t,e,n)=>{const r={};return n.filter(i=>Array.isArray(i[t])?!0:(typeof i[t]<"u"&&HA(`Helmet: ${t} should be of type "Array". Instead found type "${typeof i[t]}"`),!1)).map(i=>i[t]).reverse().reduce((i,s)=>{const o={};s.filter(l=>{let u;const d=Object.keys(l);for(let f=0;f<d.length;f+=1){const g=d[f],_=g.toLowerCase();e.indexOf(_)!==-1&&!(u==="rel"&&l[u].toLowerCase()==="canonical")&&!(_==="rel"&&l[_].toLowerCase()==="stylesheet")&&(u=_),e.indexOf(g)!==-1&&(g==="innerHTML"||g==="cssText"||g==="itemprop")&&(u=g)}if(!u||!l[u])return!1;const p=l[u].toLowerCase();return r[u]||(r[u]={}),o[u]||(o[u]={}),r[u][p]?!1:(o[u][p]=!0,!0)}).reverse().forEach(l=>i.push(l));const a=Object.keys(o);for(let l=0;l<a.length;l+=1){const u=a[l],d={...r[u],...o[u]};r[u]=d}return i},[]).reverse()},$A=(t,e)=>{if(Array.isArray(t)&&t.length){for(let n=0;n<t.length;n+=1)if(t[n][e])return!0}return!1},KA=t=>({baseTag:WA(["href"],t),bodyAttributes:Mp("bodyAttributes",t),defer:Js(t,Xs.DEFER),encode:Js(t,Xs.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Mp("htmlAttributes",t),linkTags:oa("link",["rel","href"],t),metaTags:oa("meta",["name","charset","http-equiv","property","itemprop"],t),noscriptTags:oa("noscript",["innerHTML"],t),onChangeClientState:BA(t),scriptTags:oa("script",["src","innerHTML"],t),styleTags:oa("style",["cssText"],t),title:qA(t),titleAttributes:Mp("titleAttributes",t),prioritizeSeoTags:$A(t,Xs.PRIORITIZE_SEO_TAGS)}),Rw=t=>Array.isArray(t)?t.join(""):t,QA=(t,e)=>{const n=Object.keys(t);for(let r=0;r<n.length;r+=1)if(e[n[r]]&&e[n[r]].includes(t[n[r]]))return!0;return!1},jp=(t,e)=>Array.isArray(t)?t.reduce((n,r)=>(QA(r,e)?n.priority.push(r):n.default.push(r),n),{priority:[],default:[]}):{default:t,priority:[]},b0=(t,e)=>({...t,[e]:void 0}),GA=["noscript","script","style"],xf=(t,e=!0)=>e===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),Nw=t=>Object.keys(t).reduce((e,n)=>{const r=typeof t[n]<"u"?`${n}="${t[n]}"`:`${n}`;return e?`${e} ${r}`:r},""),YA=(t,e,n,r)=>{const i=Nw(n),s=Rw(e);return i?`<${t} ${zn}="true" ${i}>${xf(s,r)}</${t}>`:`<${t} ${zn}="true">${xf(s,r)}</${t}>`},XA=(t,e,n=!0)=>e.reduce((r,i)=>{const s=i,o=Object.keys(s).filter(u=>!(u==="innerHTML"||u==="cssText")).reduce((u,d)=>{const p=typeof s[d]>"u"?d:`${d}="${xf(s[d],n)}"`;return u?`${u} ${p}`:p},""),a=s.innerHTML||s.cssText||"",l=GA.indexOf(t)===-1;return`${r}<${t} ${zn}="true" ${o}${l?"/>":`>${a}</${t}>`}`},""),Lw=(t,e={})=>Object.keys(t).reduce((n,r)=>{const i=ng[r];return n[i||r]=t[r],n},e),JA=(t,e,n)=>{const r={key:e,[zn]:!0},i=Lw(n,r);return[_t.createElement("title",i,e)]},Bu=(t,e)=>e.map((n,r)=>{const i={key:r,[zn]:!0};return Object.keys(n).forEach(s=>{const a=ng[s]||s;if(a==="innerHTML"||a==="cssText"){const l=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:l}}else i[a]=n[s]}),_t.createElement(t,i)}),mn=(t,e,n=!0)=>{switch(t){case"title":return{toComponent:()=>JA(t,e.title,e.titleAttributes),toString:()=>YA(t,e.title,e.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>Lw(e),toString:()=>Nw(e)};default:return{toComponent:()=>Bu(t,e),toString:()=>XA(t,e,n)}}},ZA=({metaTags:t,linkTags:e,scriptTags:n,encode:r})=>{const i=jp(t,zp.meta),s=jp(e,zp.link),o=jp(n,zp.script);return{priorityMethods:{toComponent:()=>[...Bu("meta",i.priority),...Bu("link",s.priority),...Bu("script",o.priority)],toString:()=>`${mn("meta",i.priority,r)} ${mn("link",s.priority,r)} ${mn("script",o.priority,r)}`},metaTags:i.default,linkTags:s.default,scriptTags:o.default}},eP=t=>{const{baseTag:e,bodyAttributes:n,encode:r=!0,htmlAttributes:i,noscriptTags:s,styleTags:o,title:a="",titleAttributes:l,prioritizeSeoTags:u}=t;let{linkTags:d,metaTags:p,scriptTags:f}=t,g={toComponent:()=>{},toString:()=>""};return u&&({priorityMethods:g,linkTags:d,metaTags:p,scriptTags:f}=ZA(t)),{priority:g,base:mn("base",e,r),bodyAttributes:mn("bodyAttributes",n,r),htmlAttributes:mn("htmlAttributes",i,r),link:mn("link",d,r),meta:mn("meta",p,r),noscript:mn("noscript",s,r),script:mn("script",f,r),style:mn("style",o,r),title:mn("title",{title:a,titleAttributes:l},r)}},vf=eP,mu=[],Dw=!!(typeof window<"u"&&window.document&&window.document.createElement),bf=class{constructor(t,e){hr(this,"instances",[]);hr(this,"canUseDOM",Dw);hr(this,"context");hr(this,"value",{setHelmet:t=>{this.context.helmet=t},helmetInstances:{get:()=>this.canUseDOM?mu:this.instances,add:t=>{(this.canUseDOM?mu:this.instances).push(t)},remove:t=>{const e=(this.canUseDOM?mu:this.instances).indexOf(t);(this.canUseDOM?mu:this.instances).splice(e,1)}}});this.context=t,this.canUseDOM=e||!1,e||(t.helmet=vf({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},tP={},Ow=_t.createContext(tP),Qi,zw=(Qi=class extends z.Component{constructor(n){super(n);hr(this,"helmetData");this.helmetData=new bf(this.props.context||{},Qi.canUseDOM)}render(){return _t.createElement(Ow.Provider,{value:this.helmetData.value},this.props.children)}},hr(Qi,"canUseDOM",Dw),Qi),Ts=(t,e)=>{const n=document.head||document.querySelector("head"),r=n.querySelectorAll(`${t}[${zn}]`),i=[].slice.call(r),s=[];let o;return e&&e.length&&e.forEach(a=>{const l=document.createElement(t);for(const u in a)if(Object.prototype.hasOwnProperty.call(a,u))if(u==="innerHTML")l.innerHTML=a.innerHTML;else if(u==="cssText")l.styleSheet?l.styleSheet.cssText=a.cssText:l.appendChild(document.createTextNode(a.cssText));else{const d=u,p=typeof a[d]>"u"?"":a[d];l.setAttribute(u,p)}l.setAttribute(zn,"true"),i.some((u,d)=>(o=d,l.isEqualNode(u)))?i.splice(o,1):s.push(l)}),i.forEach(a=>{var l;return(l=a.parentNode)==null?void 0:l.removeChild(a)}),s.forEach(a=>n.appendChild(a)),{oldTags:i,newTags:s}},wf=(t,e)=>{const n=document.getElementsByTagName(t)[0];if(!n)return;const r=n.getAttribute(zn),i=r?r.split(","):[],s=[...i],o=Object.keys(e);for(const a of o){const l=e[a]||"";n.getAttribute(a)!==l&&n.setAttribute(a,l),i.indexOf(a)===-1&&i.push(a);const u=s.indexOf(a);u!==-1&&s.splice(u,1)}for(let a=s.length-1;a>=0;a-=1)n.removeAttribute(s[a]);i.length===s.length?n.removeAttribute(zn):n.getAttribute(zn)!==o.join(",")&&n.setAttribute(zn,o.join(","))},nP=(t,e)=>{typeof t<"u"&&document.title!==t&&(document.title=Rw(t)),wf("title",e)},w0=(t,e)=>{const{baseTag:n,bodyAttributes:r,htmlAttributes:i,linkTags:s,metaTags:o,noscriptTags:a,onChangeClientState:l,scriptTags:u,styleTags:d,title:p,titleAttributes:f}=t;wf("body",r),wf("html",i),nP(p,f);const g={baseTag:Ts("base",n),linkTags:Ts("link",s),metaTags:Ts("meta",o),noscriptTags:Ts("noscript",a),scriptTags:Ts("script",u),styleTags:Ts("style",d)},_={},k={};Object.keys(g).forEach(I=>{const{newTags:x,oldTags:v}=g[I];x.length&&(_[I]=x),v.length&&(k[I]=g[I].oldTags)}),e&&e(),l(t,_,k)},aa=null,rP=t=>{aa&&cancelAnimationFrame(aa),t.defer?aa=requestAnimationFrame(()=>{w0(t,()=>{aa=null})}):(w0(t),aa=null)},iP=rP,k0=class extends z.Component{constructor(){super(...arguments);hr(this,"rendered",!1)}shouldComponentUpdate(e){return!FA(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:n}=this.props.context;let r=null;const i=KA(e.get().map(s=>{const o={...s.props};return delete o.context,o}));zw.canUseDOM?iP(i):vf&&(r=vf(i)),n(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},vh,sP=(vh=class extends z.Component{shouldComponentUpdate(t){return!zA(b0(this.props,"helmetData"),b0(t,"helmetData"))}mapNestedChildrenToProps(t,e){if(!e)return null;switch(t.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${t.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(t,e,n,r){return{...e,[t.type]:[...e[t.type]||[],{...n,...this.mapNestedChildrenToProps(t,r)}]}}mapObjectTypeChildren(t,e,n,r){switch(t.type){case"title":return{...e,[t.type]:r,titleAttributes:{...n}};case"body":return{...e,bodyAttributes:{...n}};case"html":return{...e,htmlAttributes:{...n}};default:return{...e,[t.type]:{...n}}}}mapArrayTypeChildrenToProps(t,e){let n={...e};return Object.keys(t).forEach(r=>{n={...n,[r]:t[r]}}),n}warnOnInvalidChildren(t,e){return x0(v0.some(n=>t.type===n),typeof t.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${v0.join(", ")} are allowed. Helmet does not support rendering <${t.type}> elements. Refer to our API for more information.`),x0(!e||typeof e=="string"||Array.isArray(e)&&!e.some(n=>typeof n!="string"),`Helmet expects a string as a child of <${t.type}>. Did you forget to wrap your children in braces? ( <${t.type}>{\`\`}</${t.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(t,e){let n={};return _t.Children.forEach(t,r=>{if(!r||!r.props)return;const{children:i,...s}=r.props,o=Object.keys(s).reduce((l,u)=>(l[UA[u]||u]=s[u],l),{});let{type:a}=r;switch(typeof a=="symbol"?a=a.toString():this.warnOnInvalidChildren(r,i),a){case"Symbol(react.fragment)":e=this.mapChildrenToProps(i,e);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(r,n,o,i);break;default:e=this.mapObjectTypeChildren(r,e,o,i);break}}),this.mapArrayTypeChildrenToProps(n,e)}render(){const{children:t,...e}=this.props;let n={...e},{helmetData:r}=e;if(t&&(n=this.mapChildrenToProps(t,n)),r&&!(r instanceof bf)){const i=r;r=new bf(i.context,!0),delete n.helmetData}return r?_t.createElement(k0,{...n,context:r.value}):_t.createElement(Ow.Consumer,null,i=>_t.createElement(k0,{...n,context:i}))}},hr(vh,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),vh);const oP=()=>{};var E0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},aP=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},jw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4;let f=(a&15)<<2|u>>6,g=u&63;l||(g=64,o||(f=64)),r.push(n[d],n[p],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Mw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):aP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new lP;const f=s<<2|a>>4;if(r.push(f),u!==64){const g=a<<4&240|u>>2;if(r.push(g),p!==64){const _=u<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class lP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uP=function(t){const e=Mw(t);return jw.encodeByteArray(e,!0)},Rc=function(t){return uP(t).replace(/\./g,"")},Vw=function(t){try{return jw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP=()=>cP().__FIREBASE_DEFAULTS__,pP=()=>{if(typeof process>"u"||typeof E0>"u")return;const t=E0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},hP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Vw(t[1]);return e&&JSON.parse(e)},bd=()=>{try{return oP()||dP()||pP()||hP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Fw=t=>{var e,n;return(n=(e=bd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},fP=t=>{const e=Fw(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Uw=()=>{var t;return(t=bd())==null?void 0:t.config},qw=t=>{var e;return(e=bd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Rc(JSON.stringify(n)),Rc(JSON.stringify(o)),""].join(".")}const Pa={};function yP(){const t={prod:[],emulator:[]};for(const e of Object.keys(Pa))Pa[e]?t.emulator.push(e):t.prod.push(e);return t}function _P(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let T0=!1;function Ww(t,e){if(typeof window>"u"||typeof document>"u"||!Io(window.location.host)||Pa[t]===e||Pa[t]||T0)return;Pa[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",s=yP().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{T0=!0,o()},f}function d(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function p(){const f=_P(r),g=n("text"),_=document.getElementById(g)||document.createElement("span"),k=n("learnmore"),I=document.getElementById(k)||document.createElement("a"),x=n("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const w=f.element;a(w),d(I,k);const M=u();l(v,x),w.append(v,_,I,M),document.body.appendChild(w)}s?(_.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function vP(){var e;const t=(e=bd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function kP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function EP(){const t=Ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TP(){return!vP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SP(){try{return typeof indexedDB=="object"}catch{return!1}}function CP(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP="FirebaseError";class Nr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=IP,Object.setPrototypeOf(this,Nr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tl.prototype.create)}}class Tl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?AP(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Nr(i,a,r)}}function AP(t,e){return t.replace(PP,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const PP=/\{\$([^}]+)}/g;function RP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function is(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(S0(s)&&S0(o)){if(!is(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function S0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function NP(t,e){const n=new LP(t,e);return n.subscribe.bind(n)}class LP{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");DP(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Vp),i.error===void 0&&(i.error=Vp),i.complete===void 0&&(i.complete=Vp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DP(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Vp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(t){return t&&t._delegate?t._delegate:t}class ss{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new mP;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(MP(e))try{this.getOrInitializeService({instanceIdentifier:Fi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Fi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fi){return this.instances.has(e)}getOptions(e=Fi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zP(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fi){return this.component?this.component.multipleInstances?e:Fi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zP(t){return t===Fi?void 0:t}function MP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OP(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(be||(be={}));const VP={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},FP=be.INFO,UP={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},qP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=UP[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rg{constructor(e){this.name=e,this._logLevel=FP,this._logHandler=qP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const BP=(t,e)=>e.some(n=>t instanceof n);let C0,I0;function WP(){return C0||(C0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HP(){return I0||(I0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hw=new WeakMap,kf=new WeakMap,$w=new WeakMap,Fp=new WeakMap,ig=new WeakMap;function $P(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ci(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Hw.set(n,t)}).catch(()=>{}),ig.set(e,t),e}function KP(t){if(kf.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});kf.set(t,e)}let Ef={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return kf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$w.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ci(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function QP(t){Ef=t(Ef)}function GP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Up(this),e,...n);return $w.set(r,e.sort?e.sort():[e]),ci(r)}:HP().includes(t)?function(...e){return t.apply(Up(this),e),ci(Hw.get(this))}:function(...e){return ci(t.apply(Up(this),e))}}function YP(t){return typeof t=="function"?GP(t):(t instanceof IDBTransaction&&KP(t),BP(t,WP())?new Proxy(t,Ef):t)}function ci(t){if(t instanceof IDBRequest)return $P(t);if(Fp.has(t))return Fp.get(t);const e=YP(t);return e!==t&&(Fp.set(t,e),ig.set(e,t)),e}const Up=t=>ig.get(t);function XP(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ci(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ci(o.result),l.oldVersion,l.newVersion,ci(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const JP=["get","getKey","getAll","getAllKeys","count"],ZP=["put","add","delete","clear"],qp=new Map;function A0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qp.get(e))return qp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=ZP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||JP.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return qp.set(e,s),s}QP(t=>({...t,get:(e,n,r)=>A0(e,n)||t.get(e,n,r),has:(e,n)=>!!A0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Tf="@firebase/app",P0="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new rg("@firebase/app"),nR="@firebase/app-compat",rR="@firebase/analytics-compat",iR="@firebase/analytics",sR="@firebase/app-check-compat",oR="@firebase/app-check",aR="@firebase/auth",lR="@firebase/auth-compat",uR="@firebase/database",cR="@firebase/data-connect",dR="@firebase/database-compat",pR="@firebase/functions",hR="@firebase/functions-compat",fR="@firebase/installations",mR="@firebase/installations-compat",gR="@firebase/messaging",yR="@firebase/messaging-compat",_R="@firebase/performance",xR="@firebase/performance-compat",vR="@firebase/remote-config",bR="@firebase/remote-config-compat",wR="@firebase/storage",kR="@firebase/storage-compat",ER="@firebase/firestore",TR="@firebase/ai",SR="@firebase/firestore-compat",CR="firebase",IR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf="[DEFAULT]",AR={[Tf]:"fire-core",[nR]:"fire-core-compat",[iR]:"fire-analytics",[rR]:"fire-analytics-compat",[oR]:"fire-app-check",[sR]:"fire-app-check-compat",[aR]:"fire-auth",[lR]:"fire-auth-compat",[uR]:"fire-rtdb",[cR]:"fire-data-connect",[dR]:"fire-rtdb-compat",[pR]:"fire-fn",[hR]:"fire-fn-compat",[fR]:"fire-iid",[mR]:"fire-iid-compat",[gR]:"fire-fcm",[yR]:"fire-fcm-compat",[_R]:"fire-perf",[xR]:"fire-perf-compat",[vR]:"fire-rc",[bR]:"fire-rc-compat",[wR]:"fire-gcs",[kR]:"fire-gcs-compat",[ER]:"fire-fst",[SR]:"fire-fst-compat",[TR]:"fire-vertex","fire-js":"fire-js",[CR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=new Map,PR=new Map,Cf=new Map;function R0(t,e){try{t.container.addComponent(e)}catch(n){Cr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mo(t){const e=t.name;if(Cf.has(e))return Cr.debug(`There were multiple attempts to register component ${e}.`),!1;Cf.set(e,t);for(const n of Nc.values())R0(n,t);for(const n of PR.values())R0(n,t);return!0}function sg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function On(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},di=new Tl("app","Firebase",RR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw di.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=IR;function Kw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Sf,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw di.create("bad-app-name",{appName:String(i)});if(n||(n=Uw()),!n)throw di.create("no-options");const s=Nc.get(i);if(s){if(is(n,s.options)&&is(r,s.config))return s;throw di.create("duplicate-app",{appName:i})}const o=new jP(i);for(const l of Cf.values())o.addComponent(l);const a=new NR(n,r,o);return Nc.set(i,a),a}function Qw(t=Sf){const e=Nc.get(t);if(!e&&t===Sf&&Uw())return Kw();if(!e)throw di.create("no-app",{appName:t});return e}function pi(t,e,n){let r=AR[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cr.warn(o.join(" "));return}mo(new ss(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR="firebase-heartbeat-database",DR=1,ol="firebase-heartbeat-store";let Bp=null;function Gw(){return Bp||(Bp=XP(LR,DR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ol)}catch(n){console.warn(n)}}}}).catch(t=>{throw di.create("idb-open",{originalErrorMessage:t.message})})),Bp}async function OR(t){try{const n=(await Gw()).transaction(ol),r=await n.objectStore(ol).get(Yw(t));return await n.done,r}catch(e){if(e instanceof Nr)Cr.warn(e.message);else{const n=di.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cr.warn(n.message)}}}async function N0(t,e){try{const r=(await Gw()).transaction(ol,"readwrite");await r.objectStore(ol).put(e,Yw(t)),await r.done}catch(n){if(n instanceof Nr)Cr.warn(n.message);else{const r=di.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cr.warn(r.message)}}}function Yw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR=1024,MR=30;class jR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new FR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=L0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>MR){const o=UR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Cr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=L0(),{heartbeatsToSend:r,unsentEntries:i}=VR(this._heartbeatsCache.heartbeats),s=Rc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Cr.warn(n),""}}}function L0(){return new Date().toISOString().substring(0,10)}function VR(t,e=zR){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),D0(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),D0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class FR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SP()?CP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await OR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return N0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return N0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function D0(t){return Rc(JSON.stringify({version:2,heartbeats:t})).length}function UR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(t){mo(new ss("platform-logger",e=>new eR(e),"PRIVATE")),mo(new ss("heartbeat",e=>new jR(e),"PRIVATE")),pi(Tf,P0,t),pi(Tf,P0,"esm2020"),pi("fire-js","")}qR("");function Xw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BR=Xw,Jw=new Tl("auth","Firebase",Xw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=new rg("@firebase/auth");function WR(t,...e){Lc.logLevel<=be.WARN&&Lc.warn(`Auth (${Ao}): ${t}`,...e)}function Wu(t,...e){Lc.logLevel<=be.ERROR&&Lc.error(`Auth (${Ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(t,...e){throw ag(t,...e)}function Un(t,...e){return ag(t,...e)}function og(t,e,n){const r={...BR(),[e]:n};return new Tl("auth","Firebase",r).create(e,{appName:t.name})}function Xi(t){return og(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function HR(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&or(t,"argument-error"),og(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ag(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Jw.create(t,...e)}function de(t,e,...n){if(!t)throw ag(e,...n)}function vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wu(e),new Error(e)}function Ir(t,e){t||vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function $R(){return O0()==="http:"||O0()==="https:"}function O0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($R()||wP()||"connection"in navigator)?navigator.onLine:!0}function QR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ir(n>e,"Short delay should be less than long delay!"),this.isMobile=xP()||kP()}get(){return KR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t,e){Ir(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],XR=new Cl(3e4,6e4);function ug(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Po(t,e,n,r,i={}){return ek(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Sl({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return bP()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Io(t.emulatorConfig.host)&&(u.credentials="include"),Zw.fetch()(await tk(t,t.config.apiHost,n,a),u)})}async function ek(t,e,n){t._canInitEmulator=!1;const r={...GR,...e};try{const i=new ZR(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw gu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw gu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw gu(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw og(t,d,u);or(t,d)}}catch(i){if(i instanceof Nr)throw i;or(t,"network-request-failed",{message:String(i)})}}async function JR(t,e,n,r,i={}){const s=await Po(t,e,n,r,i);return"mfaPendingCredential"in s&&or(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function tk(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?lg(t.config,i):`${t.config.apiScheme}://${i}`;return YR.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class ZR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Un(this.auth,"network-request-failed")),XR.get())})}}function gu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Un(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eN(t,e){return Po(t,"POST","/v1/accounts:delete",e)}async function Dc(t,e){return Po(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tN(t,e=!1){const n=cn(t),r=await n.getIdToken(e),i=cg(r);de(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ra(Wp(i.auth_time)),issuedAtTime:Ra(Wp(i.iat)),expirationTime:Ra(Wp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Wp(t){return Number(t)*1e3}function cg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Wu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Vw(n);return i?JSON.parse(i):(Wu("Failed to decode base64 JWT payload"),null)}catch(i){return Wu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function z0(t){const e=cg(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Nr&&nN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function nN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ra(this.lastLoginAt),this.creationTime=Ra(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await al(t,Dc(e,{idToken:n}));de(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?nk(i.providerUserInfo):[],o=sN(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Af(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function iN(t){const e=cn(t);await Oc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sN(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function nk(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t,e){const n=await ek(t,{},async()=>{const r=Sl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await tk(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Io(t.emulatorConfig.host)&&(l.credentials="include"),Zw.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function aN(t,e){return Po(t,"POST","/v2/accounts:revokeToken",ug(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):z0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=z0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await oN(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Zs;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(de(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(de(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zs,this.toJSON())}_performRefresh(){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Mn{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new rN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Af(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await al(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return tN(this,e)}reload(){return iN(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Mn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Oc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(On(this.auth.app))return Promise.reject(Xi(this.auth));const e=await this.getIdToken();return await al(this,eN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:p,emailVerified:f,isAnonymous:g,providerData:_,stsTokenManager:k}=n;de(p&&k,e,"internal-error");const I=Zs.fromJSON(this.name,k);de(typeof p=="string",e,"internal-error"),Ur(r,e.name),Ur(i,e.name),de(typeof f=="boolean",e,"internal-error"),de(typeof g=="boolean",e,"internal-error"),Ur(s,e.name),Ur(o,e.name),Ur(a,e.name),Ur(l,e.name),Ur(u,e.name),Ur(d,e.name);const x=new Mn({uid:p,auth:e,email:i,emailVerified:f,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:I,createdAt:u,lastLoginAt:d});return _&&Array.isArray(_)&&(x.providerData=_.map(v=>({...v}))),l&&(x._redirectEventId=l),x}static async _fromIdTokenResponse(e,n,r=!1){const i=new Zs;i.updateFromServerResponse(n);const s=new Mn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Oc(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];de(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?nk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Zs;a.updateFromIdToken(r);const l=new Mn({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Af(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=new Map;function br(t){Ir(t instanceof Function,"Expected a class definition");let e=M0.get(t);return e?(Ir(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,M0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}rk.type="NONE";const j0=rk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t,e,n){return`firebase:${t}:${e}:${n}`}class eo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Hu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Hu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Dc(this.auth,{idToken:e}).catch(()=>{});return n?Mn._fromGetAccountInfoResponse(this.auth,n,e):null}return Mn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new eo(br(j0),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||br(j0);const o=Hu(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){let p;if(typeof d=="string"){const f=await Dc(e,{idToken:d}).catch(()=>{});if(!f)break;p=await Mn._fromGetAccountInfoResponse(e,f,d)}else p=Mn._fromJSON(e,d);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new eo(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new eo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ak(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ik(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uk(e))return"Blackberry";if(ck(e))return"Webos";if(sk(e))return"Safari";if((e.includes("chrome/")||ok(e))&&!e.includes("edge/"))return"Chrome";if(lk(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ik(t=Ot()){return/firefox\//i.test(t)}function sk(t=Ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ok(t=Ot()){return/crios\//i.test(t)}function ak(t=Ot()){return/iemobile/i.test(t)}function lk(t=Ot()){return/android/i.test(t)}function uk(t=Ot()){return/blackberry/i.test(t)}function ck(t=Ot()){return/webos/i.test(t)}function dg(t=Ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function lN(t=Ot()){var e;return dg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function uN(){return EP()&&document.documentMode===10}function dk(t=Ot()){return dg(t)||lk(t)||ck(t)||uk(t)||/windows phone/i.test(t)||ak(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(t,e=[]){let n;switch(t){case"Browser":n=V0(Ot());break;case"Worker":n=`${V0(Ot())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dN(t,e={}){return Po(t,"GET","/v2/passwordPolicy",ug(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=6;class hN{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??pN,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new F0(this),this.idTokenSubscription=new F0(this),this.beforeStateQueue=new cN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=br(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await eo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Dc(this,{idToken:e}),r=await Mn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(On(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Oc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(On(this.app))return Promise.reject(Xi(this));const n=e?cn(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return On(this.app)?Promise.reject(Xi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return On(this.app)?Promise.reject(Xi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(br(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dN(this),n=new hN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Tl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await aN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&br(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await eo.create(this,[br(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&WR(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function wd(t){return cn(t)}class F0{constructor(e){this.auth=e,this.observer=null,this.addObserver=NP(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function mN(t){pg=t}function gN(t){return pg.loadJS(t)}function yN(){return pg.gapiScript}function _N(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(t,e){const n=sg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(is(s,e??{}))return i;or(i,"already-initialized")}return n.initialize({options:e})}function vN(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(br);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function bN(t,e,n){const r=wd(t);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=hk(e),{host:o,port:a}=wN(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(is(u,r.config.emulator)&&is(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Io(o)?(Bw(`${s}//${o}${l}`),Ww("Auth",!0)):kN()}function hk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wN(t){const e=hk(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:U0(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:U0(o)}}}function U0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vr("not implemented")}_getIdTokenResponse(e){return vr("not implemented")}_linkToIdToken(e,n){return vr("not implemented")}_getReauthenticationResolver(e){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function to(t,e){return JR(t,"POST","/v1/accounts:signInWithIdp",ug(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="http://localhost";class os extends fk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new os(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):or("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new os(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return to(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,to(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,to(e,n)}buildRequest(){const e={requestUri:EN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Sl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il extends hg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends Il{constructor(){super("facebook.com")}static credential(e){return os._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kr.credential(e.oauthAccessToken)}catch{return null}}}Kr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Kr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends Il{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return os._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return yr.credentialFromTaggedObject(e)}static credentialFromError(e){return yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return yr.credential(n,r)}catch{return null}}}yr.GOOGLE_SIGN_IN_METHOD="google.com";yr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends Il{constructor(){super("github.com")}static credential(e){return os._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qr.credential(e.oauthAccessToken)}catch{return null}}}Qr.GITHUB_SIGN_IN_METHOD="github.com";Qr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends Il{constructor(){super("twitter.com")}static credential(e,n){return os._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Gr.credential(n,r)}catch{return null}}}Gr.TWITTER_SIGN_IN_METHOD="twitter.com";Gr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Mn._fromIdTokenResponse(e,r,i),o=q0(r);return new go({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=q0(r);return new go({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function q0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends Nr{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zc(e,n,r,i)}}function mk(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zc._fromErrorAndOperation(t,s,e,r):s})}async function TN(t,e,n=!1){const r=await al(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return go._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SN(t,e,n=!1){const{auth:r}=t;if(On(r.app))return Promise.reject(Xi(r));const i="reauthenticate";try{const s=await al(t,mk(r,i,e,t),n);de(s.idToken,r,"internal-error");const o=cg(s.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(t.uid===a,r,"user-mismatch"),go._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&or(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CN(t,e,n=!1){if(On(t.app))return Promise.reject(Xi(t));const r="signIn",i=await mk(t,r,e),s=await go._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function IN(t,e,n,r){return cn(t).onIdTokenChanged(e,n,r)}function AN(t,e,n){return cn(t).beforeAuthStateChanged(e,n)}function PN(t,e,n,r){return cn(t).onAuthStateChanged(e,n,r)}function RN(t){return cn(t).signOut()}const Mc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Mc,"1"),this.storage.removeItem(Mc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=1e3,LN=10;class yk extends gk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);uN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,LN):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},NN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}yk.type="LOCAL";const DN=yk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k extends gk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}_k.type="SESSION";const xk=_k;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new kd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await ON(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=fg("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const f=p;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return window}function MN(t){tr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(){return typeof tr().WorkerGlobalScope<"u"&&typeof tr().importScripts=="function"}async function jN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function FN(){return vk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk="firebaseLocalStorageDb",UN=1,jc="firebaseLocalStorage",wk="fbase_key";class Al{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ed(t,e){return t.transaction([jc],e?"readwrite":"readonly").objectStore(jc)}function qN(){const t=indexedDB.deleteDatabase(bk);return new Al(t).toPromise()}function Pf(){const t=indexedDB.open(bk,UN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(jc,{keyPath:wk})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(jc)?e(r):(r.close(),await qN(),e(await Pf()))})})}async function B0(t,e,n){const r=Ed(t,!0).put({[wk]:e,value:n});return new Al(r).toPromise()}async function BN(t,e){const n=Ed(t,!1).get(e),r=await new Al(n).toPromise();return r===void 0?null:r.value}function W0(t,e){const n=Ed(t,!0).delete(e);return new Al(n).toPromise()}const WN=800,HN=3;class kk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>HN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kd._getInstance(FN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await jN(),!this.activeServiceWorker)return;this.sender=new zN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pf();return await B0(e,Mc,"1"),await W0(e,Mc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>B0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>BN(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>W0(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ed(i,!1).getAll();return new Al(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kk.type="LOCAL";const $N=kk;new Cl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t,e){return e?br(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg extends fk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return to(e,this._buildIdpRequest())}_linkToIdToken(e,n){return to(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return to(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function KN(t){return CN(t.auth,new mg(t),t.bypassAuthState)}function QN(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),SN(n,new mg(t),t.bypassAuthState)}async function GN(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),TN(n,new mg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KN;case"linkViaPopup":case"linkViaRedirect":return GN;case"reauthViaPopup":case"reauthViaRedirect":return QN;default:or(this.auth,"internal-error")}}resolve(e){Ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=new Cl(2e3,1e4);async function XN(t,e,n){if(On(t.app))return Promise.reject(Un(t,"operation-not-supported-in-this-environment"));const r=wd(t);HR(t,e,hg);const i=Ek(r,n);return new $i(r,"signInViaPopup",e,i).executeNotNull()}class $i extends Tk{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,$i.currentPopupAction&&$i.currentPopupAction.cancel(),$i.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){Ir(this.filter.length===1,"Popup operations only handle one event");const e=fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$i.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YN.get())};e()}}$i.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN="pendingRedirect",$u=new Map;class ZN extends Tk{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=$u.get(this.auth._key());if(!e){try{const r=await e4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}$u.set(this.auth._key(),e)}return this.bypassAuthState||$u.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e4(t,e){const n=r4(e),r=n4(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function t4(t,e){$u.set(t._key(),e)}function n4(t){return br(t._redirectPersistence)}function r4(t){return Hu(JN,t.config.apiKey,t.name)}async function i4(t,e,n=!1){if(On(t.app))return Promise.reject(Xi(t));const r=wd(t),i=Ek(r,e),o=await new ZN(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=10*60*1e3;class o4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!a4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Sk(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Un(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s4&&this.cachedEventUids.clear(),this.cachedEventUids.has(H0(e))}saveEventToCache(e){this.cachedEventUids.add(H0(e)),this.lastProcessedEventTime=Date.now()}}function H0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Sk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function a4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(t,e={}){return Po(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c4=/^https?/;async function d4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await l4(t);for(const n of e)try{if(p4(n))return}catch{}or(t,"unauthorized-domain")}function p4(t){const e=If(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!c4.test(n))return!1;if(u4.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=new Cl(3e4,6e4);function $0(){const t=tr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function f4(t){return new Promise((e,n)=>{var i,s,o;function r(){$0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$0(),n(Un(t,"network-request-failed"))},timeout:h4.get()})}if((s=(i=tr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=tr().gapi)!=null&&o.load)r();else{const a=_N("iframefcb");return tr()[a]=()=>{gapi.load?r():n(Un(t,"network-request-failed"))},gN(`${yN()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ku=null,e})}let Ku=null;function m4(t){return Ku=Ku||f4(t),Ku}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=new Cl(5e3,15e3),y4="__/auth/iframe",_4="emulator/auth/iframe",x4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b4(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?lg(e,_4):`https://${t.config.authDomain}/${y4}`,r={apiKey:e.apiKey,appName:t.name,v:Ao},i=v4.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Sl(r).slice(1)}`}async function w4(t){const e=await m4(t),n=tr().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:b4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x4,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Un(t,"network-request-failed"),a=tr().setTimeout(()=>{s(o)},g4.get());function l(){tr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E4=500,T4=600,S4="_blank",C4="http://localhost";class K0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I4(t,e,n,r=E4,i=T4){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...k4,width:r.toString(),height:i.toString(),top:s,left:o},u=Ot().toLowerCase();n&&(a=ok(u)?S4:n),ik(u)&&(e=e||C4,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(lN(u)&&a!=="_self")return A4(e||"",a),new K0(null);const p=window.open(e||"",a,d);de(p,t,"popup-blocked");try{p.focus()}catch{}return new K0(p)}function A4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="__/auth/handler",R4="emulator/auth/handler",N4=encodeURIComponent("fac");async function Q0(t,e,n,r,i,s){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ao,eventId:i};if(e instanceof hg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",RP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(e instanceof Il){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${N4}=${encodeURIComponent(l)}`:"";return`${L4(t)}?${Sl(a).slice(1)}${u}`}function L4({config:t}){return t.emulator?lg(t,R4):`https://${t.authDomain}/${P4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="webStorageSupport";class D4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xk,this._completeRedirectFn=i4,this._overrideRedirectResult=t4}async _openPopup(e,n,r,i){var o;Ir((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await Q0(e,n,r,If(),i);return I4(e,s,fg())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Q0(e,n,r,If(),i);return MN(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ir(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await w4(e),r=new o4(e);return n.register("authEvent",i=>(de(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Hp,{type:Hp},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Hp];s!==void 0&&n(!!s),or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=d4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return dk()||sk()||dg()}}const O4=D4;var G0="@firebase/auth",Y0="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function j4(t){mo(new ss("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pk(t)},u=new fN(r,i,s,l);return vN(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),mo(new ss("auth-internal",e=>{const n=wd(e.getProvider("auth").getImmediate());return(r=>new z4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pi(G0,Y0,M4(t)),pi(G0,Y0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4=5*60,F4=qw("authIdTokenMaxAge")||V4;let X0=null;const U4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>F4)return;const i=n==null?void 0:n.token;X0!==i&&(X0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function q4(t=Qw()){const e=sg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xN(t,{popupRedirectResolver:O4,persistence:[$N,DN,xk]}),r=qw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=U4(s.toString());AN(n,o,()=>o(n.currentUser)),IN(n,a=>o(a))}}const i=Fw("auth");return i&&bN(n,`http://${i}`),n}function B4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}mN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Un("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",B4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});j4("Browser");var W4="firebase",H4="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pi(W4,H4,"app");var J0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hi,Ck;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,E){function C(){}C.prototype=E.prototype,S.F=E.prototype,S.prototype=new C,S.prototype.constructor=S,S.D=function(b,A,N){for(var P=Array(arguments.length-2),se=2;se<arguments.length;se++)P[se-2]=arguments[se];return E.prototype[A].apply(b,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,E,C){C||(C=0);const b=Array(16);if(typeof E=="string")for(var A=0;A<16;++A)b[A]=E.charCodeAt(C++)|E.charCodeAt(C++)<<8|E.charCodeAt(C++)<<16|E.charCodeAt(C++)<<24;else for(A=0;A<16;++A)b[A]=E[C++]|E[C++]<<8|E[C++]<<16|E[C++]<<24;E=S.g[0],C=S.g[1],A=S.g[2];let N=S.g[3],P;P=E+(N^C&(A^N))+b[0]+3614090360&4294967295,E=C+(P<<7&4294967295|P>>>25),P=N+(A^E&(C^A))+b[1]+3905402710&4294967295,N=E+(P<<12&4294967295|P>>>20),P=A+(C^N&(E^C))+b[2]+606105819&4294967295,A=N+(P<<17&4294967295|P>>>15),P=C+(E^A&(N^E))+b[3]+3250441966&4294967295,C=A+(P<<22&4294967295|P>>>10),P=E+(N^C&(A^N))+b[4]+4118548399&4294967295,E=C+(P<<7&4294967295|P>>>25),P=N+(A^E&(C^A))+b[5]+1200080426&4294967295,N=E+(P<<12&4294967295|P>>>20),P=A+(C^N&(E^C))+b[6]+2821735955&4294967295,A=N+(P<<17&4294967295|P>>>15),P=C+(E^A&(N^E))+b[7]+4249261313&4294967295,C=A+(P<<22&4294967295|P>>>10),P=E+(N^C&(A^N))+b[8]+1770035416&4294967295,E=C+(P<<7&4294967295|P>>>25),P=N+(A^E&(C^A))+b[9]+2336552879&4294967295,N=E+(P<<12&4294967295|P>>>20),P=A+(C^N&(E^C))+b[10]+4294925233&4294967295,A=N+(P<<17&4294967295|P>>>15),P=C+(E^A&(N^E))+b[11]+2304563134&4294967295,C=A+(P<<22&4294967295|P>>>10),P=E+(N^C&(A^N))+b[12]+1804603682&4294967295,E=C+(P<<7&4294967295|P>>>25),P=N+(A^E&(C^A))+b[13]+4254626195&4294967295,N=E+(P<<12&4294967295|P>>>20),P=A+(C^N&(E^C))+b[14]+2792965006&4294967295,A=N+(P<<17&4294967295|P>>>15),P=C+(E^A&(N^E))+b[15]+1236535329&4294967295,C=A+(P<<22&4294967295|P>>>10),P=E+(A^N&(C^A))+b[1]+4129170786&4294967295,E=C+(P<<5&4294967295|P>>>27),P=N+(C^A&(E^C))+b[6]+3225465664&4294967295,N=E+(P<<9&4294967295|P>>>23),P=A+(E^C&(N^E))+b[11]+643717713&4294967295,A=N+(P<<14&4294967295|P>>>18),P=C+(N^E&(A^N))+b[0]+3921069994&4294967295,C=A+(P<<20&4294967295|P>>>12),P=E+(A^N&(C^A))+b[5]+3593408605&4294967295,E=C+(P<<5&4294967295|P>>>27),P=N+(C^A&(E^C))+b[10]+38016083&4294967295,N=E+(P<<9&4294967295|P>>>23),P=A+(E^C&(N^E))+b[15]+3634488961&4294967295,A=N+(P<<14&4294967295|P>>>18),P=C+(N^E&(A^N))+b[4]+3889429448&4294967295,C=A+(P<<20&4294967295|P>>>12),P=E+(A^N&(C^A))+b[9]+568446438&4294967295,E=C+(P<<5&4294967295|P>>>27),P=N+(C^A&(E^C))+b[14]+3275163606&4294967295,N=E+(P<<9&4294967295|P>>>23),P=A+(E^C&(N^E))+b[3]+4107603335&4294967295,A=N+(P<<14&4294967295|P>>>18),P=C+(N^E&(A^N))+b[8]+1163531501&4294967295,C=A+(P<<20&4294967295|P>>>12),P=E+(A^N&(C^A))+b[13]+2850285829&4294967295,E=C+(P<<5&4294967295|P>>>27),P=N+(C^A&(E^C))+b[2]+4243563512&4294967295,N=E+(P<<9&4294967295|P>>>23),P=A+(E^C&(N^E))+b[7]+1735328473&4294967295,A=N+(P<<14&4294967295|P>>>18),P=C+(N^E&(A^N))+b[12]+2368359562&4294967295,C=A+(P<<20&4294967295|P>>>12),P=E+(C^A^N)+b[5]+4294588738&4294967295,E=C+(P<<4&4294967295|P>>>28),P=N+(E^C^A)+b[8]+2272392833&4294967295,N=E+(P<<11&4294967295|P>>>21),P=A+(N^E^C)+b[11]+1839030562&4294967295,A=N+(P<<16&4294967295|P>>>16),P=C+(A^N^E)+b[14]+4259657740&4294967295,C=A+(P<<23&4294967295|P>>>9),P=E+(C^A^N)+b[1]+2763975236&4294967295,E=C+(P<<4&4294967295|P>>>28),P=N+(E^C^A)+b[4]+1272893353&4294967295,N=E+(P<<11&4294967295|P>>>21),P=A+(N^E^C)+b[7]+4139469664&4294967295,A=N+(P<<16&4294967295|P>>>16),P=C+(A^N^E)+b[10]+3200236656&4294967295,C=A+(P<<23&4294967295|P>>>9),P=E+(C^A^N)+b[13]+681279174&4294967295,E=C+(P<<4&4294967295|P>>>28),P=N+(E^C^A)+b[0]+3936430074&4294967295,N=E+(P<<11&4294967295|P>>>21),P=A+(N^E^C)+b[3]+3572445317&4294967295,A=N+(P<<16&4294967295|P>>>16),P=C+(A^N^E)+b[6]+76029189&4294967295,C=A+(P<<23&4294967295|P>>>9),P=E+(C^A^N)+b[9]+3654602809&4294967295,E=C+(P<<4&4294967295|P>>>28),P=N+(E^C^A)+b[12]+3873151461&4294967295,N=E+(P<<11&4294967295|P>>>21),P=A+(N^E^C)+b[15]+530742520&4294967295,A=N+(P<<16&4294967295|P>>>16),P=C+(A^N^E)+b[2]+3299628645&4294967295,C=A+(P<<23&4294967295|P>>>9),P=E+(A^(C|~N))+b[0]+4096336452&4294967295,E=C+(P<<6&4294967295|P>>>26),P=N+(C^(E|~A))+b[7]+1126891415&4294967295,N=E+(P<<10&4294967295|P>>>22),P=A+(E^(N|~C))+b[14]+2878612391&4294967295,A=N+(P<<15&4294967295|P>>>17),P=C+(N^(A|~E))+b[5]+4237533241&4294967295,C=A+(P<<21&4294967295|P>>>11),P=E+(A^(C|~N))+b[12]+1700485571&4294967295,E=C+(P<<6&4294967295|P>>>26),P=N+(C^(E|~A))+b[3]+2399980690&4294967295,N=E+(P<<10&4294967295|P>>>22),P=A+(E^(N|~C))+b[10]+4293915773&4294967295,A=N+(P<<15&4294967295|P>>>17),P=C+(N^(A|~E))+b[1]+2240044497&4294967295,C=A+(P<<21&4294967295|P>>>11),P=E+(A^(C|~N))+b[8]+1873313359&4294967295,E=C+(P<<6&4294967295|P>>>26),P=N+(C^(E|~A))+b[15]+4264355552&4294967295,N=E+(P<<10&4294967295|P>>>22),P=A+(E^(N|~C))+b[6]+2734768916&4294967295,A=N+(P<<15&4294967295|P>>>17),P=C+(N^(A|~E))+b[13]+1309151649&4294967295,C=A+(P<<21&4294967295|P>>>11),P=E+(A^(C|~N))+b[4]+4149444226&4294967295,E=C+(P<<6&4294967295|P>>>26),P=N+(C^(E|~A))+b[11]+3174756917&4294967295,N=E+(P<<10&4294967295|P>>>22),P=A+(E^(N|~C))+b[2]+718787259&4294967295,A=N+(P<<15&4294967295|P>>>17),P=C+(N^(A|~E))+b[9]+3951481745&4294967295,S.g[0]=S.g[0]+E&4294967295,S.g[1]=S.g[1]+(A+(P<<21&4294967295|P>>>11))&4294967295,S.g[2]=S.g[2]+A&4294967295,S.g[3]=S.g[3]+N&4294967295}r.prototype.v=function(S,E){E===void 0&&(E=S.length);const C=E-this.blockSize,b=this.C;let A=this.h,N=0;for(;N<E;){if(A==0)for(;N<=C;)i(this,S,N),N+=this.blockSize;if(typeof S=="string"){for(;N<E;)if(b[A++]=S.charCodeAt(N++),A==this.blockSize){i(this,b),A=0;break}}else for(;N<E;)if(b[A++]=S[N++],A==this.blockSize){i(this,b),A=0;break}}this.h=A,this.o+=E},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var E=1;E<S.length-8;++E)S[E]=0;E=this.o*8;for(var C=S.length-8;C<S.length;++C)S[C]=E&255,E/=256;for(this.v(S),S=Array(16),E=0,C=0;C<4;++C)for(let b=0;b<32;b+=8)S[E++]=this.g[C]>>>b&255;return S};function s(S,E){var C=a;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=E(S)}function o(S,E){this.h=E;const C=[];let b=!0;for(let A=S.length-1;A>=0;A--){const N=S[A]|0;b&&N==E||(C[A]=N,b=!1)}this.g=C}var a={};function l(S){return-128<=S&&S<128?s(S,function(E){return new o([E|0],E<0?-1:0)}):new o([S|0],S<0?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return p;if(S<0)return I(u(-S));const E=[];let C=1;for(let b=0;S>=C;b++)E[b]=S/C|0,C*=4294967296;return new o(E,0)}function d(S,E){if(S.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(S.charAt(0)=="-")return I(d(S.substring(1),E));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=u(Math.pow(E,8));let b=p;for(let N=0;N<S.length;N+=8){var A=Math.min(8,S.length-N);const P=parseInt(S.substring(N,N+A),E);A<8?(A=u(Math.pow(E,A)),b=b.j(A).add(u(P))):(b=b.j(C),b=b.add(u(P)))}return b}var p=l(0),f=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(k(this))return-I(this).m();let S=0,E=1;for(let C=0;C<this.g.length;C++){const b=this.i(C);S+=(b>=0?b:4294967296+b)*E,E*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(_(this))return"0";if(k(this))return"-"+I(this).toString(S);const E=u(Math.pow(S,6));var C=this;let b="";for(;;){const A=M(C,E).g;C=x(C,A.j(E));let N=((C.g.length>0?C.g[0]:C.h)>>>0).toString(S);if(C=A,_(C))return N+b;for(;N.length<6;)N="0"+N;b=N+b}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function _(S){if(S.h!=0)return!1;for(let E=0;E<S.g.length;E++)if(S.g[E]!=0)return!1;return!0}function k(S){return S.h==-1}t.l=function(S){return S=x(this,S),k(S)?-1:_(S)?0:1};function I(S){const E=S.g.length,C=[];for(let b=0;b<E;b++)C[b]=~S.g[b];return new o(C,~S.h).add(f)}t.abs=function(){return k(this)?I(this):this},t.add=function(S){const E=Math.max(this.g.length,S.g.length),C=[];let b=0;for(let A=0;A<=E;A++){let N=b+(this.i(A)&65535)+(S.i(A)&65535),P=(N>>>16)+(this.i(A)>>>16)+(S.i(A)>>>16);b=P>>>16,N&=65535,P&=65535,C[A]=P<<16|N}return new o(C,C[C.length-1]&-2147483648?-1:0)};function x(S,E){return S.add(I(E))}t.j=function(S){if(_(this)||_(S))return p;if(k(this))return k(S)?I(this).j(I(S)):I(I(this).j(S));if(k(S))return I(this.j(I(S)));if(this.l(g)<0&&S.l(g)<0)return u(this.m()*S.m());const E=this.g.length+S.g.length,C=[];for(var b=0;b<2*E;b++)C[b]=0;for(b=0;b<this.g.length;b++)for(let A=0;A<S.g.length;A++){const N=this.i(b)>>>16,P=this.i(b)&65535,se=S.i(A)>>>16,$=S.i(A)&65535;C[2*b+2*A]+=P*$,v(C,2*b+2*A),C[2*b+2*A+1]+=N*$,v(C,2*b+2*A+1),C[2*b+2*A+1]+=P*se,v(C,2*b+2*A+1),C[2*b+2*A+2]+=N*se,v(C,2*b+2*A+2)}for(S=0;S<E;S++)C[S]=C[2*S+1]<<16|C[2*S];for(S=E;S<2*E;S++)C[S]=0;return new o(C,0)};function v(S,E){for(;(S[E]&65535)!=S[E];)S[E+1]+=S[E]>>>16,S[E]&=65535,E++}function w(S,E){this.g=S,this.h=E}function M(S,E){if(_(E))throw Error("division by zero");if(_(S))return new w(p,p);if(k(S))return E=M(I(S),E),new w(I(E.g),I(E.h));if(k(E))return E=M(S,I(E)),new w(I(E.g),E.h);if(S.g.length>30){if(k(S)||k(E))throw Error("slowDivide_ only works with positive integers.");for(var C=f,b=E;b.l(S)<=0;)C=O(C),b=O(b);var A=D(C,1),N=D(b,1);for(b=D(b,2),C=D(C,2);!_(b);){var P=N.add(b);P.l(S)<=0&&(A=A.add(C),N=P),b=D(b,1),C=D(C,1)}return E=x(S,A.j(E)),new w(A,E)}for(A=p;S.l(E)>=0;){for(C=Math.max(1,Math.floor(S.m()/E.m())),b=Math.ceil(Math.log(C)/Math.LN2),b=b<=48?1:Math.pow(2,b-48),N=u(C),P=N.j(E);k(P)||P.l(S)>0;)C-=b,N=u(C),P=N.j(E);_(N)&&(N=f),A=A.add(N),S=x(S,P)}return new w(A,S)}t.B=function(S){return M(this,S).h},t.and=function(S){const E=Math.max(this.g.length,S.g.length),C=[];for(let b=0;b<E;b++)C[b]=this.i(b)&S.i(b);return new o(C,this.h&S.h)},t.or=function(S){const E=Math.max(this.g.length,S.g.length),C=[];for(let b=0;b<E;b++)C[b]=this.i(b)|S.i(b);return new o(C,this.h|S.h)},t.xor=function(S){const E=Math.max(this.g.length,S.g.length),C=[];for(let b=0;b<E;b++)C[b]=this.i(b)^S.i(b);return new o(C,this.h^S.h)};function O(S){const E=S.g.length+1,C=[];for(let b=0;b<E;b++)C[b]=S.i(b)<<1|S.i(b-1)>>>31;return new o(C,S.h)}function D(S,E){const C=E>>5;E%=32;const b=S.g.length-C,A=[];for(let N=0;N<b;N++)A[N]=E>0?S.i(N+C)>>>E|S.i(N+C+1)<<32-E:S.i(N+C);return new o(A,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Ck=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,hi=o}).apply(typeof J0<"u"?J0:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ik,ga,Ak,Qu,Rf,Pk,Rk,Nk;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var m=0;m<c.length;++m){var y=c[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,m){if(m)e:{var y=r;c=c.split(".");for(var T=0;T<c.length-1;T++){var j=c[T];if(!(j in y))break e;y=y[j]}c=c[c.length-1],T=y[c],m=m(T),m!=T&&m!=null&&e(y,c,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(m){var y=[],T;for(T in m)Object.prototype.hasOwnProperty.call(m,T)&&y.push([T,m[T]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function l(c,m,y){return c.call.apply(c.bind,arguments)}function u(c,m,y){return u=l,u.apply(null,arguments)}function d(c,m){var y=Array.prototype.slice.call(arguments,1);return function(){var T=y.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function p(c,m){function y(){}y.prototype=m.prototype,c.Z=m.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(T,j,V){for(var X=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)X[ge-2]=arguments[ge];return m.prototype[j].apply(T,X)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const m=c.length;if(m>0){const y=Array(m);for(let T=0;T<m;T++)y[T]=c[T];return y}return[]}function _(c,m){for(let T=1;T<arguments.length;T++){const j=arguments[T];var y=typeof j;if(y=y!="object"?y:j?Array.isArray(j)?"array":y:"null",y=="array"||y=="object"&&typeof j.length=="number"){y=c.length||0;const V=j.length||0;c.length=y+V;for(let X=0;X<V;X++)c[y+X]=j[X]}else c.push(j)}}class k{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function I(c){o.setTimeout(()=>{throw c},0)}function x(){var c=S;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class v{constructor(){this.h=this.g=null}add(m,y){const T=w.get();T.set(m,y),this.h?this.h.next=T:this.g=T,this.h=T}}var w=new k(()=>new M,c=>c.reset());class M{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let O,D=!1,S=new v,E=()=>{const c=Promise.resolve(void 0);O=()=>{c.then(C)}};function C(){for(var c;c=x();){try{c.h.call(c.g)}catch(y){I(y)}var m=w;m.j(c),m.h<100&&(m.h++,c.next=m.g,m.g=c)}D=!1}function b(){this.u=this.u,this.C=this.C}b.prototype.u=!1,b.prototype.dispose=function(){this.u||(this.u=!0,this.N())},b.prototype[Symbol.dispose]=function(){this.dispose()},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,m),o.removeEventListener("test",y,m)}catch{}return c}();function P(c){return/^[\s\xa0]*$/.test(c)}function se(c,m){A.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,m)}p(se,A),se.prototype.init=function(c,m){const y=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget,m||(y=="mouseover"?m=c.fromElement:y=="mouseout"&&(m=c.toElement)),this.relatedTarget=m,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var $="closure_listenable_"+(Math.random()*1e6|0),ae=0;function ye(c,m,y,T,j){this.listener=c,this.proxy=null,this.src=m,this.type=y,this.capture=!!T,this.ha=j,this.key=++ae,this.da=this.fa=!1}function W(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ee(c,m,y){for(const T in c)m.call(y,c[T],T,c)}function R(c,m){for(const y in c)m.call(void 0,c[y],y,c)}function Z(c){const m={};for(const y in c)m[y]=c[y];return m}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(c,m){let y,T;for(let j=1;j<arguments.length;j++){T=arguments[j];for(y in T)c[y]=T[y];for(let V=0;V<re.length;V++)y=re[V],Object.prototype.hasOwnProperty.call(T,y)&&(c[y]=T[y])}}function he(c){this.src=c,this.g={},this.h=0}he.prototype.add=function(c,m,y,T,j){const V=c.toString();c=this.g[V],c||(c=this.g[V]=[],this.h++);const X=Ee(c,m,T,j);return X>-1?(m=c[X],y||(m.fa=!1)):(m=new ye(m,this.src,V,!!T,j),m.fa=y,c.push(m)),m};function Ae(c,m){const y=m.type;if(y in c.g){var T=c.g[y],j=Array.prototype.indexOf.call(T,m,void 0),V;(V=j>=0)&&Array.prototype.splice.call(T,j,1),V&&(W(m),c.g[y].length==0&&(delete c.g[y],c.h--))}}function Ee(c,m,y,T){for(let j=0;j<c.length;++j){const V=c[j];if(!V.da&&V.listener==m&&V.capture==!!y&&V.ha==T)return j}return-1}var He="closure_lm_"+(Math.random()*1e6|0),J={};function q(c,m,y,T,j){if(Array.isArray(m)){for(let V=0;V<m.length;V++)q(c,m[V],y,T,j);return null}return y=Fl(y),c&&c[$]?c.J(m,y,a(T)?!!T.capture:!1,j):Q(c,m,y,!1,T,j)}function Q(c,m,y,T,j,V){if(!m)throw Error("Invalid event type");const X=a(j)?!!j.capture:!!j;let ge=Tn(c);if(ge||(c[He]=ge=new he(c)),y=ge.add(m,y,T,X,V),y.proxy)return y;if(T=G(),y.proxy=T,T.src=c,T.listener=y,c.addEventListener)N||(j=X),j===void 0&&(j=!1),c.addEventListener(m.toString(),T,j);else if(c.attachEvent)c.attachEvent(nt(m.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return y}function G(){function c(y){return m.call(c.src,c.listener,y)}const m=hn;return c}function Ie(c,m,y,T,j){if(Array.isArray(m))for(var V=0;V<m.length;V++)Ie(c,m[V],y,T,j);else T=a(T)?!!T.capture:!!T,y=Fl(y),c&&c[$]?(c=c.i,V=String(m).toString(),V in c.g&&(m=c.g[V],y=Ee(m,y,T,j),y>-1&&(W(m[y]),Array.prototype.splice.call(m,y,1),m.length==0&&(delete c.g[V],c.h--)))):c&&(c=Tn(c))&&(m=c.g[m.toString()],c=-1,m&&(c=Ee(m,y,T,j)),(y=c>-1?m[c]:null)&&De(y))}function De(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[$])Ae(m.i,c);else{var y=c.type,T=c.proxy;m.removeEventListener?m.removeEventListener(y,T,c.capture):m.detachEvent?m.detachEvent(nt(y),T):m.addListener&&m.removeListener&&m.removeListener(T),(y=Tn(m))?(Ae(y,c),y.h==0&&(y.src=null,m[He]=null)):W(c)}}}function nt(c){return c in J?J[c]:J[c]="on"+c}function hn(c,m){if(c.da)c=!0;else{m=new se(m,this);const y=c.listener,T=c.ha||c.src;c.fa&&De(c),c=y.call(T,m)}return c}function Tn(c){return c=c[He],c instanceof he?c:null}var Sn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fl(c){return typeof c=="function"?c:(c[Sn]||(c[Sn]=function(m){return c.handleEvent(m)}),c[Sn])}function at(){b.call(this),this.i=new he(this),this.M=this,this.G=null}p(at,b),at.prototype[$]=!0,at.prototype.removeEventListener=function(c,m,y,T){Ie(this,c,m,y,T)};function ft(c,m){var y,T=c.G;if(T)for(y=[];T;T=T.G)y.push(T);if(c=c.M,T=m.type||m,typeof m=="string")m=new A(m,c);else if(m instanceof A)m.target=m.target||c;else{var j=m;m=new A(T,c),L(m,j)}j=!0;let V,X;if(y)for(X=y.length-1;X>=0;X--)V=m.g=y[X],j=vs(V,T,!0,m)&&j;if(V=m.g=c,j=vs(V,T,!0,m)&&j,j=vs(V,T,!1,m)&&j,y)for(X=0;X<y.length;X++)V=m.g=y[X],j=vs(V,T,!1,m)&&j}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var c=this.i;for(const m in c.g){const y=c.g[m];for(let T=0;T<y.length;T++)W(y[T]);delete c.g[m],c.h--}}this.G=null},at.prototype.J=function(c,m,y,T){return this.i.add(String(c),m,!1,y,T)},at.prototype.K=function(c,m,y,T){return this.i.add(String(c),m,!0,y,T)};function vs(c,m,y,T){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();let j=!0;for(let V=0;V<m.length;++V){const X=m[V];if(X&&!X.da&&X.capture==y){const ge=X.listener,lt=X.ha||X.src;X.fa&&Ae(c.i,X),j=ge.call(lt,T)!==!1&&j}}return j&&!T.defaultPrevented}function Kd(c,m){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(c,m||0)}function Ul(c){c.g=Kd(()=>{c.g=null,c.i&&(c.i=!1,Ul(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class Qd extends b{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Ul(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ri(c){b.call(this),this.h=c,this.g={}}p(Ri,b);var F=[];function Y(c){ee(c.g,function(m,y){this.g.hasOwnProperty(y)&&De(m)},c),c.g={}}Ri.prototype.N=function(){Ri.Z.N.call(this),Y(this)},Ri.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=o.JSON.stringify,_e=o.JSON.parse,Re=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Ht(){}function Hn(){}var Mt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function cr(){A.call(this,"d")}p(cr,A);function dr(){A.call(this,"c")}p(dr,A);var Ze={},pr=null;function $t(){return pr=pr||new at}Ze.Ia="serverreachability";function fy(c){A.call(this,Ze.Ia,c)}p(fy,A);function jo(c){const m=$t();ft(m,new fy(m))}Ze.STAT_EVENT="statevent";function my(c,m){A.call(this,Ze.STAT_EVENT,c),this.stat=m}p(my,A);function jt(c){const m=$t();ft(m,new my(m,c))}Ze.Ja="timingevent";function gy(c,m){A.call(this,Ze.Ja,c),this.size=m}p(gy,A);function Vo(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},m)}function Fo(){this.g=!0}Fo.prototype.ua=function(){this.g=!1};function IT(c,m,y,T,j,V){c.info(function(){if(c.g)if(V){var X="",ge=V.split("&");for(let Oe=0;Oe<ge.length;Oe++){var lt=ge[Oe].split("=");if(lt.length>1){const mt=lt[0];lt=lt[1];const Kn=mt.split("_");X=Kn.length>=2&&Kn[1]=="type"?X+(mt+"="+lt+"&"):X+(mt+"=redacted&")}}}else X=null;else X=V;return"XMLHTTP REQ ("+T+") [attempt "+j+"]: "+m+`
`+y+`
`+X})}function AT(c,m,y,T,j,V,X){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+j+"]: "+m+`
`+y+`
`+V+" "+X})}function bs(c,m,y,T){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+RT(c,y)+(T?" "+T:"")})}function PT(c,m){c.info(function(){return"TIMEOUT: "+m})}Fo.prototype.info=function(){};function RT(c,m){if(!c.g)return m;if(!m)return null;try{const V=JSON.parse(m);if(V){for(c=0;c<V.length;c++)if(Array.isArray(V[c])){var y=V[c];if(!(y.length<2)){var T=y[1];if(Array.isArray(T)&&!(T.length<1)){var j=T[0];if(j!="noop"&&j!="stop"&&j!="close")for(let X=1;X<T.length;X++)T[X]=""}}}}return ce(V)}catch{return m}}var ql={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yy={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_y;function Gd(){}p(Gd,Ht),Gd.prototype.g=function(){return new XMLHttpRequest},_y=new Gd;function Uo(c){return encodeURIComponent(String(c))}function NT(c){var m=1;c=c.split(":");const y=[];for(;m>0&&c.length;)y.push(c.shift()),m--;return c.length&&y.push(c.join(":")),y}function Dr(c,m,y,T){this.j=c,this.i=m,this.l=y,this.S=T||1,this.V=new Ri(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new xy}function xy(){this.i=null,this.g="",this.h=!1}var vy={},Yd={};function Xd(c,m,y){c.M=1,c.A=Wl($n(m)),c.u=y,c.R=!0,by(c,null)}function by(c,m){c.F=Date.now(),Bl(c),c.B=$n(c.A);var y=c.B,T=c.S;Array.isArray(T)||(T=[String(T)]),Dy(y.i,"t",T),c.C=0,y=c.j.L,c.h=new xy,c.g=Jy(c.j,y?m:null,!c.u),c.P>0&&(c.O=new Qd(u(c.Y,c,c.g),c.P)),m=c.V,y=c.g,T=c.ba;var j="readystatechange";Array.isArray(j)||(j&&(F[0]=j.toString()),j=F);for(let V=0;V<j.length;V++){const X=q(y,j[V],T||m.handleEvent,!1,m.h||m);if(!X)break;m.g[X.key]=X}m=c.J?Z(c.J):{},c.u?(c.v||(c.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,m)):(c.v="GET",c.g.ea(c.B,c.v,null,m)),jo(),IT(c.i,c.v,c.B,c.l,c.S,c.u)}Dr.prototype.ba=function(c){c=c.target;const m=this.O;m&&Mr(c)==3?m.j():this.Y(c)},Dr.prototype.Y=function(c){try{if(c==this.g)e:{const ge=Mr(this.g),lt=this.g.ya(),Oe=this.g.ca();if(!(ge<3)&&(ge!=3||this.g&&(this.h.h||this.g.la()||Uy(this.g)))){this.K||ge!=4||lt==7||(lt==8||Oe<=0?jo(3):jo(2)),Jd(this);var m=this.g.ca();this.X=m;var y=LT(this);if(this.o=m==200,AT(this.i,this.v,this.B,this.l,this.S,ge,m),this.o){if(this.U&&!this.L){t:{if(this.g){var T,j=this.g;if((T=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(T)){var V=T;break t}}V=null}if(c=V)bs(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Zd(this,c);else{this.o=!1,this.m=3,jt(12),Ni(this),qo(this);break e}}if(this.R){c=!0;let mt;for(;!this.K&&this.C<y.length;)if(mt=DT(this,y),mt==Yd){ge==4&&(this.m=4,jt(14),c=!1),bs(this.i,this.l,null,"[Incomplete Response]");break}else if(mt==vy){this.m=4,jt(15),bs(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else bs(this.i,this.l,mt,null),Zd(this,mt);if(wy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ge!=4||y.length!=0||this.h.h||(this.m=1,jt(16),c=!1),this.o=this.o&&c,!c)bs(this.i,this.l,y,"[Invalid Chunked Response]"),Ni(this),qo(this);else if(y.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),ap(X),X.P=!0,jt(11))}}else bs(this.i,this.l,y,null),Zd(this,y);ge==4&&Ni(this),this.o&&!this.K&&(ge==4?Qy(this.j,this):(this.o=!1,Bl(this)))}else QT(this.g),m==400&&y.indexOf("Unknown SID")>0?(this.m=3,jt(12)):(this.m=0,jt(13)),Ni(this),qo(this)}}}catch{}finally{}};function LT(c){if(!wy(c))return c.g.la();const m=Uy(c.g);if(m==="")return"";let y="";const T=m.length,j=Mr(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Ni(c),qo(c),"";c.h.i=new o.TextDecoder}for(let V=0;V<T;V++)c.h.h=!0,y+=c.h.i.decode(m[V],{stream:!(j&&V==T-1)});return m.length=0,c.h.g+=y,c.C=0,c.h.g}function wy(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function DT(c,m){var y=c.C,T=m.indexOf(`
`,y);return T==-1?Yd:(y=Number(m.substring(y,T)),isNaN(y)?vy:(T+=1,T+y>m.length?Yd:(m=m.slice(T,T+y),c.C=T+y,m)))}Dr.prototype.cancel=function(){this.K=!0,Ni(this)};function Bl(c){c.T=Date.now()+c.H,ky(c,c.H)}function ky(c,m){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Vo(u(c.aa,c),m)}function Jd(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Dr.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(PT(this.i,this.B),this.M!=2&&(jo(),jt(17)),Ni(this),this.m=2,qo(this)):ky(this,this.T-c)};function qo(c){c.j.I==0||c.K||Qy(c.j,c)}function Ni(c){Jd(c);var m=c.O;m&&typeof m.dispose=="function"&&m.dispose(),c.O=null,Y(c.V),c.g&&(m=c.g,c.g=null,m.abort(),m.dispose())}function Zd(c,m){try{var y=c.j;if(y.I!=0&&(y.g==c||ep(y.h,c))){if(!c.L&&ep(y.h,c)&&y.I==3){try{var T=y.Ba.g.parse(m)}catch{T=null}if(Array.isArray(T)&&T.length==3){var j=T;if(j[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)Gl(y),Kl(y);else break e;op(y),jt(18)}}else y.xa=j[1],0<y.xa-y.K&&j[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Vo(u(y.Va,y),6e3));Sy(y.h)<=1&&y.ta&&(y.ta=void 0)}else Di(y,11)}else if((c.L||y.g==c)&&Gl(y),!P(m))for(j=y.Ba.g.parse(m),m=0;m<j.length;m++){let Oe=j[m];const mt=Oe[0];if(!(mt<=y.K))if(y.K=mt,Oe=Oe[1],y.I==2)if(Oe[0]=="c"){y.M=Oe[1],y.ba=Oe[2];const Kn=Oe[3];Kn!=null&&(y.ka=Kn,y.j.info("VER="+y.ka));const Oi=Oe[4];Oi!=null&&(y.za=Oi,y.j.info("SVER="+y.za));const jr=Oe[5];jr!=null&&typeof jr=="number"&&jr>0&&(T=1.5*jr,y.O=T,y.j.info("backChannelRequestTimeoutMs_="+T)),T=y;const Vr=c.g;if(Vr){const Xl=Vr.g?Vr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xl){var V=T.h;V.g||Xl.indexOf("spdy")==-1&&Xl.indexOf("quic")==-1&&Xl.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(tp(V,V.h),V.h=null))}if(T.G){const lp=Vr.g?Vr.g.getResponseHeader("X-HTTP-Session-Id"):null;lp&&(T.wa=lp,Ve(T.J,T.G,lp))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),T=y;var X=c;if(T.na=Xy(T,T.L?T.ba:null,T.W),X.L){Cy(T.h,X);var ge=X,lt=T.O;lt&&(ge.H=lt),ge.D&&(Jd(ge),Bl(ge)),T.g=X}else $y(T);y.i.length>0&&Ql(y)}else Oe[0]!="stop"&&Oe[0]!="close"||Di(y,7);else y.I==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Di(y,7):sp(y):Oe[0]!="noop"&&y.l&&y.l.qa(Oe),y.A=0)}}jo(4)}catch{}}var OT=class{constructor(c,m){this.g=c,this.map=m}};function Ey(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ty(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Sy(c){return c.h?1:c.g?c.g.size:0}function ep(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function tp(c,m){c.g?c.g.add(m):c.h=m}function Cy(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Ey.prototype.cancel=function(){if(this.i=Iy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Iy(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const y of c.g.values())m=m.concat(y.G);return m}return g(c.i)}var Ay=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zT(c,m){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const T=c[y].indexOf("=");let j,V=null;T>=0?(j=c[y].substring(0,T),V=c[y].substring(T+1)):j=c[y],m(j,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Or(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;c instanceof Or?(this.l=c.l,Bo(this,c.j),this.o=c.o,this.g=c.g,Wo(this,c.u),this.h=c.h,np(this,Oy(c.i)),this.m=c.m):c&&(m=String(c).match(Ay))?(this.l=!1,Bo(this,m[1]||"",!0),this.o=Ho(m[2]||""),this.g=Ho(m[3]||"",!0),Wo(this,m[4]),this.h=Ho(m[5]||"",!0),np(this,m[6]||"",!0),this.m=Ho(m[7]||"")):(this.l=!1,this.i=new Ko(null,this.l))}Or.prototype.toString=function(){const c=[];var m=this.j;m&&c.push($o(m,Py,!0),":");var y=this.g;return(y||m=="file")&&(c.push("//"),(m=this.o)&&c.push($o(m,Py,!0),"@"),c.push(Uo(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push($o(y,y.charAt(0)=="/"?VT:jT,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",$o(y,UT)),c.join("")},Or.prototype.resolve=function(c){const m=$n(this);let y=!!c.j;y?Bo(m,c.j):y=!!c.o,y?m.o=c.o:y=!!c.g,y?m.g=c.g:y=c.u!=null;var T=c.h;if(y)Wo(m,c.u);else if(y=!!c.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var j=m.h.lastIndexOf("/");j!=-1&&(T=m.h.slice(0,j+1)+T)}if(j=T,j==".."||j==".")T="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){T=j.lastIndexOf("/",0)==0,j=j.split("/");const V=[];for(let X=0;X<j.length;){const ge=j[X++];ge=="."?T&&X==j.length&&V.push(""):ge==".."?((V.length>1||V.length==1&&V[0]!="")&&V.pop(),T&&X==j.length&&V.push("")):(V.push(ge),T=!0)}T=V.join("/")}else T=j}return y?m.h=T:y=c.i.toString()!=="",y?np(m,Oy(c.i)):y=!!c.m,y&&(m.m=c.m),m};function $n(c){return new Or(c)}function Bo(c,m,y){c.j=y?Ho(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function Wo(c,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);c.u=m}else c.u=null}function np(c,m,y){m instanceof Ko?(c.i=m,qT(c.i,c.l)):(y||(m=$o(m,FT)),c.i=new Ko(m,c.l))}function Ve(c,m,y){c.i.set(m,y)}function Wl(c){return Ve(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Ho(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function $o(c,m,y){return typeof c=="string"?(c=encodeURI(c).replace(m,MT),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function MT(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Py=/[#\/\?@]/g,jT=/[#\?:]/g,VT=/[#\?]/g,FT=/[#\?@]/g,UT=/#/g;function Ko(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function Li(c){c.g||(c.g=new Map,c.h=0,c.i&&zT(c.i,function(m,y){c.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}t=Ko.prototype,t.add=function(c,m){Li(this),this.i=null,c=ws(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(m),this.h+=1,this};function Ry(c,m){Li(c),m=ws(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function Ny(c,m){return Li(c),m=ws(c,m),c.g.has(m)}t.forEach=function(c,m){Li(this),this.g.forEach(function(y,T){y.forEach(function(j){c.call(m,j,T,this)},this)},this)};function Ly(c,m){Li(c);let y=[];if(typeof m=="string")Ny(c,m)&&(y=y.concat(c.g.get(ws(c,m))));else for(c=Array.from(c.g.values()),m=0;m<c.length;m++)y=y.concat(c[m]);return y}t.set=function(c,m){return Li(this),this.i=null,c=ws(this,c),Ny(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},t.get=function(c,m){return c?(c=Ly(this,c),c.length>0?String(c[0]):m):m};function Dy(c,m,y){Ry(c,m),y.length>0&&(c.i=null,c.g.set(ws(c,m),g(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(let T=0;T<m.length;T++){var y=m[T];const j=Uo(y);y=Ly(this,y);for(let V=0;V<y.length;V++){let X=j;y[V]!==""&&(X+="="+Uo(y[V])),c.push(X)}}return this.i=c.join("&")};function Oy(c){const m=new Ko;return m.i=c.i,c.g&&(m.g=new Map(c.g),m.h=c.h),m}function ws(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function qT(c,m){m&&!c.j&&(Li(c),c.i=null,c.g.forEach(function(y,T){const j=T.toLowerCase();T!=j&&(Ry(this,T),Dy(this,j,y))},c)),c.j=m}function BT(c,m){const y=new Fo;if(o.Image){const T=new Image;T.onload=d(zr,y,"TestLoadImage: loaded",!0,m,T),T.onerror=d(zr,y,"TestLoadImage: error",!1,m,T),T.onabort=d(zr,y,"TestLoadImage: abort",!1,m,T),T.ontimeout=d(zr,y,"TestLoadImage: timeout",!1,m,T),o.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else m(!1)}function WT(c,m){const y=new Fo,T=new AbortController,j=setTimeout(()=>{T.abort(),zr(y,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:T.signal}).then(V=>{clearTimeout(j),V.ok?zr(y,"TestPingServer: ok",!0,m):zr(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(j),zr(y,"TestPingServer: error",!1,m)})}function zr(c,m,y,T,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),T(y)}catch{}}function HT(){this.g=new Re}function rp(c){this.i=c.Sb||null,this.h=c.ab||!1}p(rp,Ht),rp.prototype.g=function(){return new Hl(this.i,this.h)};function Hl(c,m){at.call(this),this.H=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Hl,at),t=Hl.prototype,t.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=m,this.readyState=1,Go(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(m.body=c),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Qo(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Go(this)),this.g&&(this.readyState=3,Go(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;zy(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function zy(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?Qo(this):Go(this),this.readyState==3&&zy(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Qo(this))},t.Na=function(c){this.g&&(this.response=c,Qo(this))},t.ga=function(){this.g&&Qo(this)};function Qo(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Go(c)}t.setRequestHeader=function(c,m){this.A.append(c,m)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=m.next();return c.join(`\r
`)};function Go(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function My(c){let m="";return ee(c,function(y,T){m+=T,m+=":",m+=y,m+=`\r
`}),m}function ip(c,m,y){e:{for(T in y){var T=!1;break e}T=!0}T||(y=My(y),typeof c=="string"?y!=null&&Uo(y):Ve(c,m,y))}function Ye(c){at.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ye,at);var $T=/^https?$/i,KT=["POST","PUT"];t=Ye.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,m,y,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_y.g(),this.g.onreadystatechange=f(u(this.Ca,this));try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(V){jy(this,V);return}if(c=y||"",y=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var j in T)y.set(j,T[j]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const V of T.keys())y.set(V,T.get(V));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(y.keys()).find(V=>V.toLowerCase()=="content-type"),j=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(KT,m,void 0)>=0)||T||j||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,X]of y)this.g.setRequestHeader(V,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(V){jy(this,V)}};function jy(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.o=5,Vy(c),$l(c)}function Vy(c){c.A||(c.A=!0,ft(c,"complete"),ft(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ft(this,"complete"),ft(this,"abort"),$l(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$l(this,!0)),Ye.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Fy(this):this.Xa())},t.Xa=function(){Fy(this)};function Fy(c){if(c.h&&typeof s<"u"){if(c.v&&Mr(c)==4)setTimeout(c.Ca.bind(c),0);else if(ft(c,"readystatechange"),Mr(c)==4){c.h=!1;try{const V=c.ca();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var T;if(T=V===0){let X=String(c.D).match(Ay)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),T=!$T.test(X?X.toLowerCase():"")}y=T}if(y)ft(c,"complete"),ft(c,"success");else{c.o=6;try{var j=Mr(c)>2?c.g.statusText:""}catch{j=""}c.l=j+" ["+c.ca()+"]",Vy(c)}}finally{$l(c)}}}}function $l(c,m){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,m||ft(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Mr(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Mr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),_e(m)}};function Uy(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function QT(c){const m={};c=(c.g&&Mr(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(P(c[T]))continue;var y=NT(c[T]);const j=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const V=m[j]||[];m[j]=V,V.push(y)}R(m,function(T){return T.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yo(c,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||m}function qy(c){this.za=0,this.i=[],this.j=new Fo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yo("baseRetryDelayMs",5e3,c),this.Za=Yo("retryDelaySeedMs",1e4,c),this.Ta=Yo("forwardChannelMaxRetries",2,c),this.va=Yo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new Ey(c&&c.concurrentRequestLimit),this.Ba=new HT,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=qy.prototype,t.ka=8,t.I=1,t.connect=function(c,m,y,T){jt(0),this.W=c,this.H=m||{},y&&T!==void 0&&(this.H.OSID=y,this.H.OAID=T),this.F=this.X,this.J=Xy(this,null,this.W),Ql(this)};function sp(c){if(By(c),c.I==3){var m=c.V++,y=$n(c.J);if(Ve(y,"SID",c.M),Ve(y,"RID",m),Ve(y,"TYPE","terminate"),Xo(c,y),m=new Dr(c,c.j,m),m.M=2,m.A=Wl($n(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=m.A,y=!0),y||(m.g=Jy(m.j,null),m.g.ea(m.A)),m.F=Date.now(),Bl(m)}Yy(c)}function Kl(c){c.g&&(ap(c),c.g.cancel(),c.g=null)}function By(c){Kl(c),c.v&&(o.clearTimeout(c.v),c.v=null),Gl(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Ql(c){if(!Ty(c.h)&&!c.m){c.m=!0;var m=c.Ea;O||E(),D||(O(),D=!0),S.add(m,c),c.D=0}}function GT(c,m){return Sy(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=m.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Vo(u(c.Ea,c,m),Gy(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const j=new Dr(this,this.j,c);let V=this.o;if(this.U&&(V?(V=Z(V),L(V,this.U)):V=this.U),this.u!==null||this.R||(j.J=V,V=null),this.S)e:{for(var m=0,y=0;y<this.i.length;y++){t:{var T=this.i[y];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(m+=T,m>4096){m=y;break e}if(m===4096||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=Hy(this,j,m),y=$n(this.J),Ve(y,"RID",c),Ve(y,"CVER",22),this.G&&Ve(y,"X-HTTP-Session-Id",this.G),Xo(this,y),V&&(this.R?m="headers="+Uo(My(V))+"&"+m:this.u&&ip(y,this.u,V)),tp(this.h,j),this.Ra&&Ve(y,"TYPE","init"),this.S?(Ve(y,"$req",m),Ve(y,"SID","null"),j.U=!0,Xd(j,y,null)):Xd(j,y,m),this.I=2}}else this.I==3&&(c?Wy(this,c):this.i.length==0||Ty(this.h)||Wy(this))};function Wy(c,m){var y;m?y=m.l:y=c.V++;const T=$n(c.J);Ve(T,"SID",c.M),Ve(T,"RID",y),Ve(T,"AID",c.K),Xo(c,T),c.u&&c.o&&ip(T,c.u,c.o),y=new Dr(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),m&&(c.i=m.G.concat(c.i)),m=Hy(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),tp(c.h,y),Xd(y,T,m)}function Xo(c,m){c.H&&ee(c.H,function(y,T){Ve(m,T,y)}),c.l&&ee({},function(y,T){Ve(m,T,y)})}function Hy(c,m,y){y=Math.min(c.i.length,y);const T=c.l?u(c.l.Ka,c.l,c):null;e:{var j=c.i;let ge=-1;for(;;){const lt=["count="+y];ge==-1?y>0?(ge=j[0].g,lt.push("ofs="+ge)):ge=0:lt.push("ofs="+ge);let Oe=!0;for(let mt=0;mt<y;mt++){var V=j[mt].g;const Kn=j[mt].map;if(V-=ge,V<0)ge=Math.max(0,j[mt].g-100),Oe=!1;else try{V="req"+V+"_"||"";try{var X=Kn instanceof Map?Kn:Object.entries(Kn);for(const[Oi,jr]of X){let Vr=jr;a(jr)&&(Vr=ce(jr)),lt.push(V+Oi+"="+encodeURIComponent(Vr))}}catch(Oi){throw lt.push(V+"type="+encodeURIComponent("_badmap")),Oi}}catch{T&&T(Kn)}}if(Oe){X=lt.join("&");break e}}X=void 0}return c=c.i.splice(0,y),m.G=c,X}function $y(c){if(!c.g&&!c.v){c.Y=1;var m=c.Da;O||E(),D||(O(),D=!0),S.add(m,c),c.A=0}}function op(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Vo(u(c.Da,c),Gy(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Ky(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Vo(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,jt(10),Kl(this),Ky(this))};function ap(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Ky(c){c.g=new Dr(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var m=$n(c.na);Ve(m,"RID","rpc"),Ve(m,"SID",c.M),Ve(m,"AID",c.K),Ve(m,"CI",c.F?"0":"1"),!c.F&&c.ia&&Ve(m,"TO",c.ia),Ve(m,"TYPE","xmlhttp"),Xo(c,m),c.u&&c.o&&ip(m,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=Wl($n(m)),y.u=null,y.R=!0,by(y,c)}t.Va=function(){this.C!=null&&(this.C=null,Kl(this),op(this),jt(19))};function Gl(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Qy(c,m){var y=null;if(c.g==m){Gl(c),ap(c),c.g=null;var T=2}else if(ep(c.h,m))y=m.G,Cy(c.h,m),T=1;else return;if(c.I!=0){if(m.o)if(T==1){y=m.u?m.u.length:0,m=Date.now()-m.F;var j=c.D;T=$t(),ft(T,new gy(T,y)),Ql(c)}else $y(c);else if(j=m.m,j==3||j==0&&m.X>0||!(T==1&&GT(c,m)||T==2&&op(c)))switch(y&&y.length>0&&(m=c.h,m.i=m.i.concat(y)),j){case 1:Di(c,5);break;case 4:Di(c,10);break;case 3:Di(c,6);break;default:Di(c,2)}}}function Gy(c,m){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*m}function Di(c,m){if(c.j.info("Error code "+m),m==2){var y=u(c.bb,c),T=c.Ua;const j=!T;T=new Or(T||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Bo(T,"https"),Wl(T),j?BT(T.toString(),y):WT(T.toString(),y)}else jt(2);c.I=0,c.l&&c.l.pa(m),Yy(c),By(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function Yy(c){if(c.I=0,c.ja=[],c.l){const m=Iy(c.h);(m.length!=0||c.i.length!=0)&&(_(c.ja,m),_(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function Xy(c,m,y){var T=y instanceof Or?$n(y):new Or(y);if(T.g!="")m&&(T.g=m+"."+T.g),Wo(T,T.u);else{var j=o.location;T=j.protocol,m=m?m+"."+j.hostname:j.hostname,j=+j.port;const V=new Or(null);T&&Bo(V,T),m&&(V.g=m),j&&Wo(V,j),y&&(V.h=y),T=V}return y=c.G,m=c.wa,y&&m&&Ve(T,y,m),Ve(T,"VER",c.ka),Xo(c,T),T}function Jy(c,m,y){if(m&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Aa&&!c.ma?new Ye(new rp({ab:y})):new Ye(c.ma),m.Fa(c.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zy(){}t=Zy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Yl(){}Yl.prototype.g=function(c,m){return new tn(c,m)};function tn(c,m){at.call(this),this.g=new qy(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(c?c["X-WebChannel-Client-Profile"]=m.sa:c={"X-WebChannel-Client-Profile":m.sa}),this.g.U=c,(c=m&&m.Qb)&&!P(c)&&(this.g.u=c),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!P(m)&&(this.g.G=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new ks(this)}p(tn,at),tn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tn.prototype.close=function(){sp(this.g)},tn.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=ce(c),c=y);m.i.push(new OT(m.Ya++,c)),m.I==3&&Ql(m)},tn.prototype.N=function(){this.g.l=null,delete this.j,sp(this.g),delete this.g,tn.Z.N.call(this)};function e_(c){cr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){e:{for(const y in m){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}p(e_,cr);function t_(){dr.call(this),this.status=1}p(t_,dr);function ks(c){this.g=c}p(ks,Zy),ks.prototype.ra=function(){ft(this.g,"a")},ks.prototype.qa=function(c){ft(this.g,new e_(c))},ks.prototype.pa=function(c){ft(this.g,new t_)},ks.prototype.oa=function(){ft(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,tn.prototype.send=tn.prototype.o,tn.prototype.open=tn.prototype.m,tn.prototype.close=tn.prototype.close,Nk=function(){return new Yl},Rk=function(){return $t()},Pk=Ze,Rf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ql.NO_ERROR=0,ql.TIMEOUT=8,ql.HTTP_ERROR=6,Qu=ql,yy.COMPLETE="complete",Ak=yy,Hn.EventType=Mt,Mt.OPEN="a",Mt.CLOSE="b",Mt.ERROR="c",Mt.MESSAGE="d",at.prototype.listen=at.prototype.J,ga=Hn,Ye.prototype.listenOnce=Ye.prototype.K,Ye.prototype.getLastError=Ye.prototype.Ha,Ye.prototype.getLastErrorCode=Ye.prototype.ya,Ye.prototype.getStatus=Ye.prototype.ca,Ye.prototype.getResponseJson=Ye.prototype.La,Ye.prototype.getResponseText=Ye.prototype.la,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Fa,Ik=Ye}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pt.UNAUTHENTICATED=new Pt(null),Pt.GOOGLE_CREDENTIALS=new Pt("google-credentials-uid"),Pt.FIRST_PARTY=new Pt("first-party-uid"),Pt.MOCK_USER=new Pt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro="12.9.0";function $4(t){Ro=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as=new rg("@firebase/firestore");function Cs(){return as.logLevel}function te(t,...e){if(as.logLevel<=be.DEBUG){const n=e.map(gg);as.debug(`Firestore (${Ro}): ${t}`,...n)}}function Ar(t,...e){if(as.logLevel<=be.ERROR){const n=e.map(gg);as.error(`Firestore (${Ro}): ${t}`,...n)}}function ls(t,...e){if(as.logLevel<=be.WARN){const n=e.map(gg);as.warn(`Firestore (${Ro}): ${t}`,...n)}}function gg(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Lk(t,r,n)}function Lk(t,e,n){let r=`FIRESTORE (${Ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ar(r),new Error(r)}function Pe(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Lk(e,i,r)}function fe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Nr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Pt.UNAUTHENTICATED))}shutdown(){}}class Q4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class G4{constructor(e){this.t=e,this.currentUser=Pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Pe(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new fi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new fi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe(typeof r.accessToken=="string",31837,{l:r}),new Dk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new Pt(e)}}class Y4{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Pt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class X4{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Y4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Z0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,On(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Pe(this.o===void 0,3512);const r=s=>{s.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Z0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Z0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Z4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function Nf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return $p(i)===$p(s)?we(i,s):$p(i)?1:-1}return we(t.length,e.length)}const eL=55296,tL=57343;function $p(t){const e=t.charCodeAt(0);return e>=eL&&e<=tL}function yo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="__name__";class Xn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ue(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Xn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Xn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Xn.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return we(e.length,n.length)}static compareSegments(e,n){const r=Xn.isNumericId(e),i=Xn.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Xn.extractNumericId(e).compare(Xn.extractNumericId(n)):Nf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hi.fromString(e.substring(4,e.length-2))}}class Ue extends Xn{construct(e,n,r){return new Ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ue(n)}static emptyPath(){return new Ue([])}}const nL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends Xn{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return nL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ex}static keyField(){return new wt([ex])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ie(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ie(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ie(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ie(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe(Ue.fromString(e))}static fromName(e){return new oe(Ue.fromString(e).popFirst(5))}static empty(){return new oe(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new Ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t,e,n){if(!n)throw new ie(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function rL(t,e,n,r){if(e===!0&&r===!0)throw new ie(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function tx(t){if(!oe.isDocumentKey(t))throw new ie(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function nx(t){if(oe.isDocumentKey(t))throw new ie(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zk(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _g(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function _o(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ie(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_g(t);throw new ie(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t,e){const n={typeString:t};return e&&(n.value=e),n}function Pl(t,e){if(!zk(t))throw new ie(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new ie(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx=-62135596800,ix=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ix);return new qe(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ie(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ie(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<rx)throw new ie(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ix}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pl(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-rx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:ot("string",qe._jsonSchemaVersion),seconds:ot("number"),nanoseconds:ot("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new qe(0,0))}static max(){return new pe(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll=-1;function iL(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=pe.fromTimestamp(r===1e9?new qe(n+1,0):new qe(n,r));return new xi(i,oe.empty(),e)}function sL(t){return new xi(t.readTime,t.key,ll)}class xi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new xi(pe.min(),oe.empty(),ll)}static max(){return new xi(pe.max(),oe.empty(),ll)}}function oL(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==aL)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(i=>i?U.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new U((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new U((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function uL(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Lo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Td.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg=-1;function Sd(t){return t==null}function Vc(t){return t===0&&1/t==-1/0}function cL(t){return typeof t=="number"&&Number.isInteger(t)&&!Vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk="";function dL(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=sx(e)),e=pL(t.get(n),e);return sx(e)}function pL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Mk:n+="";break;default:n+=s}}return n}function sx(t){return t+Mk+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ms(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n){this.comparator=e,this.root=n||bt.EMPTY}insert(e,n){return new Ge(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(e){return new Ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _u(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _u(this.root,e,this.comparator,!1)}getReverseIterator(){return new _u(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _u(this.root,e,this.comparator,!0)}}class _u{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??bt.RED,this.left=i??bt.EMPTY,this.right=s??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new bt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return bt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new bt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.comparator=e,this.data=new Ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ax(this.data.getIterator())}getIteratorFrom(e){return new ax(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ht(this.comparator);return n.data=e,n}}class ax{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new jn([])}unionWith(e){let n=new ht(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new jn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vk("Invalid base64 string: "+s):s}}(e);return new Tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const hL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(t){if(Pe(!!t,39018),typeof t=="string"){let e=0;const n=hL.exec(t);if(Pe(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bi(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk="server_timestamp",Uk="__type__",qk="__previous_value__",Bk="__local_write_time__";function vg(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Uk])==null?void 0:r.stringValue)===Fk}function Cd(t){const e=t.mapValue.fields[qk];return vg(e)?Cd(e):e}function ul(t){const e=vi(t.mapValue.fields[Bk].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,n,r,i,s,o,a,l,u,d,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d,this.apiKey=p}}const Fc="(default)";class cl{constructor(e,n){this.projectId=e,this.database=n||Fc}static empty(){return new cl("","")}get isDefaultDatabase(){return this.database===Fc}isEqual(e){return e instanceof cl&&e.projectId===this.projectId&&e.database===this.database}}function mL(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ie(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cl(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="__type__",gL="__max__",xu={mapValue:{}},Hk="__vector__",Uc="value";function wi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vg(t)?4:_L(t)?9007199254740991:yL(t)?10:11:ue(28295,{value:t})}function ar(t,e){if(t===e)return!0;const n=wi(t);if(n!==wi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ul(t).isEqual(ul(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=vi(i.timestampValue),a=vi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return bi(i.bytesValue).isEqual(bi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return et(i.geoPointValue.latitude)===et(s.geoPointValue.latitude)&&et(i.geoPointValue.longitude)===et(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return et(i.integerValue)===et(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=et(i.doubleValue),a=et(s.doubleValue);return o===a?Vc(o)===Vc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return yo(t.arrayValue.values||[],e.arrayValue.values||[],ar);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ox(o)!==ox(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ar(o[l],a[l])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function dl(t,e){return(t.values||[]).find(n=>ar(n,e))!==void 0}function xo(t,e){if(t===e)return 0;const n=wi(t),r=wi(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=et(s.integerValue||s.doubleValue),l=et(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return lx(t.timestampValue,e.timestampValue);case 4:return lx(ul(t),ul(e));case 5:return Nf(t.stringValue,e.stringValue);case 6:return function(s,o){const a=bi(s),l=bi(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=we(a[u],l[u]);if(d!==0)return d}return we(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=we(et(s.latitude),et(o.latitude));return a!==0?a:we(et(s.longitude),et(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ux(t.arrayValue,e.arrayValue);case 10:return function(s,o){var f,g,_,k;const a=s.fields||{},l=o.fields||{},u=(f=a[Uc])==null?void 0:f.arrayValue,d=(g=l[Uc])==null?void 0:g.arrayValue,p=we(((_=u==null?void 0:u.values)==null?void 0:_.length)||0,((k=d==null?void 0:d.values)==null?void 0:k.length)||0);return p!==0?p:ux(u,d)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===xu.mapValue&&o===xu.mapValue)return 0;if(s===xu.mapValue)return 1;if(o===xu.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const f=Nf(l[p],d[p]);if(f!==0)return f;const g=xo(a[l[p]],u[d[p]]);if(g!==0)return g}return we(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:n})}}function lx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=vi(t),r=vi(e),i=we(n.seconds,r.seconds);return i!==0?i:we(n.nanos,r.nanos)}function ux(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=xo(n[i],r[i]);if(s)return s}return we(n.length,r.length)}function vo(t){return Lf(t)}function Lf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=vi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Lf(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Lf(n.fields[o])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function Gu(t){switch(wi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cd(t);return e?16+Gu(e):16;case 5:return 2*t.stringValue.length;case 6:return bi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Gu(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ms(r.fields,(s,o)=>{i+=s.length+Gu(o)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function Df(t){return!!t&&"integerValue"in t}function bg(t){return!!t&&"arrayValue"in t}function cx(t){return!!t&&"nullValue"in t}function dx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yu(t){return!!t&&"mapValue"in t}function yL(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Wk])==null?void 0:r.stringValue)===Hk}function Na(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ms(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Na(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Na(t.arrayValue.values[n]);return e}return{...t}}function _L(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===gL}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Yu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Na(n)}setAll(e){let n=wt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Na(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Yu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ar(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Yu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ms(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new xn(Na(this.value))}}function $k(t){const e=[];return ms(t.fields,(n,r)=>{const i=new wt([n]);if(Yu(r)){const s=$k(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new jn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Nt(e,0,pe.min(),pe.min(),pe.min(),xn.empty(),0)}static newFoundDocument(e,n,r,i){return new Nt(e,1,n,pe.min(),r,i,0)}static newNoDocument(e,n){return new Nt(e,2,n,pe.min(),pe.min(),xn.empty(),0)}static newUnknownDocument(e,n){return new Nt(e,3,n,pe.min(),pe.min(),xn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n){this.position=e,this.inclusive=n}}function px(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=xo(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function hx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ar(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,n="asc"){this.field=e,this.dir=n}}function xL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{}class ct extends Kk{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new bL(e,n,r):n==="array-contains"?new EL(e,r):n==="in"?new TL(e,r):n==="not-in"?new SL(e,r):n==="array-contains-any"?new CL(e,r):new ct(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new wL(e,r):new kL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(xo(n,this.value)):n!==null&&wi(this.value)===wi(n)&&this.matchesComparison(xo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class lr extends Kk{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new lr(e,n)}matches(e){return Qk(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Qk(t){return t.op==="and"}function Gk(t){return vL(t)&&Qk(t)}function vL(t){for(const e of t.filters)if(e instanceof lr)return!1;return!0}function Of(t){if(t instanceof ct)return t.field.canonicalString()+t.op.toString()+vo(t.value);if(Gk(t))return t.filters.map(e=>Of(e)).join(",");{const e=t.filters.map(n=>Of(n)).join(",");return`${t.op}(${e})`}}function Yk(t,e){return t instanceof ct?function(r,i){return i instanceof ct&&r.op===i.op&&r.field.isEqual(i.field)&&ar(r.value,i.value)}(t,e):t instanceof lr?function(r,i){return i instanceof lr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Yk(o,i.filters[a]),!0):!1}(t,e):void ue(19439)}function Xk(t){return t instanceof ct?function(n){return`${n.field.canonicalString()} ${n.op} ${vo(n.value)}`}(t):t instanceof lr?function(n){return n.op.toString()+" {"+n.getFilters().map(Xk).join(" ,")+"}"}(t):"Filter"}class bL extends ct{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class wL extends ct{constructor(e,n){super(e,"in",n),this.keys=Jk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class kL extends ct{constructor(e,n){super(e,"not-in",n),this.keys=Jk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Jk(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class EL extends ct{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return bg(n)&&dl(n.arrayValue,this.value)}}class TL extends ct{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&dl(this.value.arrayValue,n)}}class SL extends ct{constructor(e,n){super(e,"not-in",n)}matches(e){if(dl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!dl(this.value.arrayValue,n)}}class CL extends ct{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!bg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>dl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function fx(t,e=null,n=[],r=[],i=null,s=null,o=null){return new IL(t,e,n,r,i,s,o)}function wg(t){const e=fe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Of(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Sd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>vo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>vo(r)).join(",")),e.Te=n}return e.Te}function kg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!xL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Yk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hx(t.startAt,e.startAt)&&hx(t.endAt,e.endAt)}function zf(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function AL(t,e,n,r,i,s,o,a){return new Id(t,e,n,r,i,s,o,a)}function Eg(t){return new Id(t)}function mx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function PL(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function RL(t){return t.collectionGroup!==null}function La(t){const e=fe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ht(wt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Bc(s,r))}),n.has(wt.keyField().canonicalString())||e.Ie.push(new Bc(wt.keyField(),r))}return e.Ie}function nr(t){const e=fe(t);return e.Ee||(e.Ee=NL(e,La(t))),e.Ee}function NL(t,e){if(t.limitType==="F")return fx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Bc(i.field,s)});const n=t.endAt?new qc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qc(t.startAt.position,t.startAt.inclusive):null;return fx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Mf(t,e,n){return new Id(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ad(t,e){return kg(nr(t),nr(e))&&t.limitType===e.limitType}function Zk(t){return`${wg(nr(t))}|lt:${t.limitType}`}function Is(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Xk(i)).join(", ")}]`),Sd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>vo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>vo(i)).join(",")),`Target(${r})`}(nr(t))}; limitType=${t.limitType})`}function Pd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):oe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of La(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=px(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,La(r),i)||r.endAt&&!function(o,a,l){const u=px(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,La(r),i))}(t,e)}function LL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function eE(t){return(e,n)=>{let r=!1;for(const i of La(t)){const s=DL(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function DL(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?xo(l,u):ue(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ms(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return jk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL=new Ge(oe.comparator);function Pr(){return OL}const tE=new Ge(oe.comparator);function ya(...t){let e=tE;for(const n of t)e=e.insert(n.key,n);return e}function nE(t){let e=tE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ki(){return Da()}function rE(){return Da()}function Da(){return new gs(t=>t.toString(),(t,e)=>t.isEqual(e))}const zL=new Ge(oe.comparator),ML=new ht(oe.comparator);function ke(...t){let e=ML;for(const n of t)e=e.add(n);return e}const jL=new ht(we);function VL(){return jL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vc(e)?"-0":e}}function iE(t){return{integerValue:""+t}}function FL(t,e){return cL(e)?iE(e):Tg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(){this._=void 0}}function UL(t,e,n){return t instanceof Wc?function(i,s){const o={fields:{[Uk]:{stringValue:Fk},[Bk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&vg(s)&&(s=Cd(s)),s&&(o.fields[qk]=s),{mapValue:o}}(n,e):t instanceof pl?oE(t,e):t instanceof hl?aE(t,e):function(i,s){const o=sE(i,s),a=gx(o)+gx(i.Ae);return Df(o)&&Df(i.Ae)?iE(a):Tg(i.serializer,a)}(t,e)}function qL(t,e,n){return t instanceof pl?oE(t,e):t instanceof hl?aE(t,e):n}function sE(t,e){return t instanceof Hc?function(r){return Df(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Wc extends Rd{}class pl extends Rd{constructor(e){super(),this.elements=e}}function oE(t,e){const n=lE(e);for(const r of t.elements)n.some(i=>ar(i,r))||n.push(r);return{arrayValue:{values:n}}}class hl extends Rd{constructor(e){super(),this.elements=e}}function aE(t,e){let n=lE(e);for(const r of t.elements)n=n.filter(i=>!ar(i,r));return{arrayValue:{values:n}}}class Hc extends Rd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function gx(t){return et(t.integerValue||t.doubleValue)}function lE(t){return bg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function BL(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof pl&&i instanceof pl||r instanceof hl&&i instanceof hl?yo(r.elements,i.elements,ar):r instanceof Hc&&i instanceof Hc?ar(r.Ae,i.Ae):r instanceof Wc&&i instanceof Wc}(t.transform,e.transform)}class WL{constructor(e,n){this.version=e,this.transformResults=n}}class rr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rr}static exists(e){return new rr(void 0,e)}static updateTime(e){return new rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nd{}function uE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new dE(t.key,rr.none()):new Rl(t.key,t.data,rr.none());{const n=t.data,r=xn.empty();let i=new ht(wt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ys(t.key,r,new jn(i.toArray()),rr.none())}}function HL(t,e,n){t instanceof Rl?function(i,s,o){const a=i.value.clone(),l=_x(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ys?function(i,s,o){if(!Xu(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=_x(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(cE(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Oa(t,e,n,r){return t instanceof Rl?function(s,o,a,l){if(!Xu(s.precondition,o))return a;const u=s.value.clone(),d=xx(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ys?function(s,o,a,l){if(!Xu(s.precondition,o))return a;const u=xx(s.fieldTransforms,l,o),d=o.data;return d.setAll(cE(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Xu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function $L(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=sE(r.transform,i||null);s!=null&&(n===null&&(n=xn.empty()),n.set(r.field,s))}return n||null}function yx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&yo(r,i,(s,o)=>BL(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rl extends Nd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ys extends Nd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function cE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function _x(t,e,n){const r=new Map;Pe(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,qL(o,a,n[i]))}return r}function xx(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,UL(s,o,e))}return r}class dE extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KL extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&HL(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Oa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Oa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=rE();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=uE(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&yo(this.mutations,e.mutations,(n,r)=>yx(n,r))&&yo(this.baseMutations,e.baseMutations,(n,r)=>yx(n,r))}}class Sg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Pe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return zL}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Sg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt,Te;function XL(t){switch(t){case B.OK:return ue(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function pE(t){if(t===void 0)return Ar("GRPC error has no .code"),B.UNKNOWN;switch(t){case rt.OK:return B.OK;case rt.CANCELLED:return B.CANCELLED;case rt.UNKNOWN:return B.UNKNOWN;case rt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case rt.INTERNAL:return B.INTERNAL;case rt.UNAVAILABLE:return B.UNAVAILABLE;case rt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case rt.NOT_FOUND:return B.NOT_FOUND;case rt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case rt.ABORTED:return B.ABORTED;case rt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case rt.DATA_LOSS:return B.DATA_LOSS;default:return ue(39323,{code:t})}}(Te=rt||(rt={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new hi([4294967295,4294967295],0);function vx(t){const e=JL().encode(t),n=new Ck;return n.update(e),new Uint8Array(n.digest())}function bx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new hi([n,r],0),new hi([i,s],0)]}class Cg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new _a(`Invalid padding: ${n}`);if(r<0)throw new _a(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new _a(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new _a(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=hi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(hi.fromNumber(r)));return i.compare(ZL)===1&&(i=new hi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=vx(e),[r,i]=bx(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Cg(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=vx(e),[r,i]=bx(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class _a extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Nl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ld(pe.min(),i,new Ge(we),Pr(),ke())}}class Nl{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Nl(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=i}}class hE{constructor(e,n){this.targetId=e,this.Ce=n}}class fE{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class wx{constructor(){this.ve=0,this.Fe=kx(),this.Me=Tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ke(),n=ke(),r=ke();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue(38017,{changeType:s})}}),new Nl(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=kx()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class eD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pr(),this.He=vu(),this.Je=vu(),this.Ze=new Ge(we)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(zf(s))if(r===0){const o=new oe(s.path);this.et(n,o,Nt.newNoDocument(o,pe.min()))}else Pe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=bi(r).toUint8Array()}catch(l){if(l instanceof Vk)return ls("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Cg(o,i,s)}catch(l){return ls(l instanceof _a?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&zf(a.target)){const l=new oe(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Nt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let r=ke();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Ld(e,n,this.Ze,this.je,r);return this.je=Pr(),this.He=vu(),this.Je=vu(),this.Ze=new Ge(we),i}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.qe(n,1):i.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new wx,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new ht(we),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new ht(we),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wx),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function vu(){return new Ge(oe.comparator)}function kx(){return new Ge(oe.comparator)}const tD={asc:"ASCENDING",desc:"DESCENDING"},nD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},rD={and:"AND",or:"OR"};class iD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jf(t,e){return t.useProto3Json||Sd(e)?e:{value:e}}function $c(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sD(t,e){return $c(t,e.toTimestamp())}function ir(t){return Pe(!!t,49232),pe.fromTimestamp(function(n){const r=vi(n);return new qe(r.seconds,r.nanos)}(t))}function Ig(t,e){return Vf(t,e).canonicalString()}function Vf(t,e){const n=function(i){return new Ue(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function gE(t){const e=Ue.fromString(t);return Pe(bE(e),10190,{key:e.toString()}),e}function Ff(t,e){return Ig(t.databaseId,e.path)}function Kp(t,e){const n=gE(e);if(n.get(1)!==t.databaseId.projectId)throw new ie(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ie(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(_E(n))}function yE(t,e){return Ig(t.databaseId,e)}function oD(t){const e=gE(t);return e.length===4?Ue.emptyPath():_E(e)}function Uf(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _E(t){return Pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Ex(t,e,n){return{name:Ff(t,e),fields:n.value.mapValue.fields}}function aD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ue(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Pe(d===void 0||typeof d=="string",58123),Tt.fromBase64String(d||"")):(Pe(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Tt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?B.UNKNOWN:pE(u.code);return new ie(d,u.message||"")}(o);n=new fE(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Kp(t,r.document.name),s=ir(r.document.updateTime),o=r.document.createTime?ir(r.document.createTime):pe.min(),a=new xn({mapValue:{fields:r.document.fields}}),l=Nt.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Ju(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Kp(t,r.document),s=r.readTime?ir(r.readTime):pe.min(),o=Nt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ju([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Kp(t,r.document),s=r.removedTargetIds||[];n=new Ju([],s,i,null)}else{if(!("filter"in e))return ue(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new YL(i,s),a=r.targetId;n=new hE(a,o)}}return n}function lD(t,e){let n;if(e instanceof Rl)n={update:Ex(t,e.key,e.value)};else if(e instanceof dE)n={delete:Ff(t,e.key)};else if(e instanceof ys)n={update:Ex(t,e.key,e.data),updateMask:yD(e.fieldMask)};else{if(!(e instanceof KL))return ue(16599,{dt:e.type});n={verify:Ff(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Wc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof pl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof hl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Hc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ue(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:sD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue(27497)}(t,e.precondition)),n}function uD(t,e){return t&&t.length>0?(Pe(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?ir(i.updateTime):ir(s);return o.isEqual(pe.min())&&(o=ir(s)),new WL(o,i.transformResults||[])}(n,e))):[]}function cD(t,e){return{documents:[yE(t,e.path)]}}function dD(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=yE(t,i);const s=function(u){if(u.length!==0)return vE(lr.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:As(f.field),direction:fD(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=jf(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function pD(t){let e=oD(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Pe(r===1,65062);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){const f=xE(p);return f instanceof lr&&Gk(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(f=>function(_){return new Bc(Ps(_.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(p){let f;return f=typeof p=="object"?p.value:p,Sd(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(p){const f=!!p.before,g=p.values||[];return new qc(g,f)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const f=!p.before,g=p.values||[];return new qc(g,f)}(n.endAt)),AL(e,i,o,s,a,"F",l,u)}function hD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ps(n.unaryFilter.field);return ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ps(n.unaryFilter.field);return ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ps(n.unaryFilter.field);return ct.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ps(n.unaryFilter.field);return ct.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(n){return ct.create(Ps(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return lr.create(n.compositeFilter.filters.map(r=>xE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(n.compositeFilter.op))}(t):ue(30097,{filter:t})}function fD(t){return tD[t]}function mD(t){return nD[t]}function gD(t){return rD[t]}function As(t){return{fieldPath:t.canonicalString()}}function Ps(t){return wt.fromServerFormat(t.fieldPath)}function vE(t){return t instanceof ct?function(n){if(n.op==="=="){if(dx(n.value))return{unaryFilter:{field:As(n.field),op:"IS_NAN"}};if(cx(n.value))return{unaryFilter:{field:As(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(dx(n.value))return{unaryFilter:{field:As(n.field),op:"IS_NOT_NAN"}};if(cx(n.value))return{unaryFilter:{field:As(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:As(n.field),op:mD(n.op),value:n.value}}}(t):t instanceof lr?function(n){const r=n.getFilters().map(i=>vE(i));return r.length===1?r[0]:{compositeFilter:{op:gD(n.op),filters:r}}}(t):ue(54877,{filter:t})}function yD(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function wE(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n,r,i,s=pe.min(),o=pe.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.yt=e}}function xD(t){const e=pD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Mf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.Sn=new bD}addToCollectionParentIndex(e,n){return this.Sn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(xi.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(xi.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class bD{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ht(Ue.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ht(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kE=41943040;class Qt{static withCacheSize(e){return new Qt(e,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qt.DEFAULT_COLLECTION_PERCENTILE=10,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qt.DEFAULT=new Qt(kE,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qt.DISABLED=new Qt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new bo(0)}static ar(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx="LruGarbageCollector",wD=1048576;function Cx([t,e],[n,r]){const i=we(t,n);return i===0?we(e,r):i}class kD{constructor(e){this.Pr=e,this.buffer=new ht(Cx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Cx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ED{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){te(Sx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Lo(n)?te(Sx,"Ignoring IndexedDB error during garbage collection: ",n):await No(n)}await this.Ar(3e5)})}}class TD{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(Td.ce);const r=new kD(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(Tx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tx):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),Cs()<=be.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function SD(t,e){return new TD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.changes=new gs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Oa(r.mutation,i,jn.empty(),qe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const i=Ki();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ya();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ki();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Pr();const o=Da(),a=function(){return Da()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof ys)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Oa(d.mutation,u,d.mutation.getFieldMask(),qe.now())):o.set(u.key,jn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>a.set(u,new ID(d,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Da();let i=new Ge((o,a)=>o-a),s=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||jn.empty();d=a.applyToLocalView(u,d),r.set(l,d);const p=(i.get(a.batchId)||ke()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,p=rE();d.forEach(f=>{if(!s.has(f)){const g=uE(n.get(f),r.get(f));g!==null&&p.set(f,g),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return PL(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RL(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):U.resolve(Ki());let a=ll,l=s;return o.next(u=>U.forEach(u,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ke())).next(d=>({batchId:a,changes:nE(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let i=ya();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ya();return this.indexManager.getCollectionParents(e,s).next(a=>U.forEach(a,l=>{const u=function(p,f){return new Id(f,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((p,f)=>{o=o.insert(p,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Nt.newInvalidDocument(d)))});let a=ya();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&Oa(d.mutation,u,jn.empty(),qe.now()),Pd(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return U.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ir(i.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(i){return{name:i.name,query:xD(i.bundledQuery),readTime:ir(i.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.overlays=new Ge(oe.comparator),this.Lr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ki();return U.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.bt(e,n,s)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const i=Ki(),s=n.length+1,o=new oe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return U.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ge((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Ki(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=Ki(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return U.resolve(a)}bt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new GL(n,r));let s=this.Lr.get(n);s===void 0&&(s=ke(),this.Lr.set(n,s)),this.Lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this.kr=new ht(gt.Kr),this.qr=new ht(gt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new gt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new gt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new oe(new Ue([])),r=new gt(n,e),i=new gt(n,e+1),s=[];return this.qr.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new oe(new Ue([])),r=new gt(n,e),i=new gt(n,e+1);let s=ke();return this.qr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new gt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class gt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return oe.comparator(e.key,n.key)||we(e.Hr,n.Hr)}static Ur(e,n){return we(e.Hr,n.Hr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new ht(gt.Kr)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new QL(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Jr=this.Jr.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?xg:this.Yn-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new gt(n,0),i=new gt(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],o=>{const a=this.Zr(o.Hr);s.push(a)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ht(we);return n.forEach(i=>{const s=new gt(i,0),o=new gt(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),U.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;oe.isDocumentKey(s)||(s=s.child(""));const o=new gt(new oe(s),0);let a=new ht(we);return this.Jr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Hr)),!0)},o),U.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Pe(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return U.forEach(n.mutations,i=>{const s=new gt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new gt(n,0),i=this.Jr.firstAfterOrEqual(r);return U.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.ti=e,this.docs=function(){return new Ge(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Nt.newInvalidDocument(n))}getEntries(e,n){let r=Pr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Nt.newInvalidDocument(i))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Pr();const o=n.path,a=new oe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||oL(sL(d),r)<=0||(i.has(d.key)||Pd(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue(9500)}ni(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new OD(this)}getSize(e){return U.resolve(this.size)}}class OD extends CD{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.persistence=e,this.ri=new gs(n=>wg(n),kg),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.ii=0,this.si=new Ag,this.targetCount=0,this.oi=bo._r()}forEachTarget(e,n){return this.ri.forEach((r,i)=>n(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),U.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.lr(n),U.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),U.waitFor(s).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),U.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n){this._i={},this.overlays={},this.ai=new Td(0),this.ui=!1,this.ui=!0,this.ci=new ND,this.referenceDelegate=e(this),this.li=new zD(this),this.indexManager=new vD,this.remoteDocumentCache=function(i){return new DD(i)}(r=>this.referenceDelegate.hi(r)),this.serializer=new _D(n),this.Pi=new PD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new RD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new LD(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new MD(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(s=>this.referenceDelegate.Ii(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return U.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class MD extends lL{constructor(e){super(),this.currentSequenceNumber=e}}class Pg{constructor(e){this.persistence=e,this.Ri=new Ag,this.Ai=null}static Vi(e){return new Pg(e)}get di(){if(this.Ai)return this.Ai;throw ue(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(i=>this.di.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.di,r=>{const i=oe.fromPath(r);return this.mi(e,i).next(s=>{s||n.removeEntry(i,pe.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Kc{constructor(e,n){this.persistence=e,this.fi=new gs(r=>dL(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=SD(this,n)}static Vi(e,n){return new Kc(e,n)}Ti(){}Ii(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return U.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(s=>s?U.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,s.removeEntry(o,pe.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),U.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Gu(e.data.value)),n}wr(e,n,r){return U.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.fi.get(n);return U.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=i}static Es(e,n){let r=ke(),i=ke();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Rg(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return TP()?8:uL(Ot())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.gs(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new jD;return this.ys(e,n,o).next(a=>{if(s.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>s.result)}ws(e,n,r,i){return r.documentReadCount<this.Vs?(Cs()<=be.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Is(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),U.resolve()):(Cs()<=be.DEBUG&&te("QueryEngine","Query:",Is(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Cs()<=be.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Is(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nr(n))):U.resolve())}gs(e,n){if(mx(n))return U.resolve(null);let r=nr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Mf(n,null,"F"),r=nr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ke(...s);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.bs(n,a);return this.Ss(n,u,o,l.readTime)?this.gs(e,Mf(n,null,"F")):this.Ds(e,u,n,l)}))})))}ps(e,n,r,i){return mx(n)||i.isEqual(pe.min())?U.resolve(null):this.fs.getDocuments(e,r).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,r,i)?U.resolve(null):(Cs()<=be.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Is(n)),this.Ds(e,o,n,iL(i,ll)).next(a=>a))})}bs(e,n){let r=new ht(eE(e));return n.forEach((i,s)=>{Pd(e,s)&&(r=r.add(s))}),r}Ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,n,r){return Cs()<=be.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Is(n)),this.fs.getDocumentsMatchingQuery(e,n,xi.min(),r)}Ds(e,n,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng="LocalStore",FD=3e8;class UD{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.vs=new Ge(we),this.Fs=new gs(s=>wg(s),kg),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new AD(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function qD(t,e,n,r){return new UD(t,e,n,r)}async function TE(t,e){const n=fe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ke();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ns:u,removedBatchIds:o,addedBatchIds:a}))})})}function BD(t,e){const n=fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const p=u.batch,f=p.keys();let g=U.resolve();return f.forEach(_=>{g=g.next(()=>d.getEntry(l,_)).next(k=>{const I=u.docVersions.get(_);Pe(I!==null,48541),k.version.compareTo(I)<0&&(p.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),d.addEntry(k)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ke();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function SE(t){const e=fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function WD(t,e){const n=fe(t),r=e.snapshotVersion;let i=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});i=n.vs;const a=[];e.targetChanges.forEach((d,p)=>{const f=i.get(p);if(!f)return;a.push(n.li.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.li.addMatchingKeys(s,d.addedDocuments,p)));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?g=g.withResumeToken(Tt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),i=i.insert(p,g),function(k,I,x){return k.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=FD?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,g,d)&&a.push(n.li.updateTargetData(s,g))});let l=Pr(),u=ke();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(HD(s,o,e.documentUpdates).next(d=>{l=d.Bs,u=d.Ls})),!r.isEqual(pe.min())){const d=n.li.getLastRemoteSnapshotVersion(s).next(p=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return U.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.vs=i,s))}function HD(t,e,n){let r=ke(),i=ke();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Pr();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):te(Ng,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Bs:o,Ls:i}})}function $D(t,e){const n=fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=xg),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function KD(t,e){const n=fe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.li.getTargetData(r,e).next(s=>s?(i=s,U.resolve(i)):n.li.allocateTargetId(r).next(o=>(i=new Zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function qf(t,e,n){const r=fe(t),i=r.vs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Lo(o))throw o;te(Ng,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Ix(t,e,n){const r=fe(t);let i=pe.min(),s=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const p=fe(l),f=p.Fs.get(d);return f!==void 0?U.resolve(p.vs.get(f)):p.li.getTargetData(u,d)}(r,o,nr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:pe.min(),n?s:ke())).next(a=>(QD(r,LL(e),a),{documents:a,ks:s})))}function QD(t,e,n){let r=t.Ms.get(e)||pe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ms.set(e,r)}class Ax{constructor(){this.activeTargetIds=VL()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GD{constructor(){this.vo=new Ax,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Ax,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="ConnectivityMonitor";class Rx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){te(Px,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){te(Px,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bu=null;function Bf(){return bu===null?bu=function(){return 268435456+Math.round(2147483648*Math.random())}():bu++,"0x"+bu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="RestConnection",XD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class JD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===Fc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){const o=Bf(),a=this.Qo(e,n.toUriEncodedString());te(Qp,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,i,s);const{host:u}=new URL(a),d=Io(u);return this.zo(e,a,l,r,d).then(p=>(te(Qp,`Received RPC '${e}' ${o}: `,p),p),p=>{throw ls(Qp,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ro}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Qo(e,n){const r=XD[e];let i=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It="WebChannelConnection",la=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(i){setTimeout(()=>{throw i},0)}})};class no extends JD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!no.c_){const e=Rk();la(e,Pk.STAT_EVENT,n=>{n.stat===Rf.PROXY?te(It,"STAT_EVENT: detected buffering proxy"):n.stat===Rf.NOPROXY&&te(It,"STAT_EVENT: detected no buffering proxy")}),no.c_=!0}}zo(e,n,r,i,s){const o=Bf();return new Promise((a,l)=>{const u=new Ik;u.setWithCredentials(!0),u.listenOnce(Ak.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Qu.NO_ERROR:const p=u.getResponseJson();te(It,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Qu.TIMEOUT:te(It,`RPC '${e}' ${o} timed out`),l(new ie(B.DEADLINE_EXCEEDED,"Request time out"));break;case Qu.HTTP_ERROR:const f=u.getStatus();if(te(It,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const k=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(v)>=0?v:B.UNKNOWN}(_.status);l(new ie(k,_.message))}else l(new ie(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ie(B.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{te(It,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);te(It,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",d,r,15)})}T_(e,n,r){const i=Bf(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const u=s.join("");te(It,`Creating RPC '${e}' stream ${i}: ${u}`,a);const d=o.createWebChannel(u,a);this.I_(d);let p=!1,f=!1;const g=new ZD({Ho:_=>{f?te(It,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(p||(te(It,`Opening RPC '${e}' stream ${i} transport.`),d.open(),p=!0),te(It,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},Jo:()=>d.close()});return la(d,ga.EventType.OPEN,()=>{f||(te(It,`RPC '${e}' stream ${i} transport opened.`),g.i_())}),la(d,ga.EventType.CLOSE,()=>{f||(f=!0,te(It,`RPC '${e}' stream ${i} transport closed`),g.o_(),this.E_(d))}),la(d,ga.EventType.ERROR,_=>{f||(f=!0,ls(It,`RPC '${e}' stream ${i} transport errored. Name:`,_.name,"Message:",_.message),g.o_(new ie(B.UNAVAILABLE,"The operation could not be completed")))}),la(d,ga.EventType.MESSAGE,_=>{var k;if(!f){const I=_.data[0];Pe(!!I,16349);const x=I,v=(x==null?void 0:x.error)||((k=x[0])==null?void 0:k.error);if(v){te(It,`RPC '${e}' stream ${i} received error:`,v);const w=v.status;let M=function(S){const E=rt[S];if(E!==void 0)return pE(E)}(w),O=v.message;w==="NOT_FOUND"&&O.includes("database")&&O.includes("does not exist")&&O.includes(this.databaseId.database)&&ls(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),M===void 0&&(M=B.INTERNAL,O="Unknown error status: "+w+" with message "+v.message),f=!0,g.o_(new ie(M,O)),d.close()}else te(It,`RPC '${e}' stream ${i} received:`,I),g.__(I)}}),no.u_(),setTimeout(()=>{g.s_()},0),g}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Nk()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e3(t){return new no(t)}function Gp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t){return new iD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */no.c_=!1;class CE{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx="PersistentStream";class IE{constructor(e,n,r,i,s,o,a,l){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new CE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new ie(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return te(Nx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(te(Nx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class t3 extends IE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=aD(this.serializer,e),r=function(s){if(!("targetChange"in s))return pe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?ir(o.readTime):pe.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Uf(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=zf(l)?{documents:cD(s,l)}:{query:dD(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mE(s,o.resumeToken);const u=jf(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=$c(s,o.snapshotVersion.toTimestamp());const u=jf(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=hD(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Uf(this.serializer),n.removeTarget=e,this.K_(n)}}class n3 extends IE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uD(e.writeResults,e.commitTime),r=ir(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Uf(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>lD(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{}class i3 extends r3{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ie(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,Vf(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ie(B.UNKNOWN,s.toString())})}jo(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Vf(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function s3(t,e,n,r){return new i3(t,e,n,r)}class o3{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ar(n),this.aa=!1):te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="RemoteStore";class a3{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{_s(this)&&(te(us,"Restarting streams for network reachability change."),await async function(l){const u=fe(l);u.Ea.add(4),await Ll(u),u.Va.set("Unknown"),u.Ea.delete(4),await Od(u)}(this))})}),this.Va=new o3(r,i)}}async function Od(t){if(_s(t))for(const e of t.Ra)await e(!0)}async function Ll(t){for(const e of t.Ra)await e(!1)}function AE(t,e){const n=fe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),zg(n)?Og(n):Do(n).O_()&&Dg(n,e))}function Lg(t,e){const n=fe(t),r=Do(n);n.Ia.delete(e),r.O_()&&PE(n,e),n.Ia.size===0&&(r.O_()?r.L_():_s(n)&&n.Va.set("Unknown"))}function Dg(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Do(t).Z_(e)}function PE(t,e){t.da.$e(e),Do(t).X_(e)}function Og(t){t.da=new eD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Do(t).start(),t.Va.ua()}function zg(t){return _s(t)&&!Do(t).x_()&&t.Ia.size>0}function _s(t){return fe(t).Ea.size===0}function RE(t){t.da=void 0}async function l3(t){t.Va.set("Online")}async function u3(t){t.Ia.forEach((e,n)=>{Dg(t,e)})}async function c3(t,e){RE(t),zg(t)?(t.Va.ha(e),Og(t)):t.Va.set("Unknown")}async function d3(t,e,n){if(t.Va.set("Online"),e instanceof fE&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.da.removeTarget(a))}(t,e)}catch(r){te(us,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qc(t,r)}else if(e instanceof Ju?t.da.Xe(e):e instanceof hE?t.da.st(e):t.da.tt(e),!n.isEqual(pe.min()))try{const r=await SE(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Ia.get(u);d&&s.Ia.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.Ia.get(l);if(!d)return;s.Ia.set(l,d.withResumeToken(Tt.EMPTY_BYTE_STRING,d.snapshotVersion)),PE(s,l);const p=new Zr(d.target,l,u,d.sequenceNumber);Dg(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){te(us,"Failed to raise snapshot:",r),await Qc(t,r)}}async function Qc(t,e,n){if(!Lo(e))throw e;t.Ea.add(1),await Ll(t),t.Va.set("Offline"),n||(n=()=>SE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te(us,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Od(t)})}function NE(t,e){return e().catch(n=>Qc(t,n,e))}async function zd(t){const e=fe(t),n=ki(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xg;for(;p3(e);)try{const i=await $D(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,h3(e,i)}catch(i){await Qc(e,i)}LE(e)&&DE(e)}function p3(t){return _s(t)&&t.Ta.length<10}function h3(t,e){t.Ta.push(e);const n=ki(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function LE(t){return _s(t)&&!ki(t).x_()&&t.Ta.length>0}function DE(t){ki(t).start()}async function f3(t){ki(t).ra()}async function m3(t){const e=ki(t);for(const n of t.Ta)e.ea(n.mutations)}async function g3(t,e,n){const r=t.Ta.shift(),i=Sg.from(r,e,n);await NE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await zd(t)}async function y3(t,e){e&&ki(t).Y_&&await async function(r,i){if(function(o){return XL(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();ki(r).B_(),await NE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await zd(r)}}(t,e),LE(t)&&DE(t)}async function Lx(t,e){const n=fe(t);n.asyncQueue.verifyOperationInProgress(),te(us,"RemoteStore received new credentials");const r=_s(n);n.Ea.add(3),await Ll(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Od(n)}async function _3(t,e){const n=fe(t);e?(n.Ea.delete(2),await Od(n)):e||(n.Ea.add(2),await Ll(n),n.Va.set("Unknown"))}function Do(t){return t.ma||(t.ma=function(n,r,i){const s=fe(n);return s.sa(),new t3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:l3.bind(null,t),Yo:u3.bind(null,t),t_:c3.bind(null,t),J_:d3.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),zg(t)?Og(t):t.Va.set("Unknown")):(await t.ma.stop(),RE(t))})),t.ma}function ki(t){return t.fa||(t.fa=function(n,r,i){const s=fe(n);return s.sa(),new n3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:f3.bind(null,t),t_:y3.bind(null,t),ta:m3.bind(null,t),na:g3.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await zd(t)):(await t.fa.stop(),t.Ta.length>0&&(te(us,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Mg(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jg(t,e){if(Ar("AsyncQueue",`${e}: ${t}`),Lo(t))return new ie(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{static emptySet(e){return new ro(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=ya(),this.sortedSet=new Ge(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ro)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ro;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(){this.ga=new Ge(oe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ue(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class wo{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new wo(e,n,ro.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ad(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class v3{constructor(){this.queries=Ox(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=fe(n),s=i.queries;i.queries=Ox(),s.forEach((o,a)=>{for(const l of a.ba)l.onError(r)})})(this,new ie(B.ABORTED,"Firestore shutting down"))}}function Ox(){return new gs(t=>Zk(t),Ad)}async function b3(t,e){const n=fe(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new x3,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=jg(o,`Initialization of query '${Is(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.ba.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Vg(n)}async function w3(t,e){const n=fe(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function k3(t,e){const n=fe(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.ba)a.Fa(i)&&(r=!0);o.wa=i}}r&&Vg(n)}function E3(t,e,n){const r=fe(t),i=r.queries.get(e);if(i)for(const s of i.ba)s.onError(n);r.queries.delete(e)}function Vg(t){t.Ca.forEach(e=>{e.next()})}var Wf,zx;(zx=Wf||(Wf={})).Ma="default",zx.Cache="cache";class T3{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new wo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Wf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.key=e}}class zE{constructor(e){this.key=e}}class S3{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ke(),this.mutatedKeys=ke(),this.eu=eE(e),this.tu=new ro(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new Dx,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const f=i.get(d),g=Pd(this.query,p)?p:null,_=!!f&&this.mutatedKeys.has(f.key),k=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let I=!1;f&&g?f.data.isEqual(g.data)?_!==k&&(r.track({type:3,doc:g}),I=!0):this.su(f,g)||(r.track({type:2,doc:g}),I=!0,(l&&this.eu(g,l)>0||u&&this.eu(g,u)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),I=!0):f&&!g&&(r.track({type:1,doc:f}),I=!0,(l||u)&&(a=!0)),I&&(g?(o=o.add(g),s=k?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Ss:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,p)=>function(g,_){const k=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Vt:I})}};return k(g)-k(_)}(d.type,p.type)||this.eu(d.doc,p.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Ya.size===0&&this.current&&!i?1:0,u=l!==this.Xa;return this.Xa=l,o.length!==0||u?{snapshot:new wo(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Dx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ke(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new zE(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new OE(r))}),n}cu(e){this.Za=e.ks,this.Ya=ke();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return wo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Fg="SyncEngine";class C3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class I3{constructor(e){this.key=e,this.hu=!1}}class A3{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gs(a=>Zk(a),Ad),this.Iu=new Map,this.Eu=new Set,this.Ru=new Ge(oe.comparator),this.Au=new Map,this.Vu=new Ag,this.du={},this.mu=new Map,this.fu=bo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function P3(t,e,n=!0){const r=qE(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await ME(r,e,n,!0),i}async function R3(t,e){const n=qE(t);await ME(n,e,!0,!1)}async function ME(t,e,n,r){const i=await KD(t.localStore,nr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await N3(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&AE(t.remoteStore,i),a}async function N3(t,e,n,r,i){t.pu=(p,f,g)=>async function(k,I,x,v){let w=I.view.ru(x);w.Ss&&(w=await Ix(k.localStore,I.query,!1).then(({documents:S})=>I.view.ru(S,w)));const M=v&&v.targetChanges.get(I.targetId),O=v&&v.targetMismatches.get(I.targetId)!=null,D=I.view.applyChanges(w,k.isPrimaryClient,M,O);return jx(k,I.targetId,D.au),D.snapshot}(t,p,f,g);const s=await Ix(t.localStore,e,!0),o=new S3(e,s.ks),a=o.ru(s.documents),l=Nl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);jx(t,n,u.au);const d=new C3(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function L3(t,e,n){const r=fe(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Ad(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await qf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Lg(r.remoteStore,i.targetId),Hf(r,i.targetId)}).catch(No)):(Hf(r,i.targetId),await qf(r.localStore,i.targetId,!0))}async function D3(t,e){const n=fe(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Lg(n.remoteStore,r.targetId))}async function O3(t,e,n){const r=q3(t);try{const i=await function(o,a){const l=fe(o),u=qe.now(),d=a.reduce((g,_)=>g.add(_.key),ke());let p,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=Pr(),k=ke();return l.xs.getEntries(g,d).next(I=>{_=I,_.forEach((x,v)=>{v.isValidDocument()||(k=k.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,_)).next(I=>{p=I;const x=[];for(const v of a){const w=$L(v,p.get(v.key).overlayedDocument);w!=null&&x.push(new ys(v.key,w,$k(w.value.mapValue),rr.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,x,a)}).next(I=>{f=I;const x=I.applyToLocalDocumentSet(p,k);return l.documentOverlayCache.saveOverlays(g,I.batchId,x)})}).then(()=>({batchId:f.batchId,changes:nE(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.du[o.currentUser.toKey()];u||(u=new Ge(we)),u=u.insert(a,l),o.du[o.currentUser.toKey()]=u}(r,i.batchId,n),await Dl(r,i.changes),await zd(r.remoteStore)}catch(i){const s=jg(i,"Failed to persist write");n.reject(s)}}async function jE(t,e){const n=fe(t);try{const r=await WD(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Pe(o.hu,14607):i.removedDocuments.size>0&&(Pe(o.hu,42227),o.hu=!1))}),await Dl(n,r,e)}catch(r){await No(r)}}function Mx(t,e,n){const r=fe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=fe(o);l.onlineState=a;let u=!1;l.queries.forEach((d,p)=>{for(const f of p.ba)f.va(a)&&(u=!0)}),u&&Vg(l)}(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function z3(t,e,n){const r=fe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new Ge(oe.comparator);o=o.insert(s,Nt.newNoDocument(s,pe.min()));const a=ke().add(s),l=new Ld(pe.min(),new Map,new Ge(we),o,a);await jE(r,l),r.Ru=r.Ru.remove(s),r.Au.delete(e),Ug(r)}else await qf(r.localStore,e,!1).then(()=>Hf(r,e,n)).catch(No)}async function M3(t,e){const n=fe(t),r=e.batch.batchId;try{const i=await BD(n.localStore,e);FE(n,r,null),VE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Dl(n,i)}catch(i){await No(i)}}async function j3(t,e,n){const r=fe(t);try{const i=await function(o,a){const l=fe(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(Pe(p!==null,37113),d=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);FE(r,e,n),VE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Dl(r,i)}catch(i){await No(i)}}function VE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function FE(t,e,n){const r=fe(t);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Hf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||UE(t,r)})}function UE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Lg(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),Ug(t))}function jx(t,e,n){for(const r of n)r instanceof OE?(t.Vu.addReference(r.key,e),V3(t,r)):r instanceof zE?(te(Fg,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||UE(t,r.key)):ue(19791,{wu:r})}function V3(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(te(Fg,"New document in limbo: "+n),t.Eu.add(r),Ug(t))}function Ug(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new oe(Ue.fromString(e)),r=t.fu.next();t.Au.set(r,new I3(n)),t.Ru=t.Ru.insert(n,r),AE(t.remoteStore,new Zr(nr(Eg(n.path)),r,"TargetPurposeLimboResolution",Td.ce))}}async function Dl(t,e,n){const r=fe(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Rg.Es(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Pu.J_(i),await async function(l,u){const d=fe(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(u,f=>U.forEach(f.Ts,g=>d.persistence.referenceDelegate.addReference(p,f.targetId,g)).next(()=>U.forEach(f.Is,g=>d.persistence.referenceDelegate.removeReference(p,f.targetId,g)))))}catch(p){if(!Lo(p))throw p;te(Ng,"Failed to update sequence numbers: "+p)}for(const p of u){const f=p.targetId;if(!p.fromCache){const g=d.vs.get(f),_=g.snapshotVersion,k=g.withLastLimboFreeSnapshotVersion(_);d.vs=d.vs.insert(f,k)}}}(r.localStore,s))}async function F3(t,e){const n=fe(t);if(!n.currentUser.isEqual(e)){te(Fg,"User change. New user:",e.toKey());const r=await TE(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new ie(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Dl(n,r.Ns)}}function U3(t,e){const n=fe(t),r=n.Au.get(e);if(r&&r.hu)return ke().add(r.key);{let i=ke();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function qE(t){const e=fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=U3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=z3.bind(null,e),e.Pu.J_=k3.bind(null,e.eventManager),e.Pu.yu=E3.bind(null,e.eventManager),e}function q3(t){const e=fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=M3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=j3.bind(null,e),e}class Gc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return qD(this.persistence,new VD,e.initialUser,this.serializer)}Cu(e){return new EE(Pg.Vi,this.serializer)}Du(e){return new GD}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gc.provider={build:()=>new Gc};class B3 extends Gc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Pe(this.persistence.referenceDelegate instanceof Kc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ED(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new EE(r=>Kc.Vi(r,n),this.serializer)}}class $f{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Mx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=F3.bind(null,this.syncEngine),await _3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new v3}()}createDatastore(e){const n=Dd(e.databaseInfo.databaseId),r=e3(e.databaseInfo);return s3(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new a3(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Mx(this.syncEngine,n,0),function(){return Rx.v()?new Rx:new YD}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const p=new A3(i,s,o,a,l,u);return d&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=fe(i);te(us,"RemoteStore shutting down."),s.Ea.add(5),await Ll(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}$f.provider={build:()=>new $f};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ar("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei="FirestoreClient";class H3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=i,this.user=Pt.UNAUTHENTICATED,this.clientId=yg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{te(Ei,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(te(Ei,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Yp(t,e){t.asyncQueue.verifyOperationInProgress(),te(Ei,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await TE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Vx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await $3(t);te(Ei,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Lx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Lx(e.remoteStore,i)),t._onlineComponents=e}async function $3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te(Ei,"Using user provided OfflineComponentProvider");try{await Yp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;ls("Error using user provided cache. Falling back to memory cache: "+n),await Yp(t,new Gc)}}else te(Ei,"Using default OfflineComponentProvider"),await Yp(t,new B3(void 0));return t._offlineComponents}async function BE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te(Ei,"Using user provided OnlineComponentProvider"),await Vx(t,t._uninitializedComponentsProvider._online)):(te(Ei,"Using default OnlineComponentProvider"),await Vx(t,new $f))),t._onlineComponents}function K3(t){return BE(t).then(e=>e.syncEngine)}async function Q3(t){const e=await BE(t),n=e.eventManager;return n.onListen=P3.bind(null,e.syncEngine),n.onUnlisten=L3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=R3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=D3.bind(null,e.syncEngine),n}function G3(t,e,n={}){const r=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new W3({next:f=>{d.Nu(),o.enqueueAndForget(()=>w3(s,p));const g=f.docs.has(a);!g&&f.fromCache?u.reject(new ie(B.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?u.reject(new ie(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),p=new T3(Eg(a.path),d,{includeMetadataChanges:!0,Ka:!0});return b3(s,p)}(await Q3(t),t.asyncQueue,e,n,r)),r.promise}function Y3(t,e){const n=new fi;return t.asyncQueue.enqueueAndForget(async()=>O3(await K3(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3="ComponentProvider",Fx=new Map;function J3(t,e,n,r,i){return new fL(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,WE(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="firestore.googleapis.com",Ux=!0;class qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=HE,this.ssl=Ux}else this.host=e.host,this.ssl=e.ssl??Ux;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wD)throw new ie(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Md{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new K4;switch(r.type){case"firstParty":return new X4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Fx.get(n);r&&(te(X3,"Removing Datastore"),Fx.delete(n),r.terminate())}(this),Promise.resolve()}}function Z3(t,e,n,r={}){var u;t=_o(t,Md);const i=Io(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(Bw(`https://${a}`),Ww("Firestore",!0)),s.host!==HE&&s.host!==a&&ls("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!is(l,o)&&(t._setSettings(l),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=Pt.MOCK_USER;else{d=gP(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new ie(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Pt(f)}t._authCredentials=new Q4(new Dk(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qg(this.firestore,e,this._query)}}class pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Pl(n,pt._jsonSchema))return new pt(e,r||null,new oe(Ue.fromString(n.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:ot("string",pt._jsonSchemaVersion),referencePath:ot("string")};class mi extends qg{constructor(e,n,r){super(e,n,Eg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new oe(e))}withConverter(e){return new mi(this.firestore,e,this._path)}}function eO(t,e,...n){if(t=cn(t),Ok("collection","path",e),t instanceof Md){const r=Ue.fromString(e,...n);return nx(r),new mi(t,null,r)}{if(!(t instanceof pt||t instanceof mi))throw new ie(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return nx(r),new mi(t.firestore,null,r)}}function Bg(t,e,...n){if(t=cn(t),arguments.length===1&&(e=yg.newId()),Ok("doc","path",e),t instanceof Md){const r=Ue.fromString(e,...n);return tx(r),new pt(t,null,new oe(r))}{if(!(t instanceof pt||t instanceof mi))throw new ie(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return tx(r),new pt(t.firestore,t instanceof mi?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx="AsyncQueue";class Wx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new CE(this,"async_queue_retry"),this._c=()=>{const r=Gp();r&&te(Bx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Gp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Gp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new fi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Lo(e))throw e;te(Bx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ar("INTERNAL UNHANDLED ERROR: ",Hx(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Mg.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:Hx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Hx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class jd extends Md{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Wx,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Wx(e),this._firestoreClient=void 0,await e}}}function tO(t,e){const n=typeof t=="object"?t:Qw(),r=typeof t=="string"?t:Fc,i=sg(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=fP("firestore");s&&Z3(i,...s)}return i}function $E(t){if(t._terminated)throw new ie(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||nO(t),t._firestoreClient}function nO(t){var r,i,s,o;const e=t._freezeSettings(),n=J3(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(i=t._app)==null?void 0:i.options.apiKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new H3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vn(Tt.fromBase64String(e))}catch(n){throw new ie(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vn(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pl(e,vn._jsonSchema))return vn.fromBase64String(e.bytes)}}vn._jsonSchemaVersion="firestore/bytes/1.0",vn._jsonSchema={type:ot("string",vn._jsonSchemaVersion),bytes:ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ie(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ie(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ie(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sr._jsonSchemaVersion}}static fromJSON(e){if(Pl(e,sr._jsonSchema))return new sr(e.latitude,e.longitude)}}sr._jsonSchemaVersion="firestore/geoPoint/1.0",sr._jsonSchema={type:ot("string",sr._jsonSchemaVersion),latitude:ot("number"),longitude:ot("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pl(e,qn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new qn(e.vectorValues);throw new ie(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qn._jsonSchemaVersion="firestore/vectorValue/1.0",qn._jsonSchema={type:ot("string",qn._jsonSchemaVersion),vectorValues:ot("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO=/^__.*__$/;class iO{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ys(e,this.data,this.fieldMask,n,this.fieldTransforms):new Rl(e,this.data,n,this.fieldTransforms)}}function GE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{dataSource:t})}}class Wg{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Wg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Yc(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(GE(this.dataSource)&&rO.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class sO{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Dd(e)}createContext(e,n,r,i=!1){return new Wg({dataSource:e,methodName:n,targetDoc:r,path:wt.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function YE(t){const e=t._freezeSettings(),n=Dd(t._databaseId);return new sO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function XE(t,e,n,r,i,s={}){const o=t.createContext(s.merge||s.mergeFields?2:0,e,n,i);t2("Data must be an object, but it was:",o,r);const a=ZE(r,o);let l,u;if(s.merge)l=new jn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const f=Hg(e,p,n);if(!o.contains(f))throw new ie(B.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);lO(d,f)||d.push(f)}l=new jn(d),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new iO(new xn(a),l,u)}function JE(t,e){if(e2(t=cn(t)))return t2("Unsupported field value:",e,t),ZE(t,e);if(t instanceof QE)return function(r,i){if(!GE(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=JE(a,i.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=cn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return FL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=qe.fromDate(r);return{timestampValue:$c(i.serializer,s)}}if(r instanceof qe){const s=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$c(i.serializer,s)}}if(r instanceof sr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vn)return{bytesValue:mE(i.serializer,r._byteString)};if(r instanceof pt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ig(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof qn)return function(o,a){const l=o instanceof qn?o.toArray():o;return{mapValue:{fields:{[Wk]:{stringValue:Hk},[Uc]:{arrayValue:{values:l.map(d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return Tg(a.serializer,d)})}}}}}}(r,i);if(wE(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${_g(r)}`)}(t,e)}function ZE(t,e){const n={};return jk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ms(t,(r,i)=>{const s=JE(i,e.childContextForField(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function e2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof sr||t instanceof vn||t instanceof pt||t instanceof QE||t instanceof qn||wE(t))}function t2(t,e,n){if(!e2(n)||!zk(n)){const r=_g(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Hg(t,e,n){if((e=cn(e))instanceof KE)return e._internalPath;if(typeof e=="string")return aO(t,e);throw Yc("Field path arguments must be of type string or ",t,!1,void 0,n)}const oO=new RegExp("[~\\*/\\[\\]]");function aO(t,e,n){if(e.search(oO)>=0)throw Yc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new KE(...e.split("."))._internalPath}catch{throw Yc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yc(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ie(B.INVALID_ARGUMENT,a+t+l)}function lO(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{convertValue(e,n="none"){switch(wi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ms(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Uc].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>et(o.doubleValue));return new qn(n)}convertGeoPoint(e){return new sr(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ul(e));default:return null}}convertTimestamp(e){const n=vi(e);return new qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ue.fromString(e);Pe(bE(r),9688,{name:e});const i=new cl(r.get(1),r.get(3)),s=new oe(r.popFirst(5));return i.isEqual(n)||Ar(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO extends uO{constructor(e){super(),this.firestore=e}convertBytes(e){return new vn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,n)}}const $x="@firebase/firestore",Kx="4.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Hg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class dO extends n2{data(){return super.data()}}function r2(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class xa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ji extends n2{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Hg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ji._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ji._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ji._jsonSchema={type:ot("string",Ji._jsonSchemaVersion),bundleSource:ot("string","DocumentSnapshot"),bundleName:ot("string"),bundle:ot("string")};class Zu extends Ji{data(e={}){return super.data(e)}}class za{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new xa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zu(this._firestore,this._userDataWriter,r.key,r,new xa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ie(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Zu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Zu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:pO(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=za._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function pO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */za._jsonSchemaVersion="firestore/querySnapshot/1.0",za._jsonSchema={type:ot("string",za._jsonSchemaVersion),bundleSource:ot("string","QuerySnapshot"),bundleName:ot("string"),bundle:ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(t){t=_o(t,pt);const e=_o(t.firestore,jd),n=$E(e);return G3(n,t._key).then(r=>gO(e,t,r))}function fO(t,e,n){t=_o(t,pt);const r=_o(t.firestore,jd),i=r2(t.converter,e,n),s=YE(r);return i2(r,[XE(s,"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rr.none())])}function mO(t,e){const n=_o(t.firestore,jd),r=Bg(t),i=r2(t.converter,e),s=YE(t.firestore);return i2(n,[XE(s,"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,rr.exists(!1))]).then(()=>r)}function i2(t,e){const n=$E(t);return Y3(n,e)}function gO(t,e,n){const r=n.docs.get(e._key),i=new cO(t);return new Ji(t,i,e._key,r,new xa(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){$4(Ao),mo(new ss("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new jd(new G4(r.getProvider("auth-internal")),new J4(o,r.getProvider("app-check-internal")),mL(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),pi($x,Kx,e),pi($x,Kx,"esm2020")})();const Kf={apiKey:"AIzaSyD6Zfg5BaSWhnnVukHz9YoDzZKxGWaR7W0",authDomain:"ml-coding-lab.firebaseapp.com",projectId:"ml-coding-lab",storageBucket:"ml-coding-lab.firebasestorage.app",messagingSenderId:"1077888724124",appId:"1:1077888724124:web:95031426e624674f035159"},Vd=!!(Kf.apiKey&&Kf.projectId);let Xp=null,Ui=null,cs=null,Qf=null;Vd&&(Xp=Kw(Kf),Ui=q4(Xp),cs=tO(Xp),Qf=new yr);function yO(t,e){typeof window<"u"&&window.gtag&&window.gtag("event",t,e)}function _O(t){typeof window<"u"&&window.gtag&&window.gtag("set",{user_id:t})}async function xO(t){if(cs)try{await mO(eO(cs,"sign_ins"),{uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,timestamp:new Date().toISOString(),userAgent:navigator.userAgent})}catch(e){console.error("Failed to log sign-in:",e)}}const s2=z.createContext(null);function vO({children:t}){const[e,n]=z.useState(null),[r,i]=z.useState(Vd);z.useEffect(()=>{if(!Ui){i(!1);return}return PN(Ui,l=>{n(l),i(!1),_O((l==null?void 0:l.uid)??null)})},[]);const s=async()=>{if(!(!Ui||!Qf))try{const a=await XN(Ui,Qf);await xO(a.user),yO("login",{method:"google"})}catch(a){console.error("Google sign-in failed:",a)}},o=async()=>{Ui&&await RN(Ui)};return h.jsx(s2.Provider,{value:{user:e,loading:r,signInWithGoogle:s,signOut:o},children:t})}function $g(){const t=z.useContext(s2);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}async function bO(t){if(!cs)return null;const e=Bg(cs,"users",t),n=await hO(e);return n.exists()?n.data().progress??null:null}async function Jp(t,e,n){if(!cs)return;const r=Bg(cs,"users",t);await fO(r,{displayName:n.displayName,email:n.email,photoURL:n.photoURL,lastSynced:new Date().toISOString(),progress:e},{merge:!0})}const Qx={not_started:0,in_progress:1,completed:2};function wO(t,e){const n={},r=new Set([...Object.keys(t),...Object.keys(e)]);for(const i of r){const s=t[i]||{},o=e[i]||{};n[i]={};const a=new Set([...Object.keys(s),...Object.keys(o)]);for(const l of a){const u=s[l],d=o[l];if(!u)n[i][l]=d;else if(!d)n[i][l]=u;else{const p=Qx[u.status]??0,f=Qx[d.status]??0;if(p>f)n[i][l]=u;else if(f>p)n[i][l]=d;else{const g=u.lastAttempt?new Date(u.lastAttempt).getTime():0,_=d.lastAttempt?new Date(d.lastAttempt).getTime():0;n[i][l]=_>g?d:u}}}}return n}const Zp="ml-interview-progress",kO=2e3,o2=z.createContext(null);function EO({children:t}){const{user:e}=$g(),[n,r]=z.useState(()=>{const _=localStorage.getItem(Zp);return _?JSON.parse(_):{}}),[i,s]=z.useState(!1),o=z.useRef(),a=z.useRef(null);z.useEffect(()=>{localStorage.setItem(Zp,JSON.stringify(n))},[n]),z.useEffect(()=>{const _=(e==null?void 0:e.uid)??null;_&&_!==a.current&&(s(!0),bO(_).then(k=>{r(I=>{const x=k?wO(I,k):I;return Jp(_,x,{displayName:e.displayName,email:e.email,photoURL:e.photoURL}).catch(console.error),x})}).catch(console.error).finally(()=>s(!1))),a.current=_},[e]),z.useEffect(()=>{if(e)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{Jp(e.uid,n,{displayName:e.displayName,email:e.email,photoURL:e.photoURL}).catch(console.error)},kO),()=>{o.current&&clearTimeout(o.current)}},[n,e]);const l=z.useCallback((_,k,I)=>{r(x=>{var v;return{...x,[_]:{...x[_],[k]:{...(v=x[_])==null?void 0:v[k],status:I,lastAttempt:new Date().toISOString()}}}})},[]),u=z.useCallback((_,k,I)=>{r(x=>{var v,w,M;return{...x,[_]:{...x[_],[k]:{...(v=x[_])==null?void 0:v[k],status:((M=(w=x[_])==null?void 0:w[k])==null?void 0:M.status)||"in_progress",code:I,lastAttempt:new Date().toISOString()}}}})},[]),d=z.useCallback((_,k)=>{var x;const I=(x=n[_])==null?void 0:x[k];return{status:(I==null?void 0:I.status)||"not_started",code:I==null?void 0:I.code}},[n]),p=z.useCallback((_,k)=>{const I=n[_];if(!I||k===0)return 0;const x=Object.values(I).filter(v=>v.status==="completed").length;return Math.round(x/k*100)},[n]),f=z.useCallback(_=>{const k=_.reduce((x,v)=>x+v.problemCount,0);if(k===0)return 0;let I=0;for(const x of _){const v=n[x.id];v&&(I+=Object.values(v).filter(w=>w.status==="completed").length)}return Math.round(I/k*100)},[n]),g=z.useCallback(()=>{r({}),localStorage.removeItem(Zp),e&&Jp(e.uid,{},{displayName:e.displayName,email:e.email,photoURL:e.photoURL}).catch(console.error)},[e]);return h.jsx(o2.Provider,{value:{progress:n,isSyncing:i,updateProblemStatus:l,saveProblemCode:u,getProblemProgress:d,getSectionProgress:p,getOverallProgress:f,resetProgress:g},children:t})}function Ol(){const t=z.useContext(o2);if(!t)throw new Error("useProgress must be used within a ProgressProvider");return t}const ei=[{id:"numpy-fundamentals",title:"NumPy Fundamentals",description:"Master NumPy array operations essential for ML development.",icon:"",introduction:"\n# NumPy Fundamentals\n\nNumPy is the backbone of scientific computing in Python. Every ML library builds on it.\n\n## Key Concepts\n\n### Array Creation\n- `np.array()`: Create from lists\n- `np.zeros()`, `np.ones()`: Initialize with values\n- `np.arange()`, `np.linspace()`: Numeric ranges\n- `np.eye()`: Identity matrix\n\n### Indexing & Slicing\n- Basic: `arr[0]`, `arr[1:5]`\n- Advanced: `arr[[0, 2, 4]]`, `arr[arr > 0]`\n- Multi-dimensional: `arr[1, :]`, `arr[:, 2:4]`\n\n### Broadcasting\nArrays of different shapes can be combined:\n- (3, 4) + (4,)  broadcasts to (3, 4)\n- (3, 1) * (1, 4)  broadcasts to (3, 4)\n\n### Aggregations\n- `sum()`, `mean()`, `std()` - with axis parameter\n- `argmax()`, `argmin()` - find indices\n\n### Shape Manipulation\n- `reshape()`: Change dimensions\n- `transpose()`, `.T`: Swap axes\n- `flatten()`, `ravel()`: To 1D\n\nMaster these operations to write efficient ML code!\n    ",problems:["numpy-array-creation","numpy-indexing","numpy-broadcasting","numpy-aggregations","numpy-reshape-transpose"]},{id:"python-basics",title:"Python Basics for ML",description:"Master NumPy arrays and essential Python operations for machine learning.",icon:"",introduction:"\n# Python Basics for Machine Learning\n\nNumPy is the foundation of nearly all machine learning in Python. Before diving into complex algorithms, you need to master array operations.\n\n## Key Concepts\n\n### NumPy Arrays\n- **Creation**: `np.array()`, `np.zeros()`, `np.ones()`, `np.arange()`\n- **Shape manipulation**: `reshape()`, `flatten()`, `transpose()`\n- **Indexing**: Slicing, boolean indexing, fancy indexing\n\n### Essential Operations\n- **Element-wise**: Addition, multiplication, mathematical functions\n- **Aggregations**: `sum()`, `mean()`, `std()`, `min()`, `max()`\n- **Broadcasting**: Automatic expansion of arrays for operations\n\n### Why It Matters\nEvery ML algorithm processes data as arrays. Understanding these operations lets you:\n- Prepare data efficiently\n- Debug model issues\n- Optimize performance\n\nLet's practice with hands-on problems!\n    ",problems:["numpy-array-sum","numpy-matrix-multiply","numpy-broadcast-add"]},{id:"einsum",title:"Einstein Summation (Einsum)",description:"Master einsum for elegant tensor operations.",icon:"",introduction:`
# Einstein Summation (Einsum)

Einsum is a powerful notation for expressing tensor operations concisely.

## Why Einsum?
- Express complex operations in one line
- Often faster than chained operations
- Essential for attention mechanisms

## Syntax
\`\`\`python
np.einsum('subscripts', operands)
\`\`\`

## Common Patterns

### Basic Operations
\`\`\`
'ij->'      Sum all elements
'ij->i'     Sum along axis 1 (row sums)
'ij->j'     Sum along axis 0 (column sums)
'ij->ji'    Transpose
'ii->i'     Extract diagonal
'ii->'      Trace (sum of diagonal)
\`\`\`

### Matrix Operations
\`\`\`
'ik,kj->ij'   Matrix multiplication (A @ B)
'ij,ij->ij'   Element-wise product (A * B)
'ij,ij->'     Frobenius inner product
'i,j->ij'     Outer product
'i,i->'       Dot product
\`\`\`

### Batch Operations
\`\`\`
'bij,bjk->bik'   Batch matrix multiply
'bqd,bkd->bqk'   Attention scores (Q @ K.T)
'bhqk,bhkd->bhqd' Multi-head attention output
\`\`\`

## Key Insight
Letters that appear on both sides are kept.
Letters that disappear are summed over (contracted).

Master einsum to write clean, efficient deep learning code!
    `,problems:["einsum-basics","einsum-matrix-ops","einsum-batch-ops","einsum-advanced","einsum-vs-matmul"]},{id:"pytorch-basics",title:"PyTorch Basics",description:"Learn PyTorch patterns implemented in NumPy.",icon:"",introduction:`
# PyTorch Basics

Learn PyTorch patterns and concepts. Since Pyodide doesn't support PyTorch, we implement these concepts in NumPy.

## Tensor Operations

### Creation
\`\`\`python
# PyTorch           # NumPy equivalent
torch.tensor()      np.array()
torch.zeros()       np.zeros()
torch.randn()       np.random.randn()
\`\`\`

### Operations
\`\`\`python
# PyTorch           # NumPy equivalent
x + y               x + y
x @ y               x @ y
x.sum(dim=1)        x.sum(axis=1)
x.view(2, -1)       x.reshape(2, -1)
\`\`\`

## Autograd Concepts

PyTorch tracks operations for automatic differentiation:
\`\`\`python
x = torch.tensor([2.0], requires_grad=True)
y = x ** 2
y.backward()  # dy/dx = 2x = 4
\`\`\`

We implement this manually to understand the math.

## Module Pattern
\`\`\`python
class Linear(nn.Module):
    def __init__(self, in_features, out_features):
        self.weight = Parameter(...)
        self.bias = Parameter(...)

    def forward(self, x):
        return x @ self.weight + self.bias
\`\`\`

## Loss Functions
- CrossEntropyLoss: Classification
- MSELoss: Regression
- BCELoss: Binary classification

Learn these patterns to understand PyTorch!
    `,problems:["tensor-creation","tensor-operations","autograd-concepts","nn-modules","loss-functions"]},{id:"data-preprocessing",title:"Data Preprocessing",description:"Learn essential data cleaning and transformation techniques.",icon:"",introduction:`
# Data Preprocessing

Real-world data is messy. Before training any model, you need to clean and transform your data.

## Key Concepts

### Handling Missing Data
- **Detection**: \`np.isnan()\`, \`pd.isnull()\`
- **Strategies**: Remove, fill with mean/median/mode, interpolate

### Feature Scaling
- **Normalization**: Scale to [0, 1] range using min-max scaling
- **Standardization**: Transform to zero mean, unit variance (z-score)
- **When to use**: Most algorithms need scaled features

### Encoding Categorical Data
- **One-Hot Encoding**: Convert categories to binary vectors
- **Label Encoding**: Map categories to integers
- **When to use**: Tree-based models handle label encoding; others need one-hot

### Why It Matters
Garbage in, garbage out. Proper preprocessing can:
- Improve model accuracy by 10-30%
- Prevent training failures
- Reduce overfitting

Let's practice these essential skills!
    `,problems:["normalize-features","handle-missing-data","one-hot-encode"]},{id:"supervised-learning",title:"Supervised Learning",description:"Implement core supervised learning algorithms from scratch.",icon:"",introduction:`
# Supervised Learning

Supervised learning is when you train a model on labeled data to make predictions.

## Key Concepts

### Linear Regression
- **Goal**: Predict continuous values
- **Formula**: y = wx + b
- **Training**: Minimize mean squared error (MSE)
- **Gradient descent**: Update weights iteratively

### Logistic Regression
- **Goal**: Binary classification
- **Sigmoid function**: Maps outputs to [0, 1] probabilities
- **Loss**: Binary cross-entropy
- **Decision boundary**: Linear separation of classes

### Decision Trees
- **Concept**: Recursive binary splits based on features
- **Splitting criteria**: Gini impurity, Information gain
- **Advantages**: Interpretable, handles non-linear relationships

### Support Vector Machines (SVMs)
- **Goal**: Find the maximum-margin hyperplane
- **Hinge loss**: max(0, 1 - y * score)  penalizes misclassified and low-margin samples
- **Regularization**: L2 penalty on weights to maximize margin
- **Key insight**: Only "support vectors" (points near the boundary) affect the decision boundary

### The Interview Perspective
Interviewers often ask you to:
- Implement gradient descent from scratch
- Explain the math behind these algorithms
- Compute and interpret hinge loss
- Discuss trade-offs between algorithms

Let's build these algorithms!
    `,problems:["logistic-regression","binary-cross-entropy","hinge-loss","decision-tree-split","linear-regression-gd","logistic-regression-full","linear-svm"]},{id:"unsupervised-learning",title:"Unsupervised Learning",description:"Implement clustering and dimensionality reduction algorithms.",icon:"",introduction:`
# Unsupervised Learning

Unsupervised learning finds patterns in unlabeled data.

## Key Concepts

### K-Means Clustering
- **Goal**: Group data into K clusters
- **Algorithm**:
  1. Initialize K centroids randomly
  2. Assign points to nearest centroid
  3. Update centroids as cluster means
  4. Repeat until convergence

### Principal Component Analysis (PCA)
- **Goal**: Reduce dimensionality while preserving variance
- **Steps**:
  1. Center the data (subtract mean)
  2. Compute covariance matrix
  3. Find eigenvectors/eigenvalues
  4. Project onto top components

### Why These Matter
- **K-Means**: Customer segmentation, image compression
- **PCA**: Feature reduction, visualization, noise removal

### Interview Tips
- Be ready to implement K-means from scratch
- Explain variance explained by components
- Discuss limitations (K-means assumes spherical clusters)

Let's implement these algorithms!
    `,problems:["kmeans-clustering","pca-implementation"]},{id:"model-evaluation",title:"Model Evaluation",description:"Learn metrics and techniques to evaluate ML models properly.",icon:"",introduction:`
# Model Evaluation

Building a model is only half the job. You need to evaluate it properly.

## Key Concepts

### Classification Metrics
- **Accuracy**: Correct / Total (can be misleading!)
- **Precision**: TP / (TP + FP) - "Of positive predictions, how many correct?"
- **Recall**: TP / (TP + FN) - "Of actual positives, how many found?"
- **F1 Score**: Harmonic mean of precision and recall

### Regression Metrics
- **MSE**: Mean Squared Error
- **RMSE**: Root MSE (same units as target)
- **MAE**: Mean Absolute Error (robust to outliers)
- **R**: Proportion of variance explained

### Cross-Validation
- **Why**: Single train/test split is unreliable
- **K-Fold**: Split data into K parts, rotate test set
- **Stratified**: Maintain class distribution in folds

### Interview Essentials
- Know when to use each metric
- Implement cross-validation from scratch
- Discuss precision-recall trade-offs

Let's practice evaluation!
    `,problems:["precision-recall-f1","cross-validation","confusion-matrix"]},{id:"deep-learning",title:"Deep Learning Basics",description:"Activation functions and fundamental building blocks.",icon:"",introduction:`
# Deep Learning Basics

Core building blocks that appear in every neural network.

## Key Concepts

### Activation Functions
- **ReLU**: max(0, x) - Most common, avoids vanishing gradient
- **Sigmoid**: 1/(1+e^-x) - Output in [0,1], used for binary classification
- **Softmax**: Converts logits to probabilities that sum to 1
- **Tanh**: Output in [-1, 1], zero-centered

### When to Use Each
- **Hidden layers**: ReLU (or variants like LeakyReLU)
- **Binary output**: Sigmoid
- **Multi-class output**: Softmax
- **RNNs**: Tanh (historically)

### Dense Layers
- **Forward pass**: output = activation(W @ x + b)
- **Parameters**: Weights W and biases b
- **Computation**: Matrix multiplication + bias + activation

Let's implement these fundamentals!
    `,problems:["perceptron","neural-network-forward","backpropagation"]},{id:"neural-networks",title:"Neural Networks",description:"Build neural networks from scratch with forward and backward passes.",icon:"",introduction:`
# Neural Networks

Neural networks are the foundation of deep learning. Understanding the math behind them is essential for ML interviews.

## Key Concepts

### Multi-Layer Perceptron (MLP)
- **Architecture**: Input  Hidden layers  Output
- **Forward pass**: Compute activations layer by layer
- **Activation functions**: ReLU, Sigmoid, Tanh, Softmax

### Backpropagation
- **Chain rule**: Compute gradients layer by layer
- **Weight updates**: Gradient descent on all parameters
- **Key insight**: Errors propagate backwards through the network

### Training Techniques
- **Weight Initialization**: Xavier, He initialization
- **Batch Normalization**: Normalize activations for stable training
- **Dropout**: Randomly drop neurons to prevent overfitting

### Loss Functions
- **Cross-entropy**: For classification
- **MSE**: For regression

### Common Interview Topics
- Implement forward/backward pass from scratch
- Explain vanishing/exploding gradients
- Discuss initialization strategies
- Implement regularization techniques

Let's build neural networks from scratch!
    `,problems:["cross-entropy-loss","mlp-forward-backward","weight-init","batch-norm","dropout"]},{id:"cnn",title:"Convolutional Neural Networks",description:"Understand convolutions, pooling, and CNN architectures.",icon:"",introduction:`
# Convolutional Neural Networks (CNNs)

CNNs are the backbone of computer vision. They learn hierarchical features from images.

## Key Concepts

### Convolution Operation
- **Kernel/Filter**: Small matrix that slides over input
- **Feature maps**: Output of applying filters
- **Parameters**: Stride, padding, kernel size

### Pooling Layers
- **Max pooling**: Take maximum in each region
- **Average pooling**: Take average in each region
- **Purpose**: Reduce spatial dimensions, add translation invariance

### CNN Architecture Components
1. **Convolutional layers**: Extract features
2. **Pooling layers**: Reduce dimensions
3. **Flatten**: Convert 2D to 1D
4. **Fully connected**: Classification

### Output Size Formula
\`\`\`
output = (input - kernel + 2*padding) / stride + 1
\`\`\`

### Classic Architectures
- **LeNet**: First successful CNN
- **AlexNet**: Deep CNNs for ImageNet
- **VGG**: Very deep, small kernels
- **ResNet**: Skip connections

### Object Detection
- **IoU (Intersection over Union)**: Measures overlap between predicted and ground truth boxes
- **Non-Maximum Suppression (NMS)**: Filters redundant detections by keeping only the highest-scoring box per object
- **Focal Loss**: Addresses class imbalance by down-weighting easy examples (RetinaNet)
- **Smooth L1 Loss**: Bounding box regression loss  less sensitive to outliers than L2

### Image Segmentation
- **Pixel-level classification**: Assign a label to every pixel
- **Evaluation metrics**: IoU (Jaccard), Dice Coefficient, Pixel Accuracy
- **Key architectures**: U-Net, FCN, Mask R-CNN

Let's implement CNN operations and detection/segmentation fundamentals!
    `,problems:["conv-output-size","conv2d-forward","max-pool","flatten-layer","conv2d-advanced","iou-bounding-box","nms","focal-loss","smooth-l1-loss","seg-metrics"]},{id:"transformers",title:"Attention & Transformers",description:"Master attention mechanisms and transformer architecture.",icon:"",introduction:`
# Attention and Transformers

Transformers have revolutionized NLP and are now used in vision, speech, and more.

## Key Concepts

### Self-Attention
- **Query, Key, Value**: Three projections of input
- **Attention scores**: Q @ K.T / sqrt(d_k)
- **Output**: Weighted sum of values

### Scaled Dot-Product Attention
\`\`\`
Attention(Q, K, V) = softmax(Q @ K.T / sqrt(d_k)) @ V
\`\`\`

### Multi-Head Attention
- **Multiple heads**: Parallel attention with different projections
- **Concatenate**: Combine all head outputs
- **Project**: Linear transformation back to model dimension

### Transformer Components
- **Positional Encoding**: Inject position information
- **Layer Normalization**: Normalize across features
- **Feed-Forward Network**: MLP after attention
- **Residual Connections**: Add input to output

### Causal Masking
- **Purpose**: Prevent attending to future tokens
- **Implementation**: Add -inf to upper triangle before softmax

### Modern LLM Architecture
- **BPE Tokenization**: Subword tokenization used by GPT, LLaMA, and most LLMs
- **Rotary Positional Embeddings (RoPE)**: Encodes relative positions via rotation, replacing sinusoidal
- **Grouped Query Attention (GQA)**: Shares KV heads across query head groups for efficient inference
- **Sliding Window Attention**: Local attention pattern for efficient long-context processing

### Interview Essentials
- Implement scaled dot-product attention
- Explain why we scale by sqrt(d_k)
- Multi-head attention benefits
- Positional encoding purpose
- BPE tokenization algorithm
- RoPE vs sinusoidal positional encoding
- GQA/MQA for efficient inference

Let's build transformers from scratch!
    `,problems:["scaled-dot-product-attention","multi-head-attention","positional-encoding","layer-norm","causal-mask","bpe-tokenization","rope-embeddings","grouped-query-attention","sliding-window-attention"]},{id:"generative-models",title:"Generative Models",description:"Learn VAEs, diffusion models, and generative AI fundamentals.",icon:"",introduction:`
# Generative Models

Generative models learn to create new data similar to the training distribution.

## Key Concepts

### Variational Autoencoders (VAEs)
- **Encoder**: Maps input to latent distribution (, )
- **Decoder**: Reconstructs input from latent sample
- **Reparameterization trick**: Enable backprop through sampling
- **Loss**: Reconstruction + KL divergence

### VAE Loss (ELBO)
\`\`\`
L = Reconstruction Loss + KL Divergence
L = ||x - x_reconstructed|| + KL(q(z|x) || p(z))
\`\`\`

### Diffusion Models
- **Forward process**: Gradually add noise to data
- **Reverse process**: Learn to denoise
- **Noise schedule**: _t controls noise at each step

### Key Formulas
\`\`\`
x_t = sqrt(_bar_t) * x_0 + sqrt(1 - _bar_t) * 
\`\`\`

### KL Divergence
- Measures difference between distributions
- KL(P || Q)  0, equals 0 iff P = Q
- Not symmetric

### Interview Topics
- Explain reparameterization trick
- VAE loss components
- Diffusion forward/reverse process
- Compare GANs vs VAEs vs Diffusion

Let's implement generative models!
    `,problems:["kl-divergence","vae-reparameterization","vae-loss","vqvae-quantization","diffusion-noise-schedule","diffusion-forward"]},{id:"llm-generation",title:"LLM Generation & Decoding",description:"Master decoding strategies: temperature, sampling, KV cache, beam search, and speculative decoding.",icon:"",introduction:`
# LLM Generation & Decoding

Understanding how LLMs generate text is critical for ML interviews and production deployment. This section covers the decoding pipeline from raw logits to output tokens.

## The Autoregressive Pipeline

LLMs generate text one token at a time:
\`\`\`
logits = model(input_tokens)        # Raw scores for each vocab token
probs = softmax(logits / temperature)  # Convert to probabilities
next_token = sample(probs)          # Pick a token
\`\`\`

## Key Concepts

### Temperature Scaling
Controls randomness by scaling logits before softmax:
\`\`\`
scaled_logits = logits / T
\`\`\`
- T < 1: More deterministic (sharper distribution)
- T > 1: More random (flatter distribution)
- T  0: Greedy decoding (always pick most likely)

### Sampling Strategies

| Strategy | How It Works | When to Use |
|----------|-------------|-------------|
| **Top-k** | Keep only the k most likely tokens | Simple, predictable filtering |
| **Top-p (Nucleus)** | Keep smallest set with cumulative prob  p | Adaptive, works across distributions |
| **Repetition Penalty** | Reduce probability of already-generated tokens | Prevent loops and repetition |

### KV Cache
The key optimization for efficient autoregressive generation:
- Cache Key and Value projections from previous tokens
- Only compute Q, K, V for the **new** token at each step
- Reduces per-token cost from O(n) to O(n)

### Beam Search
Maintain multiple candidate sequences:
\`\`\`
score(sequence) = sum(log P(token_i))
\`\`\`
- Explores multiple paths simultaneously
- Finds higher-probability sequences than greedy decoding
- Used in translation, summarization, and structured output

### Speculative Decoding
Use a small "draft" model to propose tokens, verified by the large model:
1. Draft model generates K tokens quickly
2. Target model verifies all K in one forward pass
3. Accept with probability min(1, p_target / p_draft)
- Mathematically guarantees target model distribution
- 2-3x speedup in practice

## Interview Essentials
- Explain temperature scaling and its effect on output diversity
- Compare top-k vs top-p sampling trade-offs
- Describe how KV cache reduces inference cost
- Implement beam search with length normalization
- Explain why speculative decoding preserves the target distribution

Let's implement these essential LLM techniques!
    `,problems:["llm-temperature-scaling","llm-top-k-sampling","llm-top-p-sampling","llm-repetition-penalty","llm-kv-cache","llm-beam-search","llm-speculative-decoding"]},{id:"reinforcement-learning",title:"Reinforcement Learning",description:"Master RL fundamentals from Q-learning to policy gradients.",icon:"",introduction:`
# Reinforcement Learning

Reinforcement learning (RL) trains agents to make decisions by learning from rewards and punishments through trial and error.

## Key Concepts

### The RL Framework
- **Agent**: The learner/decision-maker
- **Environment**: What the agent interacts with
- **State (s)**: Current situation
- **Action (a)**: What the agent can do
- **Reward (r)**: Feedback signal
- **Policy ()**: Strategy for choosing actions

### Value Functions
- **State Value V(s)**: Expected return starting from state s
- **Action Value Q(s,a)**: Expected return taking action a in state s

### Bellman Equations
\`\`\`python
V(s) = E[r +  * V(s')]
Q(s,a) = E[r +  * max_a' Q(s',a')]
\`\`\`

### Key Algorithms

| Algorithm | Type | Policy |
|-----------|------|--------|
| Q-Learning | Value-based | Off-policy |
| SARSA | Value-based | On-policy |
| REINFORCE | Policy-based | On-policy |
| Actor-Critic | Hybrid | On-policy |
| PPO | Policy-based | On-policy |

### Exploration vs Exploitation
- **Exploration**: Try new actions to discover better strategies
- **Exploitation**: Use known good actions to maximize reward
- **-greedy**: Simple balance (random with probability )

### RL for LLMs (RLHF)
- **Reward Modeling**: Learn preferences from human feedback
- **PPO for LLMs**: Fine-tune with KL constraints
- **DPO**: Direct preference optimization without reward model

### Interview Essentials
- Implement Q-learning and SARSA from scratch
- Explain on-policy vs off-policy
- Understand policy gradients and REINFORCE
- Know GAE and PPO for modern deep RL
- **RLHF**: Reward modeling, KL penalties, DPO

Master these concepts for ML interviews at top companies!
    `,problems:["rl-discounted-return","rl-epsilon-greedy","rl-bellman-value","rl-q-learning-update","rl-sarsa-update","rl-td0-prediction","rl-value-iteration","rl-n-step-return","rl-policy-gradient","rl-advantage-estimation","rl-ppo-clip","rl-reward-modeling","rl-dpo-loss","rl-kl-penalty","rl-ppo-llm-objective"]},{id:"e2e-implementations",title:"End-to-End Implementations",description:"Build complete ML models from scratch.",icon:"",introduction:`
# End-to-End Implementations

Put everything together to build complete models from scratch.

## Why Build From Scratch?

1. **Deep Understanding**: Know every component
2. **Interview Preparation**: Common coding questions
3. **Debugging Skills**: Understand what can go wrong
4. **Framework Independence**: Adapt to any library

## Models Covered

### 2-Layer MLP with Backprop
Complete neural network with:
- Forward pass through hidden layer
- Backpropagation of gradients
- Weight updates via gradient descent

### Transformer Encoder
Full encoder block with:
- Multi-head self-attention
- Positional encoding
- Layer normalization
- Feed-forward network
- Residual connections

### Variational Autoencoder (VAE)
Generative model with:
- Encoder  latent distribution
- Reparameterization trick
- Decoder  reconstruction
- ELBO loss (reconstruction + KL)

### Diffusion Model
DDPM-style diffusion with:
- Noise schedule (, , )
- Forward diffusion process
- Reverse denoising process
- Training objective

### Convolutional Neural Network
Image classifier with:
- Conv2D layers
- Max pooling
- Flatten + FC layers
- Full forward pass

Build these models to truly understand deep learning!
    `,problems:["e2e-mlp","e2e-transformer","e2e-vae","e2e-vqvae","e2e-diffusion","e2e-cnn"]}];function TO({isOpen:t,onClose:e}){const[n,r]=z.useState(""),[i,s]=z.useState(""),[o,a]=z.useState(!1),[l,u]=z.useState(!1),[d,p]=z.useState("");if(!t)return null;const f=async _=>{_.preventDefault(),a(!0),p("");try{(await fetch("https://formspree.io/f/mpqqwpav",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,feedback:i,_subject:`ML Grind Feedback from ${n}`})})).ok?(u(!0),r(""),s("")):p("Failed to send feedback. Please try again.")}catch{p("Failed to send feedback. Please try again.")}finally{a(!1)}},g=()=>{u(!1),p(""),e()};return h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:g}),h.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-md mx-4 p-6",children:[h.jsx("button",{onClick:g,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),h.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Send Feedback"}),l?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),h.jsx("p",{className:"text-gray-700 mb-4",children:"Thank you for your feedback!"}),h.jsx("button",{onClick:g,className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors",children:"Close"})]}):h.jsxs("form",{onSubmit:f,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),h.jsx("input",{type:"text",id:"name",value:n,onChange:_=>r(_.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Your name"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"feedback",className:"block text-sm font-medium text-gray-700 mb-1",children:"Feedback"}),h.jsx("textarea",{id:"feedback",value:i,onChange:_=>s(_.target.value),required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"Share your thoughts, suggestions, or report issues..."})]}),d&&h.jsx("p",{className:"text-red-600 text-sm",children:d}),h.jsxs("div",{className:"flex gap-3 justify-end",children:[h.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),h.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?"Sending...":"Send Feedback"})]})]})]})]})}function Kg(){const[t,e]=z.useState(()=>{const r=localStorage.getItem("ml-lab-dark-mode");return r!==null?r==="true":!0});return z.useEffect(()=>{const r=document.documentElement;t?r.classList.add("dark"):r.classList.remove("dark"),localStorage.setItem("ml-lab-dark-mode",String(t))},[t]),{isDark:t,toggle:()=>e(r=>!r)}}function SO(){var o,a;const{user:t,signInWithGoogle:e,signOut:n}=$g(),[r,i]=z.useState(!1),s=z.useRef(null);return z.useEffect(()=>{function l(u){s.current&&!s.current.contains(u.target)&&i(!1)}return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),Vd?t?h.jsxs("div",{className:"relative hidden lg:block",ref:s,children:[h.jsx("button",{onClick:()=>i(!r),className:"w-8 h-8 rounded-full overflow-hidden border-2 border-transparent hover:border-primary-400 transition-colors",children:t.photoURL?h.jsx("img",{src:t.photoURL,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):h.jsx("div",{className:"w-full h-full bg-primary-500 flex items-center justify-center text-white text-sm font-medium",children:((o=t.displayName)==null?void 0:o[0])??((a=t.email)==null?void 0:a[0])??"?"})}),r&&h.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-dark-800 border border-gray-200 dark:border-dark-500 rounded-lg shadow-lg py-2 z-50",children:[h.jsxs("div",{className:"px-4 py-2 border-b border-gray-100 dark:border-dark-600",children:[h.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-dark-100 truncate",children:t.displayName}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-dark-300 truncate",children:t.email})]}),h.jsx("button",{onClick:()=>{n(),i(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-dark-200 hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:"Sign Out"})]})]}):h.jsxs("button",{onClick:e,className:"hidden lg:flex px-3 py-1.5 text-gray-600 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-100 dark:hover:bg-dark-800 hover:text-gray-900 dark:hover:text-dark-100 border border-transparent hover:border-gray-200 dark:hover:border-dark-500 transition-all items-center gap-2",children:[h.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M12.545 10.239v3.821h5.445c-.712 2.315-2.647 3.972-5.445 3.972a6.033 6.033 0 110-12.064c1.498 0 2.866.549 3.921 1.453l2.814-2.814A9.969 9.969 0 0012.545 2C7.021 2 2.543 6.477 2.543 12s4.478 10 10.002 10c8.396 0 10.249-7.85 9.426-11.748l-9.426-.013z"})}),"Sign In"]}):null}function CO({onMenuToggle:t}){const{getOverallProgress:e}=Ol(),[n,r]=z.useState(!1),{isDark:i,toggle:s}=Kg(),o=ei.map(l=>({id:l.id,problemCount:l.problems.length})),a=e(o);return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:"bg-white/80 dark:bg-dark-900/80 backdrop-blur-xl backdrop-saturate-[1.2] border-b border-gray-200 dark:border-dark-500 sticky top-0 z-50",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"flex items-center justify-between h-16",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[t&&h.jsx("button",{onClick:t,className:"lg:hidden p-2 -ml-2 text-gray-600 dark:text-dark-200 hover:text-gray-900 dark:hover:text-dark-100 hover:bg-gray-100 dark:hover:bg-dark-600 rounded-lg transition-colors","aria-label":"Toggle menu",children:h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),h.jsxs(Ft,{to:"/",className:"flex items-center gap-3",children:[h.jsxs("svg",{className:"w-8 h-8 shrink-0",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("rect",{width:"32",height:"32",rx:"8",fill:"#6c5ce7"}),h.jsx("line",{x1:"10",y1:"8.5",x2:"22",y2:"16",stroke:"white",strokeWidth:"1.8",opacity:"0.4",strokeLinecap:"round"}),h.jsx("line",{x1:"10",y1:"16",x2:"22",y2:"16",stroke:"white",strokeWidth:"1.8",opacity:"0.4",strokeLinecap:"round"}),h.jsx("line",{x1:"10",y1:"23.5",x2:"22",y2:"16",stroke:"white",strokeWidth:"1.8",opacity:"0.4",strokeLinecap:"round"}),h.jsx("circle",{cx:"10",cy:"8.5",r:"2.8",fill:"white",fillOpacity:"0.9"}),h.jsx("circle",{cx:"10",cy:"16",r:"2.8",fill:"white",fillOpacity:"0.9"}),h.jsx("circle",{cx:"10",cy:"23.5",r:"2.8",fill:"white",fillOpacity:"0.9"}),h.jsx("circle",{cx:"22",cy:"16",r:"3.5",fill:"white"})]}),h.jsxs("span",{className:"text-lg font-extrabold tracking-tight whitespace-nowrap",children:[h.jsx("span",{className:"text-primary-500",children:"ML"}),h.jsx("span",{className:"text-gray-900 dark:text-dark-100",children:" Grind"})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Ft,{to:"/scratchpad",className:"hidden lg:flex px-3 py-1.5 text-gray-600 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-100 dark:hover:bg-dark-800 hover:text-gray-900 dark:hover:text-dark-100 border border-transparent hover:border-gray-200 dark:hover:border-dark-500 transition-all items-center gap-2",children:[h.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scratchpad"]}),h.jsxs("a",{href:"/ml-cheatsheet.html",target:"_blank",rel:"noopener noreferrer",className:"hidden lg:flex px-3 py-1.5 text-primary-400 dark:text-primary-300 text-sm font-medium rounded-lg bg-primary-50 dark:bg-primary-500/10 border border-primary-200 dark:border-primary-500/20 hover:bg-primary-100 dark:hover:bg-primary-500/20 hover:border-primary-300 dark:hover:border-primary-500/30 transition-all items-center gap-2",children:[h.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Cheat Sheet"]}),h.jsxs("button",{onClick:()=>r(!0),className:"hidden lg:flex px-3 py-1.5 text-gray-500 dark:text-dark-200 text-sm font-medium hover:text-gray-700 dark:hover:text-dark-100 transition-colors items-center gap-1",children:[h.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Feedback"]}),h.jsx("button",{onClick:s,className:"p-2 text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 hover:bg-gray-100 dark:hover:bg-dark-600 rounded-lg transition-colors","aria-label":"Toggle dark mode",children:i?h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):h.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),h.jsx(SO,{}),h.jsxs("div",{className:"hidden xl:flex items-center gap-2.5 px-3.5 py-1.5 rounded-full bg-gray-100 dark:bg-dark-800 border border-gray-200 dark:border-dark-500 text-xs",children:[h.jsx("div",{className:"w-20 h-1 bg-gray-200 dark:bg-dark-500 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full progress-gradient rounded-full transition-all duration-500",style:{width:`${a}%`}})}),h.jsxs("span",{className:"font-mono font-semibold text-primary-600 dark:text-primary-300",children:[a,"%"]})]})]})]})})}),h.jsx(TO,{isOpen:n,onClose:()=>r(!1)})]})}function Gx({onNavigate:t}){var s,o;const{getSectionProgress:e}=Ol(),{user:n,signInWithGoogle:r,signOut:i}=$g();return h.jsxs("aside",{className:"w-64 bg-white dark:bg-dark-800/50 border-r border-gray-200 dark:border-dark-500 min-h-[calc(100vh-4rem)] p-4 flex flex-col",children:[h.jsxs("nav",{className:"space-y-1 flex-1",children:[h.jsx("h3",{className:"text-dark-300 dark:text-dark-300 text-[11px] font-semibold uppercase tracking-widest mb-4 px-3 font-mono",children:"Curriculum"}),ei.map((a,l)=>{const u=e(a.id,a.problems.length);return h.jsxs(CA,{to:`/section/${a.id}`,onClick:t,className:({isActive:d})=>`flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all ${d?"bg-primary-50 dark:bg-primary-500/10 text-primary-700 dark:text-primary-300 border border-primary-200 dark:border-primary-500/20":"text-gray-700 dark:text-dark-200 hover:bg-gray-100 dark:hover:bg-dark-600 hover:text-gray-900 dark:hover:text-dark-100 border border-transparent"}`,children:[h.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-lg",children:a.icon}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-dark-300 text-[10px] font-mono",children:String(l+1).padStart(2,"0")}),h.jsx("span",{className:"text-sm font-medium truncate",children:a.title})]}),h.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[h.jsx("div",{className:"flex-1 h-0.5 bg-gray-200 dark:bg-dark-500 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full progress-gradient rounded-full transition-all duration-300",style:{width:`${u}%`}})}),h.jsxs("span",{className:"text-[10px] text-dark-300 font-mono",children:[u,"%"]})]})]})]},a.id)})]}),Vd&&h.jsx("div",{className:"lg:hidden border-t border-gray-200 dark:border-dark-500 pt-4 mt-4",children:n?h.jsxs("div",{className:"flex items-center gap-3 px-3",children:[n.photoURL?h.jsx("img",{src:n.photoURL,alt:"",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):h.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white text-sm font-medium",children:((s=n.displayName)==null?void 0:s[0])??((o=n.email)==null?void 0:o[0])??"?"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-dark-100 truncate",children:n.displayName}),h.jsx("button",{onClick:()=>{i(),t==null||t()},className:"text-xs text-gray-500 dark:text-dark-300 hover:text-gray-700 dark:hover:text-dark-100",children:"Sign Out"})]})]}):h.jsxs("button",{onClick:()=>{r(),t==null||t()},className:"flex items-center gap-2 px-3 py-2.5 w-full text-sm font-medium text-gray-700 dark:text-dark-200 hover:bg-gray-100 dark:hover:bg-dark-600 rounded-lg transition-colors",children:[h.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M12.545 10.239v3.821h5.445c-.712 2.315-2.647 3.972-5.445 3.972a6.033 6.033 0 110-12.064c1.498 0 2.866.549 3.921 1.453l2.814-2.814A9.969 9.969 0 0012.545 2C7.021 2 2.543 6.477 2.543 12s4.478 10 10.002 10c8.396 0 10.249-7.85 9.426-11.748l-9.426-.013z"})}),"Sign In with Google"]})})]})}function IO(){const t=new Date().getFullYear();return h.jsx("footer",{className:"border-t border-gray-200 dark:border-dark-500 mt-auto",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[h.jsxs("div",{className:"text-gray-500 dark:text-dark-300 text-xs",children:[" ",t," Siddharth Choudhary. All rights reserved."]}),h.jsxs("div",{className:"flex items-center gap-6 text-xs",children:[h.jsx(Ft,{to:"/terms",className:"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 transition-colors",children:"Terms"}),h.jsx(Ft,{to:"/privacy",className:"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 transition-colors",children:"Privacy"}),h.jsxs("a",{href:"https://github.com/mlgrind/mlgrind.github.io",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 transition-colors flex items-center gap-1",children:[h.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"})}),"GitHub"]})]})]}),h.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-dark-500/50 text-center text-xs text-gray-400 dark:text-dark-300",children:h.jsx("p",{children:"Code licensed under MIT. Educational content is copyrighted."})})]})})}function AO({children:t}){const[e,n]=z.useState(!1);return h.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-900 flex flex-col",children:[h.jsx("div",{className:"bg-mesh"}),h.jsx("div",{className:"bg-noise"}),h.jsxs("div",{className:"relative z-[1] flex flex-col min-h-screen",children:[h.jsx(CO,{onMenuToggle:()=>n(!e)}),h.jsxs("div",{className:"flex flex-1",children:[h.jsx("div",{className:"hidden lg:block",children:h.jsx(Gx,{})}),e&&h.jsxs("div",{className:"fixed inset-0 z-40 lg:hidden",children:[h.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>n(!1)}),h.jsx("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-dark-800 shadow-xl overflow-y-auto border-r border-gray-200 dark:border-dark-500",children:h.jsx("div",{className:"pt-2",children:h.jsx(Gx,{onNavigate:()=>n(!1)})})})]}),h.jsx("main",{className:"flex-1 p-6",children:t})]}),h.jsx(IO,{})]})]})}const Yx="https://mlgrind.github.io",PO="ML Grind - Learn Machine Learning by Building",RO="Practice hands-on machine learning coding problems. Implement NumPy, neural networks, CNNs, transformers, and more. Run Python code directly in your browser with instant feedback.",NO="machine learning, ML, deep learning, neural networks, Python, NumPy, transformers, CNN, PyTorch, coding practice, interview prep, AI";function Oo({title:t,description:e=RO,keywords:n=NO,canonical:r,type:i="website"}){const s=t?`${t} | ML Grind`:PO,o=r?`${Yx}${r}`:Yx;return h.jsxs(sP,{children:[h.jsx("title",{children:s}),h.jsx("meta",{name:"title",content:s}),h.jsx("meta",{name:"description",content:e}),h.jsx("meta",{name:"keywords",content:n}),h.jsx("link",{rel:"canonical",href:o}),h.jsx("meta",{property:"og:type",content:i}),h.jsx("meta",{property:"og:url",content:o}),h.jsx("meta",{property:"og:title",content:s}),h.jsx("meta",{property:"og:description",content:e}),h.jsx("meta",{property:"twitter:url",content:o}),h.jsx("meta",{property:"twitter:title",content:s}),h.jsx("meta",{property:"twitter:description",content:e})]})}function LO(){const{getSectionProgress:t,getOverallProgress:e}=Ol(),n=ei.map(s=>({id:s.id,problemCount:s.problems.length})),r=e(n),i=z.useMemo(()=>ei.reduce((s,o)=>s+o.problems.length,0),[]);return h.jsxs("div",{className:"max-w-[1200px] mx-auto",children:[h.jsx(Oo,{canonical:"/"}),h.jsxs("div",{className:"text-center mb-16 pt-8",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-white dark:bg-dark-800 border border-gray-200 dark:border-dark-500 rounded-full text-sm text-gray-600 dark:text-dark-200 mb-8 animate-fade-up",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-accent-500 animate-pulse-dot"}),"100% browser-based  No setup required"]}),h.jsxs("h1",{className:"font-display text-[clamp(2.5rem,6vw,4.2rem)] font-normal leading-[1.1] tracking-tight text-gray-900 dark:text-dark-100 mb-6 animate-fade-up [animation-delay:0.1s]",children:["Learn Machine Learning",h.jsx("br",{}),"by ",h.jsx("em",{className:"text-primary-400 dark:text-primary-300",children:"Building"})]}),h.jsx("p",{className:"text-lg text-gray-500 dark:text-dark-200 max-w-[560px] mx-auto mb-10 font-light leading-relaxed animate-fade-up [animation-delay:0.2s]",children:"Implement algorithms from scratch  NumPy, neural networks, transformers, diffusion models. Write real Python with instant feedback, directly in your browser."}),h.jsxs("div",{className:"flex justify-center gap-12 animate-fade-up [animation-delay:0.3s]",children:[h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"font-mono text-2xl font-bold text-gray-900 dark:text-dark-100",children:[i,"+"]}),h.jsx("div",{className:"text-[11px] text-gray-400 dark:text-dark-300 uppercase tracking-widest mt-1",children:"Problems"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"font-mono text-2xl font-bold text-gray-900 dark:text-dark-100",children:ei.length}),h.jsx("div",{className:"text-[11px] text-gray-400 dark:text-dark-300 uppercase tracking-widest mt-1",children:"Sections"})]}),h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"font-mono text-2xl font-bold text-gray-900 dark:text-dark-100",children:[r,"%"]}),h.jsx("div",{className:"text-[11px] text-gray-400 dark:text-dark-300 uppercase tracking-widest mt-1",children:"Complete"})]})]})]}),h.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-gray-400 dark:text-dark-300 mb-6 font-mono",children:"Curriculum"}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ei.map((s,o)=>{const a=t(s.id,s.problems.length);return h.jsxs(Ft,{to:`/section/${s.id}`,className:"card-stagger animate-fade-up group relative flex gap-4 p-5 bg-white dark:bg-dark-800 rounded-[14px] border border-gray-200 dark:border-dark-500 hover:border-gray-300 dark:hover:border-dark-400 hover:bg-gray-50 dark:hover:bg-dark-700 hover:-translate-y-0.5 hover:shadow-lg dark:hover:shadow-[0_8px_32px_rgba(0,0,0,0.2)] transition-all duration-250 overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 rounded-[14px] bg-gradient-to-br from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"}),h.jsx("div",{className:"shrink-0 w-11 h-11 bg-gray-100 dark:bg-dark-600 border border-gray-200 dark:border-dark-500 rounded-[10px] flex items-center justify-center text-[22px] group-hover:bg-primary-50 dark:group-hover:bg-primary-500/10 group-hover:border-primary-200 dark:group-hover:border-primary-500/25 transition-all relative z-[1]",children:s.icon}),h.jsxs("div",{className:"flex-1 min-w-0 relative z-[1]",children:[h.jsx("div",{className:"font-mono text-[11px] text-gray-400 dark:text-dark-300 mb-0.5",children:String(o+1).padStart(2,"0")}),h.jsx("div",{className:"text-base font-semibold text-gray-900 dark:text-dark-100 tracking-tight mb-1.5 group-hover:text-primary-600 dark:group-hover:text-primary-300 transition-colors",children:s.title}),h.jsx("div",{className:"text-[13px] text-gray-500 dark:text-dark-300 leading-relaxed mb-3.5",children:s.description}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"font-mono text-[11px] text-gray-400 dark:text-dark-300",children:[s.problems.length," problems"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-[60px] h-[3px] bg-gray-200 dark:bg-dark-500 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full progress-gradient rounded-full transition-all duration-500",style:{width:`${a}%`}})}),h.jsxs("span",{className:"font-mono text-[11px] text-gray-400 dark:text-dark-300",children:[a,"%"]})]})]})]}),h.jsx("span",{className:"absolute right-5 top-1/2 -translate-y-1/2 -translate-x-1 opacity-0 text-primary-500 dark:text-primary-300 text-lg group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-250",children:""})]},s.id)})}),h.jsx("div",{className:"mt-16 mb-8",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-px bg-gray-200 dark:bg-dark-500 border border-gray-200 dark:border-dark-500 rounded-[14px] overflow-hidden",children:[h.jsxs("div",{className:"bg-white dark:bg-dark-800 p-8 text-center hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:[h.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-gray-100 dark:bg-dark-600 border border-gray-200 dark:border-dark-500 rounded-xl flex items-center justify-center text-[22px]",children:""}),h.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-dark-100 tracking-tight mb-2",children:"Python in Browser"}),h.jsx("div",{className:"text-[13px] text-gray-500 dark:text-dark-300 leading-relaxed",children:"Full Python runtime with NumPy, pandas, and scikit-learn. No install, no config."})]}),h.jsxs("div",{className:"bg-white dark:bg-dark-800 p-8 text-center hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:[h.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-gray-100 dark:bg-dark-600 border border-gray-200 dark:border-dark-500 rounded-xl flex items-center justify-center text-[22px]",children:""}),h.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-dark-100 tracking-tight mb-2",children:"Instant Feedback"}),h.jsx("div",{className:"text-[13px] text-gray-500 dark:text-dark-300 leading-relaxed",children:"Run your code against test suites and see results immediately."})]}),h.jsxs("div",{className:"bg-white dark:bg-dark-800 p-8 text-center hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors",children:[h.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-gray-100 dark:bg-dark-600 border border-gray-200 dark:border-dark-500 rounded-xl flex items-center justify-center text-[22px]",children:""}),h.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-dark-100 tracking-tight mb-2",children:"Progress Saved Locally"}),h.jsx("div",{className:"text-[13px] text-gray-500 dark:text-dark-300 leading-relaxed",children:"Your code and progress persist in your browser. Pick up anytime."})]})]})})]})}function DO(t,e){const n={};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const OO=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,zO=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,MO={};function Xx(t,e){return(MO.jsx?zO:OO).test(t)}const jO=/[ \t\n\f\r]/g;function VO(t){return typeof t=="object"?t.type==="text"?Jx(t.value):!1:Jx(t)}function Jx(t){return t.replace(jO,"")===""}class zl{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}zl.prototype.normal={};zl.prototype.property={};zl.prototype.space=void 0;function a2(t,e){const n={},r={};for(const i of t)Object.assign(n,i.property),Object.assign(r,i.normal);return new zl(n,r,e)}function Gf(t){return t.toLowerCase()}class en{constructor(e,n){this.attribute=n,this.property=e}}en.prototype.attribute="";en.prototype.booleanish=!1;en.prototype.boolean=!1;en.prototype.commaOrSpaceSeparated=!1;en.prototype.commaSeparated=!1;en.prototype.defined=!1;en.prototype.mustUseProperty=!1;en.prototype.number=!1;en.prototype.overloadedBoolean=!1;en.prototype.property="";en.prototype.spaceSeparated=!1;en.prototype.space=void 0;let FO=0;const me=xs(),it=xs(),Yf=xs(),K=xs(),Me=xs(),io=xs(),nn=xs();function xs(){return 2**++FO}const Xf=Object.freeze(Object.defineProperty({__proto__:null,boolean:me,booleanish:it,commaOrSpaceSeparated:nn,commaSeparated:io,number:K,overloadedBoolean:Yf,spaceSeparated:Me},Symbol.toStringTag,{value:"Module"})),eh=Object.keys(Xf);class Qg extends en{constructor(e,n,r,i){let s=-1;if(super(e,n),Zx(this,"space",i),typeof r=="number")for(;++s<eh.length;){const o=eh[s];Zx(this,eh[s],(r&Xf[o])===Xf[o])}}}Qg.prototype.defined=!0;function Zx(t,e,n){n&&(t[e]=n)}function zo(t){const e={},n={};for(const[r,i]of Object.entries(t.properties)){const s=new Qg(r,t.transform(t.attributes||{},r),i,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,n[Gf(r)]=r,n[Gf(s.attribute)]=r}return new zl(e,n,t.space)}const l2=zo({properties:{ariaActiveDescendant:null,ariaAtomic:it,ariaAutoComplete:null,ariaBusy:it,ariaChecked:it,ariaColCount:K,ariaColIndex:K,ariaColSpan:K,ariaControls:Me,ariaCurrent:null,ariaDescribedBy:Me,ariaDetails:null,ariaDisabled:it,ariaDropEffect:Me,ariaErrorMessage:null,ariaExpanded:it,ariaFlowTo:Me,ariaGrabbed:it,ariaHasPopup:null,ariaHidden:it,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Me,ariaLevel:K,ariaLive:null,ariaModal:it,ariaMultiLine:it,ariaMultiSelectable:it,ariaOrientation:null,ariaOwns:Me,ariaPlaceholder:null,ariaPosInSet:K,ariaPressed:it,ariaReadOnly:it,ariaRelevant:null,ariaRequired:it,ariaRoleDescription:Me,ariaRowCount:K,ariaRowIndex:K,ariaRowSpan:K,ariaSelected:it,ariaSetSize:K,ariaSort:null,ariaValueMax:K,ariaValueMin:K,ariaValueNow:K,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function u2(t,e){return e in t?t[e]:e}function c2(t,e){return u2(t,e.toLowerCase())}const UO=zo({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:io,acceptCharset:Me,accessKey:Me,action:null,allow:null,allowFullScreen:me,allowPaymentRequest:me,allowUserMedia:me,alt:null,as:null,async:me,autoCapitalize:null,autoComplete:Me,autoFocus:me,autoPlay:me,blocking:Me,capture:null,charSet:null,checked:me,cite:null,className:Me,cols:K,colSpan:null,content:null,contentEditable:it,controls:me,controlsList:Me,coords:K|io,crossOrigin:null,data:null,dateTime:null,decoding:null,default:me,defer:me,dir:null,dirName:null,disabled:me,download:Yf,draggable:it,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:me,formTarget:null,headers:Me,height:K,hidden:Yf,high:K,href:null,hrefLang:null,htmlFor:Me,httpEquiv:Me,id:null,imageSizes:null,imageSrcSet:null,inert:me,inputMode:null,integrity:null,is:null,isMap:me,itemId:null,itemProp:Me,itemRef:Me,itemScope:me,itemType:Me,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:me,low:K,manifest:null,max:null,maxLength:K,media:null,method:null,min:null,minLength:K,multiple:me,muted:me,name:null,nonce:null,noModule:me,noValidate:me,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:me,optimum:K,pattern:null,ping:Me,placeholder:null,playsInline:me,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:me,referrerPolicy:null,rel:Me,required:me,reversed:me,rows:K,rowSpan:K,sandbox:Me,scope:null,scoped:me,seamless:me,selected:me,shadowRootClonable:me,shadowRootDelegatesFocus:me,shadowRootMode:null,shape:null,size:K,sizes:null,slot:null,span:K,spellCheck:it,src:null,srcDoc:null,srcLang:null,srcSet:null,start:K,step:null,style:null,tabIndex:K,target:null,title:null,translate:null,type:null,typeMustMatch:me,useMap:null,value:it,width:K,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Me,axis:null,background:null,bgColor:null,border:K,borderColor:null,bottomMargin:K,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:me,declare:me,event:null,face:null,frame:null,frameBorder:null,hSpace:K,leftMargin:K,link:null,longDesc:null,lowSrc:null,marginHeight:K,marginWidth:K,noResize:me,noHref:me,noShade:me,noWrap:me,object:null,profile:null,prompt:null,rev:null,rightMargin:K,rules:null,scheme:null,scrolling:it,standby:null,summary:null,text:null,topMargin:K,valueType:null,version:null,vAlign:null,vLink:null,vSpace:K,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:me,disableRemotePlayback:me,prefix:null,property:null,results:K,security:null,unselectable:null},space:"html",transform:c2}),qO=zo({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:nn,accentHeight:K,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:K,amplitude:K,arabicForm:null,ascent:K,attributeName:null,attributeType:null,azimuth:K,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:K,by:null,calcMode:null,capHeight:K,className:Me,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:K,diffuseConstant:K,direction:null,display:null,dur:null,divisor:K,dominantBaseline:null,download:me,dx:null,dy:null,edgeMode:null,editable:null,elevation:K,enableBackground:null,end:null,event:null,exponent:K,externalResourcesRequired:null,fill:null,fillOpacity:K,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:io,g2:io,glyphName:io,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:K,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:K,horizOriginX:K,horizOriginY:K,id:null,ideographic:K,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:K,k:K,k1:K,k2:K,k3:K,k4:K,kernelMatrix:nn,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:K,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:K,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:K,overlineThickness:K,paintOrder:null,panose1:null,path:null,pathLength:K,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Me,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:K,pointsAtY:K,pointsAtZ:K,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:nn,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:nn,rev:nn,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:nn,requiredFeatures:nn,requiredFonts:nn,requiredFormats:nn,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:K,specularExponent:K,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:K,strikethroughThickness:K,string:null,stroke:null,strokeDashArray:nn,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:K,strokeOpacity:K,strokeWidth:null,style:null,surfaceScale:K,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:nn,tabIndex:K,tableValues:null,target:null,targetX:K,targetY:K,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:nn,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:K,underlineThickness:K,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:K,values:null,vAlphabetic:K,vMathematical:K,vectorEffect:null,vHanging:K,vIdeographic:K,version:null,vertAdvY:K,vertOriginX:K,vertOriginY:K,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:K,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:u2}),d2=zo({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),p2=zo({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:c2}),h2=zo({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),BO={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},WO=/[A-Z]/g,ev=/-[a-z]/g,HO=/^data[-\w.:]+$/i;function $O(t,e){const n=Gf(e);let r=e,i=en;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&HO.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(ev,QO);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!ev.test(s)){let o=s.replace(WO,KO);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}i=Qg}return new i(r,e)}function KO(t){return"-"+t.toLowerCase()}function QO(t){return t.charAt(1).toUpperCase()}const GO=a2([l2,UO,d2,p2,h2],"html"),Gg=a2([l2,qO,d2,p2,h2],"svg");function YO(t){return t.join(" ").trim()}var Yg={},tv=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,XO=/\n/g,JO=/^\s*/,ZO=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,ez=/^:\s*/,tz=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,nz=/^[;\s]*/,rz=/^\s+|\s+$/g,iz=`
`,nv="/",rv="*",qi="",sz="comment",oz="declaration";function az(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function i(_){var k=_.match(XO);k&&(n+=k.length);var I=_.lastIndexOf(iz);r=~I?_.length-I:r+_.length}function s(){var _={line:n,column:r};return function(k){return k.position=new o(_),u(),k}}function o(_){this.start=_,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function a(_){var k=new Error(e.source+":"+n+":"+r+": "+_);if(k.reason=_,k.filename=e.source,k.line=n,k.column=r,k.source=t,!e.silent)throw k}function l(_){var k=_.exec(t);if(k){var I=k[0];return i(I),t=t.slice(I.length),k}}function u(){l(JO)}function d(_){var k;for(_=_||[];k=p();)k!==!1&&_.push(k);return _}function p(){var _=s();if(!(nv!=t.charAt(0)||rv!=t.charAt(1))){for(var k=2;qi!=t.charAt(k)&&(rv!=t.charAt(k)||nv!=t.charAt(k+1));)++k;if(k+=2,qi===t.charAt(k-1))return a("End of comment missing");var I=t.slice(2,k-2);return r+=2,i(I),t=t.slice(k),r+=2,_({type:sz,comment:I})}}function f(){var _=s(),k=l(ZO);if(k){if(p(),!l(ez))return a("property missing ':'");var I=l(tz),x=_({type:oz,property:iv(k[0].replace(tv,qi)),value:I?iv(I[0].replace(tv,qi)):qi});return l(nz),x}}function g(){var _=[];d(_);for(var k;k=f();)k!==!1&&(_.push(k),d(_));return _}return u(),g()}function iv(t){return t?t.replace(rz,qi):qi}var lz=az,uz=ic&&ic.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yg,"__esModule",{value:!0});Yg.default=dz;const cz=uz(lz);function dz(t,e){let n=null;if(!t||typeof t!="string")return n;const r=(0,cz.default)(t),i=typeof e=="function";return r.forEach(s=>{if(s.type!=="declaration")return;const{property:o,value:a}=s;i?e(o,a,s):a&&(n=n||{},n[o]=a)}),n}var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.camelCase=void 0;var pz=/^--[a-zA-Z0-9_-]+$/,hz=/-([a-z])/g,fz=/^[^-]+$/,mz=/^-(webkit|moz|ms|o|khtml)-/,gz=/^-(ms)-/,yz=function(t){return!t||fz.test(t)||pz.test(t)},_z=function(t,e){return e.toUpperCase()},sv=function(t,e){return"".concat(e,"-")},xz=function(t,e){return e===void 0&&(e={}),yz(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(gz,sv):t=t.replace(mz,sv),t.replace(hz,_z))};Fd.camelCase=xz;var vz=ic&&ic.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},bz=vz(Yg),wz=Fd;function Jf(t,e){var n={};return!t||typeof t!="string"||(0,bz.default)(t,function(r,i){r&&i&&(n[(0,wz.camelCase)(r,e)]=i)}),n}Jf.default=Jf;var kz=Jf;const Ez=ps(kz),f2=m2("end"),Xg=m2("start");function m2(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function Tz(t){const e=Xg(t),n=f2(t);if(e&&n)return{start:e,end:n}}function Ma(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?ov(t.position):"start"in t||"end"in t?ov(t):"line"in t||"column"in t?Zf(t):""}function Zf(t){return av(t&&t.line)+":"+av(t&&t.column)}function ov(t){return Zf(t&&t.start)+"-"+Zf(t&&t.end)}function av(t){return t&&typeof t=="number"?t:1}class zt extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",s={},o=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof e=="string"?i=e:!s.cause&&e&&(o=!0,i=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?s.ruleId=r:(s.source=r.slice(0,l),s.ruleId=r.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const a=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=a?a.line:void 0,this.name=Ma(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}zt.prototype.file="";zt.prototype.name="";zt.prototype.reason="";zt.prototype.message="";zt.prototype.stack="";zt.prototype.column=void 0;zt.prototype.line=void 0;zt.prototype.ancestors=void 0;zt.prototype.cause=void 0;zt.prototype.fatal=void 0;zt.prototype.place=void 0;zt.prototype.ruleId=void 0;zt.prototype.source=void 0;const Jg={}.hasOwnProperty,Sz=new Map,Cz=/[A-Z]/g,Iz=new Set(["table","tbody","thead","tfoot","tr"]),Az=new Set(["td","th"]),g2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Pz(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=jz(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Mz(n,e.jsx,e.jsxs)}const i={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Gg:GO,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=y2(i,t,void 0);return s&&typeof s!="string"?s:i.create(t,i.Fragment,{children:s||void 0},void 0)}function y2(t,e,n){if(e.type==="element")return Rz(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return Nz(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return Dz(t,e,n);if(e.type==="mdxjsEsm")return Lz(t,e);if(e.type==="root")return Oz(t,e,n);if(e.type==="text")return zz(t,e)}function Rz(t,e,n){const r=t.schema;let i=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=Gg,t.schema=i),t.ancestors.push(e);const s=x2(t,e.tagName,!1),o=Vz(t,e);let a=ey(t,e);return Iz.has(e.tagName)&&(a=a.filter(function(l){return typeof l=="string"?!VO(l):!0})),_2(t,o,s,e),Zg(o,a),t.ancestors.pop(),t.schema=r,t.create(e,s,o,n)}function Nz(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}fl(t,e.position)}function Lz(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);fl(t,e.position)}function Dz(t,e,n){const r=t.schema;let i=r;e.name==="svg"&&r.space==="html"&&(i=Gg,t.schema=i),t.ancestors.push(e);const s=e.name===null?t.Fragment:x2(t,e.name,!0),o=Fz(t,e),a=ey(t,e);return _2(t,o,s,e),Zg(o,a),t.ancestors.pop(),t.schema=r,t.create(e,s,o,n)}function Oz(t,e,n){const r={};return Zg(r,ey(t,e)),t.create(e,t.Fragment,r,n)}function zz(t,e){return e.value}function _2(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function Zg(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function Mz(t,e,n){return r;function r(i,s,o,a){const u=Array.isArray(o.children)?n:e;return a?u(s,o,a):u(s,o)}}function jz(t,e){return n;function n(r,i,s,o){const a=Array.isArray(s.children),l=Xg(r);return e(i,s,o,a,{columnNumber:l?l.column-1:void 0,fileName:t,lineNumber:l?l.line:void 0},void 0)}}function Vz(t,e){const n={};let r,i;for(i in e.properties)if(i!=="children"&&Jg.call(e.properties,i)){const s=Uz(t,i,e.properties[i]);if(s){const[o,a]=s;t.tableCellAlignToStyle&&o==="align"&&typeof a=="string"&&Az.has(e.tagName)?r=a:n[o]=a}}if(r){const s=n.style||(n.style={});s[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Fz(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const s=r.data.estree.body[0];s.type;const o=s.expression;o.type;const a=o.properties[0];a.type,Object.assign(n,t.evaluater.evaluateExpression(a.argument))}else fl(t,e.position);else{const i=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const a=r.value.data.estree.body[0];a.type,s=t.evaluater.evaluateExpression(a.expression)}else fl(t,e.position);else s=r.value===null?!0:r.value;n[i]=s}return n}function ey(t,e){const n=[];let r=-1;const i=t.passKeys?new Map:Sz;for(;++r<e.children.length;){const s=e.children[r];let o;if(t.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const u=i.get(l)||0;o=l+"-"+u,i.set(l,u+1)}}const a=y2(t,s,o);a!==void 0&&n.push(a)}return n}function Uz(t,e,n){const r=$O(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?DO(n):YO(n)),r.property==="style"){let i=typeof n=="object"?n:qz(t,String(n));return t.stylePropertyNameCase==="css"&&(i=Bz(i)),["style",i]}return[t.elementAttributeNameCase==="react"&&r.space?BO[r.property]||r.property:r.attribute,n]}}function qz(t,e){try{return Ez(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,i=new zt("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=t.filePath||void 0,i.url=g2+"#cannot-parse-style-attribute",i}}function x2(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const i=e.split(".");let s=-1,o;for(;++s<i.length;){const a=Xx(i[s])?{type:"Identifier",name:i[s]}:{type:"Literal",value:i[s]};o=o?{type:"MemberExpression",object:o,property:a,computed:!!(s&&a.type==="Literal"),optional:!1}:a}r=o}else r=Xx(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const i=r.value;return Jg.call(t.components,i)?t.components[i]:i}if(t.evaluater)return t.evaluater.evaluateExpression(r);fl(t)}function fl(t,e){const n=new zt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=g2+"#cannot-handle-mdx-estrees-without-createevaluater",n}function Bz(t){const e={};let n;for(n in t)Jg.call(t,n)&&(e[Wz(n)]=t[n]);return e}function Wz(t){let e=t.replace(Cz,Hz);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function Hz(t){return"-"+t.toLowerCase()}const th={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},$z={};function ty(t,e){const n=$z,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return v2(t,r,i)}function v2(t,e,n){if(Kz(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return lv(t.children,e,n)}return Array.isArray(t)?lv(t,e,n):""}function lv(t,e,n){const r=[];let i=-1;for(;++i<t.length;)r[i]=v2(t[i],e,n);return r.join("")}function Kz(t){return!!(t&&typeof t=="object")}const uv=document.createElement("i");function ny(t){const e="&"+t+";";uv.innerHTML=e;const n=uv.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function ln(t,e,n,r){const i=t.length;let s=0,o;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),t.splice(...o),s+=1e4,e+=1e4}function _n(t,e){return t.length>0?(ln(t,t.length,0,e),t):e}const cv={}.hasOwnProperty;function b2(t){const e={};let n=-1;for(;++n<t.length;)Qz(e,t[n]);return e}function Qz(t,e){let n;for(n in e){const i=(cv.call(t,n)?t[n]:void 0)||(t[n]={}),s=e[n];let o;if(s)for(o in s){cv.call(i,o)||(i[o]=[]);const a=s[o];Gz(i[o],Array.isArray(a)?a:a?[a]:[])}}}function Gz(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);ln(t,0,0,r)}function w2(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function Bn(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ut=Pi(/[A-Za-z]/),Lt=Pi(/[\dA-Za-z]/),Yz=Pi(/[#-'*+\--9=?A-Z^-~]/);function Xc(t){return t!==null&&(t<32||t===127)}const em=Pi(/\d/),Xz=Pi(/[\dA-Fa-f]/),Jz=Pi(/[!-/:-@[-`{-~]/);function le(t){return t!==null&&t<-2}function ze(t){return t!==null&&(t<0||t===32)}function xe(t){return t===-2||t===-1||t===32}const Ud=Pi(new RegExp("\\p{P}|\\p{S}","u")),ds=Pi(/\s/);function Pi(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Mo(t){const e=[];let n=-1,r=0,i=0;for(;++n<t.length;){const s=t.charCodeAt(n);let o="";if(s===37&&Lt(t.charCodeAt(n+1))&&Lt(t.charCodeAt(n+2)))i=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const a=t.charCodeAt(n+1);s<56320&&a>56319&&a<57344?(o=String.fromCharCode(s,a),i=1):o=""}else o=String.fromCharCode(s);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+i+1,o=""),i&&(n+=i,i=0)}return e.join("")+t.slice(r)}function Se(t,e,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(l){return xe(l)?(t.enter(n),a(l)):e(l)}function a(l){return xe(l)&&s++<i?(t.consume(l),a):(t.exit(n),e(l))}}const Zz={tokenize:eM};function eM(t){const e=t.attempt(this.parser.constructs.contentInitial,r,i);let n;return e;function r(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),Se(t,e,"linePrefix")}function i(a){return t.enter("paragraph"),s(a)}function s(a){const l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,o(a)}function o(a){if(a===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(a);return}return le(a)?(t.consume(a),t.exit("chunkText"),s):(t.consume(a),o)}}const tM={tokenize:nM},dv={tokenize:rM};function nM(t){const e=this,n=[];let r=0,i,s,o;return a;function a(w){if(r<n.length){const M=n[r];return e.containerState=M[1],t.attempt(M[0].continuation,l,u)(w)}return u(w)}function l(w){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&v();const M=e.events.length;let O=M,D;for(;O--;)if(e.events[O][0]==="exit"&&e.events[O][1].type==="chunkFlow"){D=e.events[O][1].end;break}x(r);let S=M;for(;S<e.events.length;)e.events[S][1].end={...D},S++;return ln(e.events,O+1,0,e.events.slice(M)),e.events.length=S,u(w)}return a(w)}function u(w){if(r===n.length){if(!i)return f(w);if(i.currentConstruct&&i.currentConstruct.concrete)return _(w);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(dv,d,p)(w)}function d(w){return i&&v(),x(r),f(w)}function p(w){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,_(w)}function f(w){return e.containerState={},t.attempt(dv,g,_)(w)}function g(w){return r++,n.push([e.currentConstruct,e.containerState]),f(w)}function _(w){if(w===null){i&&v(),x(0),t.consume(w);return}return i=i||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:s}),k(w)}function k(w){if(w===null){I(t.exit("chunkFlow"),!0),x(0),t.consume(w);return}return le(w)?(t.consume(w),I(t.exit("chunkFlow")),r=0,e.interrupt=void 0,a):(t.consume(w),k)}function I(w,M){const O=e.sliceStream(w);if(M&&O.push(null),w.previous=s,s&&(s.next=w),s=w,i.defineSkip(w.start),i.write(O),e.parser.lazy[w.start.line]){let D=i.events.length;for(;D--;)if(i.events[D][1].start.offset<o&&(!i.events[D][1].end||i.events[D][1].end.offset>o))return;const S=e.events.length;let E=S,C,b;for(;E--;)if(e.events[E][0]==="exit"&&e.events[E][1].type==="chunkFlow"){if(C){b=e.events[E][1].end;break}C=!0}for(x(r),D=S;D<e.events.length;)e.events[D][1].end={...b},D++;ln(e.events,E+1,0,e.events.slice(S)),e.events.length=D}}function x(w){let M=n.length;for(;M-- >w;){const O=n[M];e.containerState=O[1],O[0].exit.call(e,t)}n.length=w}function v(){i.write([null]),s=void 0,i=void 0,e.containerState._closeFlow=void 0}}function rM(t,e,n){return Se(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function ko(t){if(t===null||ze(t)||ds(t))return 1;if(Ud(t))return 2}function qd(t,e,n){const r=[];let i=-1;for(;++i<t.length;){const s=t[i].resolveAll;s&&!r.includes(s)&&(e=s(e,n),r.push(s))}return e}const tm={name:"attention",resolveAll:iM,tokenize:sM};function iM(t,e){let n=-1,r,i,s,o,a,l,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const p={...t[r][1].end},f={...t[n][1].start};pv(p,-l),pv(f,l),o={type:l>1?"strongSequence":"emphasisSequence",start:p,end:{...t[r][1].end}},a={type:l>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},s={type:l>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},i={type:l>1?"strong":"emphasis",start:{...o.start},end:{...a.end}},t[r][1].end={...o.start},t[n][1].start={...a.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=_n(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=_n(u,[["enter",i,e],["enter",o,e],["exit",o,e],["enter",s,e]]),u=_n(u,qd(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=_n(u,[["exit",s,e],["enter",a,e],["exit",a,e],["exit",i,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=_n(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,ln(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function sM(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=ko(r);let s;return o;function o(l){return s=l,t.enter("attentionSequence"),a(l)}function a(l){if(l===s)return t.consume(l),a;const u=t.exit("attentionSequence"),d=ko(l),p=!d||d===2&&i||n.includes(l),f=!i||i===2&&d||n.includes(r);return u._open=!!(s===42?p:p&&(i||!f)),u._close=!!(s===42?f:f&&(d||!p)),e(l)}}function pv(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const oM={name:"autolink",tokenize:aM};function aM(t,e,n){let r=0;return i;function i(g){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(g),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(g){return Ut(g)?(t.consume(g),o):g===64?n(g):u(g)}function o(g){return g===43||g===45||g===46||Lt(g)?(r=1,a(g)):u(g)}function a(g){return g===58?(t.consume(g),r=0,l):(g===43||g===45||g===46||Lt(g))&&r++<32?(t.consume(g),a):(r=0,u(g))}function l(g){return g===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(g),t.exit("autolinkMarker"),t.exit("autolink"),e):g===null||g===32||g===60||Xc(g)?n(g):(t.consume(g),l)}function u(g){return g===64?(t.consume(g),d):Yz(g)?(t.consume(g),u):n(g)}function d(g){return Lt(g)?p(g):n(g)}function p(g){return g===46?(t.consume(g),r=0,d):g===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(g),t.exit("autolinkMarker"),t.exit("autolink"),e):f(g)}function f(g){if((g===45||Lt(g))&&r++<63){const _=g===45?f:p;return t.consume(g),_}return n(g)}}const Ml={partial:!0,tokenize:lM};function lM(t,e,n){return r;function r(s){return xe(s)?Se(t,i,"linePrefix")(s):i(s)}function i(s){return s===null||le(s)?e(s):n(s)}}const k2={continuation:{tokenize:cM},exit:dM,name:"blockQuote",tokenize:uM};function uM(t,e,n){const r=this;return i;function i(o){if(o===62){const a=r.containerState;return a.open||(t.enter("blockQuote",{_container:!0}),a.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),s}return n(o)}function s(o){return xe(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function cM(t,e,n){const r=this;return i;function i(o){return xe(o)?Se(t,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return t.attempt(k2,e,n)(o)}}function dM(t){t.exit("blockQuote")}const E2={name:"characterEscape",tokenize:pM};function pM(t,e,n){return r;function r(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),i}function i(s){return Jz(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(s)}}const T2={name:"characterReference",tokenize:hM};function hM(t,e,n){const r=this;let i=0,s,o;return a;function a(p){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(p),t.exit("characterReferenceMarker"),l}function l(p){return p===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(p),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),s=31,o=Lt,d(p))}function u(p){return p===88||p===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(p),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,o=Xz,d):(t.enter("characterReferenceValue"),s=7,o=em,d(p))}function d(p){if(p===59&&i){const f=t.exit("characterReferenceValue");return o===Lt&&!ny(r.sliceSerialize(f))?n(p):(t.enter("characterReferenceMarker"),t.consume(p),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(p)&&i++<s?(t.consume(p),d):n(p)}}const hv={partial:!0,tokenize:mM},fv={concrete:!0,name:"codeFenced",tokenize:fM};function fM(t,e,n){const r=this,i={partial:!0,tokenize:O};let s=0,o=0,a;return l;function l(D){return u(D)}function u(D){const S=r.events[r.events.length-1];return s=S&&S[1].type==="linePrefix"?S[2].sliceSerialize(S[1],!0).length:0,a=D,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(D)}function d(D){return D===a?(o++,t.consume(D),d):o<3?n(D):(t.exit("codeFencedFenceSequence"),xe(D)?Se(t,p,"whitespace")(D):p(D))}function p(D){return D===null||le(D)?(t.exit("codeFencedFence"),r.interrupt?e(D):t.check(hv,k,M)(D)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(D))}function f(D){return D===null||le(D)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),p(D)):xe(D)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Se(t,g,"whitespace")(D)):D===96&&D===a?n(D):(t.consume(D),f)}function g(D){return D===null||le(D)?p(D):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),_(D))}function _(D){return D===null||le(D)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),p(D)):D===96&&D===a?n(D):(t.consume(D),_)}function k(D){return t.attempt(i,M,I)(D)}function I(D){return t.enter("lineEnding"),t.consume(D),t.exit("lineEnding"),x}function x(D){return s>0&&xe(D)?Se(t,v,"linePrefix",s+1)(D):v(D)}function v(D){return D===null||le(D)?t.check(hv,k,M)(D):(t.enter("codeFlowValue"),w(D))}function w(D){return D===null||le(D)?(t.exit("codeFlowValue"),v(D)):(t.consume(D),w)}function M(D){return t.exit("codeFenced"),e(D)}function O(D,S,E){let C=0;return b;function b($){return D.enter("lineEnding"),D.consume($),D.exit("lineEnding"),A}function A($){return D.enter("codeFencedFence"),xe($)?Se(D,N,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):N($)}function N($){return $===a?(D.enter("codeFencedFenceSequence"),P($)):E($)}function P($){return $===a?(C++,D.consume($),P):C>=o?(D.exit("codeFencedFenceSequence"),xe($)?Se(D,se,"whitespace")($):se($)):E($)}function se($){return $===null||le($)?(D.exit("codeFencedFence"),S($)):E($)}}}function mM(t,e,n){const r=this;return i;function i(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s)}function s(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const nh={name:"codeIndented",tokenize:yM},gM={partial:!0,tokenize:_M};function yM(t,e,n){const r=this;return i;function i(u){return t.enter("codeIndented"),Se(t,s,"linePrefix",5)(u)}function s(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?l(u):le(u)?t.attempt(gM,o,l)(u):(t.enter("codeFlowValue"),a(u))}function a(u){return u===null||le(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),a)}function l(u){return t.exit("codeIndented"),e(u)}}function _M(t,e,n){const r=this;return i;function i(o){return r.parser.lazy[r.now().line]?n(o):le(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):Se(t,s,"linePrefix",5)(o)}function s(o){const a=r.events[r.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):le(o)?i(o):n(o)}}const xM={name:"codeText",previous:bM,resolve:vM,tokenize:wM};function vM(t){let e=t.length-4,n=3,r,i;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)i===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(i=r):(r===e||t[r][1].type==="lineEnding")&&(t[i][1].type="codeTextData",r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return t}function bM(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function wM(t,e,n){let r=0,i,s;return o;function o(p){return t.enter("codeText"),t.enter("codeTextSequence"),a(p)}function a(p){return p===96?(t.consume(p),r++,a):(t.exit("codeTextSequence"),l(p))}function l(p){return p===null?n(p):p===32?(t.enter("space"),t.consume(p),t.exit("space"),l):p===96?(s=t.enter("codeTextSequence"),i=0,d(p)):le(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),l):(t.enter("codeTextData"),u(p))}function u(p){return p===null||p===32||p===96||le(p)?(t.exit("codeTextData"),l(p)):(t.consume(p),u)}function d(p){return p===96?(t.consume(p),i++,d):i===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(p)):(s.type="codeTextData",u(p))}}class kM{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const i=n||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&ua(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),ua(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),ua(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);ua(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);ua(this.left,n.reverse())}}}function ua(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function S2(t){const e={};let n=-1,r,i,s,o,a,l,u;const d=new kM(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,EM(d,n)),n=e[n],u=!0);else if(r[1]._container){for(s=n,i=void 0;s--;)if(o=d.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(i&&(d.get(i)[1].type="lineEndingBlank"),o[1].type="lineEnding",i=s);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;i&&(r[1].end={...d.get(i)[1].start},a=d.slice(i,n),a.unshift(r),d.splice(i,n-i+1,a))}}return ln(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function EM(t,e){const n=t.get(e)[1],r=t.get(e)[2];let i=e-1;const s=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const a=o.events,l=[],u={};let d,p,f=-1,g=n,_=0,k=0;const I=[k];for(;g;){for(;t.get(++i)[1]!==g;);s.push(i),g._tokenizer||(d=r.sliceStream(g),g.next||d.push(null),p&&o.defineSkip(g.start),g._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),g._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),p=g,g=g.next}for(g=n;++f<a.length;)a[f][0]==="exit"&&a[f-1][0]==="enter"&&a[f][1].type===a[f-1][1].type&&a[f][1].start.line!==a[f][1].end.line&&(k=f+1,I.push(k),g._tokenizer=void 0,g.previous=void 0,g=g.next);for(o.events=[],g?(g._tokenizer=void 0,g.previous=void 0):I.pop(),f=I.length;f--;){const x=a.slice(I[f],I[f+1]),v=s.pop();l.push([v,v+x.length-1]),t.splice(v,2,x)}for(l.reverse(),f=-1;++f<l.length;)u[_+l[f][0]]=_+l[f][1],_+=l[f][1]-l[f][0]-1;return u}const TM={resolve:CM,tokenize:IM},SM={partial:!0,tokenize:AM};function CM(t){return S2(t),t}function IM(t,e){let n;return r;function r(a){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),i(a)}function i(a){return a===null?s(a):le(a)?t.check(SM,o,s)(a):(t.consume(a),i)}function s(a){return t.exit("chunkContent"),t.exit("content"),e(a)}function o(a){return t.consume(a),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function AM(t,e,n){const r=this;return i;function i(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Se(t,s,"linePrefix")}function s(o){if(o===null||le(o))return n(o);const a=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function C2(t,e,n,r,i,s,o,a,l){const u=l||Number.POSITIVE_INFINITY;let d=0;return p;function p(x){return x===60?(t.enter(r),t.enter(i),t.enter(s),t.consume(x),t.exit(s),f):x===null||x===32||x===41||Xc(x)?n(x):(t.enter(r),t.enter(o),t.enter(a),t.enter("chunkString",{contentType:"string"}),k(x))}function f(x){return x===62?(t.enter(s),t.consume(x),t.exit(s),t.exit(i),t.exit(r),e):(t.enter(a),t.enter("chunkString",{contentType:"string"}),g(x))}function g(x){return x===62?(t.exit("chunkString"),t.exit(a),f(x)):x===null||x===60||le(x)?n(x):(t.consume(x),x===92?_:g)}function _(x){return x===60||x===62||x===92?(t.consume(x),g):g(x)}function k(x){return!d&&(x===null||x===41||ze(x))?(t.exit("chunkString"),t.exit(a),t.exit(o),t.exit(r),e(x)):d<u&&x===40?(t.consume(x),d++,k):x===41?(t.consume(x),d--,k):x===null||x===32||x===40||Xc(x)?n(x):(t.consume(x),x===92?I:k)}function I(x){return x===40||x===41||x===92?(t.consume(x),k):k(x)}}function I2(t,e,n,r,i,s){const o=this;let a=0,l;return u;function u(g){return t.enter(r),t.enter(i),t.consume(g),t.exit(i),t.enter(s),d}function d(g){return a>999||g===null||g===91||g===93&&!l||g===94&&!a&&"_hiddenFootnoteSupport"in o.parser.constructs?n(g):g===93?(t.exit(s),t.enter(i),t.consume(g),t.exit(i),t.exit(r),e):le(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),p(g))}function p(g){return g===null||g===91||g===93||le(g)||a++>999?(t.exit("chunkString"),d(g)):(t.consume(g),l||(l=!xe(g)),g===92?f:p)}function f(g){return g===91||g===92||g===93?(t.consume(g),a++,p):p(g)}}function A2(t,e,n,r,i,s){let o;return a;function a(f){return f===34||f===39||f===40?(t.enter(r),t.enter(i),t.consume(f),t.exit(i),o=f===40?41:f,l):n(f)}function l(f){return f===o?(t.enter(i),t.consume(f),t.exit(i),t.exit(r),e):(t.enter(s),u(f))}function u(f){return f===o?(t.exit(s),l(o)):f===null?n(f):le(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Se(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||le(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?p:d)}function p(f){return f===o||f===92?(t.consume(f),d):d(f)}}function ja(t,e){let n;return r;function r(i){return le(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),n=!0,r):xe(i)?Se(t,r,n?"linePrefix":"lineSuffix")(i):e(i)}}const PM={name:"definition",tokenize:NM},RM={partial:!0,tokenize:LM};function NM(t,e,n){const r=this;let i;return s;function s(g){return t.enter("definition"),o(g)}function o(g){return I2.call(r,t,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(g)}function a(g){return i=Bn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),g===58?(t.enter("definitionMarker"),t.consume(g),t.exit("definitionMarker"),l):n(g)}function l(g){return ze(g)?ja(t,u)(g):u(g)}function u(g){return C2(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(g)}function d(g){return t.attempt(RM,p,p)(g)}function p(g){return xe(g)?Se(t,f,"whitespace")(g):f(g)}function f(g){return g===null||le(g)?(t.exit("definition"),r.parser.defined.push(i),e(g)):n(g)}}function LM(t,e,n){return r;function r(a){return ze(a)?ja(t,i)(a):n(a)}function i(a){return A2(t,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function s(a){return xe(a)?Se(t,o,"whitespace")(a):o(a)}function o(a){return a===null||le(a)?e(a):n(a)}}const DM={name:"hardBreakEscape",tokenize:OM};function OM(t,e,n){return r;function r(s){return t.enter("hardBreakEscape"),t.consume(s),i}function i(s){return le(s)?(t.exit("hardBreakEscape"),e(s)):n(s)}}const zM={name:"headingAtx",resolve:MM,tokenize:jM};function MM(t,e){let n=t.length-2,r=3,i,s;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},s={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},ln(t,r,n-r+1,[["enter",i,e],["enter",s,e],["exit",s,e],["exit",i,e]])),t}function jM(t,e,n){let r=0;return i;function i(d){return t.enter("atxHeading"),s(d)}function s(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||ze(d)?(t.exit("atxHeadingSequence"),a(d)):n(d)}function a(d){return d===35?(t.enter("atxHeadingSequence"),l(d)):d===null||le(d)?(t.exit("atxHeading"),e(d)):xe(d)?Se(t,a,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function l(d){return d===35?(t.consume(d),l):(t.exit("atxHeadingSequence"),a(d))}function u(d){return d===null||d===35||ze(d)?(t.exit("atxHeadingText"),a(d)):(t.consume(d),u)}}const VM=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],mv=["pre","script","style","textarea"],FM={concrete:!0,name:"htmlFlow",resolveTo:BM,tokenize:WM},UM={partial:!0,tokenize:$M},qM={partial:!0,tokenize:HM};function BM(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function WM(t,e,n){const r=this;let i,s,o,a,l;return u;function u(L){return d(L)}function d(L){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(L),p}function p(L){return L===33?(t.consume(L),f):L===47?(t.consume(L),s=!0,k):L===63?(t.consume(L),i=3,r.interrupt?e:R):Ut(L)?(t.consume(L),o=String.fromCharCode(L),I):n(L)}function f(L){return L===45?(t.consume(L),i=2,g):L===91?(t.consume(L),i=5,a=0,_):Ut(L)?(t.consume(L),i=4,r.interrupt?e:R):n(L)}function g(L){return L===45?(t.consume(L),r.interrupt?e:R):n(L)}function _(L){const he="CDATA[";return L===he.charCodeAt(a++)?(t.consume(L),a===he.length?r.interrupt?e:N:_):n(L)}function k(L){return Ut(L)?(t.consume(L),o=String.fromCharCode(L),I):n(L)}function I(L){if(L===null||L===47||L===62||ze(L)){const he=L===47,Ae=o.toLowerCase();return!he&&!s&&mv.includes(Ae)?(i=1,r.interrupt?e(L):N(L)):VM.includes(o.toLowerCase())?(i=6,he?(t.consume(L),x):r.interrupt?e(L):N(L)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(L):s?v(L):w(L))}return L===45||Lt(L)?(t.consume(L),o+=String.fromCharCode(L),I):n(L)}function x(L){return L===62?(t.consume(L),r.interrupt?e:N):n(L)}function v(L){return xe(L)?(t.consume(L),v):b(L)}function w(L){return L===47?(t.consume(L),b):L===58||L===95||Ut(L)?(t.consume(L),M):xe(L)?(t.consume(L),w):b(L)}function M(L){return L===45||L===46||L===58||L===95||Lt(L)?(t.consume(L),M):O(L)}function O(L){return L===61?(t.consume(L),D):xe(L)?(t.consume(L),O):w(L)}function D(L){return L===null||L===60||L===61||L===62||L===96?n(L):L===34||L===39?(t.consume(L),l=L,S):xe(L)?(t.consume(L),D):E(L)}function S(L){return L===l?(t.consume(L),l=null,C):L===null||le(L)?n(L):(t.consume(L),S)}function E(L){return L===null||L===34||L===39||L===47||L===60||L===61||L===62||L===96||ze(L)?O(L):(t.consume(L),E)}function C(L){return L===47||L===62||xe(L)?w(L):n(L)}function b(L){return L===62?(t.consume(L),A):n(L)}function A(L){return L===null||le(L)?N(L):xe(L)?(t.consume(L),A):n(L)}function N(L){return L===45&&i===2?(t.consume(L),ae):L===60&&i===1?(t.consume(L),ye):L===62&&i===4?(t.consume(L),Z):L===63&&i===3?(t.consume(L),R):L===93&&i===5?(t.consume(L),ee):le(L)&&(i===6||i===7)?(t.exit("htmlFlowData"),t.check(UM,re,P)(L)):L===null||le(L)?(t.exit("htmlFlowData"),P(L)):(t.consume(L),N)}function P(L){return t.check(qM,se,re)(L)}function se(L){return t.enter("lineEnding"),t.consume(L),t.exit("lineEnding"),$}function $(L){return L===null||le(L)?P(L):(t.enter("htmlFlowData"),N(L))}function ae(L){return L===45?(t.consume(L),R):N(L)}function ye(L){return L===47?(t.consume(L),o="",W):N(L)}function W(L){if(L===62){const he=o.toLowerCase();return mv.includes(he)?(t.consume(L),Z):N(L)}return Ut(L)&&o.length<8?(t.consume(L),o+=String.fromCharCode(L),W):N(L)}function ee(L){return L===93?(t.consume(L),R):N(L)}function R(L){return L===62?(t.consume(L),Z):L===45&&i===2?(t.consume(L),R):N(L)}function Z(L){return L===null||le(L)?(t.exit("htmlFlowData"),re(L)):(t.consume(L),Z)}function re(L){return t.exit("htmlFlow"),e(L)}}function HM(t,e,n){const r=this;return i;function i(o){return le(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):n(o)}function s(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function $M(t,e,n){return r;function r(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),t.attempt(Ml,e,n)}}const KM={name:"htmlText",tokenize:QM};function QM(t,e,n){const r=this;let i,s,o;return a;function a(R){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(R),l}function l(R){return R===33?(t.consume(R),u):R===47?(t.consume(R),O):R===63?(t.consume(R),w):Ut(R)?(t.consume(R),E):n(R)}function u(R){return R===45?(t.consume(R),d):R===91?(t.consume(R),s=0,_):Ut(R)?(t.consume(R),v):n(R)}function d(R){return R===45?(t.consume(R),g):n(R)}function p(R){return R===null?n(R):R===45?(t.consume(R),f):le(R)?(o=p,ye(R)):(t.consume(R),p)}function f(R){return R===45?(t.consume(R),g):p(R)}function g(R){return R===62?ae(R):R===45?f(R):p(R)}function _(R){const Z="CDATA[";return R===Z.charCodeAt(s++)?(t.consume(R),s===Z.length?k:_):n(R)}function k(R){return R===null?n(R):R===93?(t.consume(R),I):le(R)?(o=k,ye(R)):(t.consume(R),k)}function I(R){return R===93?(t.consume(R),x):k(R)}function x(R){return R===62?ae(R):R===93?(t.consume(R),x):k(R)}function v(R){return R===null||R===62?ae(R):le(R)?(o=v,ye(R)):(t.consume(R),v)}function w(R){return R===null?n(R):R===63?(t.consume(R),M):le(R)?(o=w,ye(R)):(t.consume(R),w)}function M(R){return R===62?ae(R):w(R)}function O(R){return Ut(R)?(t.consume(R),D):n(R)}function D(R){return R===45||Lt(R)?(t.consume(R),D):S(R)}function S(R){return le(R)?(o=S,ye(R)):xe(R)?(t.consume(R),S):ae(R)}function E(R){return R===45||Lt(R)?(t.consume(R),E):R===47||R===62||ze(R)?C(R):n(R)}function C(R){return R===47?(t.consume(R),ae):R===58||R===95||Ut(R)?(t.consume(R),b):le(R)?(o=C,ye(R)):xe(R)?(t.consume(R),C):ae(R)}function b(R){return R===45||R===46||R===58||R===95||Lt(R)?(t.consume(R),b):A(R)}function A(R){return R===61?(t.consume(R),N):le(R)?(o=A,ye(R)):xe(R)?(t.consume(R),A):C(R)}function N(R){return R===null||R===60||R===61||R===62||R===96?n(R):R===34||R===39?(t.consume(R),i=R,P):le(R)?(o=N,ye(R)):xe(R)?(t.consume(R),N):(t.consume(R),se)}function P(R){return R===i?(t.consume(R),i=void 0,$):R===null?n(R):le(R)?(o=P,ye(R)):(t.consume(R),P)}function se(R){return R===null||R===34||R===39||R===60||R===61||R===96?n(R):R===47||R===62||ze(R)?C(R):(t.consume(R),se)}function $(R){return R===47||R===62||ze(R)?C(R):n(R)}function ae(R){return R===62?(t.consume(R),t.exit("htmlTextData"),t.exit("htmlText"),e):n(R)}function ye(R){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(R),t.exit("lineEnding"),W}function W(R){return xe(R)?Se(t,ee,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):ee(R)}function ee(R){return t.enter("htmlTextData"),o(R)}}const ry={name:"labelEnd",resolveAll:JM,resolveTo:ZM,tokenize:ej},GM={tokenize:tj},YM={tokenize:nj},XM={tokenize:rj};function JM(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",e+=i}}return t.length!==n.length&&ln(t,0,t.length,n),t}function ZM(t,e){let n=t.length,r=0,i,s,o,a;for(;n--;)if(i=t[n][1],s){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;t[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(s=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(o=n);const l={type:t[s][1].type==="labelLink"?"link":"image",start:{...t[s][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[s][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[s+r+2][1].end},end:{...t[o-2][1].start}};return a=[["enter",l,e],["enter",u,e]],a=_n(a,t.slice(s+1,s+r+3)),a=_n(a,[["enter",d,e]]),a=_n(a,qd(e.parser.constructs.insideSpan.null,t.slice(s+r+4,o-3),e)),a=_n(a,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),a=_n(a,t.slice(o+1)),a=_n(a,[["exit",l,e]]),ln(t,s,t.length,a),t}function ej(t,e,n){const r=this;let i=r.events.length,s,o;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return a;function a(f){return s?s._inactive?p(f):(o=r.parser.defined.includes(Bn(r.sliceSerialize({start:s.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),l):n(f)}function l(f){return f===40?t.attempt(GM,d,o?d:p)(f):f===91?t.attempt(YM,d,o?u:p)(f):o?d(f):p(f)}function u(f){return t.attempt(XM,d,p)(f)}function d(f){return e(f)}function p(f){return s._balanced=!0,n(f)}}function tj(t,e,n){return r;function r(p){return t.enter("resource"),t.enter("resourceMarker"),t.consume(p),t.exit("resourceMarker"),i}function i(p){return ze(p)?ja(t,s)(p):s(p)}function s(p){return p===41?d(p):C2(t,o,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function o(p){return ze(p)?ja(t,l)(p):d(p)}function a(p){return n(p)}function l(p){return p===34||p===39||p===40?A2(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):d(p)}function u(p){return ze(p)?ja(t,d)(p):d(p)}function d(p){return p===41?(t.enter("resourceMarker"),t.consume(p),t.exit("resourceMarker"),t.exit("resource"),e):n(p)}}function nj(t,e,n){const r=this;return i;function i(a){return I2.call(r,t,s,o,"reference","referenceMarker","referenceString")(a)}function s(a){return r.parser.defined.includes(Bn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(a):n(a)}function o(a){return n(a)}}function rj(t,e,n){return r;function r(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),i}function i(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):n(s)}}const ij={name:"labelStartImage",resolveAll:ry.resolveAll,tokenize:sj};function sj(t,e,n){const r=this;return i;function i(a){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(a),t.exit("labelImageMarker"),s}function s(a){return a===91?(t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelImage"),o):n(a)}function o(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):e(a)}}const oj={name:"labelStartLink",resolveAll:ry.resolveAll,tokenize:aj};function aj(t,e,n){const r=this;return i;function i(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const rh={name:"lineEnding",tokenize:lj};function lj(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Se(t,e,"linePrefix")}}const ec={name:"thematicBreak",tokenize:uj};function uj(t,e,n){let r=0,i;return s;function s(u){return t.enter("thematicBreak"),o(u)}function o(u){return i=u,a(u)}function a(u){return u===i?(t.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||le(u))?(t.exit("thematicBreak"),e(u)):n(u)}function l(u){return u===i?(t.consume(u),r++,l):(t.exit("thematicBreakSequence"),xe(u)?Se(t,a,"whitespace")(u):a(u))}}const Kt={continuation:{tokenize:hj},exit:mj,name:"list",tokenize:pj},cj={partial:!0,tokenize:gj},dj={partial:!0,tokenize:fj};function pj(t,e,n){const r=this,i=r.events[r.events.length-1];let s=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,o=0;return a;function a(g){const _=r.containerState.type||(g===42||g===43||g===45?"listUnordered":"listOrdered");if(_==="listUnordered"?!r.containerState.marker||g===r.containerState.marker:em(g)){if(r.containerState.type||(r.containerState.type=_,t.enter(_,{_container:!0})),_==="listUnordered")return t.enter("listItemPrefix"),g===42||g===45?t.check(ec,n,u)(g):u(g);if(!r.interrupt||g===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(g)}return n(g)}function l(g){return em(g)&&++o<10?(t.consume(g),l):(!r.interrupt||o<2)&&(r.containerState.marker?g===r.containerState.marker:g===41||g===46)?(t.exit("listItemValue"),u(g)):n(g)}function u(g){return t.enter("listItemMarker"),t.consume(g),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||g,t.check(Ml,r.interrupt?n:d,t.attempt(cj,f,p))}function d(g){return r.containerState.initialBlankLine=!0,s++,f(g)}function p(g){return xe(g)?(t.enter("listItemPrefixWhitespace"),t.consume(g),t.exit("listItemPrefixWhitespace"),f):n(g)}function f(g){return r.containerState.size=s+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(g)}}function hj(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(Ml,i,s);function i(a){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Se(t,e,"listItemIndent",r.containerState.size+1)(a)}function s(a){return r.containerState.furtherBlankLines||!xe(a)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(a)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(dj,e,o)(a))}function o(a){return r.containerState._closeFlow=!0,r.interrupt=void 0,Se(t,t.attempt(Kt,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function fj(t,e,n){const r=this;return Se(t,i,"listItemIndent",r.containerState.size+1);function i(s){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(s):n(s)}}function mj(t){t.exit(this.containerState.type)}function gj(t,e,n){const r=this;return Se(t,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(s){const o=r.events[r.events.length-1];return!xe(s)&&o&&o[1].type==="listItemPrefixWhitespace"?e(s):n(s)}}const gv={name:"setextUnderline",resolveTo:yj,tokenize:_j};function yj(t,e){let n=t.length,r,i,s;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(i=n)}else t[n][1].type==="content"&&t.splice(n,1),!s&&t[n][1].type==="definition"&&(s=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[i][1].type="setextHeadingText",s?(t.splice(i,0,["enter",o,e]),t.splice(s+1,0,["exit",t[r][1],e]),t[r][1].end={...t[s][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function _j(t,e,n){const r=this;let i;return s;function s(u){let d=r.events.length,p;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){p=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(t.enter("setextHeadingLine"),i=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),a(u)}function a(u){return u===i?(t.consume(u),a):(t.exit("setextHeadingLineSequence"),xe(u)?Se(t,l,"lineSuffix")(u):l(u))}function l(u){return u===null||le(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const xj={tokenize:vj};function vj(t){const e=this,n=t.attempt(Ml,r,t.attempt(this.parser.constructs.flowInitial,i,Se(t,t.attempt(this.parser.constructs.flow,i,t.attempt(TM,i)),"linePrefix")));return n;function r(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function i(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const bj={resolveAll:R2()},wj=P2("string"),kj=P2("text");function P2(t){return{resolveAll:R2(t==="text"?Ej:void 0),tokenize:e};function e(n){const r=this,i=this.parser.constructs[t],s=n.attempt(i,o,a);return o;function o(d){return u(d)?s(d):a(d)}function a(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),l}function l(d){return u(d)?(n.exit("data"),s(d)):(n.consume(d),l)}function u(d){if(d===null)return!0;const p=i[d];let f=-1;if(p)for(;++f<p.length;){const g=p[f];if(!g.previous||g.previous.call(r,r.previous))return!0}return!1}}}function R2(t){return e;function e(n,r){let i=-1,s;for(;++i<=n.length;)s===void 0?n[i]&&n[i][1].type==="data"&&(s=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==s+2&&(n[s][1].end=n[i-1][1].end,n.splice(s+2,i-s-2),i=s+2),s=void 0);return t?t(n,r):n}}function Ej(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],i=e.sliceStream(r);let s=i.length,o=-1,a=0,l;for(;s--;){const u=i[s];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)a++,o--;if(o)break;o=-1}else if(u===-2)l=!0,a++;else if(u!==-1){s++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(a=0),a){const u={type:n===t.length||l||a<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-a,offset:r.end.offset-a},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const Tj={42:Kt,43:Kt,45:Kt,48:Kt,49:Kt,50:Kt,51:Kt,52:Kt,53:Kt,54:Kt,55:Kt,56:Kt,57:Kt,62:k2},Sj={91:PM},Cj={[-2]:nh,[-1]:nh,32:nh},Ij={35:zM,42:ec,45:[gv,ec],60:FM,61:gv,95:ec,96:fv,126:fv},Aj={38:T2,92:E2},Pj={[-5]:rh,[-4]:rh,[-3]:rh,33:ij,38:T2,42:tm,60:[oM,KM],91:oj,92:[DM,E2],93:ry,95:tm,96:xM},Rj={null:[tm,bj]},Nj={null:[42,95]},Lj={null:[]},Dj=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Nj,contentInitial:Sj,disable:Lj,document:Tj,flow:Ij,flowInitial:Cj,insideSpan:Rj,string:Aj,text:Pj},Symbol.toStringTag,{value:"Module"}));function Oj(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},s=[];let o=[],a=[];const l={attempt:S(O),check:S(D),consume:v,enter:w,exit:M,interrupt:S(D,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:_,parser:t,previous:null,sliceSerialize:f,sliceStream:g,write:p};let d=e.tokenize.call(u,l);return e.resolveAll&&s.push(e),u;function p(A){return o=_n(o,A),I(),o[o.length-1]!==null?[]:(E(e,0),u.events=qd(s,u.events,u),u.events)}function f(A,N){return Mj(g(A),N)}function g(A){return zj(o,A)}function _(){const{_bufferIndex:A,_index:N,line:P,column:se,offset:$}=r;return{_bufferIndex:A,_index:N,line:P,column:se,offset:$}}function k(A){i[A.line]=A.column,b()}function I(){let A;for(;r._index<o.length;){const N=o[r._index];if(typeof N=="string")for(A=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===A&&r._bufferIndex<N.length;)x(N.charCodeAt(r._bufferIndex));else x(N)}}function x(A){d=d(A)}function v(A){le(A)?(r.line++,r.column=1,r.offset+=A===-3?2:1,b()):A!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=A}function w(A,N){const P=N||{};return P.type=A,P.start=_(),u.events.push(["enter",P,u]),a.push(P),P}function M(A){const N=a.pop();return N.end=_(),u.events.push(["exit",N,u]),N}function O(A,N){E(A,N.from)}function D(A,N){N.restore()}function S(A,N){return P;function P(se,$,ae){let ye,W,ee,R;return Array.isArray(se)?re(se):"tokenize"in se?re([se]):Z(se);function Z(Ee){return He;function He(J){const q=J!==null&&Ee[J],Q=J!==null&&Ee.null,G=[...Array.isArray(q)?q:q?[q]:[],...Array.isArray(Q)?Q:Q?[Q]:[]];return re(G)(J)}}function re(Ee){return ye=Ee,W=0,Ee.length===0?ae:L(Ee[W])}function L(Ee){return He;function He(J){return R=C(),ee=Ee,Ee.partial||(u.currentConstruct=Ee),Ee.name&&u.parser.constructs.disable.null.includes(Ee.name)?Ae():Ee.tokenize.call(N?Object.assign(Object.create(u),N):u,l,he,Ae)(J)}}function he(Ee){return A(ee,R),$}function Ae(Ee){return R.restore(),++W<ye.length?L(ye[W]):ae}}}function E(A,N){A.resolveAll&&!s.includes(A)&&s.push(A),A.resolve&&ln(u.events,N,u.events.length-N,A.resolve(u.events.slice(N),u)),A.resolveTo&&(u.events=A.resolveTo(u.events,u))}function C(){const A=_(),N=u.previous,P=u.currentConstruct,se=u.events.length,$=Array.from(a);return{from:se,restore:ae};function ae(){r=A,u.previous=N,u.currentConstruct=P,u.events.length=se,a=$,b()}}function b(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function zj(t,e){const n=e.start._index,r=e.start._bufferIndex,i=e.end._index,s=e.end._bufferIndex;let o;if(n===i)o=[t[n].slice(r,s)];else{if(o=t.slice(n,i),r>-1){const a=o[0];typeof a=="string"?o[0]=a.slice(r):o.shift()}s>0&&o.push(t[i].slice(0,s))}return o}function Mj(t,e){let n=-1;const r=[];let i;for(;++n<t.length;){const s=t[n];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&i)continue;o=" ";break}default:o=String.fromCharCode(s)}i=s===-2,r.push(o)}return r.join("")}function jj(t){const r={constructs:b2([Dj,...(t||{}).extensions||[]]),content:i(Zz),defined:[],document:i(tM),flow:i(xj),lazy:{},string:i(wj),text:i(kj)};return r;function i(s){return o;function o(a){return Oj(r,s,a)}}}function Vj(t){for(;!S2(t););return t}const yv=/[\0\t\n\r]/g;function Fj(){let t=1,e="",n=!0,r;return i;function i(s,o,a){const l=[];let u,d,p,f,g;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),p=0,e="",n&&(s.charCodeAt(0)===65279&&p++,n=void 0);p<s.length;){if(yv.lastIndex=p,u=yv.exec(s),f=u&&u.index!==void 0?u.index:s.length,g=s.charCodeAt(f),!u){e=s.slice(p);break}if(g===10&&p===f&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),p<f&&(l.push(s.slice(p,f)),t+=f-p),g){case 0:{l.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,l.push(-2);t++<d;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:r=!0,t=1}p=f+1}return a&&(r&&l.push(-5),e&&l.push(e),l.push(null)),l}}const Uj=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function qj(t){return t.replace(Uj,Bj)}function Bj(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),s=i===120||i===88;return w2(n.slice(s?2:1),s?16:10)}return ny(n)||t}const N2={}.hasOwnProperty;function Wj(t,e,n){return typeof e!="string"&&(n=e,e=void 0),Hj(n)(Vj(jj(n).document().write(Fj()(t,e,!0))))}function Hj(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(at),autolinkProtocol:C,autolinkEmail:C,atxHeading:s(hn),blockQuote:s(Q),characterEscape:C,characterReference:C,codeFenced:s(G),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(G,o),codeText:s(Ie,o),codeTextData:C,data:C,codeFlowValue:C,definition:s(De),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(nt),hardBreakEscape:s(Tn),hardBreakTrailing:s(Tn),htmlFlow:s(Sn,o),htmlFlowData:C,htmlText:s(Sn,o),htmlTextData:C,image:s(Fl),label:o,link:s(at),listItem:s(vs),listItemValue:f,listOrdered:s(ft,p),listUnordered:s(ft),paragraph:s(Kd),reference:L,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(hn),strong:s(Ul),thematicBreak:s(Ri)},exit:{atxHeading:l(),atxHeadingSequence:O,autolink:l(),autolinkEmail:q,autolinkProtocol:J,blockQuote:l(),characterEscapeValue:b,characterReferenceMarkerHexadecimal:Ae,characterReferenceMarkerNumeric:Ae,characterReferenceValue:Ee,characterReference:He,codeFenced:l(I),codeFencedFence:k,codeFencedFenceInfo:g,codeFencedFenceMeta:_,codeFlowValue:b,codeIndented:l(x),codeText:l($),codeTextData:b,data:b,definition:l(),definitionDestinationString:M,definitionLabelString:v,definitionTitleString:w,emphasis:l(),hardBreakEscape:l(N),hardBreakTrailing:l(N),htmlFlow:l(P),htmlFlowData:b,htmlText:l(se),htmlTextData:b,image:l(ye),label:ee,labelText:W,lineEnding:A,link:l(ae),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:he,resourceDestinationString:R,resourceTitleString:Z,resource:re,setextHeading:l(E),setextHeadingLineSequence:S,setextHeadingText:D,strong:l(),thematicBreak:l()}};L2(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(F){let Y={type:"root",children:[]};const ce={stack:[Y],tokenStack:[],config:e,enter:a,exit:u,buffer:o,resume:d,data:n},_e=[];let Re=-1;for(;++Re<F.length;)if(F[Re][1].type==="listOrdered"||F[Re][1].type==="listUnordered")if(F[Re][0]==="enter")_e.push(Re);else{const Ht=_e.pop();Re=i(F,Ht,Re)}for(Re=-1;++Re<F.length;){const Ht=e[F[Re][0]];N2.call(Ht,F[Re][1].type)&&Ht[F[Re][1].type].call(Object.assign({sliceSerialize:F[Re][2].sliceSerialize},ce),F[Re][1])}if(ce.tokenStack.length>0){const Ht=ce.tokenStack[ce.tokenStack.length-1];(Ht[1]||_v).call(ce,void 0,Ht[0])}for(Y.position={start:qr(F.length>0?F[0][1].start:{line:1,column:1,offset:0}),end:qr(F.length>0?F[F.length-2][1].end:{line:1,column:1,offset:0})},Re=-1;++Re<e.transforms.length;)Y=e.transforms[Re](Y)||Y;return Y}function i(F,Y,ce){let _e=Y-1,Re=-1,Ht=!1,Hn,Mt,cr,dr;for(;++_e<=ce;){const Ze=F[_e];switch(Ze[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ze[0]==="enter"?Re++:Re--,dr=void 0;break}case"lineEndingBlank":{Ze[0]==="enter"&&(Hn&&!dr&&!Re&&!cr&&(cr=_e),dr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:dr=void 0}if(!Re&&Ze[0]==="enter"&&Ze[1].type==="listItemPrefix"||Re===-1&&Ze[0]==="exit"&&(Ze[1].type==="listUnordered"||Ze[1].type==="listOrdered")){if(Hn){let pr=_e;for(Mt=void 0;pr--;){const $t=F[pr];if($t[1].type==="lineEnding"||$t[1].type==="lineEndingBlank"){if($t[0]==="exit")continue;Mt&&(F[Mt][1].type="lineEndingBlank",Ht=!0),$t[1].type="lineEnding",Mt=pr}else if(!($t[1].type==="linePrefix"||$t[1].type==="blockQuotePrefix"||$t[1].type==="blockQuotePrefixWhitespace"||$t[1].type==="blockQuoteMarker"||$t[1].type==="listItemIndent"))break}cr&&(!Mt||cr<Mt)&&(Hn._spread=!0),Hn.end=Object.assign({},Mt?F[Mt][1].start:Ze[1].end),F.splice(Mt||_e,0,["exit",Hn,Ze[2]]),_e++,ce++}if(Ze[1].type==="listItemPrefix"){const pr={type:"listItem",_spread:!1,start:Object.assign({},Ze[1].start),end:void 0};Hn=pr,F.splice(_e,0,["enter",pr,Ze[2]]),_e++,ce++,cr=void 0,dr=!0}}}return F[Y][1]._spread=Ht,ce}function s(F,Y){return ce;function ce(_e){a.call(this,F(_e),_e),Y&&Y.call(this,_e)}}function o(){this.stack.push({type:"fragment",children:[]})}function a(F,Y,ce){this.stack[this.stack.length-1].children.push(F),this.stack.push(F),this.tokenStack.push([Y,ce||void 0]),F.position={start:qr(Y.start),end:void 0}}function l(F){return Y;function Y(ce){F&&F.call(this,ce),u.call(this,ce)}}function u(F,Y){const ce=this.stack.pop(),_e=this.tokenStack.pop();if(_e)_e[0].type!==F.type&&(Y?Y.call(this,F,_e[0]):(_e[1]||_v).call(this,F,_e[0]));else throw new Error("Cannot close `"+F.type+"` ("+Ma({start:F.start,end:F.end})+"): its not open");ce.position.end=qr(F.end)}function d(){return ty(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function f(F){if(this.data.expectingFirstListItemValue){const Y=this.stack[this.stack.length-2];Y.start=Number.parseInt(this.sliceSerialize(F),10),this.data.expectingFirstListItemValue=void 0}}function g(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.lang=F}function _(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.meta=F}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function I(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.value=F.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.value=F.replace(/(\r?\n|\r)$/g,"")}function v(F){const Y=this.resume(),ce=this.stack[this.stack.length-1];ce.label=Y,ce.identifier=Bn(this.sliceSerialize(F)).toLowerCase()}function w(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.title=F}function M(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.url=F}function O(F){const Y=this.stack[this.stack.length-1];if(!Y.depth){const ce=this.sliceSerialize(F).length;Y.depth=ce}}function D(){this.data.setextHeadingSlurpLineEnding=!0}function S(F){const Y=this.stack[this.stack.length-1];Y.depth=this.sliceSerialize(F).codePointAt(0)===61?1:2}function E(){this.data.setextHeadingSlurpLineEnding=void 0}function C(F){const ce=this.stack[this.stack.length-1].children;let _e=ce[ce.length-1];(!_e||_e.type!=="text")&&(_e=Qd(),_e.position={start:qr(F.start),end:void 0},ce.push(_e)),this.stack.push(_e)}function b(F){const Y=this.stack.pop();Y.value+=this.sliceSerialize(F),Y.position.end=qr(F.end)}function A(F){const Y=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ce=Y.children[Y.children.length-1];ce.position.end=qr(F.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Y.type)&&(C.call(this,F),b.call(this,F))}function N(){this.data.atHardBreak=!0}function P(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.value=F}function se(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.value=F}function $(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.value=F}function ae(){const F=this.stack[this.stack.length-1];if(this.data.inReference){const Y=this.data.referenceType||"shortcut";F.type+="Reference",F.referenceType=Y,delete F.url,delete F.title}else delete F.identifier,delete F.label;this.data.referenceType=void 0}function ye(){const F=this.stack[this.stack.length-1];if(this.data.inReference){const Y=this.data.referenceType||"shortcut";F.type+="Reference",F.referenceType=Y,delete F.url,delete F.title}else delete F.identifier,delete F.label;this.data.referenceType=void 0}function W(F){const Y=this.sliceSerialize(F),ce=this.stack[this.stack.length-2];ce.label=qj(Y),ce.identifier=Bn(Y).toLowerCase()}function ee(){const F=this.stack[this.stack.length-1],Y=this.resume(),ce=this.stack[this.stack.length-1];if(this.data.inReference=!0,ce.type==="link"){const _e=F.children;ce.children=_e}else ce.alt=Y}function R(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.url=F}function Z(){const F=this.resume(),Y=this.stack[this.stack.length-1];Y.title=F}function re(){this.data.inReference=void 0}function L(){this.data.referenceType="collapsed"}function he(F){const Y=this.resume(),ce=this.stack[this.stack.length-1];ce.label=Y,ce.identifier=Bn(this.sliceSerialize(F)).toLowerCase(),this.data.referenceType="full"}function Ae(F){this.data.characterReferenceType=F.type}function Ee(F){const Y=this.sliceSerialize(F),ce=this.data.characterReferenceType;let _e;ce?(_e=w2(Y,ce==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):_e=ny(Y);const Re=this.stack[this.stack.length-1];Re.value+=_e}function He(F){const Y=this.stack.pop();Y.position.end=qr(F.end)}function J(F){b.call(this,F);const Y=this.stack[this.stack.length-1];Y.url=this.sliceSerialize(F)}function q(F){b.call(this,F);const Y=this.stack[this.stack.length-1];Y.url="mailto:"+this.sliceSerialize(F)}function Q(){return{type:"blockquote",children:[]}}function G(){return{type:"code",lang:null,meta:null,value:""}}function Ie(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function nt(){return{type:"emphasis",children:[]}}function hn(){return{type:"heading",depth:0,children:[]}}function Tn(){return{type:"break"}}function Sn(){return{type:"html",value:""}}function Fl(){return{type:"image",title:null,url:"",alt:null}}function at(){return{type:"link",title:null,url:"",children:[]}}function ft(F){return{type:"list",ordered:F.type==="listOrdered",start:null,spread:F._spread,children:[]}}function vs(F){return{type:"listItem",spread:F._spread,checked:null,children:[]}}function Kd(){return{type:"paragraph",children:[]}}function Ul(){return{type:"strong",children:[]}}function Qd(){return{type:"text",value:""}}function Ri(){return{type:"thematicBreak"}}}function qr(t){return{line:t.line,column:t.column,offset:t.offset}}function L2(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?L2(t,r):$j(t,r)}}function $j(t,e){let n;for(n in e)if(N2.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function _v(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Ma({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Ma({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Ma({start:e.start,end:e.end})+") is still open")}function Kj(t){const e=this;e.parser=n;function n(r){return Wj(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function Qj(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function Gj(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function Yj(t,e){const n=e.value?e.value+`
`:"",r={},i=e.lang?e.lang.split(/\s+/):[];i.length>0&&(r.className=["language-"+i[0]]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function Xj(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function Jj(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function Zj(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),i=Mo(r.toLowerCase()),s=t.footnoteOrder.indexOf(r);let o,a=t.footnoteCounts.get(r);a===void 0?(a=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=s+1,a+=1,t.footnoteCounts.set(r,a);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(a>1?"-"+a:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return t.patch(e,u),t.applyData(e,u)}function e5(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function t5(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function D2(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const i=t.all(e),s=i[0];s&&s.type==="text"?s.value="["+s.value:i.unshift({type:"text",value:"["});const o=i[i.length-1];return o&&o.type==="text"?o.value+=r:i.push({type:"text",value:r}),i}function n5(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return D2(t,e);const i={src:Mo(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"img",properties:i,children:[]};return t.patch(e,s),t.applyData(e,s)}function r5(t,e){const n={src:Mo(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function i5(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function s5(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return D2(t,e);const i={href:Mo(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"a",properties:i,children:t.all(e)};return t.patch(e,s),t.applyData(e,s)}function o5(t,e){const n={href:Mo(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function a5(t,e,n){const r=t.all(e),i=n?l5(n):O2(e),s={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let p;d&&d.type==="element"&&d.tagName==="p"?p=d:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let a=-1;for(;++a<r.length;){const d=r[a];(i||a!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!i?o.push(...d.children):o.push(d)}const l=r[r.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:o};return t.patch(e,u),t.applyData(e,u)}function l5(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=O2(n[r])}return e}function O2(t){const e=t.spread;return e??t.children.length>1}function u5(t,e){const n={},r=t.all(e);let i=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++i<r.length;){const o=r[i];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,s),t.applyData(e,s)}function c5(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function d5(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function p5(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function h5(t,e){const n=t.all(e),r=n.shift(),i=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),i.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},a=Xg(e.children[1]),l=f2(e.children[e.children.length-1]);a&&l&&(o.position={start:a,end:l}),i.push(o)}const s={type:"element",tagName:"table",properties:{},children:t.wrap(i,!0)};return t.patch(e,s),t.applyData(e,s)}function f5(t,e,n){const r=n?n.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,a=o?o.length:e.children.length;let l=-1;const u=[];for(;++l<a;){const p=e.children[l],f={},g=o?o[l]:void 0;g&&(f.align=g);let _={type:"element",tagName:s,properties:f,children:[]};p&&(_.children=t.all(p),t.patch(p,_),_=t.applyData(p,_)),u.push(_)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function m5(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const xv=9,vv=32;function g5(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),i=0;const s=[];for(;r;)s.push(bv(e.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(e);return s.push(bv(e.slice(i),i>0,!1)),s.join("")}function bv(t,e,n){let r=0,i=t.length;if(e){let s=t.codePointAt(r);for(;s===xv||s===vv;)r++,s=t.codePointAt(r)}if(n){let s=t.codePointAt(i-1);for(;s===xv||s===vv;)i--,s=t.codePointAt(i-1)}return i>r?t.slice(r,i):""}function y5(t,e){const n={type:"text",value:g5(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function _5(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const x5={blockquote:Qj,break:Gj,code:Yj,delete:Xj,emphasis:Jj,footnoteReference:Zj,heading:e5,html:t5,imageReference:n5,image:r5,inlineCode:i5,linkReference:s5,link:o5,listItem:a5,list:u5,paragraph:c5,root:d5,strong:p5,table:h5,tableCell:m5,tableRow:f5,text:y5,thematicBreak:_5,toml:wu,yaml:wu,definition:wu,footnoteDefinition:wu};function wu(){}const z2=-1,Bd=0,Va=1,Jc=2,iy=3,sy=4,oy=5,ay=6,M2=7,j2=8,wv=typeof self=="object"?self:globalThis,v5=(t,e)=>{const n=(i,s)=>(t.set(s,i),i),r=i=>{if(t.has(i))return t.get(i);const[s,o]=e[i];switch(s){case Bd:case z2:return n(o,i);case Va:{const a=n([],i);for(const l of o)a.push(r(l));return a}case Jc:{const a=n({},i);for(const[l,u]of o)a[r(l)]=r(u);return a}case iy:return n(new Date(o),i);case sy:{const{source:a,flags:l}=o;return n(new RegExp(a,l),i)}case oy:{const a=n(new Map,i);for(const[l,u]of o)a.set(r(l),r(u));return a}case ay:{const a=n(new Set,i);for(const l of o)a.add(r(l));return a}case M2:{const{name:a,message:l}=o;return n(new wv[a](l),i)}case j2:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:a}=new Uint8Array(o);return n(new DataView(a),o)}}return n(new wv[s](o),i)};return r},kv=t=>v5(new Map,t)(0),Ss="",{toString:b5}={},{keys:w5}=Object,ca=t=>{const e=typeof t;if(e!=="object"||!t)return[Bd,e];const n=b5.call(t).slice(8,-1);switch(n){case"Array":return[Va,Ss];case"Object":return[Jc,Ss];case"Date":return[iy,Ss];case"RegExp":return[sy,Ss];case"Map":return[oy,Ss];case"Set":return[ay,Ss];case"DataView":return[Va,n]}return n.includes("Array")?[Va,n]:n.includes("Error")?[M2,n]:[Jc,n]},ku=([t,e])=>t===Bd&&(e==="function"||e==="symbol"),k5=(t,e,n,r)=>{const i=(o,a)=>{const l=r.push(o)-1;return n.set(a,l),l},s=o=>{if(n.has(o))return n.get(o);let[a,l]=ca(o);switch(a){case Bd:{let d=o;switch(l){case"bigint":a=j2,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);d=null;break;case"undefined":return i([z2],o)}return i([a,d],o)}case Va:{if(l){let f=o;return l==="DataView"?f=new Uint8Array(o.buffer):l==="ArrayBuffer"&&(f=new Uint8Array(o)),i([l,[...f]],o)}const d=[],p=i([a,d],o);for(const f of o)d.push(s(f));return p}case Jc:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const d=[],p=i([a,d],o);for(const f of w5(o))(t||!ku(ca(o[f])))&&d.push([s(f),s(o[f])]);return p}case iy:return i([a,o.toISOString()],o);case sy:{const{source:d,flags:p}=o;return i([a,{source:d,flags:p}],o)}case oy:{const d=[],p=i([a,d],o);for(const[f,g]of o)(t||!(ku(ca(f))||ku(ca(g))))&&d.push([s(f),s(g)]);return p}case ay:{const d=[],p=i([a,d],o);for(const f of o)(t||!ku(ca(f)))&&d.push(s(f));return p}}const{message:u}=o;return i([a,{name:l,message:u}],o)};return s},Ev=(t,{json:e,lossy:n}={})=>{const r=[];return k5(!(e||n),!!e,new Map,r)(t),r},Zc=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?kv(Ev(t,e)):structuredClone(t):(t,e)=>kv(Ev(t,e));function E5(t,e){const n=[{type:"text",value:""}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function T5(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function S5(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||E5,r=t.options.footnoteBackLabel||T5,i=t.options.footnoteLabel||"Footnotes",s=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},a=[];let l=-1;for(;++l<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[l]);if(!u)continue;const d=t.all(u),p=String(u.identifier).toUpperCase(),f=Mo(p.toLowerCase());let g=0;const _=[],k=t.footnoteCounts.get(p);for(;k!==void 0&&++g<=k;){_.length>0&&_.push({type:"text",value:" "});let v=typeof n=="string"?n:n(l,g);typeof v=="string"&&(v={type:"text",value:v}),_.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,g),className:["data-footnote-backref"]},children:Array.isArray(v)?v:[v]})}const I=d[d.length-1];if(I&&I.type==="element"&&I.tagName==="p"){const v=I.children[I.children.length-1];v&&v.type==="text"?v.value+=" ":I.children.push({type:"text",value:" "}),I.children.push(..._)}else d.push(..._);const x={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,x),a.push(x)}if(a.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Zc(o),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(a,!0)},{type:"text",value:`
`}]}}const Wd=function(t){if(t==null)return P5;if(typeof t=="function")return Hd(t);if(typeof t=="object")return Array.isArray(t)?C5(t):I5(t);if(typeof t=="string")return A5(t);throw new Error("Expected function, string, or object as test")};function C5(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=Wd(t[n]);return Hd(r);function r(...i){let s=-1;for(;++s<e.length;)if(e[s].apply(this,i))return!0;return!1}}function I5(t){const e=t;return Hd(n);function n(r){const i=r;let s;for(s in t)if(i[s]!==e[s])return!1;return!0}}function A5(t){return Hd(e);function e(n){return n&&n.type===t}}function Hd(t){return e;function e(n,r,i){return!!(R5(n)&&t.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function P5(){return!0}function R5(t){return t!==null&&typeof t=="object"&&"type"in t}const V2=[],N5=!0,nm=!1,L5="skip";function F2(t,e,n,r){let i;typeof e=="function"&&typeof n!="function"?(r=n,n=e):i=e;const s=Wd(i),o=r?-1:1;a(t,void 0,[])();function a(l,u,d){const p=l&&typeof l=="object"?l:{};if(typeof p.type=="string"){const g=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(l.type+(g?"<"+g+">":""))+")"})}return f;function f(){let g=V2,_,k,I;if((!e||s(l,u,d[d.length-1]||void 0))&&(g=D5(n(l,d)),g[0]===nm))return g;if("children"in l&&l.children){const x=l;if(x.children&&g[0]!==L5)for(k=(r?x.children.length:-1)+o,I=d.concat(x);k>-1&&k<x.children.length;){const v=x.children[k];if(_=a(v,k,I)(),_[0]===nm)return _;k=typeof _[1]=="number"?_[1]:k+o}}return g}}}function D5(t){return Array.isArray(t)?t:typeof t=="number"?[N5,t]:t==null?V2:[t]}function ly(t,e,n,r){let i,s,o;typeof e=="function"&&typeof n!="function"?(s=void 0,o=e,i=n):(s=e,o=n,i=r),F2(t,s,a,i);function a(l,u){const d=u[u.length-1],p=d?d.children.indexOf(l):void 0;return o(l,p,d)}}const rm={}.hasOwnProperty,O5={};function z5(t,e){const n=e||O5,r=new Map,i=new Map,s=new Map,o={...x5,...n.handlers},a={all:u,applyData:j5,definitionById:r,footnoteById:i,footnoteCounts:s,footnoteOrder:[],handlers:o,one:l,options:n,patch:M5,wrap:F5};return ly(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const p=d.type==="definition"?r:i,f=String(d.identifier).toUpperCase();p.has(f)||p.set(f,d)}}),a;function l(d,p){const f=d.type,g=a.handlers[f];if(rm.call(a.handlers,f)&&g)return g(a,d,p);if(a.options.passThrough&&a.options.passThrough.includes(f)){if("children"in d){const{children:k,...I}=d,x=Zc(I);return x.children=a.all(d),x}return Zc(d)}return(a.options.unknownHandler||V5)(a,d,p)}function u(d){const p=[];if("children"in d){const f=d.children;let g=-1;for(;++g<f.length;){const _=a.one(f[g],d);if(_){if(g&&f[g-1].type==="break"&&(!Array.isArray(_)&&_.type==="text"&&(_.value=Tv(_.value)),!Array.isArray(_)&&_.type==="element")){const k=_.children[0];k&&k.type==="text"&&(k.value=Tv(k.value))}Array.isArray(_)?p.push(..._):p.push(_)}}}return p}}function M5(t,e){t.position&&(e.position=Tz(t))}function j5(t,e){let n=e;if(t&&t.data){const r=t.data.hName,i=t.data.hChildren,s=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&s&&Object.assign(n.properties,Zc(s)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function V5(t,e){const n=e.data||{},r="value"in e&&!(rm.call(n,"hProperties")||rm.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function F5(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function Tv(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function Sv(t,e){const n=z5(t,e),r=n.one(t,void 0),i=S5(n),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&s.children.push({type:"text",value:`
`},i),s}function U5(t,e){return t&&"run"in t?async function(n,r){const i=Sv(n,{file:r,...e});await t.run(i,r)}:function(n,r){return Sv(n,{file:r,...t||e})}}function Cv(t){if(t)throw t}var tc=Object.prototype.hasOwnProperty,U2=Object.prototype.toString,Iv=Object.defineProperty,Av=Object.getOwnPropertyDescriptor,Pv=function(e){return typeof Array.isArray=="function"?Array.isArray(e):U2.call(e)==="[object Array]"},Rv=function(e){if(!e||U2.call(e)!=="[object Object]")return!1;var n=tc.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&tc.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var i;for(i in e);return typeof i>"u"||tc.call(e,i)},Nv=function(e,n){Iv&&n.name==="__proto__"?Iv(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},Lv=function(e,n){if(n==="__proto__")if(tc.call(e,n)){if(Av)return Av(e,n).value}else return;return e[n]},q5=function t(){var e,n,r,i,s,o,a=arguments[0],l=1,u=arguments.length,d=!1;for(typeof a=="boolean"&&(d=a,a=arguments[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<u;++l)if(e=arguments[l],e!=null)for(n in e)r=Lv(a,n),i=Lv(e,n),a!==i&&(d&&i&&(Rv(i)||(s=Pv(i)))?(s?(s=!1,o=r&&Pv(r)?r:[]):o=r&&Rv(r)?r:{},Nv(a,{name:n,newValue:t(d,o,i)})):typeof i<"u"&&Nv(a,{name:n,newValue:i}));return a};const ih=ps(q5);function im(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function B5(){const t=[],e={run:n,use:r};return e;function n(...i){let s=-1;const o=i.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);a(null,...i);function a(l,...u){const d=t[++s];let p=-1;if(l){o(l);return}for(;++p<i.length;)(u[p]===null||u[p]===void 0)&&(u[p]=i[p]);i=u,d?W5(d,a)(...u):o(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return t.push(i),e}}function W5(t,e){let n;return r;function r(...o){const a=t.length>o.length;let l;a&&o.push(i);try{l=t.apply(this,o)}catch(u){const d=u;if(a&&n)throw d;return i(d)}a||(l&&l.then&&typeof l.then=="function"?l.then(s,i):l instanceof Error?i(l):s(l))}function i(o,...a){n||(n=!0,e(o,...a))}function s(o){i(null,o)}}const Yn={basename:H5,dirname:$5,extname:K5,join:Q5,sep:"/"};function H5(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');jl(t);let n=0,r=-1,i=t.length,s;if(e===void 0||e.length===0||e.length>t.length){for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else r<0&&(s=!0,r=i+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,a=e.length-1;for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else o<0&&(s=!0,o=i+1),a>-1&&(t.codePointAt(i)===e.codePointAt(a--)?a<0&&(r=i):(a=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function $5(t){if(jl(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function K5(t){jl(t);let e=t.length,n=-1,r=0,i=-1,s=0,o;for(;e--;){const a=t.codePointAt(e);if(a===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),a===46?i<0?i=e:s!==1&&(s=1):i>-1&&(s=-1)}return i<0||n<0||s===0||s===1&&i===n-1&&i===r+1?"":t.slice(i,n)}function Q5(...t){let e=-1,n;for(;++e<t.length;)jl(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":G5(n)}function G5(t){jl(t);const e=t.codePointAt(0)===47;let n=Y5(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function Y5(t,e){let n="",r=0,i=-1,s=0,o=-1,a,l;for(;++o<=t.length;){if(o<t.length)a=t.codePointAt(o);else{if(a===47)break;a=47}if(a===47){if(!(i===o-1||s===1))if(i!==o-1&&s===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=o,s=0;continue}}else if(n.length>0){n="",r=0,i=o,s=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(i+1,o):n=t.slice(i+1,o),r=o-i-1;i=o,s=0}else a===46&&s>-1?s++:s=-1}return n}function jl(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const X5={cwd:J5};function J5(){return"/"}function sm(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function Z5(t){if(typeof t=="string")t=new URL(t);else if(!sm(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return eV(t)}function eV(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const sh=["history","path","basename","stem","extname","dirname"];class q2{constructor(e){let n;e?sm(e)?n={path:e}:typeof e=="string"||tV(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":X5.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<sh.length;){const s=sh[r];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let i;for(i in n)sh.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?Yn.basename(this.path):void 0}set basename(e){ah(e,"basename"),oh(e,"basename"),this.path=Yn.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Yn.dirname(this.path):void 0}set dirname(e){Dv(this.basename,"dirname"),this.path=Yn.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Yn.extname(this.path):void 0}set extname(e){if(oh(e,"extname"),Dv(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Yn.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){sm(e)&&(e=Z5(e)),ah(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Yn.basename(this.path,this.extname):void 0}set stem(e){ah(e,"stem"),oh(e,"stem"),this.path=Yn.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const i=this.message(e,n,r);throw i.fatal=!0,i}info(e,n,r){const i=this.message(e,n,r);return i.fatal=void 0,i}message(e,n,r){const i=new zt(e,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function oh(t,e){if(t&&t.includes(Yn.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Yn.sep+"`")}function ah(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function Dv(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function tV(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const nV=function(t){const r=this.constructor.prototype,i=r[t],s=function(){return i.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},rV={}.hasOwnProperty;class uy extends nV{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=B5()}copy(){const e=new uy;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(ih(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(ch("data",this.frozen),this.namespace[e]=n,this):rV.call(this.namespace,e)&&this.namespace[e]||void 0:e?(ch("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(e,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Eu(e),r=this.parser||this.Parser;return lh("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),lh("process",this.parser||this.Parser),uh("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(s,o){const a=Eu(e),l=r.parse(a);r.run(l,a,function(d,p,f){if(d||!p||!f)return u(d);const g=p,_=r.stringify(g,f);oV(_)?f.value=_:f.result=_,u(d,f)});function u(d,p){d||!p?o(d):s?s(p):n(void 0,p)}}}processSync(e){let n=!1,r;return this.freeze(),lh("processSync",this.parser||this.Parser),uh("processSync",this.compiler||this.Compiler),this.process(e,i),zv("processSync","process",n),r;function i(s,o){n=!0,Cv(s),r=o}}run(e,n,r){Ov(e),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?s(void 0,r):new Promise(s);function s(o,a){const l=Eu(n);i.run(e,l,u);function u(d,p,f){const g=p||e;d?a(d):o?o(g):r(void 0,g,f)}}}runSync(e,n){let r=!1,i;return this.run(e,n,s),zv("runSync","run",r),i;function s(o,a){Cv(o),i=a,r=!0}}stringify(e,n){this.freeze();const r=Eu(n),i=this.compiler||this.Compiler;return uh("stringify",i),Ov(e),i(e,r)}use(e,...n){const r=this.attachers,i=this.namespace;if(ch("use",this.frozen),e!=null)if(typeof e=="function")l(e,n);else if(typeof e=="object")Array.isArray(e)?a(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...p]=u;l(d,p)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");a(u.plugins),u.settings&&(i.settings=ih(!0,i.settings,u.settings))}function a(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const p=u[d];s(p)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,d){let p=-1,f=-1;for(;++p<r.length;)if(r[p][0]===u){f=p;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[g,..._]=d;const k=r[f][1];im(k)&&im(g)&&(g=ih(!0,k,g)),r[f]=[u,g,..._]}}}}const iV=new uy().freeze();function lh(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function uh(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function ch(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ov(t){if(!im(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function zv(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Eu(t){return sV(t)?t:new q2(t)}function sV(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function oV(t){return typeof t=="string"||aV(t)}function aV(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const lV="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Mv=[],jv={allowDangerousHtml:!0},uV=/^(https?|ircs?|mailto|xmpp)$/i,cV=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function B2(t){const e=dV(t),n=pV(t);return hV(e.runSync(e.parse(n),n),t)}function dV(t){const e=t.rehypePlugins||Mv,n=t.remarkPlugins||Mv,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...jv}:jv;return iV().use(Kj).use(n).use(U5,r).use(e)}function pV(t){const e=t.children||"",n=new q2;return typeof e=="string"&&(n.value=e),n}function hV(t,e){const n=e.allowedElements,r=e.allowElement,i=e.components,s=e.disallowedElements,o=e.skipHtml,a=e.unwrapDisallowed,l=e.urlTransform||fV;for(const d of cV)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+lV+d.id,void 0);return e.className&&(t={type:"element",tagName:"div",properties:{className:e.className},children:t.type==="root"?t.children:[t]}),ly(t,u),Pz(t,{Fragment:h.Fragment,components:i,ignoreInvalidStyle:!0,jsx:h.jsx,jsxs:h.jsxs,passKeys:!0,passNode:!0});function u(d,p,f){if(d.type==="raw"&&f&&typeof p=="number")return o?f.children.splice(p,1):f.children[p]={type:"text",value:d.value},p;if(d.type==="element"){let g;for(g in th)if(Object.hasOwn(th,g)&&Object.hasOwn(d.properties,g)){const _=d.properties[g],k=th[g];(k===null||k.includes(d.tagName))&&(d.properties[g]=l(String(_||""),g,d))}}if(d.type==="element"){let g=n?!n.includes(d.tagName):s?s.includes(d.tagName):!1;if(!g&&r&&typeof p=="number"&&(g=!r(d,p,f)),g&&f&&typeof p=="number")return a&&d.children?f.children.splice(p,1,...d.children):f.children.splice(p,1),p}}}function fV(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),i=t.indexOf("/");return e===-1||i!==-1&&e>i||n!==-1&&e>n||r!==-1&&e>r||uV.test(t.slice(0,e))?t:""}function Vv(t,e){const n=String(t);if(typeof e!="string")throw new TypeError("Expected character");let r=0,i=n.indexOf(e);for(;i!==-1;)r++,i=n.indexOf(e,i+e.length);return r}function mV(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function gV(t,e,n){const i=Wd((n||{}).ignore||[]),s=yV(e);let o=-1;for(;++o<s.length;)F2(t,"text",a);function a(u,d){let p=-1,f;for(;++p<d.length;){const g=d[p],_=f?f.children:void 0;if(i(g,_?_.indexOf(g):void 0,f))return;f=g}if(f)return l(u,d)}function l(u,d){const p=d[d.length-1],f=s[o][0],g=s[o][1];let _=0;const I=p.children.indexOf(u);let x=!1,v=[];f.lastIndex=0;let w=f.exec(u.value);for(;w;){const M=w.index,O={index:w.index,input:w.input,stack:[...d,u]};let D=g(...w,O);if(typeof D=="string"&&(D=D.length>0?{type:"text",value:D}:void 0),D===!1?f.lastIndex=M+1:(_!==M&&v.push({type:"text",value:u.value.slice(_,M)}),Array.isArray(D)?v.push(...D):D&&v.push(D),_=M+w[0].length,x=!0),!f.global)break;w=f.exec(u.value)}return x?(_<u.value.length&&v.push({type:"text",value:u.value.slice(_)}),p.children.splice(I,1,...v)):v=[u],I+v.length}}function yV(t){const e=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!t[0]||Array.isArray(t[0])?t:[t];let r=-1;for(;++r<n.length;){const i=n[r];e.push([_V(i[0]),xV(i[1])])}return e}function _V(t){return typeof t=="string"?new RegExp(mV(t),"g"):t}function xV(t){return typeof t=="function"?t:function(){return t}}const dh="phrasing",ph=["autolink","link","image","label"];function vV(){return{transforms:[CV],enter:{literalAutolink:wV,literalAutolinkEmail:hh,literalAutolinkHttp:hh,literalAutolinkWww:hh},exit:{literalAutolink:SV,literalAutolinkEmail:TV,literalAutolinkHttp:kV,literalAutolinkWww:EV}}}function bV(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:dh,notInConstruct:ph},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:dh,notInConstruct:ph},{character:":",before:"[ps]",after:"\\/",inConstruct:dh,notInConstruct:ph}]}}function wV(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function hh(t){this.config.enter.autolinkProtocol.call(this,t)}function kV(t){this.config.exit.autolinkProtocol.call(this,t)}function EV(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(t)}function TV(t){this.config.exit.autolinkEmail.call(this,t)}function SV(t){this.exit(t)}function CV(t){gV(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,IV],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),AV]],{ignore:["link","linkReference"]})}function IV(t,e,n,r,i){let s="";if(!W2(i)||(/^w/i.test(e)&&(n=e+n,e="",s="http://"),!PV(n)))return!1;const o=RV(n+r);if(!o[0])return!1;const a={type:"link",title:null,url:s+e+o[0],children:[{type:"text",value:e+o[0]}]};return o[1]?[a,{type:"text",value:o[1]}]:a}function AV(t,e,n,r){return!W2(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+n,children:[{type:"text",value:e+"@"+n}]}}function PV(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function RV(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let n=e[0],r=n.indexOf(")");const i=Vv(t,"(");let s=Vv(t,")");for(;r!==-1&&i>s;)t+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),s++;return[t,n]}function W2(t,e){const n=t.input.charCodeAt(t.index-1);return(t.index===0||ds(n)||Ud(n))&&(!e||n!==47)}H2.peek=FV;function NV(){this.buffer()}function LV(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function DV(){this.buffer()}function OV(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function zV(t){const e=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=Bn(this.sliceSerialize(t)).toLowerCase(),n.label=e}function MV(t){this.exit(t)}function jV(t){const e=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=Bn(this.sliceSerialize(t)).toLowerCase(),n.label=e}function VV(t){this.exit(t)}function FV(){return"["}function H2(t,e,n,r){const i=n.createTracker(r);let s=i.move("[^");const o=n.enter("footnoteReference"),a=n.enter("reference");return s+=i.move(n.safe(n.associationId(t),{after:"]",before:s})),a(),o(),s+=i.move("]"),s}function UV(){return{enter:{gfmFootnoteCallString:NV,gfmFootnoteCall:LV,gfmFootnoteDefinitionLabelString:DV,gfmFootnoteDefinition:OV},exit:{gfmFootnoteCallString:zV,gfmFootnoteCall:MV,gfmFootnoteDefinitionLabelString:jV,gfmFootnoteDefinition:VV}}}function qV(t){let e=!1;return t&&t.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:n,footnoteReference:H2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,i,s,o){const a=s.createTracker(o);let l=a.move("[^");const u=s.enter("footnoteDefinition"),d=s.enter("label");return l+=a.move(s.safe(s.associationId(r),{before:l,after:"]"})),d(),l+=a.move("]:"),r.children&&r.children.length>0&&(a.shift(4),l+=a.move((e?`
`:" ")+s.indentLines(s.containerFlow(r,a.current()),e?$2:BV))),u(),l}}function BV(t,e,n){return e===0?t:$2(t,e,n)}function $2(t,e,n){return(n?"":"    ")+t}const WV=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];K2.peek=GV;function HV(){return{canContainEols:["delete"],enter:{strikethrough:KV},exit:{strikethrough:QV}}}function $V(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:WV}],handlers:{delete:K2}}}function KV(t){this.enter({type:"delete",children:[]},t)}function QV(t){this.exit(t)}function K2(t,e,n,r){const i=n.createTracker(r),s=n.enter("strikethrough");let o=i.move("~~");return o+=n.containerPhrasing(t,{...i.current(),before:o,after:"~"}),o+=i.move("~~"),s(),o}function GV(){return"~"}function YV(t){return t.length}function XV(t,e){const n=e||{},r=(n.align||[]).concat(),i=n.stringLength||YV,s=[],o=[],a=[],l=[];let u=0,d=-1;for(;++d<t.length;){const k=[],I=[];let x=-1;for(t[d].length>u&&(u=t[d].length);++x<t[d].length;){const v=JV(t[d][x]);if(n.alignDelimiters!==!1){const w=i(v);I[x]=w,(l[x]===void 0||w>l[x])&&(l[x]=w)}k.push(v)}o[d]=k,a[d]=I}let p=-1;if(typeof r=="object"&&"length"in r)for(;++p<u;)s[p]=Fv(r[p]);else{const k=Fv(r);for(;++p<u;)s[p]=k}p=-1;const f=[],g=[];for(;++p<u;){const k=s[p];let I="",x="";k===99?(I=":",x=":"):k===108?I=":":k===114&&(x=":");let v=n.alignDelimiters===!1?1:Math.max(1,l[p]-I.length-x.length);const w=I+"-".repeat(v)+x;n.alignDelimiters!==!1&&(v=I.length+v+x.length,v>l[p]&&(l[p]=v),g[p]=v),f[p]=w}o.splice(1,0,f),a.splice(1,0,g),d=-1;const _=[];for(;++d<o.length;){const k=o[d],I=a[d];p=-1;const x=[];for(;++p<u;){const v=k[p]||"";let w="",M="";if(n.alignDelimiters!==!1){const O=l[p]-(I[p]||0),D=s[p];D===114?w=" ".repeat(O):D===99?O%2?(w=" ".repeat(O/2+.5),M=" ".repeat(O/2-.5)):(w=" ".repeat(O/2),M=w):M=" ".repeat(O)}n.delimiterStart!==!1&&!p&&x.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&v==="")&&(n.delimiterStart!==!1||p)&&x.push(" "),n.alignDelimiters!==!1&&x.push(w),x.push(v),n.alignDelimiters!==!1&&x.push(M),n.padding!==!1&&x.push(" "),(n.delimiterEnd!==!1||p!==u-1)&&x.push("|")}_.push(n.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return _.join(`
`)}function JV(t){return t==null?"":String(t)}function Fv(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function ZV(t,e,n,r){const i=n.enter("blockquote"),s=n.createTracker(r);s.move("> "),s.shift(2);const o=n.indentLines(n.containerFlow(t,s.current()),eF);return i(),o}function eF(t,e,n){return">"+(n?"":" ")+t}function tF(t,e){return Uv(t,e.inConstruct,!0)&&!Uv(t,e.notInConstruct,!1)}function Uv(t,e,n){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return n;let r=-1;for(;++r<e.length;)if(t.includes(e[r]))return!0;return!1}function qv(t,e,n,r){let i=-1;for(;++i<n.unsafe.length;)if(n.unsafe[i].character===`
`&&tF(n.stack,n.unsafe[i]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function nF(t,e){const n=String(t);let r=n.indexOf(e),i=r,s=0,o=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===i?++s>o&&(o=s):s=1,i=r+e.length,r=n.indexOf(e,i);return o}function rF(t,e){return!!(e.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function iF(t){const e=t.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function sF(t,e,n,r){const i=iF(n),s=t.value||"",o=i==="`"?"GraveAccent":"Tilde";if(rF(t,n)){const p=n.enter("codeIndented"),f=n.indentLines(s,oF);return p(),f}const a=n.createTracker(r),l=i.repeat(Math.max(nF(s,i)+1,3)),u=n.enter("codeFenced");let d=a.move(l);if(t.lang){const p=n.enter(`codeFencedLang${o}`);d+=a.move(n.safe(t.lang,{before:d,after:" ",encode:["`"],...a.current()})),p()}if(t.lang&&t.meta){const p=n.enter(`codeFencedMeta${o}`);d+=a.move(" "),d+=a.move(n.safe(t.meta,{before:d,after:`
`,encode:["`"],...a.current()})),p()}return d+=a.move(`
`),s&&(d+=a.move(s+`
`)),d+=a.move(l),u(),d}function oF(t,e,n){return(n?"":"    ")+t}function cy(t){const e=t.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function aF(t,e,n,r){const i=cy(n),s=i==='"'?"Quote":"Apostrophe",o=n.enter("definition");let a=n.enter("label");const l=n.createTracker(r);let u=l.move("[");return u+=l.move(n.safe(n.associationId(t),{before:u,after:"]",...l.current()})),u+=l.move("]: "),a(),!t.url||/[\0- \u007F]/.test(t.url)?(a=n.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(n.safe(t.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(a=n.enter("destinationRaw"),u+=l.move(n.safe(t.url,{before:u,after:t.title?" ":`
`,...l.current()}))),a(),t.title&&(a=n.enter(`title${s}`),u+=l.move(" "+i),u+=l.move(n.safe(t.title,{before:u,after:i,...l.current()})),u+=l.move(i),a()),o(),u}function lF(t){const e=t.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function ml(t){return"&#x"+t.toString(16).toUpperCase()+";"}function ed(t,e,n){const r=ko(t),i=ko(e);return r===void 0?i===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Q2.peek=uF;function Q2(t,e,n,r){const i=lF(n),s=n.enter("emphasis"),o=n.createTracker(r),a=o.move(i);let l=o.move(n.containerPhrasing(t,{after:i,before:a,...o.current()}));const u=l.charCodeAt(0),d=ed(r.before.charCodeAt(r.before.length-1),u,i);d.inside&&(l=ml(u)+l.slice(1));const p=l.charCodeAt(l.length-1),f=ed(r.after.charCodeAt(0),p,i);f.inside&&(l=l.slice(0,-1)+ml(p));const g=o.move(i);return s(),n.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},a+l+g}function uF(t,e,n){return n.options.emphasis||"*"}function cF(t,e){let n=!1;return ly(t,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,nm}),!!((!t.depth||t.depth<3)&&ty(t)&&(e.options.setext||n))}function dF(t,e,n,r){const i=Math.max(Math.min(6,t.depth||1),1),s=n.createTracker(r);if(cF(t,n)){const d=n.enter("headingSetext"),p=n.enter("phrasing"),f=n.containerPhrasing(t,{...s.current(),before:`
`,after:`
`});return p(),d(),f+`
`+(i===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const o="#".repeat(i),a=n.enter("headingAtx"),l=n.enter("phrasing");s.move(o+" ");let u=n.containerPhrasing(t,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(u)&&(u=ml(u.charCodeAt(0))+u.slice(1)),u=u?o+" "+u:o,n.options.closeAtx&&(u+=" "+o),l(),a(),u}G2.peek=pF;function G2(t){return t.value||""}function pF(){return"<"}Y2.peek=hF;function Y2(t,e,n,r){const i=cy(n),s=i==='"'?"Quote":"Apostrophe",o=n.enter("image");let a=n.enter("label");const l=n.createTracker(r);let u=l.move("![");return u+=l.move(n.safe(t.alt,{before:u,after:"]",...l.current()})),u+=l.move("]("),a(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(a=n.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(n.safe(t.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(a=n.enter("destinationRaw"),u+=l.move(n.safe(t.url,{before:u,after:t.title?" ":")",...l.current()}))),a(),t.title&&(a=n.enter(`title${s}`),u+=l.move(" "+i),u+=l.move(n.safe(t.title,{before:u,after:i,...l.current()})),u+=l.move(i),a()),u+=l.move(")"),o(),u}function hF(){return"!"}X2.peek=fF;function X2(t,e,n,r){const i=t.referenceType,s=n.enter("imageReference");let o=n.enter("label");const a=n.createTracker(r);let l=a.move("![");const u=n.safe(t.alt,{before:l,after:"]",...a.current()});l+=a.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const p=n.safe(n.associationId(t),{before:l,after:"]",...a.current()});return o(),n.stack=d,s(),i==="full"||!u||u!==p?l+=a.move(p+"]"):i==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function fF(){return"!"}J2.peek=mF;function J2(t,e,n){let r=t.value||"",i="`",s=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(r);)i+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<n.unsafe.length;){const o=n.unsafe[s],a=n.compilePattern(o);let l;if(o.atBreak)for(;l=a.exec(r);){let u=l.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(l.index+1)}}return i+r+i}function mF(){return"`"}function Z2(t,e){const n=ty(t);return!!(!e.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(n===t.url||"mailto:"+n===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}eT.peek=gF;function eT(t,e,n,r){const i=cy(n),s=i==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let a,l;if(Z2(t,n)){const d=n.stack;n.stack=[],a=n.enter("autolink");let p=o.move("<");return p+=o.move(n.containerPhrasing(t,{before:p,after:">",...o.current()})),p+=o.move(">"),a(),n.stack=d,p}a=n.enter("link"),l=n.enter("label");let u=o.move("[");return u+=o.move(n.containerPhrasing(t,{before:u,after:"](",...o.current()})),u+=o.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),u+=o.move("<"),u+=o.move(n.safe(t.url,{before:u,after:">",...o.current()})),u+=o.move(">")):(l=n.enter("destinationRaw"),u+=o.move(n.safe(t.url,{before:u,after:t.title?" ":")",...o.current()}))),l(),t.title&&(l=n.enter(`title${s}`),u+=o.move(" "+i),u+=o.move(n.safe(t.title,{before:u,after:i,...o.current()})),u+=o.move(i),l()),u+=o.move(")"),a(),u}function gF(t,e,n){return Z2(t,n)?"<":"["}tT.peek=yF;function tT(t,e,n,r){const i=t.referenceType,s=n.enter("linkReference");let o=n.enter("label");const a=n.createTracker(r);let l=a.move("[");const u=n.containerPhrasing(t,{before:l,after:"]",...a.current()});l+=a.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const p=n.safe(n.associationId(t),{before:l,after:"]",...a.current()});return o(),n.stack=d,s(),i==="full"||!u||u!==p?l+=a.move(p+"]"):i==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function yF(){return"["}function dy(t){const e=t.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function _F(t){const e=dy(t),n=t.options.bulletOther;if(!n)return e==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+n+"`) to be different");return n}function xF(t){const e=t.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function nT(t){const e=t.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function vF(t,e,n,r){const i=n.enter("list"),s=n.bulletCurrent;let o=t.ordered?xF(n):dy(n);const a=t.ordered?o==="."?")":".":_F(n);let l=e&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!t.ordered){const d=t.children?t.children[0]:void 0;if((o==="*"||o==="-")&&d&&(!d.children||!d.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(l=!0),nT(n)===o&&d){let p=-1;for(;++p<t.children.length;){const f=t.children[p];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(o=a),n.bulletCurrent=o;const u=n.containerFlow(t,r);return n.bulletLastUsed=o,n.bulletCurrent=s,i(),u}function bF(t){const e=t.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function wF(t,e,n,r){const i=bF(n);let s=n.bulletCurrent||dy(n);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(n.options.incrementListMarker===!1?0:e.children.indexOf(t))+s);let o=s.length+1;(i==="tab"||i==="mixed"&&(e&&e.type==="list"&&e.spread||t.spread))&&(o=Math.ceil(o/4)*4);const a=n.createTracker(r);a.move(s+" ".repeat(o-s.length)),a.shift(o);const l=n.enter("listItem"),u=n.indentLines(n.containerFlow(t,a.current()),d);return l(),u;function d(p,f,g){return f?(g?"":" ".repeat(o))+p:(g?s:s+" ".repeat(o-s.length))+p}}function kF(t,e,n,r){const i=n.enter("paragraph"),s=n.enter("phrasing"),o=n.containerPhrasing(t,r);return s(),i(),o}const EF=Wd(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function TF(t,e,n,r){return(t.children.some(function(o){return EF(o)})?n.containerPhrasing:n.containerFlow).call(n,t,r)}function SF(t){const e=t.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}rT.peek=CF;function rT(t,e,n,r){const i=SF(n),s=n.enter("strong"),o=n.createTracker(r),a=o.move(i+i);let l=o.move(n.containerPhrasing(t,{after:i,before:a,...o.current()}));const u=l.charCodeAt(0),d=ed(r.before.charCodeAt(r.before.length-1),u,i);d.inside&&(l=ml(u)+l.slice(1));const p=l.charCodeAt(l.length-1),f=ed(r.after.charCodeAt(0),p,i);f.inside&&(l=l.slice(0,-1)+ml(p));const g=o.move(i+i);return s(),n.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},a+l+g}function CF(t,e,n){return n.options.strong||"*"}function IF(t,e,n,r){return n.safe(t.value,r)}function AF(t){const e=t.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function PF(t,e,n){const r=(nT(n)+(n.options.ruleSpaces?" ":"")).repeat(AF(n));return n.options.ruleSpaces?r.slice(0,-1):r}const iT={blockquote:ZV,break:qv,code:sF,definition:aF,emphasis:Q2,hardBreak:qv,heading:dF,html:G2,image:Y2,imageReference:X2,inlineCode:J2,link:eT,linkReference:tT,list:vF,listItem:wF,paragraph:kF,root:TF,strong:rT,text:IF,thematicBreak:PF};function RF(){return{enter:{table:NF,tableData:Bv,tableHeader:Bv,tableRow:DF},exit:{codeText:OF,table:LF,tableData:fh,tableHeader:fh,tableRow:fh}}}function NF(t){const e=t._align;this.enter({type:"table",align:e.map(function(n){return n==="none"?null:n}),children:[]},t),this.data.inTable=!0}function LF(t){this.exit(t),this.data.inTable=void 0}function DF(t){this.enter({type:"tableRow",children:[]},t)}function fh(t){this.exit(t)}function Bv(t){this.enter({type:"tableCell",children:[]},t)}function OF(t){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,zF));const n=this.stack[this.stack.length-1];n.type,n.value=e,this.exit(t)}function zF(t,e){return e==="|"?e:t}function MF(t){const e=t||{},n=e.tableCellPadding,r=e.tablePipeAlign,i=e.stringLength,s=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:o,tableCell:l,tableRow:a}};function o(g,_,k,I){return u(d(g,k,I),g.align)}function a(g,_,k,I){const x=p(g,k,I),v=u([x]);return v.slice(0,v.indexOf(`
`))}function l(g,_,k,I){const x=k.enter("tableCell"),v=k.enter("phrasing"),w=k.containerPhrasing(g,{...I,before:s,after:s});return v(),x(),w}function u(g,_){return XV(g,{align:_,alignDelimiters:r,padding:n,stringLength:i})}function d(g,_,k){const I=g.children;let x=-1;const v=[],w=_.enter("table");for(;++x<I.length;)v[x]=p(I[x],_,k);return w(),v}function p(g,_,k){const I=g.children;let x=-1;const v=[],w=_.enter("tableRow");for(;++x<I.length;)v[x]=l(I[x],g,_,k);return w(),v}function f(g,_,k){let I=iT.inlineCode(g,_,k);return k.stack.includes("tableCell")&&(I=I.replace(/\|/g,"\\$&")),I}}function jF(){return{exit:{taskListCheckValueChecked:Wv,taskListCheckValueUnchecked:Wv,paragraph:FF}}}function VF(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:UF}}}function Wv(t){const e=this.stack[this.stack.length-2];e.type,e.checked=t.type==="taskListCheckValueChecked"}function FF(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const i=e.children;let s=-1,o;for(;++s<i.length;){const a=i[s];if(a.type==="paragraph"){o=a;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(t)}function UF(t,e,n,r){const i=t.children[0],s=typeof t.checked=="boolean"&&i&&i.type==="paragraph",o="["+(t.checked?"x":" ")+"] ",a=n.createTracker(r);s&&a.move(o);let l=iT.listItem(t,e,n,{...r,...a.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),l;function u(d){return d+o}}function qF(){return[vV(),UV(),HV(),RF(),jF()]}function BF(t){return{extensions:[bV(),qV(t),$V(),MF(t),VF()]}}const WF={tokenize:YF,partial:!0},sT={tokenize:XF,partial:!0},oT={tokenize:JF,partial:!0},aT={tokenize:ZF,partial:!0},HF={tokenize:e6,partial:!0},lT={name:"wwwAutolink",tokenize:QF,previous:cT},uT={name:"protocolAutolink",tokenize:GF,previous:dT},Lr={name:"emailAutolink",tokenize:KF,previous:pT},ur={};function $F(){return{text:ur}}let zi=48;for(;zi<123;)ur[zi]=Lr,zi++,zi===58?zi=65:zi===91&&(zi=97);ur[43]=Lr;ur[45]=Lr;ur[46]=Lr;ur[95]=Lr;ur[72]=[Lr,uT];ur[104]=[Lr,uT];ur[87]=[Lr,lT];ur[119]=[Lr,lT];function KF(t,e,n){const r=this;let i,s;return o;function o(p){return!om(p)||!pT.call(r,r.previous)||py(r.events)?n(p):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),a(p))}function a(p){return om(p)?(t.consume(p),a):p===64?(t.consume(p),l):n(p)}function l(p){return p===46?t.check(HF,d,u)(p):p===45||p===95||Lt(p)?(s=!0,t.consume(p),l):d(p)}function u(p){return t.consume(p),i=!0,l}function d(p){return s&&i&&Ut(r.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(p)):n(p)}}function QF(t,e,n){const r=this;return i;function i(o){return o!==87&&o!==119||!cT.call(r,r.previous)||py(r.events)?n(o):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(WF,t.attempt(sT,t.attempt(oT,s),n),n)(o))}function s(o){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(o)}}function GF(t,e,n){const r=this;let i="",s=!1;return o;function o(p){return(p===72||p===104)&&dT.call(r,r.previous)&&!py(r.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),i+=String.fromCodePoint(p),t.consume(p),a):n(p)}function a(p){if(Ut(p)&&i.length<5)return i+=String.fromCodePoint(p),t.consume(p),a;if(p===58){const f=i.toLowerCase();if(f==="http"||f==="https")return t.consume(p),l}return n(p)}function l(p){return p===47?(t.consume(p),s?u:(s=!0,l)):n(p)}function u(p){return p===null||Xc(p)||ze(p)||ds(p)||Ud(p)?n(p):t.attempt(sT,t.attempt(oT,d),n)(p)}function d(p){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(p)}}function YF(t,e,n){let r=0;return i;function i(o){return(o===87||o===119)&&r<3?(r++,t.consume(o),i):o===46&&r===3?(t.consume(o),s):n(o)}function s(o){return o===null?n(o):e(o)}}function XF(t,e,n){let r,i,s;return o;function o(u){return u===46||u===95?t.check(aT,l,a)(u):u===null||ze(u)||ds(u)||u!==45&&Ud(u)?l(u):(s=!0,t.consume(u),o)}function a(u){return u===95?r=!0:(i=r,r=void 0),t.consume(u),o}function l(u){return i||r||!s?n(u):e(u)}}function JF(t,e){let n=0,r=0;return i;function i(o){return o===40?(n++,t.consume(o),i):o===41&&r<n?s(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?t.check(aT,e,s)(o):o===null||ze(o)||ds(o)?e(o):(t.consume(o),i)}function s(o){return o===41&&r++,t.consume(o),i}}function ZF(t,e,n){return r;function r(a){return a===33||a===34||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===63||a===95||a===126?(t.consume(a),r):a===38?(t.consume(a),s):a===93?(t.consume(a),i):a===60||a===null||ze(a)||ds(a)?e(a):n(a)}function i(a){return a===null||a===40||a===91||ze(a)||ds(a)?e(a):r(a)}function s(a){return Ut(a)?o(a):n(a)}function o(a){return a===59?(t.consume(a),r):Ut(a)?(t.consume(a),o):n(a)}}function e6(t,e,n){return r;function r(s){return t.consume(s),i}function i(s){return Lt(s)?n(s):e(s)}}function cT(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||ze(t)}function dT(t){return!Ut(t)}function pT(t){return!(t===47||om(t))}function om(t){return t===43||t===45||t===46||t===95||Lt(t)}function py(t){let e=t.length,n=!1;for(;e--;){const r=t[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const t6={tokenize:u6,partial:!0};function n6(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:o6,continuation:{tokenize:a6},exit:l6}},text:{91:{name:"gfmFootnoteCall",tokenize:s6},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:r6,resolveTo:i6}}}}function r6(t,e,n){const r=this;let i=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;i--;){const l=r.events[i][1];if(l.type==="labelImage"){o=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return a;function a(l){if(!o||!o._balanced)return n(l);const u=Bn(r.sliceSerialize({start:o.end,end:r.now()}));return u.codePointAt(0)!==94||!s.includes(u.slice(1))?n(l):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(l),t.exit("gfmFootnoteCallLabelMarker"),e(l))}}function i6(t,e){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},t[t.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},a=[t[n+1],t[n+2],["enter",r,e],t[n+3],t[n+4],["enter",i,e],["exit",i,e],["enter",s,e],["enter",o,e],["exit",o,e],["exit",s,e],t[t.length-2],t[t.length-1],["exit",r,e]];return t.splice(n,t.length-n+1,...a),t}function s6(t,e,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,o;return a;function a(p){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(p),t.exit("gfmFootnoteCallLabelMarker"),l}function l(p){return p!==94?n(p):(t.enter("gfmFootnoteCallMarker"),t.consume(p),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",u)}function u(p){if(s>999||p===93&&!o||p===null||p===91||ze(p))return n(p);if(p===93){t.exit("chunkString");const f=t.exit("gfmFootnoteCallString");return i.includes(Bn(r.sliceSerialize(f)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(p),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e):n(p)}return ze(p)||(o=!0),s++,t.consume(p),p===92?d:u}function d(p){return p===91||p===92||p===93?(t.consume(p),s++,u):u(p)}}function o6(t,e,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,o=0,a;return l;function l(_){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(_),t.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(_){return _===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(_),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",d):n(_)}function d(_){if(o>999||_===93&&!a||_===null||_===91||ze(_))return n(_);if(_===93){t.exit("chunkString");const k=t.exit("gfmFootnoteDefinitionLabelString");return s=Bn(r.sliceSerialize(k)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(_),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),f}return ze(_)||(a=!0),o++,t.consume(_),_===92?p:d}function p(_){return _===91||_===92||_===93?(t.consume(_),o++,d):d(_)}function f(_){return _===58?(t.enter("definitionMarker"),t.consume(_),t.exit("definitionMarker"),i.includes(s)||i.push(s),Se(t,g,"gfmFootnoteDefinitionWhitespace")):n(_)}function g(_){return e(_)}}function a6(t,e,n){return t.check(Ml,e,t.attempt(t6,e,n))}function l6(t){t.exit("gfmFootnoteDefinition")}function u6(t,e,n){const r=this;return Se(t,i,"gfmFootnoteDefinitionIndent",5);function i(s){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?e(s):n(s)}}function c6(t){let n=(t||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:i};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function i(o,a){let l=-1;for(;++l<o.length;)if(o[l][0]==="enter"&&o[l][1].type==="strikethroughSequenceTemporary"&&o[l][1]._close){let u=l;for(;u--;)if(o[u][0]==="exit"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._open&&o[l][1].end.offset-o[l][1].start.offset===o[u][1].end.offset-o[u][1].start.offset){o[l][1].type="strikethroughSequence",o[u][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},o[u][1].start),end:Object.assign({},o[l][1].end)},p={type:"strikethroughText",start:Object.assign({},o[u][1].end),end:Object.assign({},o[l][1].start)},f=[["enter",d,a],["enter",o[u][1],a],["exit",o[u][1],a],["enter",p,a]],g=a.parser.constructs.insideSpan.null;g&&ln(f,f.length,0,qd(g,o.slice(u+1,l),a)),ln(f,f.length,0,[["exit",p,a],["enter",o[l][1],a],["exit",o[l][1],a],["exit",d,a]]),ln(o,u-1,l-u+3,f),l=u+f.length-2;break}}for(l=-1;++l<o.length;)o[l][1].type==="strikethroughSequenceTemporary"&&(o[l][1].type="data");return o}function s(o,a,l){const u=this.previous,d=this.events;let p=0;return f;function f(_){return u===126&&d[d.length-1][1].type!=="characterEscape"?l(_):(o.enter("strikethroughSequenceTemporary"),g(_))}function g(_){const k=ko(u);if(_===126)return p>1?l(_):(o.consume(_),p++,g);if(p<2&&!n)return l(_);const I=o.exit("strikethroughSequenceTemporary"),x=ko(_);return I._open=!x||x===2&&!!k,I._close=!k||k===2&&!!x,a(_)}}}class d6{constructor(){this.map=[]}add(e,n,r){p6(this,e,n,r)}consume(e){if(this.map.sort(function(s,o){return s[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(e.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),e.length=this.map[n][0];r.push(e.slice()),e.length=0;let i=r.pop();for(;i;){for(const s of i)e.push(s);i=r.pop()}this.map.length=0}}function p6(t,e,n,r){let i=0;if(!(n===0&&r.length===0)){for(;i<t.map.length;){if(t.map[i][0]===e){t.map[i][1]+=n,t.map[i][2].push(...r);return}i+=1}t.map.push([e,n,r])}}function h6(t,e){let n=!1;const r=[];for(;e<t.length;){const i=t[e];if(n){if(i[0]==="enter")i[1].type==="tableContent"&&r.push(t[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(i[1].type==="tableContent"){if(t[e-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(i[1].type==="tableDelimiterRow")break}else i[0]==="enter"&&i[1].type==="tableDelimiterRow"&&(n=!0);e+=1}return r}function f6(){return{flow:{null:{name:"table",tokenize:m6,resolveAll:g6}}}}function m6(t,e,n){const r=this;let i=0,s=0,o;return a;function a(b){let A=r.events.length-1;for(;A>-1;){const se=r.events[A][1].type;if(se==="lineEnding"||se==="linePrefix")A--;else break}const N=A>-1?r.events[A][1].type:null,P=N==="tableHead"||N==="tableRow"?D:l;return P===D&&r.parser.lazy[r.now().line]?n(b):P(b)}function l(b){return t.enter("tableHead"),t.enter("tableRow"),u(b)}function u(b){return b===124||(o=!0,s+=1),d(b)}function d(b){return b===null?n(b):le(b)?s>1?(s=0,r.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(b),t.exit("lineEnding"),g):n(b):xe(b)?Se(t,d,"whitespace")(b):(s+=1,o&&(o=!1,i+=1),b===124?(t.enter("tableCellDivider"),t.consume(b),t.exit("tableCellDivider"),o=!0,d):(t.enter("data"),p(b)))}function p(b){return b===null||b===124||ze(b)?(t.exit("data"),d(b)):(t.consume(b),b===92?f:p)}function f(b){return b===92||b===124?(t.consume(b),p):p(b)}function g(b){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(b):(t.enter("tableDelimiterRow"),o=!1,xe(b)?Se(t,_,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(b):_(b))}function _(b){return b===45||b===58?I(b):b===124?(o=!0,t.enter("tableCellDivider"),t.consume(b),t.exit("tableCellDivider"),k):O(b)}function k(b){return xe(b)?Se(t,I,"whitespace")(b):I(b)}function I(b){return b===58?(s+=1,o=!0,t.enter("tableDelimiterMarker"),t.consume(b),t.exit("tableDelimiterMarker"),x):b===45?(s+=1,x(b)):b===null||le(b)?M(b):O(b)}function x(b){return b===45?(t.enter("tableDelimiterFiller"),v(b)):O(b)}function v(b){return b===45?(t.consume(b),v):b===58?(o=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(b),t.exit("tableDelimiterMarker"),w):(t.exit("tableDelimiterFiller"),w(b))}function w(b){return xe(b)?Se(t,M,"whitespace")(b):M(b)}function M(b){return b===124?_(b):b===null||le(b)?!o||i!==s?O(b):(t.exit("tableDelimiterRow"),t.exit("tableHead"),e(b)):O(b)}function O(b){return n(b)}function D(b){return t.enter("tableRow"),S(b)}function S(b){return b===124?(t.enter("tableCellDivider"),t.consume(b),t.exit("tableCellDivider"),S):b===null||le(b)?(t.exit("tableRow"),e(b)):xe(b)?Se(t,S,"whitespace")(b):(t.enter("data"),E(b))}function E(b){return b===null||b===124||ze(b)?(t.exit("data"),S(b)):(t.consume(b),b===92?C:E)}function C(b){return b===92||b===124?(t.consume(b),E):E(b)}}function g6(t,e){let n=-1,r=!0,i=0,s=[0,0,0,0],o=[0,0,0,0],a=!1,l=0,u,d,p;const f=new d6;for(;++n<t.length;){const g=t[n],_=g[1];g[0]==="enter"?_.type==="tableHead"?(a=!1,l!==0&&(Hv(f,e,l,u,d),d=void 0,l=0),u={type:"table",start:Object.assign({},_.start),end:Object.assign({},_.end)},f.add(n,0,[["enter",u,e]])):_.type==="tableRow"||_.type==="tableDelimiterRow"?(r=!0,p=void 0,s=[0,0,0,0],o=[0,n+1,0,0],a&&(a=!1,d={type:"tableBody",start:Object.assign({},_.start),end:Object.assign({},_.end)},f.add(n,0,[["enter",d,e]])),i=_.type==="tableDelimiterRow"?2:d?3:1):i&&(_.type==="data"||_.type==="tableDelimiterMarker"||_.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(s[1]!==0&&(o[0]=o[1],p=Tu(f,e,s,i,void 0,p),s=[0,0,0,0]),o[2]=n)):_.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(o[0]=o[1],p=Tu(f,e,s,i,void 0,p)),s=o,o=[s[1],n,0,0])):_.type==="tableHead"?(a=!0,l=n):_.type==="tableRow"||_.type==="tableDelimiterRow"?(l=n,s[1]!==0?(o[0]=o[1],p=Tu(f,e,s,i,n,p)):o[1]!==0&&(p=Tu(f,e,o,i,n,p)),i=0):i&&(_.type==="data"||_.type==="tableDelimiterMarker"||_.type==="tableDelimiterFiller")&&(o[3]=n)}for(l!==0&&Hv(f,e,l,u,d),f.consume(e.events),n=-1;++n<e.events.length;){const g=e.events[n];g[0]==="enter"&&g[1].type==="table"&&(g[1]._align=h6(e.events,n))}return t}function Tu(t,e,n,r,i,s){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",a="tableContent";n[0]!==0&&(s.end=Object.assign({},Rs(e.events,n[0])),t.add(n[0],0,[["exit",s,e]]));const l=Rs(e.events,n[1]);if(s={type:o,start:Object.assign({},l),end:Object.assign({},l)},t.add(n[1],0,[["enter",s,e]]),n[2]!==0){const u=Rs(e.events,n[2]),d=Rs(e.events,n[3]),p={type:a,start:Object.assign({},u),end:Object.assign({},d)};if(t.add(n[2],0,[["enter",p,e]]),r!==2){const f=e.events[n[2]],g=e.events[n[3]];if(f[1].end=Object.assign({},g[1].end),f[1].type="chunkText",f[1].contentType="text",n[3]>n[2]+1){const _=n[2]+1,k=n[3]-n[2]-1;t.add(_,k,[])}}t.add(n[3]+1,0,[["exit",p,e]])}return i!==void 0&&(s.end=Object.assign({},Rs(e.events,i)),t.add(i,0,[["exit",s,e]]),s=void 0),s}function Hv(t,e,n,r,i){const s=[],o=Rs(e.events,n);i&&(i.end=Object.assign({},o),s.push(["exit",i,e])),r.end=Object.assign({},o),s.push(["exit",r,e]),t.add(n+1,0,s)}function Rs(t,e){const n=t[e],r=n[0]==="enter"?"start":"end";return n[1][r]}const y6={name:"tasklistCheck",tokenize:x6};function _6(){return{text:{91:y6}}}function x6(t,e,n){const r=this;return i;function i(l){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(l):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),s)}function s(l){return ze(l)?(t.enter("taskListCheckValueUnchecked"),t.consume(l),t.exit("taskListCheckValueUnchecked"),o):l===88||l===120?(t.enter("taskListCheckValueChecked"),t.consume(l),t.exit("taskListCheckValueChecked"),o):n(l)}function o(l){return l===93?(t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),a):n(l)}function a(l){return le(l)?e(l):xe(l)?t.check({tokenize:v6},e,n)(l):n(l)}}function v6(t,e,n){return Se(t,r,"whitespace");function r(i){return i===null?n(i):e(i)}}function b6(t){return b2([$F(),n6(),c6(t),f6(),_6()])}const w6={};function hT(t){const e=this,n=t||w6,r=e.data(),i=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);i.push(b6(n)),s.push(qF()),o.push(BF(n))}const k6=[{id:"numpy-array-sum",title:"Array Sum",section:"python-basics",difficulty:"easy",description:`
## Array Sum

Given a NumPy array of numbers, implement a function that returns the sum of all elements.

### Function Signature
\`\`\`python
def array_sum(arr: np.ndarray) -> float:
\`\`\`

### Constraints
- Array length: 1 <= n <= 1000
- Element values: -10^6 <= arr[i] <= 10^6
    `,examples:[{input:"np.array([1, 2, 3, 4, 5])",output:"15",explanation:"1 + 2 + 3 + 4 + 5 = 15"},{input:"np.array([-1, 0, 1])",output:"0",explanation:"-1 + 0 + 1 = 0"}],starterCode:`import numpy as np

def array_sum(arr: np.ndarray) -> float:
    """
    Calculate the sum of all elements in a NumPy array.

    Args:
        arr: A NumPy array of numbers

    Returns:
        The sum of all elements
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic positive numbers",input:"[1, 2, 3, 4, 5]",expected:"15",hidden:!1},{id:"2",description:"With negatives",input:"[-1, 0, 1]",expected:"0",hidden:!1},{id:"3",description:"Single element",input:"[42]",expected:"42",hidden:!1},{id:"4",description:"Larger array",input:"[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]",expected:"55",hidden:!0}],hints:["NumPy arrays have built-in methods for common operations.","Try using np.sum() or the .sum() method on the array."],solution:`import numpy as np

def array_sum(arr: np.ndarray) -> float:
    """
    Calculate the sum of all elements in a NumPy array.
    """
    return np.sum(arr)
`},{id:"numpy-matrix-multiply",title:"Matrix Multiplication",section:"python-basics",difficulty:"medium",description:`
## Matrix Multiplication

Implement matrix multiplication between two 2D NumPy arrays.

### Function Signature
\`\`\`python
def matrix_multiply(A: np.ndarray, B: np.ndarray) -> np.ndarray:
\`\`\`

### Constraints
- A has shape (m, n)
- B has shape (n, p)
- Result has shape (m, p)
- 1 <= m, n, p <= 100

### Note
You should use NumPy's built-in functions, not manual loops.
    `,examples:[{input:"A = [[1, 2], [3, 4]], B = [[5, 6], [7, 8]]",output:"[[19, 22], [43, 50]]",explanation:"Standard matrix multiplication"}],starterCode:`import numpy as np

def matrix_multiply(A: np.ndarray, B: np.ndarray) -> np.ndarray:
    """
    Multiply two matrices A and B.

    Args:
        A: First matrix of shape (m, n)
        B: Second matrix of shape (n, p)

    Returns:
        Result matrix of shape (m, p)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"2x2 matrices",input:"([[1, 2], [3, 4]], [[5, 6], [7, 8]])",expected:"[[19, 22], [43, 50]]",hidden:!1},{id:"2",description:"Identity multiplication",input:"([[1, 0], [0, 1]], [[5, 6], [7, 8]])",expected:"[[5, 6], [7, 8]]",hidden:!1},{id:"3",description:"Different dimensions",input:"([[1, 2, 3]], [[1], [2], [3]])",expected:"[[14]]",hidden:!0}],hints:["NumPy provides several ways to do matrix multiplication.","Try np.dot(), np.matmul(), or the @ operator."],solution:`import numpy as np

def matrix_multiply(A: np.ndarray, B: np.ndarray) -> np.ndarray:
    """
    Multiply two matrices A and B.
    """
    return np.dot(A, B)
    # Alternative: return A @ B
    # Alternative: return np.matmul(A, B)
`},{id:"numpy-broadcast-add",title:"Broadcasting Addition",section:"python-basics",difficulty:"medium",description:`
## Broadcasting Addition

Given a 2D matrix and a 1D vector, add the vector to each row of the matrix using broadcasting.

### Function Signature
\`\`\`python
def broadcast_add(matrix: np.ndarray, vector: np.ndarray) -> np.ndarray:
\`\`\`

### Constraints
- Matrix has shape (m, n)
- Vector has shape (n,)
- 1 <= m, n <= 100

### Note
Broadcasting is a powerful NumPy feature that allows operations between arrays of different shapes.
    `,examples:[{input:"matrix = [[1, 2, 3], [4, 5, 6]], vector = [10, 20, 30]",output:"[[11, 22, 33], [14, 25, 36]]",explanation:"Vector is added to each row"}],starterCode:`import numpy as np

def broadcast_add(matrix: np.ndarray, vector: np.ndarray) -> np.ndarray:
    """
    Add a vector to each row of a matrix using broadcasting.

    Args:
        matrix: 2D array of shape (m, n)
        vector: 1D array of shape (n,)

    Returns:
        Result matrix of shape (m, n)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic broadcasting",input:"([[1, 2, 3], [4, 5, 6]], [10, 20, 30])",expected:"[[11, 22, 33], [14, 25, 36]]",hidden:!1},{id:"2",description:"With zeros",input:"([[1, 2], [3, 4]], [0, 0])",expected:"[[1, 2], [3, 4]]",hidden:!1},{id:"3",description:"Negative values",input:"([[1, 2], [3, 4]], [-1, -2])",expected:"[[0, 0], [2, 2]]",hidden:!0}],hints:["NumPy automatically broadcasts the vector across rows.","Simply use the + operator - NumPy handles the rest!"],solution:`import numpy as np

def broadcast_add(matrix: np.ndarray, vector: np.ndarray) -> np.ndarray:
    """
    Add a vector to each row of a matrix using broadcasting.
    """
    return matrix + vector
`}],E6=[{id:"normalize-features",title:"Normalize Features",section:"data-preprocessing",difficulty:"easy",description:`
## Normalize Features (Min-Max Scaling)

Implement min-max normalization to scale features to the range [0, 1].

### Formula
\`\`\`
X_normalized = (X - X_min) / (X_max - X_min)
\`\`\`

### Function Signature
\`\`\`python
def normalize(arr: np.ndarray) -> np.ndarray:
\`\`\`

### Constraints
- Input is a 1D array
- Array length: 2 <= n <= 1000
- All elements are finite numbers
    `,examples:[{input:"np.array([1, 2, 3, 4, 5])",output:"[0.0, 0.25, 0.5, 0.75, 1.0]",explanation:"min=1, max=5, so (x-1)/(5-1) gives [0, 0.25, 0.5, 0.75, 1]"}],starterCode:`import numpy as np

def normalize(arr: np.ndarray) -> np.ndarray:
    """
    Apply min-max normalization to scale values to [0, 1].

    Args:
        arr: Input array of numbers

    Returns:
        Normalized array with values in [0, 1]
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic normalization",input:"[1, 2, 3, 4, 5]",expected:"[0.0, 0.25, 0.5, 0.75, 1.0]",hidden:!1},{id:"2",description:"With negative values",input:"[-10, 0, 10]",expected:"[0.0, 0.5, 1.0]",hidden:!1},{id:"3",description:"Larger range",input:"[0, 50, 100]",expected:"[0.0, 0.5, 1.0]",hidden:!0}],hints:["Use np.min() and np.max() to find the range.","Apply the formula: (x - min) / (max - min)"],solution:`import numpy as np

def normalize(arr: np.ndarray) -> np.ndarray:
    """
    Apply min-max normalization to scale values to [0, 1].
    """
    arr_min = np.min(arr)
    arr_max = np.max(arr)
    return (arr - arr_min) / (arr_max - arr_min)
`},{id:"handle-missing-data",title:"Handle Missing Data",section:"data-preprocessing",difficulty:"medium",description:`
## Handle Missing Data

Replace NaN (missing) values in an array with the mean of non-NaN values.

### Function Signature
\`\`\`python
def fill_missing_with_mean(arr: np.ndarray) -> np.ndarray:
\`\`\`

### Constraints
- Input is a 1D array
- Array contains at least one non-NaN value
- NaN values are represented as np.nan
    `,examples:[{input:"np.array([1.0, np.nan, 3.0, np.nan, 5.0])",output:"[1.0, 3.0, 3.0, 3.0, 5.0]",explanation:"Mean of [1, 3, 5] is 3, which replaces NaN values"}],starterCode:`import numpy as np

def fill_missing_with_mean(arr: np.ndarray) -> np.ndarray:
    """
    Replace NaN values with the mean of non-NaN values.

    Args:
        arr: Input array that may contain NaN values

    Returns:
        Array with NaN values replaced by the mean
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic case",input:'[1.0, float("nan"), 3.0, float("nan"), 5.0]',expected:"[1.0, 3.0, 3.0, 3.0, 5.0]",hidden:!1},{id:"2",description:"Single NaN",input:'[2.0, 4.0, float("nan"), 6.0]',expected:"[2.0, 4.0, 4.0, 6.0]",hidden:!1},{id:"3",description:"NaN at start",input:'[float("nan"), 10.0, 20.0]',expected:"[15.0, 10.0, 20.0]",hidden:!0}],hints:["Use np.isnan() to find NaN values.","Use np.nanmean() to compute mean ignoring NaN values.","Use boolean indexing to replace values."],solution:`import numpy as np

def fill_missing_with_mean(arr: np.ndarray) -> np.ndarray:
    """
    Replace NaN values with the mean of non-NaN values.
    """
    arr = arr.copy()  # Don't modify original
    mean_val = np.nanmean(arr)
    arr[np.isnan(arr)] = mean_val
    return arr
`},{id:"one-hot-encode",title:"One-Hot Encoding",section:"data-preprocessing",difficulty:"medium",description:`
## One-Hot Encoding

Convert an array of categorical integers to one-hot encoded format.

### Function Signature
\`\`\`python
def one_hot_encode(labels: np.ndarray, num_classes: int) -> np.ndarray:
\`\`\`

### Example
For labels [0, 1, 2] with 3 classes:
\`\`\`
[[1, 0, 0],
 [0, 1, 0],
 [0, 0, 1]]
\`\`\`

### Constraints
- Labels are integers in range [0, num_classes - 1]
- 1 <= num_classes <= 100
    `,examples:[{input:"labels = [0, 1, 2, 1], num_classes = 3",output:"[[1, 0, 0], [0, 1, 0], [0, 0, 1], [0, 1, 0]]",explanation:"Each label becomes a row with 1 at the label index"}],starterCode:`import numpy as np

def one_hot_encode(labels: np.ndarray, num_classes: int) -> np.ndarray:
    """
    Convert integer labels to one-hot encoded format.

    Args:
        labels: 1D array of integer labels
        num_classes: Total number of classes

    Returns:
        2D array of shape (len(labels), num_classes)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic encoding",input:"([0, 1, 2], 3)",expected:"[[1, 0, 0], [0, 1, 0], [0, 0, 1]]",hidden:!1},{id:"2",description:"Repeated labels",input:"([0, 0, 1, 1], 2)",expected:"[[1, 0], [1, 0], [0, 1], [0, 1]]",hidden:!1},{id:"3",description:"More classes than used",input:"([0, 2], 4)",expected:"[[1, 0, 0, 0], [0, 0, 1, 0]]",hidden:!0}],hints:["Create a zeros matrix of shape (num_samples, num_classes).","Use array indexing to set the appropriate positions to 1.","np.eye() can be useful for creating one-hot encodings."],solution:`import numpy as np

def one_hot_encode(labels: np.ndarray, num_classes: int) -> np.ndarray:
    """
    Convert integer labels to one-hot encoded format.
    """
    # Method 1: Using np.eye
    return np.eye(num_classes)[labels].astype(int)

    # Method 2: Manual approach
    # one_hot = np.zeros((len(labels), num_classes), dtype=int)
    # one_hot[np.arange(len(labels)), labels] = 1
    # return one_hot
`}],T6=[{id:"logistic-regression",title:"Sigmoid Function",section:"supervised-learning",difficulty:"easy",description:`
## Sigmoid Function

Implement the sigmoid activation function used in logistic regression.

### Formula
\`\`\`
sigmoid(x) = 1 / (1 + exp(-x))
\`\`\`

### Properties
- Output is always between 0 and 1
- sigmoid(0) = 0.5
- Monotonically increasing

### Function Signature
\`\`\`python
def sigmoid(x: np.ndarray) -> np.ndarray:
\`\`\`
    `,examples:[{input:"np.array([0, 1, -1])",output:"[0.5, 0.731059, 0.268941]",explanation:"sigmoid(0)=0.5, sigmoid(1)0.73, sigmoid(-1)0.27"}],starterCode:`import numpy as np

def sigmoid(x: np.ndarray) -> np.ndarray:
    """
    Compute the sigmoid activation function.

    Args:
        x: Input array of any shape

    Returns:
        Array of same shape with sigmoid applied element-wise
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Zero input",input:"[0]",expected:"[0.5]",hidden:!1},{id:"2",description:"Positive and negative",input:"bool(np.allclose(sigmoid(np.array([-1, 0, 1])), [0.268941, 0.5, 0.731059], atol=1e-5))",expected:"True",hidden:!1},{id:"3",description:"Large values",input:"bool(np.allclose(sigmoid(np.array([-10, 10])), [4.5e-05, 0.999955], atol=1e-5))",expected:"True",hidden:!0}],hints:["Use np.exp() for the exponential function.","The formula is 1 / (1 + exp(-x))"],solution:`import numpy as np

def sigmoid(x: np.ndarray) -> np.ndarray:
    """
    Compute the sigmoid activation function.
    """
    return 1 / (1 + np.exp(-x))
`},{id:"binary-cross-entropy",title:"Binary Cross-Entropy Loss",section:"supervised-learning",difficulty:"easy",description:`
## Binary Cross-Entropy Loss

Implement the binary cross-entropy (log loss) function.

### Formula
\`\`\`
BCE = -1/m * sum(y * log(p) + (1-y) * log(1-p))
\`\`\`

Where:
- y: True labels (0 or 1)
- p: Predicted probabilities
- m: Number of samples

### Numerical Stability
Clip predictions to avoid log(0):
\`\`\`python
p = np.clip(p, 1e-15, 1 - 1e-15)
\`\`\`
    `,examples:[{input:"y = [1, 0, 1], p = [0.9, 0.1, 0.8]",output:"0.1446",explanation:"Low loss for confident correct predictions"}],starterCode:`import numpy as np

def binary_cross_entropy(y_true, y_pred):
    """
    Compute binary cross-entropy loss.

    Args:
        y_true: True labels (0 or 1)
        y_pred: Predicted probabilities

    Returns:
        loss: Scalar BCE loss
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Perfect predictions",input:"([1, 0, 1, 0], [1.0, 0.0, 1.0, 0.0])",expected:"0.0",hidden:!1},{id:"2",description:"Typical case",input:"([1, 0, 1], [0.9, 0.1, 0.8])",expected:"0.1446",hidden:!1}],hints:["Clip predictions for numerical stability","Apply the formula element-wise","Take the mean over all samples"],solution:`import numpy as np

def binary_cross_entropy(y_true, y_pred):
    y_true = np.array(y_true)
    y_pred = np.array(y_pred)

    # Clip for numerical stability
    y_pred = np.clip(y_pred, 1e-15, 1 - 1e-15)

    # BCE formula
    loss = -np.mean(y_true * np.log(y_pred) + (1 - y_true) * np.log(1 - y_pred))

    return round(loss, 4)
`},{id:"hinge-loss",title:"Hinge Loss",section:"supervised-learning",difficulty:"easy",description:`
## Hinge Loss

Implement the hinge loss function used in Support Vector Machines (SVMs).

### Formula
\`\`\`
L = (1/n) * sum(max(0, 1 - y * s))
\`\`\`

Where:
- **y**: True labels in {-1, +1}
- **s**: Raw model scores (not probabilities)
- **n**: Number of samples

### Properties
- Loss is **0** when the prediction has the correct sign AND confidence margin >= 1
- Loss increases linearly when the prediction is wrong or within the margin
- Unlike cross-entropy, hinge loss encourages a "margin" of separation between classes

### Function Signature
\`\`\`python
def hinge_loss(y_true: np.ndarray, scores: np.ndarray) -> float:
\`\`\`

Returns the mean hinge loss rounded to 4 decimal places.
    `,examples:[{input:"y_true = [1, -1, 1], scores = [0.5, -0.8, 1.5]",output:"0.2333",explanation:"Margins: [0.5, 0.2, -0.5]  losses: [0.5, 0.2, 0.0]  mean = 0.2333"},{input:"y_true = [1, -1], scores = [2.0, -3.0]",output:"0.0",explanation:"Both predictions correct with margin >= 1, so zero loss"}],starterCode:`import numpy as np

def hinge_loss(y_true, scores):
    """
    Compute the mean hinge loss.

    Args:
        y_true: True labels in {-1, +1}, shape (n,)
        scores: Raw model scores, shape (n,)

    Returns:
        Mean hinge loss (float, rounded to 4 decimals)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Perfect predictions with large margin",input:"([1, -1], [2.0, -3.0])",expected:"0.0",hidden:!1},{id:"2",description:"Partial margin violations",input:"([1, -1, 1], [0.5, -0.8, 1.5])",expected:"0.2333",hidden:!1},{id:"3",description:"All misclassified",input:"([1, 1], [-1.0, -2.0])",expected:"2.5",hidden:!1},{id:"4",description:"On the decision boundary (margin = 1)",input:"([1, -1], [1.0, -1.0])",expected:"0.0",hidden:!0}],hints:["Compute element-wise margins: y_true * scores","Apply max(0, 1 - margin) using np.maximum","Return the mean of the losses, rounded to 4 decimals"],solution:`import numpy as np

def hinge_loss(y_true, scores):
    """
    Compute the mean hinge loss.
    """
    y_true = np.array(y_true, dtype=float)
    scores = np.array(scores, dtype=float)

    # Compute hinge loss for each sample
    losses = np.maximum(0, 1 - y_true * scores)

    return round(float(np.mean(losses)), 4)
`},{id:"decision-tree-split",title:"Gini Impurity",section:"supervised-learning",difficulty:"medium",description:`
## Gini Impurity

Calculate the Gini impurity for a set of labels. This metric is used in decision trees to determine the best split.

### Formula
\`\`\`
Gini = 1 - sum(p_i^2)
\`\`\`

Where p_i is the proportion of class i in the set.

### Properties
- Gini = 0 means pure (all same class)
- Gini = 0.5 means maximum impurity (for binary classification with equal split)

### Function Signature
\`\`\`python
def gini_impurity(labels: np.ndarray) -> float:
\`\`\`
    `,examples:[{input:"np.array([0, 0, 0, 0])",output:"0.0",explanation:"All same class, pure node"},{input:"np.array([0, 0, 1, 1])",output:"0.5",explanation:"Equal split, maximum impurity for binary"}],starterCode:`import numpy as np

def gini_impurity(labels: np.ndarray) -> float:
    """
    Calculate Gini impurity for a set of labels.

    Args:
        labels: Array of class labels (integers)

    Returns:
        Gini impurity value between 0 and 1
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Pure node",input:"[0, 0, 0, 0]",expected:"0.0",hidden:!1},{id:"2",description:"Maximum impurity",input:"[0, 0, 1, 1]",expected:"0.5",hidden:!1},{id:"3",description:"Unequal split",input:"[0, 0, 0, 1]",expected:"0.375",hidden:!0}],hints:["Count the occurrences of each class.","Calculate the proportion (probability) of each class.","Gini = 1 - sum of squared probabilities."],solution:`import numpy as np

def gini_impurity(labels: np.ndarray) -> float:
    """
    Calculate Gini impurity for a set of labels.
    """
    if len(labels) == 0:
        return 0.0

    # Count occurrences of each class
    _, counts = np.unique(labels, return_counts=True)

    # Calculate probabilities
    probabilities = counts / len(labels)

    # Gini = 1 - sum(p^2)
    return 1 - np.sum(probabilities ** 2)
`},{id:"linear-regression-gd",title:"Linear Regression with Gradient Descent",section:"supervised-learning",difficulty:"medium",description:`
## Linear Regression with Gradient Descent

Implement simple linear regression using gradient descent optimization.

### Model
\`\`\`
y = w * x + b
\`\`\`

### Gradient Descent Updates
\`\`\`
w = w - learning_rate * dw
b = b - learning_rate * db
\`\`\`

Where:
- dw = (2/n) * sum((y_pred - y) * x)
- db = (2/n) * sum(y_pred - y)

### Function Signature
\`\`\`python
def linear_regression(X: np.ndarray, y: np.ndarray,
                      learning_rate: float, iterations: int) -> tuple:
\`\`\`

Returns (w, b) - the learned weight and bias.
    `,examples:[{input:"X = [1, 2, 3, 4], y = [2, 4, 6, 8], lr = 0.1, iters = 1000",output:"w  2.0, b  0.0",explanation:"The true relationship is y = 2x, so w should be close to 2"}],starterCode:`import numpy as np

def linear_regression(X: np.ndarray, y: np.ndarray,
                      learning_rate: float = 0.01,
                      iterations: int = 1000) -> tuple:
    """
    Train a simple linear regression model using gradient descent.

    Args:
        X: Input features (1D array)
        y: Target values (1D array)
        learning_rate: Step size for gradient descent
        iterations: Number of training iterations

    Returns:
        Tuple of (weight, bias)
    """
    # Initialize parameters
    w = 0.0
    b = 0.0
    n = len(X)

    # Your gradient descent implementation here
    pass

    return (round(w, 2), round(b, 2))
`,testCases:[{id:"1",description:"Perfect linear relationship",input:"([1, 2, 3, 4], [2, 4, 6, 8], 0.1, 1000)",expected:"(2.0, 0.0)",hidden:!1},{id:"2",description:"With intercept",input:"([1, 2, 3, 4], [3, 5, 7, 9], 0.1, 1000)",expected:"(2.0, 1.0)",hidden:!1},{id:"3",description:"Different slope",input:"([0, 1, 2, 3], [1, 4, 7, 10], 0.1, 1000)",expected:"(3.0, 1.0)",hidden:!0}],hints:["First compute predictions: y_pred = w * X + b","Then compute gradients: dw = (2/n) * sum((y_pred - y) * X)","Update weights: w = w - learning_rate * dw"],solution:`import numpy as np

def linear_regression(X: np.ndarray, y: np.ndarray,
                      learning_rate: float = 0.01,
                      iterations: int = 1000) -> tuple:
    """
    Train a simple linear regression model using gradient descent.
    """
    w = 0.0
    b = 0.0
    n = len(X)

    for _ in range(iterations):
        # Forward pass
        y_pred = w * X + b

        # Compute gradients
        dw = (2/n) * np.sum((y_pred - y) * X)
        db = (2/n) * np.sum(y_pred - y)

        # Update parameters
        w = w - learning_rate * dw
        b = b - learning_rate * db

    return (round(w, 2), round(b, 2))
`},{id:"logistic-regression-full",title:"Logistic Regression with Gradient Descent",section:"supervised-learning",difficulty:"medium",description:`
## Logistic Regression with Gradient Descent

Implement binary logistic regression from scratch.

### Model
\`\`\`
z = X @ w + b
y_pred = sigmoid(z) = 1 / (1 + exp(-z))
\`\`\`

### Loss (Binary Cross-Entropy)
\`\`\`
L = -1/m * sum(y * log(y_pred) + (1-y) * log(1-y_pred))
\`\`\`

### Gradients
\`\`\`
dw = 1/m * X.T @ (y_pred - y)
db = 1/m * sum(y_pred - y)
\`\`\`
    `,examples:[{input:"X (100, 2), y binary labels, 1000 iterations",output:"Trained weights and bias",explanation:"Learns decision boundary separating classes"}],starterCode:`import numpy as np

def sigmoid(z):
    return 1 / (1 + np.exp(-z))

def logistic_regression(X, y, learning_rate=0.1, iterations=1000):
    """
    Train logistic regression using gradient descent.

    Args:
        X: Features (m samples, n features)
        y: Binary labels (m,)
        learning_rate: Step size
        iterations: Number of iterations

    Returns:
        w: Learned weights (n,)
        b: Learned bias (scalar)
    """
    m, n = X.shape
    w = np.zeros(n)
    b = 0.0

    # Your code here
    pass

    return np.round(w, 4), round(b, 4)
`,testCases:[{id:"1",description:"Simple separable data",input:"(lambda r: bool(np.allclose(r[0], [6.0141, 6.0141], atol=1e-3) and np.isclose(r[1], -9.1984, atol=1e-3)))(logistic_regression(np.array([[0, 0], [0, 1], [1, 0], [1, 1]]), np.array([0, 0, 0, 1]), 0.5, 1000))",expected:"True",hidden:!1}],hints:["Forward: z = X @ w + b, then y_pred = sigmoid(z)","Gradients: dw = (1/m) * X.T @ (y_pred - y)","Update: w = w - lr * dw, b = b - lr * db"],solution:`import numpy as np

def sigmoid(z):
    return 1 / (1 + np.exp(-z))

def logistic_regression(X, y, learning_rate=0.1, iterations=1000):
    m, n = X.shape
    w = np.zeros(n)
    b = 0.0

    for _ in range(iterations):
        # Forward pass
        z = X @ w + b
        y_pred = sigmoid(z)

        # Compute gradients
        dw = (1/m) * X.T @ (y_pred - y)
        db = (1/m) * np.sum(y_pred - y)

        # Update parameters
        w = w - learning_rate * dw
        b = b - learning_rate * db

    return np.round(w, 4), round(b, 4)
`},{id:"linear-svm",title:"Linear SVM with Gradient Descent",section:"supervised-learning",difficulty:"medium",description:`
## Linear SVM with Gradient Descent

Implement a linear Support Vector Machine (SVM) classifier using gradient descent on the hinge loss with L2 regularization.

### Objective
\`\`\`
L = (/2) * ||w|| + (1/m) *  max(0, 1 - y * (X  w + b))
\`\`\`

### Gradients
Compute gradients over all samples. For samples where the margin \`y * (X  w + b) < 1\` (hinge loss is active):
\`\`\`
dw =  * w - (1/m) *  y * X    (sum over violating samples)
db = -(1/m) *  y                  (sum over violating samples)
\`\`\`

For samples where the margin >= 1:
\`\`\`
dw contribution =  * w   (only regularization)
db contribution = 0
\`\`\`

### Function Signature
\`\`\`python
def linear_svm(X, y, learning_rate=0.01, lambda_param=0.01, iterations=1000):
\`\`\`

Returns \`(w, b)\`  the learned weight vector (rounded to 4 decimals) and bias (rounded to 4 decimals).

**Note**: Labels \`y\` are in {-1, +1}.
    `,examples:[{input:"X = [[2,1],[3,2],[-2,-1],[-3,-2]], y = [1,1,-1,-1], lr=0.01, =0.01, iters=1000",output:"w and b that correctly classify all points",explanation:"SVM finds a maximum-margin hyperplane separating positive and negative points"}],starterCode:`import numpy as np

def linear_svm(X, y, learning_rate=0.01, lambda_param=0.01, iterations=1000):
    """
    Train a linear SVM using gradient descent on hinge loss + L2 regularization.

    Args:
        X: Features (m samples, n features)
        y: Labels in {-1, +1}, shape (m,)
        learning_rate: Step size for gradient descent
        lambda_param: L2 regularization strength
        iterations: Number of training iterations

    Returns:
        w: Learned weights (n,), rounded to 4 decimals
        b: Learned bias (scalar), rounded to 4 decimals
    """
    m, n = X.shape
    w = np.zeros(n)
    b = 0.0

    # Your gradient descent implementation here
    pass

    return np.round(w, 4), round(b, 4)
`,testCases:[{id:"1",description:"Correctly classifies separable 2D data",input:`(lambda: (
    X := np.array([[2, 1], [3, 2], [1, 3], [-2, -1], [-3, -2], [-1, -3]]),
    y := np.array([1, 1, 1, -1, -1, -1]),
    result := linear_svm(X, y, 0.01, 0.01, 1000),
    preds := np.sign(X @ result[0] + result[1]),
    bool(np.array_equal(preds, y))
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"Correctly classifies 1D data",input:`(lambda: (
    X := np.array([[3], [4], [5], [-3], [-4], [-5]]),
    y := np.array([1, 1, 1, -1, -1, -1]),
    result := linear_svm(X, y, 0.01, 0.01, 1000),
    preds := np.sign(X @ result[0] + result[1]),
    bool(np.array_equal(preds, y))
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Weight vector has correct sign",input:`(lambda: (
    X := np.array([[1], [-1]]),
    y := np.array([1, -1]),
    result := linear_svm(X, y, 0.1, 0.01, 500),
    bool(result[0][0] > 0)
)[-1])()`,expected:"True",hidden:!0}],hints:["Compute margins for all samples: margins = y * (X @ w + b)","Find violating samples with mask = margins < 1","Gradient: dw = lambda_param * w - (1/m) * X[mask].T @ y[mask]","Update w and b using gradient descent"],solution:`import numpy as np

def linear_svm(X, y, learning_rate=0.01, lambda_param=0.01, iterations=1000):
    """
    Train a linear SVM using gradient descent on hinge loss + L2 regularization.
    """
    m, n = X.shape
    w = np.zeros(n)
    b = 0.0

    for _ in range(iterations):
        # Compute margins
        margins = y * (X @ w + b)

        # Find samples violating the margin
        mask = margins < 1

        # Compute gradients
        dw = lambda_param * w - (1/m) * (X[mask].T @ y[mask])
        db = -(1/m) * np.sum(y[mask])

        # Update parameters
        w -= learning_rate * dw
        b -= learning_rate * db

    return np.round(w, 4), round(b, 4)
`}],S6=[{id:"kmeans-clustering",title:"K-Means: Assign to Nearest Centroid",section:"unsupervised-learning",difficulty:"medium",description:`
## K-Means: Assign Points to Nearest Centroid

Implement the assignment step of K-means clustering: given data points and centroids, assign each point to its nearest centroid.

### Function Signature
\`\`\`python
def assign_clusters(X: np.ndarray, centroids: np.ndarray) -> np.ndarray:
\`\`\`

### Args
- X: Data points of shape (n_samples, n_features)
- centroids: Cluster centers of shape (k, n_features)

### Returns
- Array of cluster assignments (integers 0 to k-1)

### Distance
Use Euclidean distance: sqrt(sum((x - c)^2))
    `,examples:[{input:"X = [[0, 0], [1, 1], [10, 10]], centroids = [[0, 0], [10, 10]]",output:"[0, 0, 1]",explanation:"First two points closer to centroid 0, last point closer to centroid 1"}],starterCode:`import numpy as np

def assign_clusters(X: np.ndarray, centroids: np.ndarray) -> np.ndarray:
    """
    Assign each point to its nearest centroid.

    Args:
        X: Data points of shape (n_samples, n_features)
        centroids: Cluster centers of shape (k, n_features)

    Returns:
        Array of cluster assignments (shape: n_samples)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Simple 2D case",input:"([[0, 0], [1, 1], [10, 10]], [[0, 0], [10, 10]])",expected:"[0, 0, 1]",hidden:!1},{id:"2",description:"Three clusters",input:"([[0, 0], [5, 5], [10, 10]], [[0, 0], [5, 5], [10, 10]])",expected:"[0, 1, 2]",hidden:!1},{id:"3",description:"Tiebreaker (first centroid wins)",input:"([[5, 5]], [[0, 0], [10, 10]])",expected:"[0]",hidden:!0}],hints:["Calculate distance from each point to each centroid.","Use np.linalg.norm() for Euclidean distance.","Use np.argmin() to find the closest centroid."],solution:`import numpy as np

def assign_clusters(X: np.ndarray, centroids: np.ndarray) -> np.ndarray:
    """
    Assign each point to its nearest centroid.
    """
    # Calculate distances from each point to each centroid
    # Using broadcasting: X[:, np.newaxis] has shape (n, 1, d)
    # centroids has shape (k, d)
    # Difference has shape (n, k, d)
    distances = np.linalg.norm(X[:, np.newaxis] - centroids, axis=2)

    # Return index of minimum distance for each point
    return np.argmin(distances, axis=1)
`},{id:"pca-implementation",title:"PCA: Center Data",section:"unsupervised-learning",difficulty:"easy",description:`
## PCA: Center the Data

The first step in PCA is to center the data by subtracting the mean of each feature.

### Function Signature
\`\`\`python
def center_data(X: np.ndarray) -> np.ndarray:
\`\`\`

### Args
- X: Data matrix of shape (n_samples, n_features)

### Returns
- Centered data where each column has mean 0

### Why Center?
Centering ensures PCA finds directions of maximum variance from the origin, not from an arbitrary point.
    `,examples:[{input:"X = [[1, 2], [3, 4], [5, 6]]",output:"[[-2, -2], [0, 0], [2, 2]]",explanation:"Column means are [3, 4], so we subtract them"}],starterCode:`import numpy as np

def center_data(X: np.ndarray) -> np.ndarray:
    """
    Center the data by subtracting the mean of each feature.

    Args:
        X: Data matrix of shape (n_samples, n_features)

    Returns:
        Centered data matrix of same shape
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic centering",input:"[[1, 2], [3, 4], [5, 6]]",expected:"[[-2.0, -2.0], [0.0, 0.0], [2.0, 2.0]]",hidden:!1},{id:"2",description:"Already centered",input:"[[-1, -1], [0, 0], [1, 1]]",expected:"[[-1.0, -1.0], [0.0, 0.0], [1.0, 1.0]]",hidden:!1},{id:"3",description:"Single column",input:"[[10], [20], [30]]",expected:"[[-10.0], [0.0], [10.0]]",hidden:!0}],hints:["Calculate the mean of each column using np.mean() with axis=0.","Subtract the mean from the data (broadcasting handles this)."],solution:`import numpy as np

def center_data(X: np.ndarray) -> np.ndarray:
    """
    Center the data by subtracting the mean of each feature.
    """
    mean = np.mean(X, axis=0)
    return X - mean
`}],C6=[{id:"perceptron",title:"ReLU Activation",section:"deep-learning",difficulty:"easy",description:`
## ReLU Activation Function

Implement the Rectified Linear Unit (ReLU) activation function, one of the most popular activation functions in deep learning.

### Formula
\`\`\`
ReLU(x) = max(0, x)
\`\`\`

### Properties
- Output is x if x > 0, else 0
- Helps with vanishing gradient problem
- Computationally efficient

### Function Signature
\`\`\`python
def relu(x: np.ndarray) -> np.ndarray:
\`\`\`
    `,examples:[{input:"np.array([-2, -1, 0, 1, 2])",output:"[0, 0, 0, 1, 2]",explanation:"Negative values become 0, positive values unchanged"}],starterCode:`import numpy as np

def relu(x: np.ndarray) -> np.ndarray:
    """
    Apply ReLU activation function.

    Args:
        x: Input array of any shape

    Returns:
        Array with ReLU applied element-wise
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Mixed values",input:"[-2, -1, 0, 1, 2]",expected:"[0, 0, 0, 1, 2]",hidden:!1},{id:"2",description:"All negative",input:"[-5, -3, -1]",expected:"[0, 0, 0]",hidden:!1},{id:"3",description:"All positive",input:"[1, 2, 3]",expected:"[1, 2, 3]",hidden:!0}],hints:["Use np.maximum() to compare with 0.","Alternatively, use boolean indexing or np.where()."],solution:`import numpy as np

def relu(x: np.ndarray) -> np.ndarray:
    """
    Apply ReLU activation function.
    """
    return np.maximum(0, x)
`},{id:"neural-network-forward",title:"Dense Layer Forward Pass",section:"deep-learning",difficulty:"medium",description:`
## Dense Layer Forward Pass

Implement the forward pass of a fully-connected (dense) neural network layer.

### Formula
\`\`\`
output = activation(X @ W + b)
\`\`\`

Where:
- X: Input of shape (batch_size, input_dim)
- W: Weights of shape (input_dim, output_dim)
- b: Bias of shape (output_dim,)

### Function Signature
\`\`\`python
def dense_forward(X: np.ndarray, W: np.ndarray, b: np.ndarray) -> np.ndarray:
\`\`\`

Use ReLU as the activation function.
    `,examples:[{input:"X = [[1, 2]], W = [[1, 0], [0, 1]], b = [1, 1]",output:"[[2, 3]]",explanation:"X @ W = [[1, 2]], + b = [[2, 3]], ReLU keeps positive"}],starterCode:`import numpy as np

def dense_forward(X: np.ndarray, W: np.ndarray, b: np.ndarray) -> np.ndarray:
    """
    Compute forward pass of a dense layer with ReLU activation.

    Args:
        X: Input of shape (batch_size, input_dim)
        W: Weights of shape (input_dim, output_dim)
        b: Bias of shape (output_dim,)

    Returns:
        Output of shape (batch_size, output_dim)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic forward pass",input:"([[1, 2]], [[1, 0], [0, 1]], [1, 1])",expected:"[[2, 3]]",hidden:!1},{id:"2",description:"With negative pre-activation",input:"([[1, 1]], [[1, -2], [-1, 1]], [0, 0])",expected:"[[0, 0]]",hidden:!1},{id:"3",description:"Batch of 2",input:"([[1, 0], [0, 1]], [[2, 0], [0, 2]], [0, 0])",expected:"[[2, 0], [0, 2]]",hidden:!0}],hints:["First compute the linear transformation: Z = X @ W + b","Then apply ReLU: output = max(0, Z)"],solution:`import numpy as np

def dense_forward(X: np.ndarray, W: np.ndarray, b: np.ndarray) -> np.ndarray:
    """
    Compute forward pass of a dense layer with ReLU activation.
    """
    # Linear transformation
    Z = np.dot(X, W) + b
    # ReLU activation
    return np.maximum(0, Z)
`},{id:"backpropagation",title:"Softmax Function",section:"deep-learning",difficulty:"medium",description:`
## Softmax Function

Implement the softmax function, used to convert raw scores to probabilities in multi-class classification.

### Formula
\`\`\`
softmax(x)_i = exp(x_i) / sum(exp(x_j))
\`\`\`

### Properties
- Output sums to 1
- All outputs are positive
- Larger inputs get larger probabilities

### Function Signature
\`\`\`python
def softmax(x: np.ndarray) -> np.ndarray:
\`\`\`

**Note**: For numerical stability, subtract max(x) before computing exp.
    `,examples:[{input:"np.array([1, 2, 3])",output:"[0.090031, 0.244728, 0.665241]",explanation:"Higher values get higher probabilities, sum = 1"}],starterCode:`import numpy as np

def softmax(x: np.ndarray) -> np.ndarray:
    """
    Compute softmax probabilities.

    Args:
        x: Input array (1D)

    Returns:
        Array of same shape with softmax probabilities
    """
    # Your code here
    # Hint: subtract max for numerical stability
    pass
`,testCases:[{id:"1",description:"Basic softmax",input:"bool(np.allclose(softmax(np.array([1, 2, 3])), [0.090031, 0.244728, 0.665241], atol=1e-5))",expected:"True",hidden:!1},{id:"2",description:"Equal inputs",input:"bool(np.allclose(softmax(np.array([1, 1, 1])), [0.333333, 0.333333, 0.333333], atol=1e-5))",expected:"True",hidden:!1},{id:"3",description:"Large values",input:"bool(np.allclose(softmax(np.array([100, 101, 102])), [0.090031, 0.244728, 0.665241], atol=1e-5))",expected:"True",hidden:!0}],hints:["Subtract the max value for numerical stability.","Compute exp of each element.","Divide by the sum of all exp values."],solution:`import numpy as np

def softmax(x: np.ndarray) -> np.ndarray:
    """
    Compute softmax probabilities.
    """
    # Subtract max for numerical stability
    x_shifted = x - np.max(x)
    exp_x = np.exp(x_shifted)
    return exp_x / np.sum(exp_x)
`}],I6=[{id:"precision-recall-f1",title:"Precision and Recall",section:"model-evaluation",difficulty:"medium",description:`
## Precision and Recall

Calculate precision and recall from true labels and predictions.

### Formulas
\`\`\`
Precision = TP / (TP + FP)
Recall = TP / (TP + FN)
\`\`\`

Where:
- TP = True Positives (predicted 1, actual 1)
- FP = False Positives (predicted 1, actual 0)
- FN = False Negatives (predicted 0, actual 1)

### Function Signature
\`\`\`python
def precision_recall(y_true: np.ndarray, y_pred: np.ndarray) -> tuple:
\`\`\`

Returns (precision, recall) rounded to 4 decimal places.
    `,examples:[{input:"y_true = [1, 1, 0, 1, 0], y_pred = [1, 0, 0, 1, 1]",output:"(0.6667, 0.6667)",explanation:"TP=2, FP=1, FN=1. Precision=2/3, Recall=2/3"}],starterCode:`import numpy as np

def precision_recall(y_true: np.ndarray, y_pred: np.ndarray) -> tuple:
    """
    Calculate precision and recall for binary classification.

    Args:
        y_true: True labels (0 or 1)
        y_pred: Predicted labels (0 or 1)

    Returns:
        Tuple of (precision, recall) rounded to 4 decimal places
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Mixed predictions",input:"([1, 1, 0, 1, 0], [1, 0, 0, 1, 1])",expected:"(0.6667, 0.6667)",hidden:!1},{id:"2",description:"Perfect predictions",input:"([1, 1, 0, 0], [1, 1, 0, 0])",expected:"(1.0, 1.0)",hidden:!1},{id:"3",description:"High precision, low recall",input:"([1, 1, 1, 1, 0], [1, 0, 0, 0, 0])",expected:"(1.0, 0.25)",hidden:!0}],hints:["Count TP where both y_true and y_pred are 1.","Count FP where y_pred is 1 but y_true is 0.","Count FN where y_true is 1 but y_pred is 0."],solution:`import numpy as np

def precision_recall(y_true: np.ndarray, y_pred: np.ndarray) -> tuple:
    """
    Calculate precision and recall for binary classification.
    """
    y_true = np.array(y_true)
    y_pred = np.array(y_pred)

    # Calculate TP, FP, FN
    tp = np.sum((y_true == 1) & (y_pred == 1))
    fp = np.sum((y_true == 0) & (y_pred == 1))
    fn = np.sum((y_true == 1) & (y_pred == 0))

    # Calculate precision and recall
    precision = tp / (tp + fp) if (tp + fp) > 0 else 0
    recall = tp / (tp + fn) if (tp + fn) > 0 else 0

    return (round(precision, 4), round(recall, 4))
`},{id:"cross-validation",title:"K-Fold Split Indices",section:"model-evaluation",difficulty:"medium",description:`
## K-Fold Cross-Validation Indices

Generate train and validation indices for K-fold cross-validation.

### Concept
Split data into K equal parts. For each fold:
- Use 1 part for validation
- Use remaining K-1 parts for training

### Function Signature
\`\`\`python
def kfold_indices(n_samples: int, k: int) -> list:
\`\`\`

Returns list of (train_indices, val_indices) tuples for each fold.
    `,examples:[{input:"n_samples = 6, k = 3",output:"[([2,3,4,5], [0,1]), ([0,1,4,5], [2,3]), ([0,1,2,3], [4,5])]",explanation:"Split [0,1,2,3,4,5] into 3 folds of size 2"}],starterCode:`import numpy as np

def kfold_indices(n_samples: int, k: int) -> list:
    """
    Generate train/validation indices for K-fold cross-validation.

    Args:
        n_samples: Total number of samples
        k: Number of folds

    Returns:
        List of (train_indices, val_indices) tuples
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic 3-fold",input:"(6, 3)",expected:"[[[2, 3, 4, 5], [0, 1]], [[0, 1, 4, 5], [2, 3]], [[0, 1, 2, 3], [4, 5]]]",hidden:!1},{id:"2",description:"2-fold",input:"(4, 2)",expected:"[[[2, 3], [0, 1]], [[0, 1], [2, 3]]]",hidden:!1},{id:"3",description:"4-fold",input:"(8, 4)",expected:"[[[2, 3, 4, 5, 6, 7], [0, 1]], [[0, 1, 4, 5, 6, 7], [2, 3]], [[0, 1, 2, 3, 6, 7], [4, 5]], [[0, 1, 2, 3, 4, 5], [6, 7]]]",hidden:!0}],hints:["Divide indices into k equal-sized chunks.","For each fold, one chunk is validation, rest are training.","Use np.array_split() to create chunks."],solution:`import numpy as np

def kfold_indices(n_samples: int, k: int) -> list:
    """
    Generate train/validation indices for K-fold cross-validation.
    """
    indices = np.arange(n_samples)
    fold_sizes = np.full(k, n_samples // k)
    fold_sizes[:n_samples % k] += 1

    folds = []
    current = 0
    for fold_size in fold_sizes:
        val_indices = list(range(current, current + fold_size))
        train_indices = [i for i in range(n_samples) if i not in val_indices]
        folds.append((train_indices, val_indices))
        current += fold_size

    return folds
`},{id:"confusion-matrix",title:"Accuracy Score",section:"model-evaluation",difficulty:"easy",description:`
## Accuracy Score

Calculate the accuracy of predictions - the proportion of correct predictions.

### Formula
\`\`\`
Accuracy = (Number of correct predictions) / (Total predictions)
\`\`\`

### Function Signature
\`\`\`python
def accuracy(y_true: np.ndarray, y_pred: np.ndarray) -> float:
\`\`\`

### Note
While simple, accuracy can be misleading for imbalanced datasets.
    `,examples:[{input:"y_true = [0, 1, 1, 0, 1], y_pred = [0, 1, 0, 0, 1]",output:"0.8",explanation:"4 correct out of 5 predictions"}],starterCode:`import numpy as np

def accuracy(y_true: np.ndarray, y_pred: np.ndarray) -> float:
    """
    Calculate accuracy of predictions.

    Args:
        y_true: True labels
        y_pred: Predicted labels

    Returns:
        Accuracy score between 0 and 1
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic accuracy",input:"([0, 1, 1, 0, 1], [0, 1, 0, 0, 1])",expected:"0.8",hidden:!1},{id:"2",description:"Perfect accuracy",input:"([1, 1, 0, 0], [1, 1, 0, 0])",expected:"1.0",hidden:!1},{id:"3",description:"Zero accuracy",input:"([0, 0, 1, 1], [1, 1, 0, 0])",expected:"0.0",hidden:!0}],hints:["Compare y_true and y_pred element-wise.","Count matches and divide by total.","np.mean() of boolean array gives proportion of True."],solution:`import numpy as np

def accuracy(y_true: np.ndarray, y_pred: np.ndarray) -> float:
    """
    Calculate accuracy of predictions.
    """
    y_true = np.array(y_true)
    y_pred = np.array(y_pred)
    return np.mean(y_true == y_pred)
`}],A6=[{id:"mlp-forward-backward",title:"MLP Forward & Backward Pass",section:"neural-networks",difficulty:"hard",description:"\n## MLP Forward & Backward Pass\n\nImplement both forward and backward passes for a 2-layer MLP (Multi-Layer Perceptron).\n\n### Architecture\n```\nInput (n_features)  Hidden (n_hidden)  Output (n_classes)\n```\n\n### Forward Pass\n```\nZ1 = X @ W1 + b1\nA1 = ReLU(Z1)\nZ2 = A1 @ W2 + b2\noutput = softmax(Z2)\n```\n\nReturn: `(output, cache)` where cache = `(X, Z1, A1, Z2, W1, W2)`\n\n### Backward Pass (Backpropagation)\nUsing the chain rule, gradients flow backwards:\n\n```\nLoss  dZ2  dW2, db2  dA1  dZ1 (ReLU)  dW1, db1\n```\n\n**Key Formulas:**\n- `dZ2 = output - Y_onehot` (softmax + cross-entropy derivative)\n- `dW2 = (1/m) * A1.T @ dZ2`\n- `db2 = (1/m) * sum(dZ2, axis=0)`\n- `dZ1 = (dZ2 @ W2.T) * (Z1 > 0)` (ReLU derivative)\n- `dW1 = (1/m) * X.T @ dZ1`\n- `db1 = (1/m) * sum(dZ1, axis=0)`\n\nReturn: `{'dW1': ..., 'db1': ..., 'dW2': ..., 'db2': ...}`\n    ",examples:[{input:"X shape (2, 3), hidden_size=4, output_size=2",output:"Forward: probabilities (2, 2), rows sum to 1. Backward: gradients for all weights/biases",explanation:"Forward computes predictions; backward computes gradients for training"}],starterCode:`import numpy as np

def relu(x):
    return np.maximum(0, x)

def softmax(x):
    exp_x = np.exp(x - np.max(x, axis=1, keepdims=True))
    return exp_x / np.sum(exp_x, axis=1, keepdims=True)

def mlp_forward(X, W1, b1, W2, b2):
    """
    Forward pass for a 2-layer MLP.

    Args:
        X: Input data (batch_size, n_features)
        W1: First layer weights (n_features, n_hidden)
        b1: First layer bias (n_hidden,)
        W2: Second layer weights (n_hidden, n_classes)
        b2: Second layer bias (n_classes,)

    Returns:
        output: Class probabilities (batch_size, n_classes)
        cache: Tuple (X, Z1, A1, Z2, W1, W2) for backprop
    """
    # Your code here
    pass

def mlp_backward(Y, output, cache):
    """
    Backward pass (backpropagation) for 2-layer MLP.

    Args:
        Y: One-hot encoded labels (batch_size, n_classes)
        output: Predicted probabilities from forward pass
        cache: Cached values from forward pass (X, Z1, A1, Z2, W1, W2)

    Returns:
        grads: Dictionary with dW1, db1, dW2, db2
    """
    X, Z1, A1, Z2, W1, W2 = cache
    m = X.shape[0]  # batch size

    # Your code here
    pass
`,testCases:[{id:"1",description:"Forward: output shape correct",input:"mlp_forward(np.array([[1, 2, 3], [4, 5, 6]]), np.ones((3, 4)), np.zeros(4), np.ones((4, 2)), np.zeros(2))[0].shape",expected:"(2, 2)",hidden:!1},{id:"2",description:"Forward: probabilities sum to 1",input:"round(float(np.sum(mlp_forward(np.array([[1, 0], [0, 1]]), np.array([[1, 0], [0, 1]]), np.zeros(2), np.array([[1, 0], [0, 1]]), np.zeros(2))[0][0])), 1)",expected:"1.0",hidden:!1},{id:"3",description:"Backward: dW2 shape matches W2",input:`(lambda: (
            X := np.array([[1.0, 2.0], [3.0, 4.0]]),
            W1 := np.array([[0.1, 0.2, 0.3], [0.4, 0.5, 0.6]]),
            b1 := np.zeros(3),
            W2 := np.array([[0.1, 0.2], [0.3, 0.4], [0.5, 0.6]]),
            b2 := np.zeros(2),
            result := mlp_forward(X, W1, b1, W2, b2),
            output := result[0],
            cache := result[1],
            Y := np.array([[1, 0], [0, 1]]),
            grads := mlp_backward(Y, output, cache),
            grads['dW2'].shape == W2.shape
        )[-1])()`,expected:"True",hidden:!1},{id:"4",description:"Backward: gradients are non-zero",input:`(lambda: (
            X := np.array([[1.0, 2.0], [3.0, 4.0]]),
            W1 := np.array([[0.1, 0.2, 0.3], [0.4, 0.5, 0.6]]),
            b1 := np.zeros(3),
            W2 := np.array([[0.1, 0.2], [0.3, 0.4], [0.5, 0.6]]),
            b2 := np.zeros(2),
            result := mlp_forward(X, W1, b1, W2, b2),
            output := result[0],
            cache := result[1],
            Y := np.array([[1, 0], [0, 1]]),
            grads := mlp_backward(Y, output, cache),
            bool(np.any(grads['dW1'] != 0) and np.any(grads['dW2'] != 0))
        )[-1])()`,expected:"True",hidden:!0},{id:"5",description:"Backward: all gradient keys present",input:`(lambda: (
            X := np.array([[1.0, 2.0]]),
            W1 := np.array([[0.1, 0.2], [0.3, 0.4]]),
            b1 := np.zeros(2),
            W2 := np.array([[0.1], [0.2]]),
            b2 := np.zeros(1),
            result := mlp_forward(X, W1, b1, W2, b2),
            grads := mlp_backward(np.array([[1]]), result[0], result[1]),
            sorted(grads.keys())
        )[-1])()`,expected:'["dW1", "dW2", "db1", "db2"]',hidden:!0}],hints:["Forward: Compute Z1 = X @ W1 + b1, then A1 = ReLU(Z1)","Forward: Compute Z2 = A1 @ W2 + b2, then output = softmax(Z2)","Forward: Store cache = (X, Z1, A1, Z2, W1, W2) for backprop","Backward: Start from output layer: dZ2 = output - Y","Backward: dW2 = (1/m) * A1.T @ dZ2, db2 = (1/m) * sum(dZ2, axis=0)","Backward: Propagate through ReLU: dZ1 = (dZ2 @ W2.T) * (Z1 > 0)","Backward: dW1 = (1/m) * X.T @ dZ1, db1 = (1/m) * sum(dZ1, axis=0)"],solution:`import numpy as np

def relu(x):
    return np.maximum(0, x)

def softmax(x):
    exp_x = np.exp(x - np.max(x, axis=1, keepdims=True))
    return exp_x / np.sum(exp_x, axis=1, keepdims=True)

def mlp_forward(X, W1, b1, W2, b2):
    # First layer
    Z1 = X @ W1 + b1
    A1 = relu(Z1)

    # Second layer
    Z2 = A1 @ W2 + b2
    output = softmax(Z2)

    # Cache for backprop
    cache = (X, Z1, A1, Z2, W1, W2)

    return output, cache

def mlp_backward(Y, output, cache):
    X, Z1, A1, Z2, W1, W2 = cache
    m = X.shape[0]

    # Output layer gradient (softmax + cross-entropy)
    dZ2 = output - Y
    dW2 = (1/m) * A1.T @ dZ2
    db2 = (1/m) * np.sum(dZ2, axis=0)

    # Hidden layer gradient
    dA1 = dZ2 @ W2.T
    dZ1 = dA1 * (Z1 > 0)  # ReLU derivative
    dW1 = (1/m) * X.T @ dZ1
    db1 = (1/m) * np.sum(dZ1, axis=0)

    return {'dW1': dW1, 'db1': db1, 'dW2': dW2, 'db2': db2}
`},{id:"cross-entropy-loss",title:"Cross-Entropy Loss",section:"neural-networks",difficulty:"easy",description:`
## Cross-Entropy Loss

Implement the cross-entropy loss function for multi-class classification.

### Formula
\`\`\`
L = -1/m * sum(Y * log(Y_pred))
\`\`\`

Where:
- Y is one-hot encoded true labels
- Y_pred is predicted probabilities
- m is batch size

### Numerical Stability
Add small epsilon to avoid log(0):
\`\`\`python
np.log(Y_pred + 1e-15)
\`\`\`
    `,examples:[{input:"Y_pred = [[0.7, 0.2, 0.1], [0.1, 0.8, 0.1]], Y = [[1,0,0], [0,1,0]]",output:"0.2231",explanation:"-1/2 * (log(0.7) + log(0.8))"}],starterCode:`import numpy as np

def cross_entropy_loss(Y_pred, Y_true):
    """
    Compute cross-entropy loss.

    Args:
        Y_pred: Predicted probabilities (batch_size, n_classes)
        Y_true: One-hot encoded true labels (batch_size, n_classes)

    Returns:
        loss: Scalar cross-entropy loss
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Perfect prediction",input:"abs(cross_entropy_loss(np.array([[1.0, 0.0], [0.0, 1.0]]), np.array([[1, 0], [0, 1]])))",expected:"0.0",hidden:!1},{id:"2",description:"Typical case",input:"cross_entropy_loss(np.array([[0.7, 0.3], [0.2, 0.8]]), np.array([[1, 0], [0, 1]]))",expected:"0.2899",hidden:!1}],hints:["Use np.log with a small epsilon for numerical stability","Multiply element-wise: Y_true * np.log(Y_pred)","Sum and negate, then divide by batch size"],solution:`import numpy as np

def cross_entropy_loss(Y_pred, Y_true):
    m = Y_pred.shape[0]
    epsilon = 1e-15
    log_probs = np.log(Y_pred + epsilon)
    loss = -np.sum(Y_true * log_probs) / m
    return round(loss, 4)
`},{id:"weight-init",title:"Xavier/He Weight Initialization",section:"neural-networks",difficulty:"medium",description:`
## Weight Initialization

Implement Xavier and He weight initialization to prevent vanishing/exploding gradients.

### Xavier Initialization (for tanh/sigmoid)
\`\`\`
W = randn(n_in, n_out) * sqrt(2 / (n_in + n_out))
\`\`\`

### He Initialization (for ReLU)
\`\`\`
W = randn(n_in, n_out) * sqrt(2 / n_in)
\`\`\`

### Why It Matters
- Keeps variance of activations stable across layers
- Prevents gradients from vanishing or exploding
- Enables training of deep networks
    `,examples:[{input:'n_in=784, n_out=256, method="he"',output:"Weights with std  0.0505",explanation:"sqrt(2/784)  0.0505"}],starterCode:`import numpy as np

def initialize_weights(n_in, n_out, method='xavier'):
    """
    Initialize weights using Xavier or He initialization.

    Args:
        n_in: Number of input units
        n_out: Number of output units
        method: 'xavier' or 'he'

    Returns:
        std: Standard deviation of initialized weights (rounded to 4 decimals)
    """
    np.random.seed(42)  # For reproducibility
    # Your code here
    pass
`,testCases:[{id:"1",description:"Xavier std correct",input:'(100, 50, "xavier")',expected:"0.1151",hidden:!1},{id:"2",description:"He std correct",input:'(100, 50, "he")',expected:"0.1409",hidden:!1}],hints:["Use np.random.randn to generate random numbers","Xavier: multiply by sqrt(2 / (n_in + n_out))","He: multiply by sqrt(2 / n_in)"],solution:`import numpy as np

def initialize_weights(n_in, n_out, method='xavier'):
    np.random.seed(42)

    if method == 'xavier':
        std = np.sqrt(2.0 / (n_in + n_out))
    elif method == 'he':
        std = np.sqrt(2.0 / n_in)
    else:
        raise ValueError("Method must be 'xavier' or 'he'")

    W = np.random.randn(n_in, n_out) * std
    return round(np.std(W), 4)
`},{id:"batch-norm",title:"Batch Normalization",section:"neural-networks",difficulty:"medium",description:`
## Batch Normalization

Implement batch normalization to stabilize training.

### Forward Pass
\`\`\`
1. Compute batch mean:  = mean(x, axis=0)
2. Compute batch variance:  = var(x, axis=0)
3. Normalize: x_norm = (x - ) / sqrt( + )
4. Scale and shift: out =  * x_norm + 
\`\`\`

### Return Format
Return \`(out, cache)\` where:
- \`out\`: Normalized and scaled output
- \`cache\`: Tuple \`(X, X_norm, mu, var, gamma, eps)\` for backward pass

### Benefits
- Reduces internal covariate shift
- Allows higher learning rates
- Acts as regularization
    `,examples:[{input:"X with mean=5, var=4, gamma=1, beta=0",output:"Normalized X with mean0, var1",explanation:"BatchNorm normalizes each feature"}],starterCode:`import numpy as np

def batch_norm_forward(X, gamma, beta, eps=1e-5):
    """
    Batch normalization forward pass.

    Args:
        X: Input (batch_size, features)
        gamma: Scale parameter (features,)
        beta: Shift parameter (features,)
        eps: Small constant for numerical stability

    Returns:
        out: Normalized output (batch_size, features)
        cache: Tuple (X, X_norm, mu, var, gamma, eps) for backward pass
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output mean near zero",input:"bool(np.allclose(np.mean(batch_norm_forward(np.array([[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]), np.ones(2), np.zeros(2))[0], axis=0), 0, atol=1e-5))",expected:"True",hidden:!1},{id:"2",description:"Gamma scales output",input:"list(np.round(batch_norm_forward(np.array([[0.0, 0.0], [2.0, 2.0]]), np.array([2.0, 3.0]), np.zeros(2))[0][1], 1))",expected:"[2.0, 3.0]",hidden:!0}],hints:["Compute mean along axis=0 (batch dimension)","Compute variance along axis=0","Normalize: (X - mean) / sqrt(var + eps)","Apply scale and shift: gamma * normalized + beta"],solution:`import numpy as np

def batch_norm_forward(X, gamma, beta, eps=1e-5):
    # Compute batch statistics
    mu = np.mean(X, axis=0)
    var = np.var(X, axis=0)

    # Normalize
    X_norm = (X - mu) / np.sqrt(var + eps)

    # Scale and shift
    out = gamma * X_norm + beta

    # Cache for backward pass
    cache = (X, X_norm, mu, var, gamma, eps)

    return out, cache
`},{id:"dropout",title:"Dropout",section:"neural-networks",difficulty:"easy",description:`
## Dropout Regularization

Implement dropout to prevent overfitting.

### Training Mode
\`\`\`
1. Generate mask: mask = (rand < keep_prob) / keep_prob
2. Apply mask: out = x * mask
\`\`\`

### Key Points
- Randomly "drop" neurons with probability (1 - keep_prob)
- Scale by 1/keep_prob to maintain expected value
- Disabled during inference (return input unchanged)
    `,examples:[{input:"X = [[1, 2, 3, 4]], keep_prob=0.5",output:"Some values zeroed, others scaled by 2",explanation:"Half neurons dropped, rest doubled"}],starterCode:`import numpy as np

def dropout_forward(X, keep_prob=0.5, training=True):
    """
    Apply dropout to input.

    Args:
        X: Input array
        keep_prob: Probability of keeping a neuron
        training: Whether in training mode

    Returns:
        out: Output after dropout
        mask: Dropout mask (for backward pass)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Inference returns unchanged",input:"dropout_forward(np.array([[1, 2, 3, 4]]), 0.5, False)[0].tolist()",expected:"[[1, 2, 3, 4]]",hidden:!1},{id:"2",description:"Expected value preserved",input:`(lambda: (
            np.random.seed(42),
            X := np.ones((1000, 100)),
            out := dropout_forward(X, 0.8, True)[0],
            bool(abs(np.mean(out) - 1.0) < 0.1)
        )[-1])()`,expected:"True",hidden:!0}],hints:["In training: create binary mask with np.random.rand","Scale mask by 1/keep_prob (inverted dropout)","In inference: return input unchanged"],solution:`import numpy as np

def dropout_forward(X, keep_prob=0.5, training=True):
    if not training:
        return X, None

    # Create mask and scale
    mask = (np.random.rand(*X.shape) < keep_prob) / keep_prob
    out = X * mask

    return out, mask
`}],P6=[{id:"conv2d-forward",title:"2D Convolution",section:"cnn",difficulty:"hard",description:`
## 2D Convolution Operation

Implement the forward pass of a 2D convolution (no padding, stride=1).

### Operation
For each position (i, j) in the output:
\`\`\`
out[i, j] = sum(input[i:i+kH, j:j+kW] * kernel)
\`\`\`

### Output Size
\`\`\`
out_height = input_height - kernel_height + 1
out_width = input_width - kernel_width + 1
\`\`\`

### Function Signature
\`\`\`python
def conv2d(image, kernel):
    # image: (H, W)
    # kernel: (kH, kW)
    # output: (H-kH+1, W-kW+1)
\`\`\`
    `,examples:[{input:"image 4x4, kernel 3x3",output:"output 2x2",explanation:"4-3+1 = 2 in each dimension"}],starterCode:`import numpy as np

def conv2d(image, kernel):
    """
    Apply 2D convolution to an image.

    Args:
        image: Input image (H, W)
        kernel: Convolution kernel (kH, kW)

    Returns:
        output: Convolved image (H-kH+1, W-kW+1)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Identity kernel",input:"([[1, 2, 3], [4, 5, 6], [7, 8, 9]], [[0, 0, 0], [0, 1, 0], [0, 0, 0]])",expected:"[[5]]",hidden:!1},{id:"2",description:"Edge detection",input:"([[0, 0, 0, 0], [0, 1, 1, 0], [0, 1, 1, 0], [0, 0, 0, 0]], [[-1, -1, -1], [-1, 8, -1], [-1, -1, -1]])",expected:"[[5, 5], [5, 5]]",hidden:!1}],hints:["Use nested loops to slide the kernel over the image","At each position, compute element-wise product and sum","Output size is (H-kH+1, W-kW+1)"],solution:`import numpy as np

def conv2d(image, kernel):
    image = np.array(image)
    kernel = np.array(kernel)

    H, W = image.shape
    kH, kW = kernel.shape

    out_H = H - kH + 1
    out_W = W - kW + 1

    output = np.zeros((out_H, out_W))

    for i in range(out_H):
        for j in range(out_W):
            region = image[i:i+kH, j:j+kW]
            output[i, j] = np.sum(region * kernel)

    return output.astype(int).tolist()
`},{id:"max-pool",title:"Max Pooling",section:"cnn",difficulty:"medium",description:`
## Max Pooling

Implement 2x2 max pooling with stride 2.

### Operation
Divide input into non-overlapping 2x2 regions and take maximum of each.

### Output Size
\`\`\`
out_height = input_height // 2
out_width = input_width // 2
\`\`\`

### Purpose
- Reduces spatial dimensions
- Provides translation invariance
- Reduces computation
    `,examples:[{input:"[[1,2,3,4], [5,6,7,8], [9,10,11,12], [13,14,15,16]]",output:"[[6, 8], [14, 16]]",explanation:"Max of each 2x2 region"}],starterCode:`import numpy as np

def max_pool2d(image, pool_size=2):
    """
    Apply 2D max pooling.

    Args:
        image: Input image (H, W)
        pool_size: Size of pooling window

    Returns:
        output: Pooled image (H//pool_size, W//pool_size)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"4x4 to 2x2",input:"[[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16]]",expected:"[[6, 8], [14, 16]]",hidden:!1},{id:"2",description:"With negative values",input:"[[-1, -2, -3, -4], [-5, -6, -7, -8], [-9, -10, -11, -12], [-13, -14, -15, -16]]",expected:"[[-1, -3], [-9, -11]]",hidden:!0}],hints:["Iterate with step size = pool_size","For each 2x2 region, use np.max()","Output dimensions are input dimensions // pool_size"],solution:`import numpy as np

def max_pool2d(image, pool_size=2):
    image = np.array(image)
    H, W = image.shape

    out_H = H // pool_size
    out_W = W // pool_size

    output = np.zeros((out_H, out_W))

    for i in range(out_H):
        for j in range(out_W):
            region = image[i*pool_size:(i+1)*pool_size,
                          j*pool_size:(j+1)*pool_size]
            output[i, j] = np.max(region)

    return output.astype(int).tolist()
`},{id:"flatten-layer",title:"Flatten Layer",section:"cnn",difficulty:"easy",description:`
## Flatten Layer

Implement the flatten operation that converts a 3D feature map to a 1D vector for the fully connected layer.

### Operation
\`\`\`
(batch, height, width, channels)  (batch, height * width * channels)
\`\`\`

### Usage
- Connects convolutional layers to fully connected layers
- Preserves batch dimension
    `,examples:[{input:"shape (2, 4, 4, 3)",output:"shape (2, 48)",explanation:"4 * 4 * 3 = 48 features per sample"}],starterCode:`import numpy as np

def flatten(X):
    """
    Flatten feature maps to vectors.

    Args:
        X: Input tensor (batch, height, width, channels)

    Returns:
        output: Flattened tensor (batch, height*width*channels)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Correct output shape",input:"flatten(np.random.randn(2, 4, 4, 3)).shape",expected:"(2, 48)",hidden:!1},{id:"2",description:"Values preserved",input:"bool(np.allclose(flatten(np.arange(24).reshape(1, 2, 3, 4)), np.arange(24).reshape(1, 24)))",expected:"True",hidden:!0}],hints:["Get batch size as X.shape[0]","Use reshape to flatten remaining dimensions","np.reshape(X, (batch_size, -1)) uses -1 to infer size"],solution:`import numpy as np

def flatten(X):
    batch_size = X.shape[0]
    return X.reshape(batch_size, -1)
`},{id:"conv-output-size",title:"Convolution Output Size",section:"cnn",difficulty:"easy",description:`
## Calculate Convolution Output Size

Implement a function to calculate the output dimensions of a convolution layer.

### Formula
\`\`\`
output_size = (input_size - kernel_size + 2 * padding) / stride + 1
\`\`\`

### Parameters
- **input_size**: Height or width of input
- **kernel_size**: Height or width of kernel
- **padding**: Zero-padding added to input
- **stride**: Step size of kernel
    `,examples:[{input:"input=32, kernel=3, padding=1, stride=1",output:"32",explanation:"(32 - 3 + 2*1) / 1 + 1 = 32"}],starterCode:`def conv_output_size(input_size, kernel_size, padding=0, stride=1):
    """
    Calculate output size of a convolution layer.

    Args:
        input_size: Input dimension (height or width)
        kernel_size: Kernel dimension
        padding: Zero-padding
        stride: Stride

    Returns:
        output_size: Output dimension
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Same padding",input:"(32, 3, 1, 1)",expected:"32",hidden:!1},{id:"2",description:"No padding, stride 2",input:"(32, 3, 0, 2)",expected:"15",hidden:!1},{id:"3",description:"Large kernel",input:"(224, 7, 3, 2)",expected:"112",hidden:!0}],hints:["Apply the formula: (input - kernel + 2*padding) / stride + 1","Use integer division (//) for the result"],solution:`def conv_output_size(input_size, kernel_size, padding=0, stride=1):
    return (input_size - kernel_size + 2 * padding) // stride + 1
`},{id:"conv2d-advanced",title:"Advanced 2D Convolution",section:"cnn",difficulty:"hard",description:`
## Advanced 2D Convolution

Implement a full-featured 2D convolution with **padding**, **stride**, and **groups** support.

### Parameters
- **padding**: Zero-padding added to input borders
- **stride**: Step size when sliding the kernel
- **groups**: Split input/output channels into groups (used in depthwise separable convolutions)

### Group Convolution
When \`groups > 1\`:
- Input channels are split into \`groups\` chunks
- Output channels are split into \`groups\` chunks
- Each group's input is convolved only with its corresponding kernel group
- \`in_channels\` and \`out_channels\` must be divisible by \`groups\`

### Special Cases
- \`groups=1\`: Standard convolution
- \`groups=in_channels=out_channels\`: Depthwise convolution (MobileNet)

### Output Size Formula
\`\`\`
H_out = (H_in + 2*padding - kernel_height) // stride + 1
W_out = (W_in + 2*padding - kernel_width) // stride + 1
\`\`\`

### Function Signature
\`\`\`python
def conv2d_advanced(input, kernel, padding=0, stride=1, groups=1):
    # input: (batch, in_channels, H, W)
    # kernel: (out_channels, in_channels//groups, kH, kW)
    # output: (batch, out_channels, H_out, W_out)
\`\`\`
    `,examples:[{input:"input (1, 4, 5, 5), kernel (8, 2, 3, 3), groups=2",output:"output (1, 8, 3, 3)",explanation:"Groups=2: channels 0-1 use kernels 0-3, channels 2-3 use kernels 4-7"},{input:"input (1, 1, 5, 5), kernel (1, 1, 3, 3), padding=1, stride=2",output:"output (1, 1, 3, 3)",explanation:"(5+2*1-3)//2+1 = 3"}],starterCode:`import numpy as np

def conv2d_advanced(input, kernel, padding=0, stride=1, groups=1):
    """
    Advanced 2D convolution with padding, stride, and groups.

    Args:
        input: Input tensor (batch, in_channels, H, W)
        kernel: Convolution kernels (out_channels, in_channels//groups, kH, kW)
        padding: Zero-padding added to input (default: 0)
        stride: Stride of the convolution (default: 1)
        groups: Number of groups for grouped convolution (default: 1)

    Returns:
        output: Convolved tensor (batch, out_channels, H_out, W_out)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic convolution with padding and stride",input:"conv2d_advanced(np.ones((1, 1, 5, 5)), np.ones((1, 1, 3, 3)), 1, 2, 1).shape",expected:"(1, 1, 3, 3)",hidden:!1},{id:"2",description:"Grouped convolution (groups=2)",input:"conv2d_advanced(np.arange(32).reshape(1, 2, 4, 4).astype(float), np.ones((4, 1, 2, 2)), 0, 1, 2).shape",expected:"(1, 4, 3, 3)",hidden:!1},{id:"3",description:"Depthwise convolution (groups=in_channels)",input:"conv2d_advanced(np.ones((2, 3, 4, 4)), np.ones((3, 1, 2, 2)), 0, 1, 3).shape",expected:"(2, 3, 3, 3)",hidden:!0},{id:"4",description:"Verify correct output values with groups",input:"bool(np.allclose(conv2d_advanced(np.ones((1, 2, 3, 3)), np.ones((2, 1, 2, 2)), 0, 1, 2), np.array([[[[4., 4.], [4., 4.]], [[4., 4.], [4., 4.]]]])) )",expected:"True",hidden:!0}],hints:["First, pad the input using np.pad() along the H and W dimensions","Calculate output dimensions: H_out = (H_padded - kH) // stride + 1","For groups: split input channels into chunks of size in_channels//groups","For groups: split kernels into chunks of size out_channels//groups","Convolve each input group with its corresponding kernel group","Concatenate results along the channel dimension"],solution:`import numpy as np

def conv2d_advanced(input, kernel, padding=0, stride=1, groups=1):
    input = np.array(input, dtype=float)
    kernel = np.array(kernel, dtype=float)

    batch, in_channels, H, W = input.shape
    out_channels, kernel_in_channels, kH, kW = kernel.shape

    # Pad input
    if padding > 0:
        input = np.pad(input, ((0, 0), (0, 0), (padding, padding), (padding, padding)), mode='constant')

    _, _, H_padded, W_padded = input.shape

    # Calculate output dimensions
    H_out = (H_padded - kH) // stride + 1
    W_out = (W_padded - kW) // stride + 1

    # Initialize output
    output = np.zeros((batch, out_channels, H_out, W_out))

    # Channels per group
    in_channels_per_group = in_channels // groups
    out_channels_per_group = out_channels // groups

    for g in range(groups):
        # Input channels for this group
        in_start = g * in_channels_per_group
        in_end = in_start + in_channels_per_group

        # Output channels for this group
        out_start = g * out_channels_per_group
        out_end = out_start + out_channels_per_group

        # Get the input slice for this group
        input_group = input[:, in_start:in_end, :, :]

        # Get the kernels for this group
        kernel_group = kernel[out_start:out_end, :, :, :]

        # Perform convolution for this group
        for b in range(batch):
            for oc in range(out_channels_per_group):
                for i in range(H_out):
                    for j in range(W_out):
                        h_start = i * stride
                        w_start = j * stride
                        region = input_group[b, :, h_start:h_start+kH, w_start:w_start+kW]
                        output[b, out_start + oc, i, j] = np.sum(region * kernel_group[oc])

    return output
`},{id:"iou-bounding-box",title:"IoU (Intersection over Union)",section:"cnn",difficulty:"easy",description:`
## IoU (Intersection over Union)

Implement Intersection over Union (IoU) for two axis-aligned bounding boxes.

### What is IoU?
IoU measures the overlap between two bounding boxes. It is the **most fundamental metric** in object detection, used for:
- Evaluating detection quality (mAP calculation)
- Matching predictions to ground truth
- Non-Maximum Suppression (NMS)

### Formula
\`\`\`
IoU = Area of Intersection / Area of Union
    = Intersection / (Area_A + Area_B - Intersection)
\`\`\`

### Bounding Box Format
Each box is \`[x1, y1, x2, y2]\` where:
- \`(x1, y1)\` = top-left corner
- \`(x2, y2)\` = bottom-right corner

### Computing Intersection
\`\`\`
inter_x1 = max(box_a_x1, box_b_x1)
inter_y1 = max(box_a_y1, box_b_y1)
inter_x2 = min(box_a_x2, box_b_x2)
inter_y2 = min(box_a_y2, box_b_y2)
\`\`\`
If \`inter_x1 >= inter_x2\` or \`inter_y1 >= inter_y2\`, there is no overlap (IoU = 0).

### Function Signature
\`\`\`python
def iou(box_a, box_b):
    # box_a, box_b: [x1, y1, x2, y2]
    # Returns: float (IoU score, rounded to 4 decimal places)
\`\`\`
    `,examples:[{input:"box_a=[0, 0, 2, 2], box_b=[1, 1, 3, 3]",output:"0.1429",explanation:"Intersection=1, Union=4+4-1=7, IoU=1/70.1429"},{input:"box_a=[0, 0, 1, 1], box_b=[2, 2, 3, 3]",output:"0.0",explanation:"No overlap, IoU=0"}],starterCode:`import numpy as np

def iou(box_a, box_b):
    """
    Calculate Intersection over Union of two bounding boxes.

    Args:
        box_a: [x1, y1, x2, y2] first bounding box
        box_b: [x1, y1, x2, y2] second bounding box

    Returns:
        IoU score as float, rounded to 4 decimal places
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Partial overlap",input:"([0, 0, 2, 2], [1, 1, 3, 3])",expected:"0.1429",hidden:!1},{id:"2",description:"No overlap",input:"([0, 0, 1, 1], [2, 2, 3, 3])",expected:"0.0",hidden:!1},{id:"3",description:"One box inside the other",input:"([0, 0, 4, 4], [1, 1, 3, 3])",expected:"0.25",hidden:!0}],hints:["Find the intersection rectangle using max of top-left corners and min of bottom-right corners","If the intersection has zero or negative width/height, IoU is 0","Union = Area_A + Area_B - Intersection"],solution:`import numpy as np

def iou(box_a, box_b):
    x1 = max(box_a[0], box_b[0])
    y1 = max(box_a[1], box_b[1])
    x2 = min(box_a[2], box_b[2])
    y2 = min(box_a[3], box_b[3])

    inter_w = max(0, x2 - x1)
    inter_h = max(0, y2 - y1)
    intersection = inter_w * inter_h

    area_a = (box_a[2] - box_a[0]) * (box_a[3] - box_a[1])
    area_b = (box_b[2] - box_b[0]) * (box_b[3] - box_b[1])
    union = area_a + area_b - intersection

    if union == 0:
        return 0.0

    return round(intersection / union, 4)
`},{id:"nms",title:"Non-Maximum Suppression (NMS)",section:"cnn",difficulty:"medium",description:`
## Non-Maximum Suppression (NMS)

Implement Non-Maximum Suppression to filter redundant object detections.

### Why NMS?
Object detectors often produce **multiple overlapping boxes** for the same object. NMS keeps only the best detection per object.

### Algorithm
1. Sort boxes by confidence score (descending)
2. Pick the box with the highest score, add to results
3. Remove all remaining boxes with IoU > threshold against the picked box
4. Repeat until no boxes remain

### Parameters
- **boxes**: List of \`[x1, y1, x2, y2]\` bounding boxes
- **scores**: Confidence score for each box
- **iou_threshold**: Boxes with IoU above this are suppressed (default: 0.5)

### Function Signature
\`\`\`python
def nms(boxes, scores, iou_threshold=0.5):
    # boxes: list of [x1, y1, x2, y2]
    # scores: list of confidence scores
    # Returns: list of kept indices (sorted by decreasing score)
\`\`\`
    `,examples:[{input:"boxes=[[0,0,4,4],[1,1,4,4],[6,6,8,8]], scores=[0.9,0.75,0.8], threshold=0.5",output:"[0, 2]",explanation:"Box 1 (score 0.75) suppressed by box 0 (score 0.9) due to IoU=0.56 > 0.5. Box 2 has no overlap."}],starterCode:`import numpy as np

def nms(boxes, scores, iou_threshold=0.5):
    """
    Apply Non-Maximum Suppression.

    Args:
        boxes: List of [x1, y1, x2, y2] bounding boxes
        scores: List of confidence scores for each box
        iou_threshold: IoU threshold for suppression (default: 0.5)

    Returns:
        List of indices of kept boxes, sorted by decreasing score
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Overlapping box suppressed",input:"([[0,0,4,4],[1,1,4,4],[6,6,8,8]], [0.9, 0.75, 0.8], 0.5)",expected:"[0, 2]",hidden:!1},{id:"2",description:"No suppression (no overlaps)",input:"([[0,0,1,1],[3,3,4,4],[6,6,7,7]], [0.5, 0.9, 0.7], 0.5)",expected:"[1, 2, 0]",hidden:!1},{id:"3",description:"Two overlapping pairs",input:"([[0,0,4,4],[1,1,4,4],[10,10,14,14],[11,11,14,14]], [0.9, 0.85, 0.8, 0.7], 0.5)",expected:"[0, 2]",hidden:!0}],hints:["Sort indices by score in descending order","Use a while loop: pick the top-scoring box, then filter out boxes with IoU > threshold","You can reuse an IoU helper function inside NMS"],solution:`import numpy as np

def nms(boxes, scores, iou_threshold=0.5):
    def compute_iou(a, b):
        x1 = max(a[0], b[0])
        y1 = max(a[1], b[1])
        x2 = min(a[2], b[2])
        y2 = min(a[3], b[3])
        inter = max(0, x2 - x1) * max(0, y2 - y1)
        area_a = (a[2] - a[0]) * (a[3] - a[1])
        area_b = (b[2] - b[0]) * (b[3] - b[1])
        union = area_a + area_b - inter
        return inter / union if union > 0 else 0.0

    order = sorted(range(len(scores)), key=lambda i: scores[i], reverse=True)
    keep = []

    while order:
        i = order.pop(0)
        keep.append(i)
        order = [j for j in order if compute_iou(boxes[i], boxes[j]) <= iou_threshold]

    return keep
`},{id:"focal-loss",title:"Focal Loss",section:"cnn",difficulty:"medium",description:"\n## Focal Loss\n\nImplement Focal Loss from the RetinaNet paper (Lin et al., 2017).\n\n### Motivation\nIn object detection, there is a huge **class imbalance** between background (easy negatives) and foreground (actual objects). Standard cross-entropy gives equal weight to all examples, causing easy negatives to dominate training.\n\n### Formula\n```\nFL(p_t) = -alpha_t * (1 - p_t)^gamma * log(p_t)\n```\n\nWhere:\n- `p_t = p` if `y=1`, else `p_t = 1 - p` (model's estimated probability for the true class)\n- `alpha`: Balancing factor (default 0.25)\n- `gamma`: Focusing parameter (default 2.0)\n\n### Key Insight\n- When `p_t` is high (easy example): `(1 - p_t)^gamma`  0, so loss is **down-weighted**\n- When `p_t` is low (hard example): `(1 - p_t)^gamma`  1, so loss is **unchanged**\n- `gamma=0` reduces to standard cross-entropy\n\n### Function Signature\n```python\ndef focal_loss(predictions, targets, alpha=0.25, gamma=2.0):\n    # predictions: predicted probabilities (array of floats in [0, 1])\n    # targets: ground truth labels (array of 0s and 1s)\n    # Returns: mean focal loss (float, rounded to 4 decimal places)\n```\n    ",examples:[{input:"predictions=[0.9, 0.1], targets=[1, 0], alpha=0.25, gamma=2.0",output:"0.0005",explanation:"Both are confident correct predictions, so focal loss heavily down-weights them"}],starterCode:`import numpy as np

def focal_loss(predictions, targets, alpha=0.25, gamma=2.0):
    """
    Compute focal loss for binary classification.

    Args:
        predictions: Predicted probabilities (array of floats in [0, 1])
        targets: Ground truth labels (array of 0s and 1s)
        alpha: Balancing factor (default: 0.25)
        gamma: Focusing parameter (default: 2.0)

    Returns:
        Mean focal loss, rounded to 4 decimal places
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Confident correct predictions",input:"([0.9, 0.1], [1, 0], 0.25, 2.0)",expected:"0.0005",hidden:!1},{id:"2",description:"Uncertain predictions",input:"([0.6, 0.4], [1, 0], 0.25, 2.0)",expected:"0.0409",hidden:!1},{id:"3",description:"Gamma=0 (standard cross-entropy with alpha)",input:"([0.9, 0.1], [1, 0], 0.25, 0.0)",expected:"0.0527",hidden:!0}],hints:["First compute p_t: if target=1 then p_t=p, else p_t=1-p","Apply alpha_t: if target=1 then alpha_t=alpha, else alpha_t=1-alpha","Clip predictions to avoid log(0), e.g., np.clip(p, 1e-7, 1-1e-7)","FL = -alpha_t * (1 - p_t)^gamma * log(p_t), then take the mean"],solution:`import numpy as np

def focal_loss(predictions, targets, alpha=0.25, gamma=2.0):
    p = np.array(predictions, dtype=float)
    t = np.array(targets, dtype=float)

    p = np.clip(p, 1e-7, 1 - 1e-7)

    p_t = np.where(t == 1, p, 1 - p)
    alpha_t = np.where(t == 1, alpha, 1 - alpha)

    loss = -alpha_t * (1 - p_t) ** gamma * np.log(p_t)

    return round(float(np.mean(loss)), 4)
`},{id:"smooth-l1-loss",title:"Smooth L1 Loss",section:"cnn",difficulty:"easy",description:`
## Smooth L1 Loss (Huber Loss)

Implement Smooth L1 Loss, the standard loss for bounding box regression in object detection.

### Motivation
- **L2 loss** (MSE): Sensitive to outliers  large errors produce huge gradients
- **L1 loss** (MAE): Not differentiable at zero
- **Smooth L1**: Combines the best of both  quadratic for small errors, linear for large errors

### Formula
\`\`\`
          0.5 * x / beta    if |x| < beta
L(x) =  
          |x| - 0.5 * beta   if |x| >= beta
\`\`\`

Where \`x = prediction - target\` and \`beta\` controls the transition point (default: 1.0).

### Properties
- Differentiable everywhere (unlike L1)
- Less sensitive to outliers than L2
- At \`beta=1\`: transitions from quadratic to linear at \`|x|=1\`
- Used in Faster R-CNN, SSD, and most modern detectors

### Function Signature
\`\`\`python
def smooth_l1_loss(predictions, targets, beta=1.0):
    # predictions: predicted values (array)
    # targets: target values (array)
    # Returns: mean smooth L1 loss (float, rounded to 4 decimal places)
\`\`\`
    `,examples:[{input:"predictions=[0.5, 1.5], targets=[0.0, 0.0], beta=1.0",output:"0.5625",explanation:"|0.5|<1  0.5*0.25/1=0.125; |1.5|>=1  1.5-0.5=1.0; mean=(0.125+1.0)/2=0.5625"}],starterCode:`import numpy as np

def smooth_l1_loss(predictions, targets, beta=1.0):
    """
    Compute Smooth L1 (Huber) Loss.

    Args:
        predictions: Predicted values (array)
        targets: Target values (array)
        beta: Threshold for quadratic-to-linear transition (default: 1.0)

    Returns:
        Mean smooth L1 loss, rounded to 4 decimal places
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Small errors (quadratic region)",input:"([0.2, -0.3], [0.0, 0.0], 1.0)",expected:"0.0325",hidden:!1},{id:"2",description:"Large errors (linear region)",input:"([3.0, -2.0], [0.0, 0.0], 1.0)",expected:"2.0",hidden:!1},{id:"3",description:"Mixed small and large errors",input:"([0.5, 1.5, -2.0], [0.0, 0.0, 0.0], 1.0)",expected:"0.875",hidden:!0}],hints:["Compute the element-wise difference: x = predictions - targets","Use np.where to apply different formulas based on |x| < beta","Small errors: 0.5 * x^2 / beta; Large errors: |x| - 0.5 * beta"],solution:`import numpy as np

def smooth_l1_loss(predictions, targets, beta=1.0):
    p = np.array(predictions, dtype=float)
    t = np.array(targets, dtype=float)

    x = p - t
    abs_x = np.abs(x)

    loss = np.where(abs_x < beta, 0.5 * x ** 2 / beta, abs_x - 0.5 * beta)

    return round(float(np.mean(loss)), 4)
`},{id:"seg-metrics",title:"Segmentation Metrics",section:"cnn",difficulty:"medium",description:`
## Segmentation Metrics

Implement three key metrics for evaluating binary image segmentation: **IoU**, **Pixel Accuracy**, and **Dice Coefficient**.

### Metrics

#### 1. IoU (Intersection over Union / Jaccard Index)
\`\`\`
IoU = |Prediction  Target| / |Prediction  Target|
\`\`\`

#### 2. Pixel Accuracy
\`\`\`
Pixel Accuracy = Number of correct pixels / Total pixels
\`\`\`

#### 3. Dice Coefficient (F1 Score for pixels)
\`\`\`
Dice = 2 * |Prediction  Target| / (|Prediction| + |Target|)
\`\`\`

### Relationship Between IoU and Dice
\`\`\`
Dice = 2 * IoU / (1 + IoU)
\`\`\`

### Expected Return Format
Return a dictionary with these keys:
- \`'iou'\`: Intersection over Union (float, rounded to 4 dp)
- \`'pixel_accuracy'\`: Pixel accuracy (float, rounded to 4 dp)
- \`'dice'\`: Dice coefficient (float, rounded to 4 dp)

### Function Signature
\`\`\`python
def segmentation_metrics(prediction, target):
    # prediction: binary mask (2D array of 0s and 1s)
    # target: binary ground truth mask (2D array of 0s and 1s)
    # Returns: dict with 'iou', 'pixel_accuracy', 'dice'
\`\`\`
    `,examples:[{input:"prediction=[[1,1],[0,0]], target=[[1,0],[0,1]]",output:'{"iou": 0.3333, "pixel_accuracy": 0.5, "dice": 0.5}',explanation:"Intersection=1, Union=3, IoU=1/3; 2 correct out of 4 pixels; Dice=2*1/(2+2)=0.5"}],starterCode:`import numpy as np

def segmentation_metrics(prediction, target):
    """
    Compute segmentation evaluation metrics.

    Args:
        prediction: Binary predicted mask (2D array of 0s and 1s)
        target: Binary ground truth mask (2D array of 0s and 1s)

    Returns:
        Dictionary with 'iou', 'pixel_accuracy', 'dice' (all rounded to 4 dp)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Partial overlap",input:"segmentation_metrics(np.array([[1,1],[0,0]]), np.array([[1,0],[0,1]]))",expected:'{"iou": 0.3333, "pixel_accuracy": 0.5, "dice": 0.5}',hidden:!1},{id:"2",description:"Perfect match",input:"segmentation_metrics(np.array([[1,0],[0,1]]), np.array([[1,0],[0,1]]))",expected:'{"iou": 1.0, "pixel_accuracy": 1.0, "dice": 1.0}',hidden:!1},{id:"3",description:"Dice coefficient check",input:"segmentation_metrics(np.array([[1,1,0],[0,0,0]]), np.array([[0,1,1],[0,0,0]]))['dice']",expected:"0.5",hidden:!0}],hints:["Intersection: np.sum(prediction * target) (both are binary, so multiplication gives AND)","Union: np.sum(prediction) + np.sum(target) - intersection (or use np.sum((prediction + target) > 0))","Pixel accuracy: np.sum(prediction == target) / total_pixels"],solution:`import numpy as np

def segmentation_metrics(prediction, target):
    pred = np.array(prediction, dtype=float)
    targ = np.array(target, dtype=float)

    intersection = np.sum(pred * targ)
    union = np.sum(pred) + np.sum(targ) - intersection

    iou_val = intersection / union if union > 0 else 0.0
    pixel_acc = np.sum(pred == targ) / pred.size
    dice = 2 * intersection / (np.sum(pred) + np.sum(targ)) if (np.sum(pred) + np.sum(targ)) > 0 else 0.0

    return {
        'iou': round(float(iou_val), 4),
        'pixel_accuracy': round(float(pixel_acc), 4),
        'dice': round(float(dice), 4)
    }
`}],R6=[{id:"scaled-dot-product-attention",title:"Scaled Dot-Product Attention",section:"transformers",difficulty:"medium",description:`
## Scaled Dot-Product Attention

Implement the core attention mechanism from "Attention Is All You Need".

### Formula
\`\`\`
Attention(Q, K, V) = softmax(Q @ K.T / sqrt(d_k)) @ V
\`\`\`

Where:
- Q: Queries (seq_len, d_k)
- K: Keys (seq_len, d_k)
- V: Values (seq_len, d_v)
- d_k: Dimension of keys

### Steps
1. Compute attention scores: Q @ K.T
2. Scale by sqrt(d_k)
3. Apply softmax
4. Multiply by V
    `,examples:[{input:"Q, K, V all (4, 8) - 4 tokens, 8 dims",output:"output (4, 8)",explanation:"Each token attends to all tokens"}],starterCode:`import numpy as np

def scaled_dot_product_attention(Q, K, V):
    """
    Compute scaled dot-product attention.

    Args:
        Q: Queries (seq_len, d_k)
        K: Keys (seq_len, d_k)
        V: Values (seq_len, d_v)

    Returns:
        output: Attention output (seq_len, d_v)
        attention_weights: Attention weights (seq_len, seq_len)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape correct",input:"scaled_dot_product_attention(np.random.randn(4, 8), np.random.randn(4, 8), np.random.randn(4, 8))[0].shape",expected:"(4, 8)",hidden:!1},{id:"2",description:"Attention weights sum to 1",input:"bool(np.allclose(scaled_dot_product_attention(np.ones((4, 8)), np.ones((4, 8)), np.ones((4, 8)))[1].sum(axis=-1), 1.0))",expected:"True",hidden:!1}],hints:["Compute scores = Q @ K.T","Scale by sqrt(d_k) where d_k = Q.shape[-1]","Apply softmax along the last axis","Return softmax(scores) @ V"],solution:`import numpy as np

def softmax(x, axis=-1):
    exp_x = np.exp(x - np.max(x, axis=axis, keepdims=True))
    return exp_x / np.sum(exp_x, axis=axis, keepdims=True)

def scaled_dot_product_attention(Q, K, V):
    d_k = Q.shape[-1]

    # Compute attention scores
    scores = Q @ K.T / np.sqrt(d_k)

    # Apply softmax
    attention_weights = softmax(scores)

    # Compute output
    output = attention_weights @ V

    return output, attention_weights
`},{id:"multi-head-attention",title:"Multi-Head Attention",section:"transformers",difficulty:"hard",description:`
## Multi-Head Attention

Implement multi-head attention from the Transformer architecture.

### Concept
\`\`\`
MultiHead(Q, K, V) = Concat(head_1, ..., head_h) @ W_O

where head_i = Attention(Q @ W_Q_i, K @ W_K_i, V @ W_V_i)
\`\`\`

### Steps
1. Project Q, K, V with different learned projections for each head
2. Apply scaled dot-product attention in parallel
3. Concatenate heads
4. Project back to original dimension
    `,examples:[{input:"X (4, 64), num_heads=8, d_model=64",output:"output (4, 64)",explanation:"8 heads with d_k=8 each, concatenated to 64"}],starterCode:`import numpy as np

def multi_head_attention(Q, K, V, num_heads):
    """
    Multi-head attention mechanism.

    Args:
        Q: Queries (seq_len, d_model)
        K: Keys (seq_len, d_model)
        V: Values (seq_len, d_model)
        num_heads: Number of attention heads

    Returns:
        output: Multi-head attention output (seq_len, d_model)
    """
    seq_len, d_model = Q.shape
    assert d_model % num_heads == 0
    d_k = d_model // num_heads

    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape preserved",input:"multi_head_attention(np.random.randn(4, 64), np.random.randn(4, 64), np.random.randn(4, 64), 8).shape",expected:"(4, 64)",hidden:!1}],hints:["Reshape Q, K, V to (seq_len, num_heads, d_k)","Apply attention for each head","Reshape back to (seq_len, d_model)"],solution:`import numpy as np

def softmax(x, axis=-1):
    exp_x = np.exp(x - np.max(x, axis=axis, keepdims=True))
    return exp_x / np.sum(exp_x, axis=axis, keepdims=True)

def multi_head_attention(Q, K, V, num_heads):
    seq_len, d_model = Q.shape
    d_k = d_model // num_heads

    # Reshape to (seq_len, num_heads, d_k)
    Q = Q.reshape(seq_len, num_heads, d_k)
    K = K.reshape(seq_len, num_heads, d_k)
    V = V.reshape(seq_len, num_heads, d_k)

    # Transpose to (num_heads, seq_len, d_k)
    Q = Q.transpose(1, 0, 2)
    K = K.transpose(1, 0, 2)
    V = V.transpose(1, 0, 2)

    # Scaled dot-product attention for each head
    scores = Q @ K.transpose(0, 2, 1) / np.sqrt(d_k)
    attention = softmax(scores)
    heads = attention @ V

    # Transpose and reshape back
    heads = heads.transpose(1, 0, 2)  # (seq_len, num_heads, d_k)
    output = heads.reshape(seq_len, d_model)

    return output
`},{id:"positional-encoding",title:"Sinusoidal Positional Encoding",section:"transformers",difficulty:"medium",description:`
## Sinusoidal Positional Encoding

Implement the positional encoding from the original Transformer paper.

### Formulas
\`\`\`
PE(pos, 2i) = sin(pos / 10000^(2i/d_model))
PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))
\`\`\`

Where:
- pos: Position in sequence
- i: Dimension index
- d_model: Model dimension

### Purpose
- Injects position information into embeddings
- Allows model to learn relative positions
- Fixed (not learned) encodings
    `,examples:[{input:"max_len=100, d_model=512",output:"PE matrix (100, 512)",explanation:"Position encoding for 100 positions"}],starterCode:`import numpy as np

def positional_encoding(max_len, d_model):
    """
    Generate sinusoidal positional encodings.

    Args:
        max_len: Maximum sequence length
        d_model: Model dimension

    Returns:
        PE: Positional encoding matrix (max_len, d_model)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Correct shape",input:"positional_encoding(50, 64).shape",expected:"(50, 64)",hidden:!1},{id:"2",description:"First position starts with sin(0)=0",input:"bool(np.isclose(positional_encoding(10, 4)[0, 0], 0.0))",expected:"True",hidden:!0}],hints:["Create position indices: np.arange(max_len)","Create dimension indices for the divisor","Use div_term = 10000^(2i/d_model)","Apply sin to even indices, cos to odd indices"],solution:`import numpy as np

def positional_encoding(max_len, d_model):
    PE = np.zeros((max_len, d_model))

    position = np.arange(max_len)[:, np.newaxis]
    div_term = np.exp(np.arange(0, d_model, 2) * (-np.log(10000.0) / d_model))

    PE[:, 0::2] = np.sin(position * div_term)
    PE[:, 1::2] = np.cos(position * div_term)

    return PE
`},{id:"layer-norm",title:"Layer Normalization",section:"transformers",difficulty:"easy",description:`
## Layer Normalization

Implement layer normalization, used in Transformers instead of batch normalization.

### Formula
\`\`\`
LayerNorm(x) =  * (x - ) / sqrt( + ) + 
\`\`\`

### Difference from BatchNorm
- **BatchNorm**: Normalizes across batch dimension
- **LayerNorm**: Normalizes across feature dimension
- LayerNorm works better for sequence models
    `,examples:[{input:"X (batch, seq_len, features)",output:"Normalized X, each position normalized independently",explanation:"Normalize across last dimension"}],starterCode:`import numpy as np

def layer_norm(X, gamma, beta, eps=1e-5):
    """
    Apply layer normalization.

    Args:
        X: Input (batch, seq_len, features) or (seq_len, features)
        gamma: Scale parameter (features,)
        beta: Shift parameter (features,)
        eps: Small constant

    Returns:
        output: Normalized tensor
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output mean near zero",input:"bool(np.allclose(layer_norm(np.array([[1.0, 2.0, 3.0, 4.0], [5.0, 6.0, 7.0, 8.0]]), np.ones(4), np.zeros(4)).mean(axis=-1), 0.0, atol=1e-5))",expected:"True",hidden:!1},{id:"2",description:"Gamma and beta work",input:"bool(np.allclose(layer_norm(np.array([[0.0, 0.0, 2.0, 2.0]]), np.array([1.0, 2.0, 1.0, 2.0]), np.zeros(4)), np.array([[-1.0, -2.0, 1.0, 2.0]])))",expected:"True",hidden:!0}],hints:["Compute mean and variance along the last axis","Use keepdims=True for proper broadcasting","Apply normalization: (x - mean) / sqrt(var + eps)"],solution:`import numpy as np

def layer_norm(X, gamma, beta, eps=1e-5):
    # Compute statistics along last dimension
    mean = np.mean(X, axis=-1, keepdims=True)
    var = np.var(X, axis=-1, keepdims=True)

    # Normalize
    X_norm = (X - mean) / np.sqrt(var + eps)

    # Scale and shift
    return gamma * X_norm + beta
`},{id:"causal-mask",title:"Causal Attention Mask",section:"transformers",difficulty:"easy",description:`
## Causal (Autoregressive) Mask

Create a causal mask for decoder self-attention to prevent attending to future tokens.

### Mask Structure
\`\`\`
[[0, -inf, -inf, -inf],
 [0,    0, -inf, -inf],
 [0,    0,    0, -inf],
 [0,    0,    0,    0]]
\`\`\`

### Usage
- Add mask to attention scores before softmax
- -inf becomes 0 after softmax
- Ensures each position only attends to previous positions
    `,examples:[{input:"seq_len=4",output:"Lower triangular mask (4, 4)",explanation:"Position i can only attend to positions <= i"}],starterCode:`import numpy as np

def create_causal_mask(seq_len):
    """
    Create a causal attention mask.

    Args:
        seq_len: Sequence length

    Returns:
        mask: Causal mask (seq_len, seq_len)
               0 for allowed positions, -inf for masked
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Correct shape and pattern",input:"create_causal_mask(4).shape",expected:"(4, 4)",hidden:!1},{id:"2",description:"Lower triangular zeros, upper triangular -inf",input:'bool(np.allclose(create_causal_mask(3), np.array([[0.0, float("-inf"), float("-inf")], [0.0, 0.0, float("-inf")], [0.0, 0.0, 0.0]])))',expected:"True",hidden:!0}],hints:["Create a matrix of ones using np.ones((seq_len, seq_len))","Use np.triu to get upper triangular matrix (excluding diagonal)","Replace 1s with -inf"],solution:`import numpy as np

def create_causal_mask(seq_len):
    # Create upper triangular matrix (above diagonal)
    mask = np.triu(np.ones((seq_len, seq_len)), k=1)
    # Replace 1s with -inf
    mask = np.where(mask == 1, float('-inf'), 0.0)
    return mask
`},{id:"bpe-tokenization",title:"BPE Tokenization",section:"transformers",difficulty:"medium",description:`
## Byte-Pair Encoding (BPE) Tokenization

Implement the training step of BPE, the tokenization algorithm used by GPT, LLaMA, and most modern LLMs.

### Algorithm
1. Start with words split into individual character tokens
2. Count frequency of all adjacent token pairs across the corpus
3. Merge the most frequent pair into a new token
4. Repeat for \`num_merges\` iterations

### Input Format
- \`word_freqs\`: Dict mapping space-separated token sequences to frequency
  - e.g., \`{"h u g </w>": 10, "p u g </w>": 5}\`
  - \`</w>\` marks end-of-word

### Return Format
Return a list of merge pair tuples, in the order they were applied.

### Why BPE?
- Handles any input text (no unknown tokens)
- Balances character-level and word-level tokenization
- Common subwords become single tokens, rare words split into subwords
    `,examples:[{input:'word_freqs = {"h u g </w>": 10, "p u g </w>": 5, "b u g </w>": 2}, num_merges=3',output:"[('u', 'g'), ('ug', '</w>'), ('h', 'ug</w>')]",explanation:'"ug" is the most frequent pair (freq 17), merged first'}],starterCode:`import numpy as np
from collections import Counter

def bpe_train(word_freqs, num_merges):
    """
    Train BPE tokenizer by learning merge rules.

    Args:
        word_freqs: Dict mapping space-separated token sequences to frequency
                    e.g., {"h u g </w>": 10, "p u g </w>": 5}
        num_merges: Number of merge operations to perform

    Returns:
        merges: List of (token_a, token_b) tuples merged, in order
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"First merge is most frequent pair",input:'bpe_train({"h u g </w>": 10, "p u g </w>": 5, "b u g </w>": 2}, 3)[0]',expected:"('u', 'g')",hidden:!1},{id:"2",description:"Correct number of merges returned",input:'len(bpe_train({"h u g </w>": 10, "p u g </w>": 5, "b u g </w>": 2}, 3))',expected:"3",hidden:!1},{id:"3",description:"Second merge builds on first",input:'bpe_train({"h u g </w>": 10, "p u g </w>": 5, "b u g </w>": 2}, 3)[1]',expected:"('ug', '</w>')",hidden:!0},{id:"4",description:"Works with different corpus",input:'bpe_train({"a b c </w>": 10, "a b </w>": 7, "b c </w>": 3}, 2)[0]',expected:"('a', 'b')",hidden:!0}],hints:["Split each word into tokens using word.split()","Count pair frequencies by iterating adjacent tokens, weighted by word frequency","Find the most frequent pair with max(pair_freqs, key=pair_freqs.get)","Merge the pair: scan tokens left-to-right, joining matching adjacent pairs"],solution:`import numpy as np
from collections import Counter

def bpe_train(word_freqs, num_merges):
    # Split each word into tokens
    splits = {word: word.split() for word in word_freqs}
    merges = []

    for _ in range(num_merges):
        # Count pair frequencies
        pair_freqs = Counter()
        for word, freq in word_freqs.items():
            tokens = splits[word]
            for i in range(len(tokens) - 1):
                pair_freqs[(tokens[i], tokens[i + 1])] += freq

        if not pair_freqs:
            break

        # Find and record most frequent pair
        best_pair = max(pair_freqs, key=pair_freqs.get)
        merges.append(best_pair)

        # Merge the pair in all words
        for word in splits:
            tokens = splits[word]
            new_tokens = []
            i = 0
            while i < len(tokens):
                if i < len(tokens) - 1 and (tokens[i], tokens[i + 1]) == best_pair:
                    new_tokens.append(tokens[i] + tokens[i + 1])
                    i += 2
                else:
                    new_tokens.append(tokens[i])
                    i += 1
            splits[word] = new_tokens

    return merges
`},{id:"rope-embeddings",title:"Rotary Positional Embeddings (RoPE)",section:"transformers",difficulty:"medium",description:`
## Rotary Positional Embeddings (RoPE)

Implement RoPE, the positional encoding used by LLaMA, Mistral, GPT-NeoX, and most modern LLMs.

### How It Works
Instead of *adding* position information to embeddings (like sinusoidal encoding), RoPE *rotates* pairs of dimensions in Q and K by position-dependent angles.

### Formulas
For position \`pos\` and dimension pair \`(2i, 2i+1)\`:
\`\`\`
_i = 1 / (10000^(2i / d_model))

q_rot[2i]   = q[2i]  cos(pos  _i) - q[2i+1]  sin(pos  _i)
q_rot[2i+1] = q[2i]  sin(pos  _i) + q[2i+1]  cos(pos  _i)
\`\`\`

Apply the same rotation to both Q and K.

### Key Properties
- **Relative position awareness**: The dot product between rotated Q and K depends only on the relative position difference
- **Norm preservation**: Rotation does not change vector magnitudes
- **No learned parameters**: Computed directly from position indices

### Why RoPE Over Sinusoidal?
- Encodes *relative* positions naturally (sinusoidal is absolute)
- Better extrapolation to longer sequences
- Applied directly in attention computation (not added to embeddings)
    `,examples:[{input:"Q, K both (4, 8) - 4 tokens, 8 dims",output:"Q_rot (4, 8), K_rot (4, 8)",explanation:"Each pair of dimensions is rotated by a position-dependent angle"}],starterCode:`import numpy as np

def apply_rope(Q, K):
    """
    Apply Rotary Positional Embeddings to Q and K.

    Args:
        Q: Queries (seq_len, d_model) where d_model is even
        K: Keys (seq_len, d_model)

    Returns:
        Q_rot: Rotated queries (seq_len, d_model)
        K_rot: Rotated keys (seq_len, d_model)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape preserved",input:"apply_rope(np.ones((4, 8)), np.ones((4, 8)))[0].shape",expected:"(4, 8)",hidden:!1},{id:"2",description:"Position 0 is unchanged (rotation angle is 0)",input:"bool(np.allclose(apply_rope(np.array([[1.0, 2.0, 3.0, 4.0]]), np.ones((1, 4)))[0], np.array([[1.0, 2.0, 3.0, 4.0]])))",expected:"True",hidden:!1},{id:"3",description:"Rotation preserves vector norms",input:"(lambda: [np.random.seed(42), (Q := np.random.randn(6, 8)), (Q_rot := apply_rope(Q, Q)[0]), bool(np.allclose(np.linalg.norm(Q_rot, axis=-1), np.linalg.norm(Q, axis=-1)))][-1])()",expected:"True",hidden:!0}],hints:["Compute _i = 1.0 / (10000^(2i/d)) for dimension indices i = 0, 1, ..., d/2-1","Multiply positions (0 to seq_len-1) by  to get angles matrix (seq_len, d/2)","Even dims: q_even * cos(angles) - q_odd * sin(angles)","Odd dims: q_even * sin(angles) + q_odd * cos(angles)"],solution:`import numpy as np

def apply_rope(Q, K):
    seq_len, d = Q.shape

    # Compute rotation angles
    positions = np.arange(seq_len)[:, np.newaxis]  # (seq_len, 1)
    dims = np.arange(0, d, 2)  # (d/2,)
    theta = 1.0 / (10000.0 ** (dims / d))  # (d/2,)
    angles = positions * theta  # (seq_len, d/2)

    cos_a = np.cos(angles)
    sin_a = np.sin(angles)

    # Rotate Q
    Q_rot = np.zeros_like(Q)
    Q_rot[:, 0::2] = Q[:, 0::2] * cos_a - Q[:, 1::2] * sin_a
    Q_rot[:, 1::2] = Q[:, 0::2] * sin_a + Q[:, 1::2] * cos_a

    # Rotate K
    K_rot = np.zeros_like(K)
    K_rot[:, 0::2] = K[:, 0::2] * cos_a - K[:, 1::2] * sin_a
    K_rot[:, 1::2] = K[:, 0::2] * sin_a + K[:, 1::2] * cos_a

    return Q_rot, K_rot
`},{id:"grouped-query-attention",title:"Grouped Query Attention (GQA)",section:"transformers",difficulty:"medium",description:`
## Grouped Query Attention (GQA)

Implement GQA, the efficient attention variant used in LLaMA 2, Mistral, Gemma, and most modern LLMs.

### Concept
In standard Multi-Head Attention (MHA), each head has its own Q, K, and V projections. GQA reduces memory by sharing KV heads across groups of query heads:

| Variant | Q Heads | KV Heads | Used In |
|---------|---------|----------|---------|
| MHA | H | H | Original Transformer |
| GQA | H | G (1 < G < H) | LLaMA 2, Mistral |
| MQA | H | 1 | PaLM, Falcon |

### Steps
1. Reshape Q into \`num_q_heads\` heads of size \`d_head\`
2. Reshape K, V into \`num_kv_heads\` heads of size \`d_head\`
3. Repeat each KV head \`group_size\` times (group_size = num_q_heads / num_kv_heads)
4. Apply scaled dot-product attention per head
5. Concatenate all heads

### Why GQA?
- Reduces KV cache size by \`num_q_heads / num_kv_heads\` factor
- Faster inference with minimal quality loss vs MHA
- Key optimization for serving large language models
    `,examples:[{input:"Q (4, 64), K (4, 16), V (4, 16), num_q_heads=8, num_kv_heads=2",output:"output (4, 64)",explanation:"8 query heads grouped into 2 KV groups of 4, d_head=8"}],starterCode:`import numpy as np

def grouped_query_attention(Q, K, V, num_q_heads, num_kv_heads):
    """
    Grouped Query Attention.

    Args:
        Q: Queries (seq_len, num_q_heads * d_head)
        K: Keys (seq_len, num_kv_heads * d_head)
        V: Values (seq_len, num_kv_heads * d_head)
        num_q_heads: Number of query heads
        num_kv_heads: Number of key/value heads (divides num_q_heads)

    Returns:
        output: (seq_len, num_q_heads * d_head)
    """
    seq_len = Q.shape[0]
    d_head = Q.shape[1] // num_q_heads
    group_size = num_q_heads // num_kv_heads

    # Your code here
    pass
`,testCases:[{id:"1",description:"GQA output shape (8 Q heads, 2 KV heads)",input:"grouped_query_attention(np.random.randn(4, 64), np.random.randn(4, 16), np.random.randn(4, 16), 8, 2).shape",expected:"(4, 64)",hidden:!1},{id:"2",description:"MQA case (1 KV head shared by all Q heads)",input:"grouped_query_attention(np.random.randn(4, 32), np.random.randn(4, 4), np.random.randn(4, 4), 8, 1).shape",expected:"(4, 32)",hidden:!1},{id:"3",description:"MHA case (num_q_heads == num_kv_heads)",input:"grouped_query_attention(np.random.randn(4, 64), np.random.randn(4, 64), np.random.randn(4, 64), 8, 8).shape",expected:"(4, 64)",hidden:!0}],hints:["Reshape Q to (num_q_heads, seq_len, d_head) using reshape then transpose","Reshape K, V to (num_kv_heads, seq_len, d_head) the same way","Use np.repeat(K, group_size, axis=0) to expand KV heads to match Q heads","Apply attention: softmax(Q @ K^T / sqrt(d_head)) @ V for each head","Transpose and reshape back to (seq_len, num_q_heads * d_head)"],solution:`import numpy as np

def softmax(x, axis=-1):
    exp_x = np.exp(x - np.max(x, axis=axis, keepdims=True))
    return exp_x / np.sum(exp_x, axis=axis, keepdims=True)

def grouped_query_attention(Q, K, V, num_q_heads, num_kv_heads):
    seq_len = Q.shape[0]
    d_head = Q.shape[1] // num_q_heads
    group_size = num_q_heads // num_kv_heads

    # Reshape to per-head format: (num_heads, seq_len, d_head)
    Q = Q.reshape(seq_len, num_q_heads, d_head).transpose(1, 0, 2)
    K = K.reshape(seq_len, num_kv_heads, d_head).transpose(1, 0, 2)
    V = V.reshape(seq_len, num_kv_heads, d_head).transpose(1, 0, 2)

    # Repeat KV heads to match Q heads
    K = np.repeat(K, group_size, axis=0)
    V = np.repeat(V, group_size, axis=0)

    # Scaled dot-product attention per head
    scores = Q @ K.transpose(0, 2, 1) / np.sqrt(d_head)
    attention = softmax(scores, axis=-1)
    heads = attention @ V

    # Concatenate heads
    output = heads.transpose(1, 0, 2).reshape(seq_len, -1)
    return output
`},{id:"sliding-window-attention",title:"Sliding Window Attention",section:"transformers",difficulty:"easy",description:`
## Sliding Window Attention

Create a sliding window causal attention mask, used in Mistral, Gemma, and other efficient LLMs.

### Concept
Standard causal attention lets each token attend to *all* previous tokens. With long sequences this is expensive (O(n) memory). Sliding window attention restricts each token to only attend to the \`window_size\` nearest previous tokens.

### Mask Structure (seq_len=5, window_size=3)
\`\`\`
[[  0, -inf, -inf, -inf, -inf],
 [  0,    0, -inf, -inf, -inf],
 [  0,    0,    0, -inf, -inf],
 [-inf,   0,    0,    0, -inf],
 [-inf, -inf,  0,    0,    0]]
\`\`\`

### Rules
- Position \`i\` can attend to position \`j\` if:
  - \`j <= i\` (causal: no future tokens)
  - \`i - j < window_size\` (within the window)
- Allowed positions get \`0\`, masked positions get \`-inf\`

### Why Sliding Window?
- Reduces memory from O(n) to O(n  window_size)
- Information still propagates across layers (layer L sees L  window_size tokens)
- Combined with full attention layers in some architectures
    `,examples:[{input:"seq_len=4, window_size=2",output:"(4, 4) mask where each token sees at most 2 previous tokens",explanation:"Position 3 attends to positions 2 and 3 only"}],starterCode:`import numpy as np

def sliding_window_mask(seq_len, window_size):
    """
    Create a sliding window causal attention mask.

    Args:
        seq_len: Sequence length
        window_size: Number of tokens each position can attend to
                     (including itself)

    Returns:
        mask: (seq_len, seq_len) with 0 for allowed, -inf for masked
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Correct shape",input:"sliding_window_mask(6, 3).shape",expected:"(6, 6)",hidden:!1},{id:"2",description:"Out-of-window position is masked",input:'bool(sliding_window_mask(4, 2)[2, 0] == float("-inf"))',expected:"True",hidden:!1},{id:"3",description:"In-window position is allowed",input:"bool(sliding_window_mask(4, 2)[2, 1] == 0.0)",expected:"True",hidden:!0},{id:"4",description:"Large window equals causal mask",input:'bool(np.array_equal(sliding_window_mask(4, 10), np.where(np.triu(np.ones((4, 4)), k=1) == 1, float("-inf"), 0.0)))',expected:"True",hidden:!0}],hints:["Create row and column index grids using np.arange","Allowed condition: (col <= row) AND (row - col < window_size)",'Use np.where(allowed, 0.0, float("-inf")) to build the mask'],solution:`import numpy as np

def sliding_window_mask(seq_len, window_size):
    rows = np.arange(seq_len)[:, None]
    cols = np.arange(seq_len)[None, :]

    # Causal: can only attend to current or past positions
    # Window: distance must be less than window_size
    allowed = (cols <= rows) & (rows - cols < window_size)

    return np.where(allowed, 0.0, float('-inf'))
`}],N6=[{id:"vae-reparameterization",title:"VAE Reparameterization Trick",section:"generative-models",difficulty:"medium",description:`
## VAE Reparameterization Trick

Implement the reparameterization trick that allows backpropagation through stochastic sampling in VAEs.

### The Problem
We want to sample z ~ N(, ), but sampling is not differentiable.

### The Solution
\`\`\`
 ~ N(0, 1)
z =  +  * 
\`\`\`

### Why It Works
-  is sampled independently of parameters
- z is now a deterministic function of , , and 
- Gradients can flow through  and 
    `,examples:[{input:"mu = [0, 1], log_var = [0, 0]",output:"z = mu + exp(0.5 * log_var) * epsilon",explanation:"log_var=0 means =1"}],starterCode:`import numpy as np

def reparameterize(mu, log_var):
    """
    Sample from latent distribution using reparameterization trick.

    Args:
        mu: Mean of latent distribution (batch, latent_dim)
        log_var: Log variance of latent distribution (batch, latent_dim)

    Returns:
        z: Sampled latent vectors (batch, latent_dim)
    """
    np.random.seed(42)  # For reproducibility
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape matches input",input:"reparameterize(np.zeros((2, 4)), np.zeros((2, 4))).shape",expected:"(2, 4)",hidden:!1},{id:"2",description:"Zero variance case has correct shape",input:"reparameterize(np.ones((3, 5)), np.full((3, 5), -1000)).shape",expected:"(3, 5)",hidden:!0}],hints:["std = exp(0.5 * log_var)","Sample epsilon from standard normal","z = mu + std * epsilon"],solution:`import numpy as np

def reparameterize(mu, log_var):
    np.random.seed(42)
    # Compute standard deviation
    std = np.exp(0.5 * log_var)
    # Sample epsilon from standard normal
    eps = np.random.randn(*mu.shape)
    # Reparameterization trick
    z = mu + std * eps
    return z
`},{id:"vae-loss",title:"VAE Loss Function",section:"generative-models",difficulty:"medium",description:`
## VAE Loss (ELBO)

Implement the VAE loss function: reconstruction loss + KL divergence.

### Loss Components
\`\`\`
L = L_reconstruction + L_KL

L_reconstruction = MSE(x, x_reconstructed)
L_KL = -0.5 * sum(1 + log_var - mu - exp(log_var))
\`\`\`

### Intuition
- **Reconstruction loss**: Output should match input
- **KL divergence**: Latent distribution should be close to N(0,1)
    `,examples:[{input:"Perfect reconstruction, mu=0, var=1",output:"Loss  0",explanation:"Both terms are minimized"}],starterCode:`import numpy as np

def vae_loss(x, x_reconstructed, mu, log_var):
    """
    Compute VAE loss (negative ELBO).

    Args:
        x: Original input (batch, features)
        x_reconstructed: Reconstructed input (batch, features)
        mu: Latent mean (batch, latent_dim)
        log_var: Latent log variance (batch, latent_dim)

    Returns:
        total_loss: Combined loss
        recon_loss: Reconstruction loss
        kl_loss: KL divergence
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Perfect case",input:"(np.zeros((2, 4)), np.zeros((2, 4)), np.zeros((2, 2)), np.zeros((2, 2)))",expected:"(0.0, 0.0, 0.0)",hidden:!1},{id:"2",description:"Non-zero KL",input:"(np.zeros((1, 4)), np.zeros((1, 4)), np.ones((1, 2)), np.zeros((1, 2)))",expected:"(0.3161, 0.0, 0.3161)",hidden:!0}],hints:["Reconstruction: np.mean((x - x_reconstructed))","KL: -0.5 * sum(1 + log_var - mu - exp(log_var))","Average over batch"],solution:`import numpy as np

def vae_loss(x, x_reconstructed, mu, log_var):
    # Reconstruction loss (MSE)
    recon_loss = np.mean((x - x_reconstructed) ** 2)

    # KL divergence
    kl_loss = -0.5 * np.mean(1 + log_var - mu**2 - np.exp(log_var))

    total_loss = recon_loss + kl_loss

    return round(total_loss, 4), round(recon_loss, 4), round(kl_loss, 4)
`},{id:"diffusion-noise-schedule",title:"Diffusion Noise Schedule",section:"generative-models",difficulty:"easy",description:`
## Diffusion Noise Schedule

Implement a linear noise schedule for diffusion models.

### Linear Schedule
\`\`\`
_t = _start + t * (_end - _start) / T

where t = 0, 1, ..., T-1
\`\`\`

### Derived Quantities
\`\`\`
_t = 1 - _t
_t = prod(_1, ..., _t)  # cumulative product
\`\`\`

These control how much noise is added at each step.
    `,examples:[{input:"T=1000, beta_start=0.0001, beta_end=0.02",output:"betas, alphas, alpha_bars arrays",explanation:"Standard DDPM schedule"}],starterCode:`import numpy as np

def linear_noise_schedule(T, beta_start=0.0001, beta_end=0.02):
    """
    Create linear noise schedule for diffusion.

    Args:
        T: Number of diffusion steps
        beta_start: Starting beta value
        beta_end: Ending beta value

    Returns:
        betas: Beta values (T,)
        alphas: Alpha values (T,)
        alpha_bars: Cumulative alpha product (T,)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Beta range correct",input:"linear_noise_schedule(100, 0.0001, 0.02)[0].shape",expected:"(100,)",hidden:!1},{id:"2",description:"Alpha bar decreases - last < first",input:"bool(linear_noise_schedule(50, 0.001, 0.01)[2][-1] < linear_noise_schedule(50, 0.001, 0.01)[2][0])",expected:"True",hidden:!0}],hints:["Use np.linspace for linear interpolation","alphas = 1 - betas","alpha_bars = np.cumprod(alphas)"],solution:`import numpy as np

def linear_noise_schedule(T, beta_start=0.0001, beta_end=0.02):
    # Linear schedule
    betas = np.linspace(beta_start, beta_end, T)

    # Compute alphas
    alphas = 1 - betas

    # Cumulative product
    alpha_bars = np.cumprod(alphas)

    return betas, alphas, alpha_bars
`},{id:"diffusion-forward",title:"Diffusion Forward Process",section:"generative-models",difficulty:"medium",description:`
## Diffusion Forward Process (Adding Noise)

Implement the forward diffusion process that adds noise to data.

### Formula
\`\`\`
x_t = sqrt(_t) * x_0 + sqrt(1 - _t) * 

where  ~ N(0, I)
\`\`\`

### Intuition
- As t increases, _t decreases
- More noise is added, signal is reduced
- At t=T, x_T  pure noise
    `,examples:[{input:"x_0 (image), t=500, T=1000",output:"x_t (noisy image)",explanation:"Halfway through diffusion process"}],starterCode:`import numpy as np

def diffusion_forward(x_0, t, alpha_bars):
    """
    Add noise to data using forward diffusion.

    Args:
        x_0: Original data (batch, ...)
        t: Timestep (int)
        alpha_bars: Cumulative alpha products (T,)

    Returns:
        x_t: Noisy data at timestep t
        noise: The noise that was added
    """
    np.random.seed(42)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape matches input",input:"diffusion_forward(np.ones((2, 4)), 50, np.linspace(0.99, 0.01, 100))[0].shape",expected:"(2, 4)",hidden:!1},{id:"2",description:"Noise shape matches input",input:"diffusion_forward(np.ones((3, 5)), 10, np.linspace(0.99, 0.01, 100))[1].shape",expected:"(3, 5)",hidden:!0}],hints:["Get alpha_bar_t = alpha_bars[t]","Sample noise from standard normal","Apply formula: sqrt(alpha_bar_t) * x_0 + sqrt(1 - alpha_bar_t) * noise"],solution:`import numpy as np

def diffusion_forward(x_0, t, alpha_bars):
    np.random.seed(42)

    alpha_bar_t = alpha_bars[t]

    # Sample noise
    noise = np.random.randn(*x_0.shape)

    # Forward process
    x_t = np.sqrt(alpha_bar_t) * x_0 + np.sqrt(1 - alpha_bar_t) * noise

    return x_t, noise
`},{id:"vqvae-quantization",title:"VQ-VAE Vector Quantization",section:"generative-models",difficulty:"hard",description:`
## VQ-VAE Vector Quantization

Implement the vector quantization layer used in VQ-VAE (Vector Quantized Variational Autoencoder).

### Overview
Unlike standard VAEs that use continuous latent spaces, VQ-VAE uses **discrete** latent representations by mapping encoder outputs to the nearest embedding in a learned codebook.

### Quantization Process
1. **Encoder output**: z_e of shape (batch, H, W, D)
2. **Codebook**: K embedding vectors of dimension D
3. **Find nearest**: For each spatial position, find the closest codebook entry
4. **Quantize**: Replace z_e with the nearest codebook vector z_q

### Distance Calculation
\`\`\`
distances[b, h, w, k] = ||z_e[b, h, w] - codebook[k]||
\`\`\`

### Straight-Through Estimator
During training, gradients flow through z_q to z_e by copying gradients:
\`\`\`
z_q = z_e + stop_gradient(z_q - z_e)
\`\`\`
(We don't implement this here, just the forward pass)

### VQ-VAE Loss Components
\`\`\`
L = reconstruction +  * ||sg[z_e] - e|| + ||z_e - sg[e]||
\`\`\`
- **Codebook loss**: Moves embeddings toward encoder outputs
- **Commitment loss**: Commits encoder to embeddings

### Function Signature
\`\`\`python
def vq_quantize(z_e, codebook):
    # z_e: (batch, H, W, embedding_dim) - encoder output
    # codebook: (num_embeddings, embedding_dim) - K embedding vectors
    # Returns: z_q, indices
\`\`\`
    `,examples:[{input:"z_e (2, 4, 4, 64), codebook (512, 64)",output:"z_q (2, 4, 4, 64), indices (2, 4, 4)",explanation:"Each spatial position mapped to one of 512 codes"}],starterCode:`import numpy as np

def vq_quantize(z_e, codebook):
    """
    Vector quantization for VQ-VAE.

    Args:
        z_e: Encoder output (batch, H, W, embedding_dim)
        codebook: Embedding vectors (num_embeddings, embedding_dim)

    Returns:
        z_q: Quantized vectors (batch, H, W, embedding_dim)
        indices: Codebook indices used (batch, H, W)
    """
    # Your code here
    pass


def vq_loss(z_e, z_q, beta=0.25):
    """
    Compute VQ-VAE losses (codebook + commitment).

    Args:
        z_e: Encoder output (batch, H, W, embedding_dim)
        z_q: Quantized vectors (batch, H, W, embedding_dim)
        beta: Commitment loss weight (default: 0.25)

    Returns:
        codebook_loss: Loss to update codebook
        commitment_loss: Loss to commit encoder to codebook
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"z_q output shape matches input",input:"vq_quantize(np.random.randn(2, 4, 4, 8), np.random.randn(16, 8))[0].shape",expected:"(2, 4, 4, 8)",hidden:!1},{id:"2",description:"Indices shape is correct",input:"vq_quantize(np.random.randn(2, 4, 4, 8), np.random.randn(16, 8))[1].shape",expected:"(2, 4, 4)",hidden:!1},{id:"3",description:"Indices are valid codebook indices (all less than K)",input:"bool(np.all(vq_quantize(np.random.randn(2, 3, 3, 4), np.random.randn(8, 4))[1] < 8))",expected:"True",hidden:!0},{id:"4",description:"VQ loss returns tuple of two values",input:"len(vq_loss(np.random.randn(2, 3, 3, 4), np.random.randn(2, 3, 3, 4), 0.25))",expected:"2",hidden:!0}],hints:["Reshape z_e to (batch*H*W, D) for easier distance computation","Use broadcasting: ||a - b|| = ||a|| + ||b|| - 2*ab","np.argmin along the codebook axis gives indices","Index into codebook with the indices to get z_q","Reshape back to original spatial dimensions","For loss: codebook_loss = ||z_e.detach() - z_q||, commitment = ||z_e - z_q.detach()||"],solution:`import numpy as np

def vq_quantize(z_e, codebook):
    z_e = np.array(z_e)
    codebook = np.array(codebook)

    batch, H, W, D = z_e.shape
    K, _ = codebook.shape

    # Flatten spatial dimensions: (batch*H*W, D)
    z_flat = z_e.reshape(-1, D)

    # Compute distances using: ||a-b|| = ||a|| + ||b|| - 2*ab
    # z_flat: (N, D), codebook: (K, D)
    z_sq = np.sum(z_flat ** 2, axis=1, keepdims=True)  # (N, 1)
    codebook_sq = np.sum(codebook ** 2, axis=1)        # (K,)
    cross = z_flat @ codebook.T                        # (N, K)

    distances = z_sq + codebook_sq - 2 * cross         # (N, K)

    # Find nearest codebook entry
    indices_flat = np.argmin(distances, axis=1)        # (N,)

    # Get quantized vectors
    z_q_flat = codebook[indices_flat]                  # (N, D)

    # Reshape back
    z_q = z_q_flat.reshape(batch, H, W, D)
    indices = indices_flat.reshape(batch, H, W)

    return z_q, indices


def vq_loss(z_e, z_q, beta=0.25):
    z_e = np.array(z_e)
    z_q = np.array(z_q)

    # Codebook loss: ||sg[z_e] - z_q|| (moves codebook toward encoder output)
    # In practice, sg[z_e] means z_e is treated as constant
    codebook_loss = np.mean((z_e - z_q) ** 2)

    # Commitment loss: ||z_e - sg[z_q]|| (commits encoder to codebook)
    # Same computation, but gradient only flows to z_e
    commitment_loss = beta * np.mean((z_e - z_q) ** 2)

    return round(codebook_loss, 4), round(commitment_loss, 4)
`},{id:"kl-divergence",title:"KL Divergence (Gaussians)",section:"generative-models",difficulty:"easy",description:`
## KL Divergence Between Gaussians

Compute the KL divergence between two univariate Gaussian distributions.

### Formula
\`\`\`
KL(P || Q) = log(_q/_p) + (_p + (_p - _q)) / (2_q) - 0.5
\`\`\`

Where P = N(_p, _p) and Q = N(_q, _q)

### Properties
- KL  0
- KL = 0 iff P = Q
- Not symmetric: KL(P||Q)  KL(Q||P)
    `,examples:[{input:"P = N(0, 1), Q = N(0, 1)",output:"0",explanation:"Same distribution"}],starterCode:`import numpy as np

def kl_divergence_gaussian(mu_p, sigma_p, mu_q, sigma_q):
    """
    Compute KL divergence between two Gaussians.

    Args:
        mu_p, sigma_p: Mean and std of P
        mu_q, sigma_q: Mean and std of Q

    Returns:
        kl: KL(P || Q)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Same distribution",input:"(0, 1, 0, 1)",expected:"0.0",hidden:!1},{id:"2",description:"Different means",input:"(1, 1, 0, 1)",expected:"0.5",hidden:!1},{id:"3",description:"Different variances",input:"(0, 2, 0, 1)",expected:"0.8069",hidden:!0}],hints:["Apply the formula directly","Use np.log for natural logarithm","Remember:  is variance,  is std"],solution:`import numpy as np

def kl_divergence_gaussian(mu_p, sigma_p, mu_q, sigma_q):
    term1 = np.log(sigma_q / sigma_p)
    term2 = (sigma_p**2 + (mu_p - mu_q)**2) / (2 * sigma_q**2)
    term3 = -0.5

    kl = term1 + term2 + term3
    return round(kl, 4)
`}],L6=[{id:"numpy-array-creation",title:"Array Creation Methods",section:"numpy-fundamentals",difficulty:"easy",description:`
## NumPy Array Creation

Implement a function that creates various NumPy arrays using different methods.

### Requirements
Create and return a dictionary with:
- \`zeros\`: 3x4 array of zeros
- \`ones\`: 2x3 array of ones
- \`arange\`: array from 0 to 9
- \`linspace\`: 5 evenly spaced values from 0 to 1
- \`eye\`: 4x4 identity matrix

### Function Signature
\`\`\`python
def create_arrays() -> dict:
\`\`\`
    `,examples:[{input:"create_arrays()",output:"{'zeros': array([[0,0,0,0],...]), ...}",explanation:"Dictionary with 5 different array types"}],starterCode:`import numpy as np

def create_arrays() -> dict:
    """
    Create various NumPy arrays.

    Returns:
        Dictionary with keys: zeros, ones, arange, linspace, eye
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Zeros shape correct",input:'create_arrays()["zeros"].shape',expected:"(3, 4)",hidden:!1},{id:"2",description:"Linspace length correct",input:'len(create_arrays()["linspace"])',expected:"5",hidden:!1},{id:"3",description:"Eye is identity",input:'bool(np.allclose(create_arrays()["eye"], np.eye(4)))',expected:"True",hidden:!0}],hints:["Use np.zeros((3, 4)) for zero array","np.linspace(start, stop, num) creates evenly spaced values","np.eye(n) creates an identity matrix"],solution:`import numpy as np

def create_arrays() -> dict:
    return {
        'zeros': np.zeros((3, 4)),
        'ones': np.ones((2, 3)),
        'arange': np.arange(10),
        'linspace': np.linspace(0, 1, 5),
        'eye': np.eye(4)
    }
`},{id:"numpy-indexing",title:"Advanced Indexing",section:"numpy-fundamentals",difficulty:"medium",description:`
## NumPy Advanced Indexing

Implement various indexing operations on a 2D array.

### Given
\`\`\`python
arr = np.arange(20).reshape(4, 5)
# array([[ 0,  1,  2,  3,  4],
#        [ 5,  6,  7,  8,  9],
#        [10, 11, 12, 13, 14],
#        [15, 16, 17, 18, 19]])
\`\`\`

### Requirements
Return a dictionary with:
- \`row_1\`: Second row (index 1)
- \`col_2\`: Third column (index 2)
- \`subarray\`: Rows 1-2, columns 2-4
- \`diagonal\`: Main diagonal
- \`reversed\`: Array with rows reversed

### Function Signature
\`\`\`python
def advanced_indexing(arr: np.ndarray) -> dict:
\`\`\`
    `,examples:[{input:"arr = np.arange(20).reshape(4, 5)",output:"{'row_1': [5,6,7,8,9], ...}",explanation:"Various slicing and indexing operations"}],starterCode:`import numpy as np

def advanced_indexing(arr: np.ndarray) -> dict:
    """
    Perform advanced indexing operations.

    Args:
        arr: 2D input array

    Returns:
        Dictionary with indexed results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Row extraction",input:'advanced_indexing(np.arange(20).reshape(4, 5))["row_1"].tolist()',expected:"[5, 6, 7, 8, 9]",hidden:!1},{id:"2",description:"Subarray correct",input:'advanced_indexing(np.arange(20).reshape(4, 5))["subarray"].tolist()',expected:"[[7, 8, 9], [12, 13, 14]]",hidden:!1}],hints:["arr[1] or arr[1, :] gets row 1","arr[:, 2] gets column 2","arr[1:3, 2:5] gets a subarray","np.diag(arr) extracts diagonal","arr[::-1] reverses rows"],solution:`import numpy as np

def advanced_indexing(arr: np.ndarray) -> dict:
    return {
        'row_1': arr[1],
        'col_2': arr[:, 2],
        'subarray': arr[1:3, 2:5],
        'diagonal': np.diag(arr),
        'reversed': arr[::-1]
    }
`},{id:"numpy-broadcasting",title:"Broadcasting Operations",section:"numpy-fundamentals",difficulty:"medium",description:`
## NumPy Broadcasting

Implement operations that leverage NumPy's broadcasting rules.

### Task
Given a 2D array of shape (3, 4):
1. Subtract the row means from each row (center rows)
2. Subtract the column means from each column (center columns)
3. Add a 1D bias vector of shape (4,) to each row
4. Multiply by a column vector of shape (3, 1)

### Broadcasting Rules
- Arrays are compatible when dimensions are equal or one of them is 1
- Operations proceed element-wise on matching dimensions

### Function Signature
\`\`\`python
def broadcasting_ops(arr: np.ndarray, bias: np.ndarray, scale: np.ndarray) -> dict:
\`\`\`
    `,examples:[{input:"arr (3,4), bias (4,), scale (3,1)",output:"{'row_centered': ..., 'col_centered': ..., 'biased': ..., 'scaled': ...}",explanation:"Various broadcasting operations"}],starterCode:`import numpy as np

def broadcasting_ops(arr: np.ndarray, bias: np.ndarray, scale: np.ndarray) -> dict:
    """
    Perform broadcasting operations.

    Args:
        arr: 2D array of shape (3, 4)
        bias: 1D array of shape (4,)
        scale: 2D array of shape (3, 1)

    Returns:
        Dictionary with results of broadcasting operations
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Row centering",input:'bool(np.allclose(broadcasting_ops(np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]]), np.zeros(4), np.ones((3,1)))["row_centered"].mean(axis=1), 0))',expected:"True",hidden:!1},{id:"2",description:"Bias addition shape",input:'broadcasting_ops(np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]]), np.array([1,1,1,1]), np.ones((3,1)))["biased"].shape',expected:"(3, 4)",hidden:!1}],hints:["Row means: arr.mean(axis=1, keepdims=True)","Column means: arr.mean(axis=0, keepdims=True) or arr.mean(axis=0)","Bias shape (4,) broadcasts with arr shape (3, 4)","Scale shape (3, 1) broadcasts with arr shape (3, 4)"],solution:`import numpy as np

def broadcasting_ops(arr: np.ndarray, bias: np.ndarray, scale: np.ndarray) -> dict:
    # Row centered: subtract mean of each row
    row_means = arr.mean(axis=1, keepdims=True)  # (3, 1)
    row_centered = arr - row_means

    # Column centered: subtract mean of each column
    col_means = arr.mean(axis=0)  # (4,)
    col_centered = arr - col_means

    # Add bias to each row
    biased = arr + bias  # bias (4,) broadcasts to (3, 4)

    # Scale each row
    scaled = arr * scale  # scale (3, 1) broadcasts to (3, 4)

    return {
        'row_centered': row_centered,
        'col_centered': col_centered,
        'biased': biased,
        'scaled': scaled
    }
`},{id:"numpy-aggregations",title:"Aggregation Functions",section:"numpy-fundamentals",difficulty:"easy",description:"\n## NumPy Aggregations\n\nImplement common aggregation operations along different axes.\n\n### Task\nGiven a 2D array, compute:\n- Global statistics (mean, std, min, max, sum)\n- Row-wise statistics (along axis=1)\n- Column-wise statistics (along axis=0)\n- Argmax and argmin (indices of max/min values)\n\n### Expected Return Format\nReturn a dictionary with these keys:\n- **Global**: `'global_mean'`, `'global_std'`, `'global_min'`, `'global_max'`, `'global_sum'`\n- **Row-wise**: `'row_mean'`, `'row_sum'`\n- **Column-wise**: `'col_mean'`, `'col_sum'`\n- **Indices**: `'argmax'` (2D index tuple), `'argmin'` (2D index tuple)\n    ",examples:[{input:"np.array([[1, 2, 3], [4, 5, 6]])",output:"{'global_mean': 3.5, 'global_sum': 21, 'row_sum': [6, 15], 'col_mean': [2.5, 3.5, 4.5], 'argmax': (1, 2), ...}",explanation:"Global, row-wise, and column-wise aggregations"}],starterCode:`import numpy as np

def compute_aggregations(arr: np.ndarray) -> dict:
    """
    Compute aggregation statistics.

    Args:
        arr: 2D input array

    Returns:
        Dictionary with aggregation results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Global mean",input:'compute_aggregations(np.array([[1, 2, 3], [4, 5, 6]]))["global_mean"]',expected:"3.5",hidden:!1},{id:"2",description:"Row sums",input:'compute_aggregations(np.array([[1, 2, 3], [4, 5, 6]]))["row_sum"].tolist()',expected:"[6, 15]",hidden:!1}],hints:["arr.mean() computes global mean","arr.mean(axis=0) computes column means","arr.mean(axis=1) computes row means","np.argmax(arr) gives index of max in flattened array"],solution:`import numpy as np

def compute_aggregations(arr: np.ndarray) -> dict:
    return {
        'global_mean': arr.mean(),
        'global_std': arr.std(),
        'global_min': arr.min(),
        'global_max': arr.max(),
        'global_sum': arr.sum(),
        'row_mean': arr.mean(axis=1),
        'row_sum': arr.sum(axis=1),
        'col_mean': arr.mean(axis=0),
        'col_sum': arr.sum(axis=0),
        'argmax': np.unravel_index(arr.argmax(), arr.shape),
        'argmin': np.unravel_index(arr.argmin(), arr.shape),
    }
`},{id:"numpy-reshape-transpose",title:"Reshape and Transpose",section:"numpy-fundamentals",difficulty:"medium",description:`
## Reshape and Transpose Operations

Master array shape manipulation - essential for ML data pipelines.

### Task
Given a 1D array of 24 elements:
1. Reshape to (4, 6)
2. Reshape to (2, 3, 4)
3. Transpose the 2D version
4. Swap axes on the 3D version
5. Flatten back to 1D

### Important Concepts
- \`reshape\` changes shape without changing data order
- \`transpose\` swaps axes
- \`-1\` in reshape means "infer this dimension"

### Expected Return Format
Return a dictionary with these keys:
- \`'arr_2d'\`: Reshaped to (4, 6)
- \`'arr_3d'\`: Reshaped to (2, 3, 4)
- \`'arr_2d_transposed'\`: Transpose of arr_2d, shape (6, 4)
- \`'arr_3d_swapped'\`: arr_3d with axes swapped (2,1,0), shape (4, 3, 2)
- \`'arr_flat'\`: Flattened back to 1D, shape (24,)
    `,examples:[{input:"np.arange(24)",output:"{'arr_2d': shape (4,6), 'arr_3d': shape (2,3,4), 'arr_2d_transposed': shape (6,4), ...}",explanation:"Various reshape and transpose operations"}],starterCode:`import numpy as np

def reshape_transpose(arr: np.ndarray) -> dict:
    """
    Perform reshape and transpose operations.

    Args:
        arr: 1D array of 24 elements

    Returns:
        Dictionary with reshaped arrays
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"2D reshape shape",input:'reshape_transpose(np.arange(24))["arr_2d"].shape',expected:"(4, 6)",hidden:!1},{id:"2",description:"3D reshape shape",input:'reshape_transpose(np.arange(24))["arr_3d"].shape',expected:"(2, 3, 4)",hidden:!1}],hints:["arr.reshape(4, 6) or arr.reshape(4, -1)","arr.reshape(2, 3, 4) for 3D",".T or .transpose() for transpose",".flatten() or .ravel() for 1D"],solution:`import numpy as np

def reshape_transpose(arr: np.ndarray) -> dict:
    # 2D reshape
    arr_2d = arr.reshape(4, 6)

    # 3D reshape
    arr_3d = arr.reshape(2, 3, 4)

    # Transpose 2D
    arr_2d_T = arr_2d.T

    # Swap axes on 3D (swap axis 0 and 2)
    arr_3d_swapped = arr_3d.transpose(2, 1, 0)

    # Flatten
    arr_flat = arr_2d.flatten()

    return {
        'arr_2d': arr_2d,
        'arr_3d': arr_3d,
        'arr_2d_transposed': arr_2d_T,
        'arr_3d_swapped': arr_3d_swapped,
        'arr_flat': arr_flat
    }
`}],D6=[{id:"einsum-basics",title:"Einsum Fundamentals",section:"einsum",difficulty:"easy",description:`
## Einsum Fundamentals

Einstein summation notation provides a powerful way to express array operations.

### Syntax
\`\`\`python
np.einsum('subscripts', operands)
\`\`\`

### Basic Operations
- \`'i->'\`: Sum all elements (reduce)
- \`'ij->i'\`: Sum along columns (row sums)
- \`'ij->j'\`: Sum along rows (column sums)
- \`'ii->i'\`: Extract diagonal
- \`'ij->ji'\`: Transpose

### Task
Implement basic einsum operations on a 2D array.

### Expected Return Format
Return a dictionary with these keys:
- \`'sum_all'\`: Sum of all elements
- \`'row_sum'\`: Sum along each row
- \`'col_sum'\`: Sum along each column
- \`'transpose'\`: Transposed array
- \`'diagonal'\`: Diagonal elements (for square matrices, else None)
    `,examples:[{input:"np.array([[1,2],[3,4]])",output:"{'sum_all': 10, 'row_sum': [3,7], 'col_sum': [4,6], 'transpose': [[1,3],[2,4]], 'diagonal': [1,4]}",explanation:"Basic einsum operations on a 2x2 matrix"}],starterCode:`import numpy as np

def einsum_basics(arr: np.ndarray) -> dict:
    """
    Perform basic einsum operations.

    Args:
        arr: 2D input array

    Returns:
        Dictionary with einsum results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Sum all elements",input:'einsum_basics(np.array([[1, 2], [3, 4]]))["sum_all"]',expected:"10",hidden:!1},{id:"2",description:"Transpose",input:'bool(np.array_equal(einsum_basics(np.array([[1, 2], [3, 4]]))["transpose"], np.array([[1, 3], [2, 4]])))',expected:"True",hidden:!1}],hints:["'ij->' sums all elements","'ij->i' sums each row","'ij->ji' transposes","'ii->i' extracts diagonal (for square matrices)"],solution:`import numpy as np

def einsum_basics(arr: np.ndarray) -> dict:
    return {
        'sum_all': np.einsum('ij->', arr),
        'row_sum': np.einsum('ij->i', arr),
        'col_sum': np.einsum('ij->j', arr),
        'transpose': np.einsum('ij->ji', arr),
        'diagonal': np.einsum('ii->i', arr) if arr.shape[0] == arr.shape[1] else None
    }
`},{id:"einsum-matrix-ops",title:"Matrix Operations with Einsum",section:"einsum",difficulty:"medium",description:`
## Matrix Operations with Einsum

Einsum can express matrix multiplication and more complex operations.

### Key Operations
- \`'ik,kj->ij'\`: Matrix multiplication (A @ B)
- \`'ij,ij->ij'\`: Element-wise multiplication (Hadamard)
- \`'ij,ij->'\`: Frobenius inner product (sum of element-wise product)
- \`'ij,j->i'\`: Matrix-vector multiplication
- \`'i,j->ij'\`: Outer product

### Task
Implement matrix operations using einsum.

### Expected Return Format
Return a dictionary with these keys:
- \`'matmul'\`: Matrix multiplication A @ B
- \`'matvec'\`: Matrix-vector multiplication A @ v
- \`'outer_product'\`: Outer product of v with itself
- \`'hadamard'\`: Element-wise A * A
- \`'frobenius'\`: Sum of A * A (Frobenius inner product)
- \`'trace'\`: Trace of A (if square, else None)
    `,examples:[{input:"A=[[1,2],[3,4]], B=[[5,6],[7,8]], v=[1,2]",output:"{'matmul': [[19,22],[43,50]], 'matvec': [5,11], 'outer_product': [[1,2],[2,4]], 'hadamard': [[1,4],[9,16]], 'frobenius': 30, 'trace': 5}",explanation:"Matrix operations via einsum"}],starterCode:`import numpy as np

def einsum_matrix_ops(A: np.ndarray, B: np.ndarray, v: np.ndarray) -> dict:
    """
    Perform matrix operations using einsum.

    Args:
        A: Matrix of shape (m, k)
        B: Matrix of shape (k, n)
        v: Vector of shape (k,)

    Returns:
        Dictionary with operation results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Matrix multiplication",input:'bool(np.array_equal(einsum_matrix_ops(np.array([[1,2],[3,4]]), np.array([[5,6],[7,8]]), np.array([1,2]))["matmul"], np.array([[19,22],[43,50]])))',expected:"True",hidden:!1},{id:"2",description:"Outer product",input:'bool(np.array_equal(einsum_matrix_ops(np.array([[1,2],[3,4]]), np.array([[5,6],[7,8]]), np.array([1,2]))["outer_product"], np.array([[1,2],[2,4]])))',expected:"True",hidden:!1}],hints:["'ik,kj->ij' contracts over k (matrix multiply)","'ij,j->i' contracts vector with columns","'i,j->ij' creates outer product (no contraction)"],solution:`import numpy as np

def einsum_matrix_ops(A: np.ndarray, B: np.ndarray, v: np.ndarray) -> dict:
    return {
        'matmul': np.einsum('ik,kj->ij', A, B),
        'matvec': np.einsum('ij,j->i', A, v),
        'outer_product': np.einsum('i,j->ij', v, v),
        'hadamard': np.einsum('ij,ij->ij', A, A),  # A * A
        'frobenius': np.einsum('ij,ij->', A, A),   # sum(A * A)
        'trace': np.einsum('ii->', A) if A.shape[0] == A.shape[1] else None
    }
`},{id:"einsum-batch-ops",title:"Batch Operations with Einsum",section:"einsum",difficulty:"medium",description:`
## Batch Operations with Einsum

Einsum shines for batch operations - multiple matrices at once.

### Batch Matrix Operations
- \`'bij,bjk->bik'\`: Batch matrix multiplication
- \`'bij,bj->bi'\`: Batch matrix-vector multiplication
- \`'bij->bji'\`: Batch transpose

### Attention-style Operations
- \`'bqd,bkd->bqk'\`: Query-Key dot products (attention scores)
- \`'bqk,bkv->bqv'\`: Weighted sum of values

### Task
Implement batch operations common in deep learning.

### Expected Return Format
Return a dictionary with these keys:
- \`'scores'\`: Raw attention scores Q @ K.T per batch, shape (batch, seq_q, seq_k)
- \`'attention_weights'\`: Softmax of scaled scores, shape (batch, seq_q, seq_k)
- \`'output'\`: Weighted sum of values, shape (batch, seq_q, dim_v)
    `,examples:[{input:"Q (2,4,8), K (2,6,8), V (2,6,16)",output:"{'scores': shape (2,4,6), 'attention_weights': shape (2,4,6), 'output': shape (2,4,16)}",explanation:"Batch attention: scores from Q@K.T, then weighted sum of V"}],starterCode:`import numpy as np

def einsum_batch_ops(Q: np.ndarray, K: np.ndarray, V: np.ndarray) -> dict:
    """
    Perform batch operations using einsum.

    Args:
        Q: Queries of shape (batch, seq_q, dim)
        K: Keys of shape (batch, seq_k, dim)
        V: Values of shape (batch, seq_k, dim_v)

    Returns:
        Dictionary with batch operation results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Attention scores shape",input:'einsum_batch_ops(np.ones((2, 4, 8)), np.ones((2, 6, 8)), np.ones((2, 6, 16)))["scores"].shape',expected:"(2, 4, 6)",hidden:!1},{id:"2",description:"Output shape",input:'einsum_batch_ops(np.ones((2, 4, 8)), np.ones((2, 6, 8)), np.ones((2, 6, 16)))["output"].shape',expected:"(2, 4, 16)",hidden:!1}],hints:["'bqd,bkd->bqk' computes Q @ K.T for each batch","'bqk,bkv->bqv' applies attention weights to values","b is the batch dimension, preserved in output"],solution:`import numpy as np

def einsum_batch_ops(Q: np.ndarray, K: np.ndarray, V: np.ndarray) -> dict:
    # Q: (batch, seq_q, dim)
    # K: (batch, seq_k, dim)
    # V: (batch, seq_k, dim_v)

    # Attention scores: Q @ K.T for each batch
    # Result: (batch, seq_q, seq_k)
    scores = np.einsum('bqd,bkd->bqk', Q, K)

    # Scale scores
    d_k = Q.shape[-1]
    scaled_scores = scores / np.sqrt(d_k)

    # Softmax (simplified, along last axis)
    exp_scores = np.exp(scaled_scores - scaled_scores.max(axis=-1, keepdims=True))
    attention_weights = exp_scores / exp_scores.sum(axis=-1, keepdims=True)

    # Weighted sum of values
    # Result: (batch, seq_q, dim_v)
    output = np.einsum('bqk,bkv->bqv', attention_weights, V)

    return {
        'scores': scores,
        'attention_weights': attention_weights,
        'output': output
    }
`},{id:"einsum-advanced",title:"Advanced Einsum Patterns",section:"einsum",difficulty:"hard",description:`
## Advanced Einsum Patterns

Complex tensor operations for deep learning.

### Multi-Head Attention Pattern
\`\`\`python
# Split heads: (batch, seq, heads, dim)
# Attention per head: 'bhqd,bhkd->bhqk'
# Combine heads: 'bhqv->bqhv' then reshape
\`\`\`

### Bilinear Operations
\`\`\`python
# x.T @ W @ y: 'i,ijk,k->j'
# Batch bilinear: 'bi,ijk,bk->bj'
\`\`\`

### Task
Implement multi-head attention using einsum.
    `,examples:[{input:"Q, K, V with multiple heads",output:"Multi-head attention output",explanation:"Parallel attention across heads"}],starterCode:`import numpy as np

def multi_head_attention_einsum(Q: np.ndarray, K: np.ndarray, V: np.ndarray,
                                 num_heads: int) -> np.ndarray:
    """
    Multi-head attention using einsum.

    Args:
        Q: Queries (batch, seq_q, d_model)
        K: Keys (batch, seq_k, d_model)
        V: Values (batch, seq_k, d_model)
        num_heads: Number of attention heads

    Returns:
        output: (batch, seq_q, d_model)
    """
    batch, seq_q, d_model = Q.shape
    seq_k = K.shape[1]
    d_k = d_model // num_heads

    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape preserved",input:"multi_head_attention_einsum(np.ones((2, 4, 64)), np.ones((2, 4, 64)), np.ones((2, 4, 64)), 8).shape",expected:"(2, 4, 64)",hidden:!1},{id:"2",description:"Output is valid array",input:"not np.isnan(multi_head_attention_einsum(np.ones((2, 4, 64)), np.ones((2, 4, 64)), np.ones((2, 4, 64)), 8)).any()",expected:"True",hidden:!0}],hints:["Reshape Q, K, V to (batch, seq, num_heads, d_k)","Use 'bqhd,bkhd->bhqk' for attention scores per head","Use 'bhqk,bkhd->bqhd' for weighted values","Reshape back to (batch, seq, d_model)"],solution:`import numpy as np

def multi_head_attention_einsum(Q: np.ndarray, K: np.ndarray, V: np.ndarray,
                                 num_heads: int) -> np.ndarray:
    batch, seq_q, d_model = Q.shape
    seq_k = K.shape[1]
    d_k = d_model // num_heads

    # Reshape to (batch, seq, num_heads, d_k)
    Q = Q.reshape(batch, seq_q, num_heads, d_k)
    K = K.reshape(batch, seq_k, num_heads, d_k)
    V = V.reshape(batch, seq_k, num_heads, d_k)

    # Compute attention scores for all heads
    # (batch, seq_q, heads, d_k) x (batch, seq_k, heads, d_k) -> (batch, heads, seq_q, seq_k)
    scores = np.einsum('bqhd,bkhd->bhqk', Q, K) / np.sqrt(d_k)

    # Softmax
    exp_scores = np.exp(scores - scores.max(axis=-1, keepdims=True))
    attention = exp_scores / exp_scores.sum(axis=-1, keepdims=True)

    # Weighted sum of values
    # (batch, heads, seq_q, seq_k) x (batch, seq_k, heads, d_k) -> (batch, seq_q, heads, d_k)
    output = np.einsum('bhqk,bkhd->bqhd', attention, V)

    # Reshape back to (batch, seq_q, d_model)
    output = output.reshape(batch, seq_q, d_model)

    return output
`},{id:"einsum-vs-matmul",title:"Einsum vs Traditional Operations",section:"einsum",difficulty:"easy",description:"\n## Einsum vs Traditional Operations\n\nCompare einsum with equivalent NumPy operations.\n\n### Equivalences\n| Einsum | NumPy |\n|--------|-------|\n| `'ij->'` | `np.sum(A)` |\n| `'ij->i'` | `np.sum(A, axis=1)` |\n| `'ik,kj->ij'` | `A @ B` |\n| `'ij,ij->'` | `np.sum(A * B)` |\n| `'ij->ji'` | `A.T` |\n\n### Task\nVerify einsum produces same results as traditional operations.\n\n### Expected Return Format\nReturn a dictionary with:\n- `'results'`: Dict mapping operation names to {'einsum': ..., 'numpy': ...}\n- `'all_match'`: Boolean indicating if all einsum results match numpy equivalents\n    ",examples:[{input:"A=[[1,2,3],[4,5,6]], B=[[1,2],[3,4],[5,6]]",output:"{'results': {'sum': {...}, 'matmul': {...}, ...}, 'all_match': True}",explanation:"All einsum operations produce identical results to NumPy equivalents"}],starterCode:`import numpy as np

def einsum_equivalence(A: np.ndarray, B: np.ndarray) -> dict:
    """
    Compare einsum with traditional NumPy operations.

    Args:
        A: First matrix (m, k)
        B: Second matrix (k, n)

    Returns:
        Dictionary with 'einsum' and 'numpy' results for comparison
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"All results match",input:'einsum_equivalence(np.array([[1.0,2.0,3.0],[4.0,5.0,6.0]]), np.array([[1.0,2.0],[3.0,4.0],[5.0,6.0]]))["all_match"]',expected:"True",hidden:!1},{id:"2",description:"Matrix multiplication matches",input:'bool(np.allclose(einsum_equivalence(np.array([[1.0,2.0],[3.0,4.0]]), np.array([[5.0,6.0],[7.0,8.0]]))["results"]["matmul"]["einsum"], np.array([[19.0,22.0],[43.0,50.0]])))',expected:"True",hidden:!1}],hints:["Use np.allclose() to compare floating point arrays","Remember 'ik,kj->ij' is matrix multiplication"],solution:`import numpy as np

def einsum_equivalence(A: np.ndarray, B: np.ndarray) -> dict:
    results = {
        'sum': {
            'einsum': np.einsum('ij->', A),
            'numpy': np.sum(A)
        },
        'row_sum': {
            'einsum': np.einsum('ij->i', A),
            'numpy': np.sum(A, axis=1)
        },
        'matmul': {
            'einsum': np.einsum('ik,kj->ij', A, B),
            'numpy': A @ B
        },
        'transpose': {
            'einsum': np.einsum('ij->ji', A),
            'numpy': A.T
        },
        'hadamard_sum': {
            'einsum': np.einsum('ij,ij->', A, A),
            'numpy': np.sum(A * A)
        }
    }

    # Verify all match
    all_match = all(
        np.allclose(v['einsum'], v['numpy'])
        for v in results.values()
    )

    return {'results': results, 'all_match': all_match}
`}],O6=[{id:"tensor-creation",title:"Tensor Creation (NumPy Style)",section:"pytorch-basics",difficulty:"easy",description:"\n## Tensor Creation\n\nLearn tensor creation patterns used in PyTorch, implemented with NumPy.\n\n### PyTorch Equivalents\n| PyTorch | NumPy |\n|---------|-------|\n| `torch.tensor([1,2,3])` | `np.array([1,2,3])` |\n| `torch.zeros(3, 4)` | `np.zeros((3, 4))` |\n| `torch.randn(2, 3)` | `np.random.randn(2, 3)` |\n| `torch.arange(10)` | `np.arange(10)` |\n| `torch.linspace(0, 1, 5)` | `np.linspace(0, 1, 5)` |\n\n### Data Types\n| PyTorch | NumPy |\n|---------|-------|\n| `torch.float32` | `np.float32` |\n| `torch.int64` | `np.int64` |\n\n### Task\nCreate tensors matching PyTorch patterns.\n\n### Expected Return Format\nReturn a dictionary with these keys:\n- `'from_list'`: Array from [1,2,3,4] with float32 dtype\n- `'zeros'`: Zero array of shape (3, 4)\n- `'ones'`: Ones array of shape (2, 3)\n- `'randn'`: Random normal array of shape (2, 3)\n- `'arange'`: Array from 0 to 9\n- `'linspace'`: 5 evenly spaced values from 0 to 1\n- `'eye'`: 4x4 identity matrix\n- `'full'`: (2, 3) array filled with 7.0\n    ",examples:[{input:"create_tensors()",output:"{'zeros': shape (3,4), 'ones': shape (2,3), 'randn': shape (2,3), 'arange': [0..9], ...}",explanation:"Dictionary containing tensors created with various methods"}],starterCode:`import numpy as np

def create_tensors() -> dict:
    """
    Create tensors using various methods.

    Returns:
        Dictionary with named tensors
    """
    np.random.seed(42)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Zeros shape",input:'create_tensors()["zeros"].shape',expected:"(3, 4)",hidden:!1},{id:"2",description:"Random tensor shape",input:'create_tensors()["randn"].shape',expected:"(2, 3)",hidden:!1}],hints:["np.zeros((3, 4)) for 3x4 zeros","np.random.randn(2, 3) for random normal","Specify dtype with astype() or dtype parameter"],solution:`import numpy as np

def create_tensors() -> dict:
    np.random.seed(42)

    return {
        'from_list': np.array([1, 2, 3, 4], dtype=np.float32),
        'zeros': np.zeros((3, 4)),
        'ones': np.ones((2, 3)),
        'randn': np.random.randn(2, 3),
        'arange': np.arange(10),
        'linspace': np.linspace(0, 1, 5),
        'eye': np.eye(4),
        'full': np.full((2, 3), 7.0),
    }
`},{id:"tensor-operations",title:"Tensor Operations",section:"pytorch-basics",difficulty:"easy",description:"\n## Basic Tensor Operations\n\nCommon tensor operations used in neural networks.\n\n### Arithmetic Operations\n- Element-wise: +, -, *, /\n- Matrix multiplication: @ or np.matmul\n- Power: ** or np.power\n\n### Reduction Operations\n- sum, mean, std, var\n- min, max, argmin, argmax\n\n### Shape Operations\n- reshape, view (reshape in NumPy)\n- squeeze, unsqueeze (np.squeeze, np.expand_dims)\n- permute, transpose\n\n### Task\nImplement common tensor operations.\n\n### Expected Return Format\nReturn a dictionary with these keys:\n- **Arithmetic**: `'add'`, `'sub'`, `'mul'`, `'div'`, `'pow'`\n- **Reductions**: `'sum_all'`, `'sum_axis0'`, `'sum_axis1'`, `'mean'`, `'std'`, `'max'`, `'argmax'`\n- **Shape ops**: `'reshape'` (to 3,2), `'flatten'`, `'unsqueeze'` (add dim 0), `'squeeze'`, `'transpose'`\n    ",examples:[{input:"x=[[1,2,3],[4,5,6]], y=[[1,1,1],[2,2,2]]",output:"{'add': [[2,3,4],[6,7,8]], 'mean': 3.5, 'reshape': [[1,2],[3,4],[5,6]], ...}",explanation:"Arithmetic, reduction, and shape operations on tensors"}],starterCode:`import numpy as np

def tensor_ops(x: np.ndarray, y: np.ndarray) -> dict:
    """
    Perform common tensor operations.

    Args:
        x: First tensor (2, 3)
        y: Second tensor (2, 3)

    Returns:
        Dictionary with operation results
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Addition",input:'bool(np.array_equal(tensor_ops(np.array([[1,2,3],[4,5,6]]), np.array([[1,1,1],[2,2,2]]))["add"], np.array([[2,3,4],[6,7,8]])))',expected:"True",hidden:!1},{id:"2",description:"Mean computation",input:'tensor_ops(np.array([[1,2,3],[4,5,6]]), np.array([[1,1,1],[2,2,2]]))["mean"]',expected:"3.5",hidden:!1}],hints:["Element-wise ops work directly: x + y, x * y","Use axis parameter for reductions along specific dims","np.expand_dims(x, axis=0) adds dimension"],solution:`import numpy as np

def tensor_ops(x: np.ndarray, y: np.ndarray) -> dict:
    return {
        # Arithmetic
        'add': x + y,
        'sub': x - y,
        'mul': x * y,
        'div': x / (y + 1e-8),
        'pow': x ** 2,

        # Reductions
        'sum_all': x.sum(),
        'sum_axis0': x.sum(axis=0),
        'sum_axis1': x.sum(axis=1),
        'mean': x.mean(),
        'std': x.std(),
        'max': x.max(),
        'argmax': x.argmax(),

        # Shape ops
        'reshape': x.reshape(3, 2),
        'flatten': x.flatten(),
        'unsqueeze': np.expand_dims(x, axis=0),  # (1, 2, 3)
        'squeeze': np.squeeze(np.expand_dims(x, 0)),
        'transpose': x.T,
    }
`},{id:"autograd-concepts",title:"Autograd Concepts (Manual)",section:"pytorch-basics",difficulty:"medium",description:`
## Autograd Concepts

Understand automatic differentiation by implementing it manually.

### PyTorch Autograd
\`\`\`python
x = torch.tensor([2.0], requires_grad=True)
y = x ** 2 + 3 * x + 1
y.backward()
print(x.grad)  # dy/dx = 2x + 3 = 7
\`\`\`

### Manual Gradient Computation
For y = x + 3x + 1:
- dy/dx = 2x + 3

### Task
Implement forward pass and gradient computation for simple functions.
    `,examples:[{input:"compute_gradients(x=2.0)",output:"{'y': 11.0, 'grad': 7.0}",explanation:"Forward and backward pass"}],starterCode:`import numpy as np

def compute_gradients(x: float) -> dict:
    """
    Compute forward and backward pass for y = x^2 + 3x + 1.

    Args:
        x: Input value

    Returns:
        Dictionary with 'y' (forward result) and 'grad' (dy/dx)
    """
    # Your code here
    pass


def linear_layer_gradients(X: np.ndarray, W: np.ndarray, b: np.ndarray,
                           grad_output: np.ndarray) -> dict:
    """
    Compute gradients for a linear layer: Y = X @ W + b

    Args:
        X: Input (batch, in_features)
        W: Weights (in_features, out_features)
        b: Bias (out_features,)
        grad_output: Gradient from next layer (batch, out_features)

    Returns:
        Dictionary with gradients for X, W, and b
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Simple gradient",input:'compute_gradients(2.0)["grad"]',expected:"7.0",hidden:!1},{id:"2",description:"Forward pass result",input:'compute_gradients(2.0)["y"]',expected:"11.0",hidden:!1}],hints:["For y = x + 3x + 1, dy/dx = 2x + 3","For Y = X @ W + b: dL/dW = X.T @ grad_output","dL/dX = grad_output @ W.T","dL/db = sum(grad_output, axis=0)"],solution:`import numpy as np

def compute_gradients(x: float) -> dict:
    # Forward pass
    y = x ** 2 + 3 * x + 1

    # Backward pass (analytical gradient)
    grad = 2 * x + 3

    return {'y': y, 'grad': grad}


def linear_layer_gradients(X: np.ndarray, W: np.ndarray, b: np.ndarray,
                           grad_output: np.ndarray) -> dict:
    # Forward: Y = X @ W + b

    # Backward:
    # dL/dW = X.T @ grad_output
    grad_W = X.T @ grad_output

    # dL/db = sum of grad_output over batch
    grad_b = grad_output.sum(axis=0)

    # dL/dX = grad_output @ W.T
    grad_X = grad_output @ W.T

    return {
        'grad_W': grad_W,
        'grad_b': grad_b,
        'grad_X': grad_X
    }
`},{id:"nn-modules",title:"Neural Network Modules",section:"pytorch-basics",difficulty:"medium",description:`
## Neural Network Modules

Implement PyTorch-style nn.Module patterns in NumPy.

### Module Pattern
\`\`\`python
class Linear:
    def __init__(self, in_features, out_features):
        self.W = np.random.randn(in_features, out_features) * 0.01
        self.b = np.zeros(out_features)

    def forward(self, x):
        return x @ self.W + self.b

    def parameters(self):
        return [self.W, self.b]
\`\`\`

### Task
Implement Linear and ReLU modules with forward method.
    `,examples:[{input:"Linear(10, 5).forward(x)",output:"Output of shape (batch, 5)",explanation:"Linear transformation"}],starterCode:`import numpy as np

class Linear:
    """Linear layer: Y = X @ W + b"""

    def __init__(self, in_features: int, out_features: int):
        # Initialize weights with small random values
        # Your code here
        pass

    def forward(self, x: np.ndarray) -> np.ndarray:
        # Your code here
        pass

    def parameters(self):
        # Return list of parameters
        pass


class ReLU:
    """ReLU activation: max(0, x)"""

    def forward(self, x: np.ndarray) -> np.ndarray:
        # Your code here
        pass


class Sequential:
    """Container for sequential layers"""

    def __init__(self, *layers):
        self.layers = layers

    def forward(self, x: np.ndarray) -> np.ndarray:
        # Your code here
        pass


def create_mlp(input_dim: int, hidden_dim: int, output_dim: int):
    """Create a 2-layer MLP: Linear -> ReLU -> Linear"""
    # Your code here
    pass
`,testCases:[{id:"1",description:"Linear output shape",input:"Linear(10, 5).forward(np.random.randn(4, 10)).shape",expected:"(4, 5)",hidden:!1},{id:"2",description:"Sequential forward",input:"create_mlp(10, 20, 5).forward(np.random.randn(4, 10)).shape",expected:"(4, 5)",hidden:!1}],hints:["Initialize W with np.random.randn() * 0.01","ReLU: np.maximum(0, x)","Sequential applies layers in order"],solution:`import numpy as np

class Linear:
    def __init__(self, in_features: int, out_features: int):
        self.W = np.random.randn(in_features, out_features) * 0.01
        self.b = np.zeros(out_features)

    def forward(self, x: np.ndarray) -> np.ndarray:
        return x @ self.W + self.b

    def parameters(self):
        return [self.W, self.b]


class ReLU:
    def forward(self, x: np.ndarray) -> np.ndarray:
        return np.maximum(0, x)


class Sequential:
    def __init__(self, *layers):
        self.layers = layers

    def forward(self, x: np.ndarray) -> np.ndarray:
        for layer in self.layers:
            x = layer.forward(x)
        return x


def create_mlp(input_dim: int, hidden_dim: int, output_dim: int):
    return Sequential(
        Linear(input_dim, hidden_dim),
        ReLU(),
        Linear(hidden_dim, output_dim)
    )
`},{id:"loss-functions",title:"Loss Functions",section:"pytorch-basics",difficulty:"medium",description:`
## Common Loss Functions

Implement loss functions used in deep learning.

### Cross-Entropy Loss
\`\`\`
L = -sum(y * log(softmax(logits)))
\`\`\`

### MSE Loss
\`\`\`
L = mean((y_pred - y_true))
\`\`\`

### Binary Cross-Entropy
\`\`\`
L = -mean(y * log(p) + (1-y) * log(1-p))
\`\`\`

### Task
Implement these loss functions with numerical stability.
    `,examples:[{input:"cross_entropy(logits, targets)",output:"Scalar loss value",explanation:"Cross-entropy for classification"}],starterCode:`import numpy as np

def softmax(x: np.ndarray) -> np.ndarray:
    """Numerically stable softmax."""
    # Your code here
    pass


def cross_entropy_loss(logits: np.ndarray, targets: np.ndarray) -> float:
    """
    Cross-entropy loss for classification.

    Args:
        logits: Raw scores (batch, num_classes)
        targets: Integer class labels (batch,)

    Returns:
        Scalar loss
    """
    # Your code here
    pass


def mse_loss(y_pred: np.ndarray, y_true: np.ndarray) -> float:
    """Mean squared error loss."""
    # Your code here
    pass


def binary_cross_entropy(y_pred: np.ndarray, y_true: np.ndarray) -> float:
    """Binary cross-entropy with numerical stability."""
    # Your code here
    pass
`,testCases:[{id:"1",description:"Cross-entropy computation",input:"round(cross_entropy_loss(np.array([[2.0, 1.0, 0.1]]), np.array([0])), 4)",expected:"0.417",hidden:!1},{id:"2",description:"MSE computation",input:"mse_loss(np.array([1.0, 2.0, 3.0]), np.array([1.0, 2.0, 4.0]))",expected:"0.333333",hidden:!1}],hints:["Softmax: exp(x - max(x)) / sum(exp(x - max(x)))","Use np.clip for numerical stability in log","Index logits with targets for cross-entropy"],solution:`import numpy as np

def softmax(x: np.ndarray) -> np.ndarray:
    exp_x = np.exp(x - np.max(x, axis=-1, keepdims=True))
    return exp_x / np.sum(exp_x, axis=-1, keepdims=True)


def cross_entropy_loss(logits: np.ndarray, targets: np.ndarray) -> float:
    batch_size = logits.shape[0]
    probs = softmax(logits)

    # Clip for numerical stability
    probs = np.clip(probs, 1e-15, 1 - 1e-15)

    # Select probability of correct class for each sample
    correct_probs = probs[np.arange(batch_size), targets]

    # Negative log likelihood
    loss = -np.mean(np.log(correct_probs))
    return loss


def mse_loss(y_pred: np.ndarray, y_true: np.ndarray) -> float:
    return np.mean((y_pred - y_true) ** 2)


def binary_cross_entropy(y_pred: np.ndarray, y_true: np.ndarray) -> float:
    y_pred = np.clip(y_pred, 1e-15, 1 - 1e-15)
    return -np.mean(y_true * np.log(y_pred) + (1 - y_true) * np.log(1 - y_pred))
`}],z6=[{id:"e2e-mlp",title:"E2E: 2-Layer MLP with Backprop",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End 2-Layer MLP

Implement a complete 2-layer MLP with forward pass, backward pass, and training loop.

### Architecture
\`\`\`
Input (batch, input_dim)
  
Linear(input_dim, hidden_dim) + ReLU
  
Linear(hidden_dim, output_dim)
  
Softmax + Cross-Entropy Loss
\`\`\`

### Forward Pass
\`\`\`python
h = relu(X @ W1 + b1)
logits = h @ W2 + b2
loss = cross_entropy(softmax(logits), y)
\`\`\`

### Backward Pass (Chain Rule)
\`\`\`python
# Output layer
d_logits = softmax(logits) - y_onehot  # (batch, output_dim)
d_W2 = h.T @ d_logits
d_b2 = d_logits.sum(axis=0)

# Hidden layer
d_h = d_logits @ W2.T
d_relu = d_h * (h > 0)  # ReLU derivative
d_W1 = X.T @ d_relu
d_b1 = d_relu.sum(axis=0)
\`\`\`

### Task
Implement forward, backward, and training step.
    `,examples:[{input:"MLP(784, 128, 10) on MNIST-like data",output:"Trained model with decreasing loss",explanation:"Full training loop"}],starterCode:`import numpy as np

class MLP:
    def __init__(self, input_dim: int, hidden_dim: int, output_dim: int):
        """Initialize 2-layer MLP with random weights."""
        np.random.seed(42)
        # Xavier initialization
        self.W1 = np.random.randn(input_dim, hidden_dim) * np.sqrt(2.0 / input_dim)
        self.b1 = np.zeros(hidden_dim)
        self.W2 = np.random.randn(hidden_dim, output_dim) * np.sqrt(2.0 / hidden_dim)
        self.b2 = np.zeros(output_dim)

        # Cache for backward pass
        self.cache = {}

    def relu(self, x):
        return np.maximum(0, x)

    def softmax(self, x):
        exp_x = np.exp(x - np.max(x, axis=-1, keepdims=True))
        return exp_x / np.sum(exp_x, axis=-1, keepdims=True)

    def forward(self, X: np.ndarray) -> np.ndarray:
        """
        Forward pass.

        Args:
            X: Input (batch, input_dim)

        Returns:
            logits: Output (batch, output_dim)
        """
        # Your code here
        pass

    def compute_loss(self, logits: np.ndarray, y: np.ndarray) -> float:
        """
        Compute cross-entropy loss.

        Args:
            logits: Model output (batch, output_dim)
            y: True labels (batch,) as integers

        Returns:
            loss: Scalar loss value
        """
        # Your code here
        pass

    def backward(self, y: np.ndarray) -> dict:
        """
        Backward pass.

        Args:
            y: True labels (batch,) as integers

        Returns:
            gradients: Dictionary with dW1, db1, dW2, db2
        """
        # Your code here
        pass

    def train_step(self, X: np.ndarray, y: np.ndarray, lr: float = 0.01) -> float:
        """
        Single training step: forward, loss, backward, update.

        Returns:
            loss: Loss value before update
        """
        # Your code here
        pass


def train_mlp(X_train, y_train, epochs=100, lr=0.01):
    """Train MLP and return loss history."""
    # Your code here
    pass
`,testCases:[{id:"1",description:"Forward pass shape",input:"MLP(784, 128, 10).forward(np.random.randn(4, 784)).shape",expected:"(4, 10)",hidden:!1},{id:"2",description:"Loss decreases",input:"(lambda: (m := MLP(10, 8, 3), X := np.random.randn(16, 10), y := np.array([0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0]), losses := [m.train_step(X, y) for _ in range(50)], losses[-1] < losses[0])[-1])()",expected:"True",hidden:!1},{id:"3",description:"Gradients computed",input:'(lambda: (m := MLP(10, 8, 3), X := np.random.randn(4, 10), y := np.array([0,1,2,0]), _ := m.forward(X), _ := m.compute_loss(m.cache["logits"], y), g := m.backward(y), all(k in g for k in ["dW1", "db1", "dW2", "db2"]))[-1])()',expected:"True",hidden:!0}],hints:["Cache X, h (hidden activations), and logits in forward pass","d_logits = probs - y_onehot (softmax gradient combined with cross-entropy)","ReLU gradient: 1 if x > 0, else 0","Update: W = W - lr * dW"],solution:`import numpy as np

class MLP:
    def __init__(self, input_dim: int, hidden_dim: int, output_dim: int):
        np.random.seed(42)
        self.W1 = np.random.randn(input_dim, hidden_dim) * np.sqrt(2.0 / input_dim)
        self.b1 = np.zeros(hidden_dim)
        self.W2 = np.random.randn(hidden_dim, output_dim) * np.sqrt(2.0 / hidden_dim)
        self.b2 = np.zeros(output_dim)
        self.cache = {}

    def relu(self, x):
        return np.maximum(0, x)

    def softmax(self, x):
        exp_x = np.exp(x - np.max(x, axis=-1, keepdims=True))
        return exp_x / np.sum(exp_x, axis=-1, keepdims=True)

    def forward(self, X: np.ndarray) -> np.ndarray:
        # Layer 1: Linear + ReLU
        z1 = X @ self.W1 + self.b1
        h = self.relu(z1)

        # Layer 2: Linear
        logits = h @ self.W2 + self.b2

        # Cache for backward
        self.cache = {'X': X, 'z1': z1, 'h': h, 'logits': logits}

        return logits

    def compute_loss(self, logits: np.ndarray, y: np.ndarray) -> float:
        probs = self.softmax(logits)
        batch_size = logits.shape[0]
        correct_probs = probs[np.arange(batch_size), y]
        loss = -np.mean(np.log(np.clip(correct_probs, 1e-15, 1)))
        self.cache['probs'] = probs
        return loss

    def backward(self, y: np.ndarray) -> dict:
        X = self.cache['X']
        h = self.cache['h']
        z1 = self.cache['z1']
        probs = self.cache['probs']
        batch_size = X.shape[0]

        # One-hot encode targets
        y_onehot = np.zeros_like(probs)
        y_onehot[np.arange(batch_size), y] = 1

        # Output layer gradients
        d_logits = (probs - y_onehot) / batch_size
        dW2 = h.T @ d_logits
        db2 = d_logits.sum(axis=0)

        # Hidden layer gradients
        d_h = d_logits @ self.W2.T
        d_relu = d_h * (z1 > 0)  # ReLU derivative
        dW1 = X.T @ d_relu
        db1 = d_relu.sum(axis=0)

        return {'dW1': dW1, 'db1': db1, 'dW2': dW2, 'db2': db2}

    def train_step(self, X: np.ndarray, y: np.ndarray, lr: float = 0.01) -> float:
        logits = self.forward(X)
        loss = self.compute_loss(logits, y)
        grads = self.backward(y)

        # Update weights
        self.W1 -= lr * grads['dW1']
        self.b1 -= lr * grads['db1']
        self.W2 -= lr * grads['dW2']
        self.b2 -= lr * grads['db2']

        return loss


def train_mlp(X_train, y_train, epochs=100, lr=0.01):
    input_dim = X_train.shape[1]
    output_dim = len(np.unique(y_train))
    model = MLP(input_dim, 64, output_dim)

    losses = []
    for _ in range(epochs):
        loss = model.train_step(X_train, y_train, lr)
        losses.append(loss)

    return model, losses
`},{id:"e2e-transformer",title:"E2E: Transformer Encoder",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End Transformer Encoder

Implement a complete Transformer encoder block.

### Architecture
\`\`\`
Input Embeddings + Positional Encoding
  
Multi-Head Self-Attention
  
Add & LayerNorm (Residual)
  
Feed-Forward Network (FFN)
  
Add & LayerNorm (Residual)
  
Output
\`\`\`

### Components
1. **Positional Encoding**: Sinusoidal position embeddings
2. **Multi-Head Attention**: Parallel attention heads
3. **FFN**: Two linear layers with ReLU
4. **Layer Normalization**: Normalize across features
5. **Residual Connections**: Add input to output

### Task
Implement all components and combine into encoder block.
    `,examples:[{input:"TransformerEncoder(d_model=64, nhead=8, dim_ff=256)",output:"Encoded sequence (batch, seq_len, d_model)",explanation:"Complete encoder forward pass"}],starterCode:`import numpy as np

def softmax(x, axis=-1):
    exp_x = np.exp(x - np.max(x, axis=axis, keepdims=True))
    return exp_x / np.sum(exp_x, axis=axis, keepdims=True)


def layer_norm(x, gamma, beta, eps=1e-5):
    """Layer normalization."""
    # Your code here
    pass


def positional_encoding(seq_len, d_model):
    """Sinusoidal positional encoding."""
    # Your code here
    pass


def scaled_dot_product_attention(Q, K, V, mask=None):
    """Scaled dot-product attention."""
    # Your code here
    pass


def multi_head_attention(Q, K, V, num_heads):
    """Multi-head attention."""
    # Your code here
    pass


def feed_forward(x, W1, b1, W2, b2):
    """Position-wise feed-forward network: Linear -> ReLU -> Linear"""
    # Your code here
    pass


class TransformerEncoderBlock:
    def __init__(self, d_model: int, num_heads: int, d_ff: int):
        """
        Initialize transformer encoder block.

        Args:
            d_model: Model dimension
            num_heads: Number of attention heads
            d_ff: Feed-forward hidden dimension
        """
        np.random.seed(42)
        self.d_model = d_model
        self.num_heads = num_heads

        # Initialize weights
        # Your code here
        pass

    def forward(self, x: np.ndarray) -> np.ndarray:
        """
        Forward pass through encoder block.

        Args:
            x: Input (batch, seq_len, d_model)

        Returns:
            output: (batch, seq_len, d_model)
        """
        # Your code here
        pass


def transformer_encoder(x, num_layers=2, d_model=64, num_heads=8, d_ff=256):
    """Stack multiple encoder blocks."""
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape preserved",input:"transformer_encoder(np.random.randn(2, 10, 64), num_layers=2, d_model=64, num_heads=8, d_ff=256).shape",expected:"(2, 10, 64)",hidden:!1},{id:"2",description:"Attention weights sum to 1",input:"(lambda: (Q := np.random.randn(2, 5, 64), K := np.random.randn(2, 5, 64), V := np.random.randn(2, 5, 64), out_attn := scaled_dot_product_attention(Q, K, V), bool(np.allclose(out_attn[1].sum(axis=-1), 1.0)))[-1])()",expected:"True",hidden:!1}],hints:["Attention: softmax(QK^T / sqrt(d_k)) @ V","Layer norm: (x - mean) / sqrt(var + eps) * gamma + beta","Residual: output = LayerNorm(x + Sublayer(x))","FFN: max(0, xW1 + b1)W2 + b2"],solution:`import numpy as np

def softmax(x, axis=-1):
    exp_x = np.exp(x - np.max(x, axis=axis, keepdims=True))
    return exp_x / np.sum(exp_x, axis=axis, keepdims=True)


def layer_norm(x, gamma, beta, eps=1e-5):
    mean = np.mean(x, axis=-1, keepdims=True)
    var = np.var(x, axis=-1, keepdims=True)
    return gamma * (x - mean) / np.sqrt(var + eps) + beta


def positional_encoding(seq_len, d_model):
    PE = np.zeros((seq_len, d_model))
    position = np.arange(seq_len)[:, np.newaxis]
    div_term = np.exp(np.arange(0, d_model, 2) * (-np.log(10000.0) / d_model))
    PE[:, 0::2] = np.sin(position * div_term)
    PE[:, 1::2] = np.cos(position * div_term)
    return PE


def scaled_dot_product_attention(Q, K, V, mask=None):
    d_k = Q.shape[-1]
    scores = Q @ K.transpose(0, 2, 1) / np.sqrt(d_k)
    if mask is not None:
        scores = scores + mask
    attention = softmax(scores, axis=-1)
    return attention @ V, attention


def multi_head_attention(Q, K, V, num_heads):
    batch, seq_len, d_model = Q.shape
    d_k = d_model // num_heads

    Q = Q.reshape(batch, seq_len, num_heads, d_k).transpose(0, 2, 1, 3)
    K = K.reshape(batch, seq_len, num_heads, d_k).transpose(0, 2, 1, 3)
    V = V.reshape(batch, seq_len, num_heads, d_k).transpose(0, 2, 1, 3)

    d_k = Q.shape[-1]
    scores = np.einsum('bhqd,bhkd->bhqk', Q, K) / np.sqrt(d_k)
    attention = softmax(scores, axis=-1)
    output = np.einsum('bhqk,bhkd->bhqd', attention, V)

    output = output.transpose(0, 2, 1, 3).reshape(batch, seq_len, d_model)
    return output


def feed_forward(x, W1, b1, W2, b2):
    hidden = np.maximum(0, x @ W1 + b1)
    return hidden @ W2 + b2


class TransformerEncoderBlock:
    def __init__(self, d_model: int, num_heads: int, d_ff: int):
        np.random.seed(42)
        self.d_model = d_model
        self.num_heads = num_heads

        # Layer norm parameters
        self.ln1_gamma = np.ones(d_model)
        self.ln1_beta = np.zeros(d_model)
        self.ln2_gamma = np.ones(d_model)
        self.ln2_beta = np.zeros(d_model)

        # FFN parameters
        self.W1 = np.random.randn(d_model, d_ff) * 0.02
        self.b1 = np.zeros(d_ff)
        self.W2 = np.random.randn(d_ff, d_model) * 0.02
        self.b2 = np.zeros(d_model)

    def forward(self, x: np.ndarray) -> np.ndarray:
        # Multi-head self-attention + residual + layer norm
        attn_output = multi_head_attention(x, x, x, self.num_heads)
        x = layer_norm(x + attn_output, self.ln1_gamma, self.ln1_beta)

        # Feed-forward + residual + layer norm
        ff_output = feed_forward(x, self.W1, self.b1, self.W2, self.b2)
        x = layer_norm(x + ff_output, self.ln2_gamma, self.ln2_beta)

        return x


def transformer_encoder(x, num_layers=2, d_model=64, num_heads=8, d_ff=256):
    batch, seq_len, _ = x.shape

    # Add positional encoding
    PE = positional_encoding(seq_len, d_model)
    x = x + PE

    # Stack encoder blocks
    for _ in range(num_layers):
        block = TransformerEncoderBlock(d_model, num_heads, d_ff)
        x = block.forward(x)

    return x
`},{id:"e2e-vae",title:"E2E: Variational Autoencoder",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End Variational Autoencoder

Implement a complete VAE with encoder, decoder, reparameterization, and ELBO loss.

### Architecture
\`\`\`
Encoder: x  h  (, log_)
         
Reparameterization: z =  +  * ,  ~ N(0,1)
         
Decoder: z  h  x_reconstructed
\`\`\`

### Loss (ELBO)
\`\`\`
L = Reconstruction Loss + KL Divergence
L = ||x - x_hat|| + KL(q(z|x) || p(z))
KL = -0.5 * sum(1 + log_var -  - exp(log_var))
\`\`\`

### Task
Implement encoder, decoder, reparameterization trick, and loss computation.
    `,examples:[{input:"VAE(input_dim=784, latent_dim=20)",output:"Reconstructed images + latent samples",explanation:"Full VAE forward pass"}],starterCode:`import numpy as np

class VAE:
    def __init__(self, input_dim: int, hidden_dim: int, latent_dim: int):
        """
        Initialize VAE.

        Args:
            input_dim: Input dimension (e.g., 784 for MNIST)
            hidden_dim: Hidden layer dimension
            latent_dim: Latent space dimension
        """
        np.random.seed(42)

        # Encoder weights
        self.W_enc = np.random.randn(input_dim, hidden_dim) * 0.01
        self.b_enc = np.zeros(hidden_dim)

        # Latent space (mean and log variance)
        self.W_mu = np.random.randn(hidden_dim, latent_dim) * 0.01
        self.b_mu = np.zeros(latent_dim)
        self.W_logvar = np.random.randn(hidden_dim, latent_dim) * 0.01
        self.b_logvar = np.zeros(latent_dim)

        # Decoder weights
        self.W_dec1 = np.random.randn(latent_dim, hidden_dim) * 0.01
        self.b_dec1 = np.zeros(hidden_dim)
        self.W_dec2 = np.random.randn(hidden_dim, input_dim) * 0.01
        self.b_dec2 = np.zeros(input_dim)

        self.latent_dim = latent_dim

    def encode(self, x: np.ndarray) -> tuple:
        """
        Encode input to latent distribution parameters.

        Returns:
            mu: Mean of latent distribution
            log_var: Log variance of latent distribution
        """
        # Your code here
        pass

    def reparameterize(self, mu: np.ndarray, log_var: np.ndarray) -> np.ndarray:
        """
        Reparameterization trick: z = mu + std * epsilon
        """
        # Your code here
        pass

    def decode(self, z: np.ndarray) -> np.ndarray:
        """
        Decode latent vector to reconstruction.
        """
        # Your code here
        pass

    def forward(self, x: np.ndarray) -> dict:
        """
        Full forward pass.

        Returns:
            Dictionary with mu, log_var, z, x_reconstructed
        """
        # Your code here
        pass

    def compute_loss(self, x: np.ndarray, x_recon: np.ndarray,
                     mu: np.ndarray, log_var: np.ndarray) -> dict:
        """
        Compute VAE loss (ELBO).

        Returns:
            Dictionary with total_loss, recon_loss, kl_loss
        """
        # Your code here
        pass

    def sample(self, num_samples: int) -> np.ndarray:
        """
        Generate samples by decoding random latent vectors.
        """
        # Your code here
        pass
`,testCases:[{id:"1",description:"Reconstruction shape",input:'VAE(784, 256, 20).forward(np.random.randn(4, 784))["x_recon"].shape',expected:"(4, 784)",hidden:!1},{id:"2",description:"KL divergence non-negative",input:'(lambda: (vae := VAE(784, 256, 20), x := np.random.randn(4, 784), out := vae.forward(x), loss := vae.compute_loss(x, out["x_recon"], out["mu"], out["log_var"]), bool(loss["kl_loss"] >= 0))[-1])()',expected:"True",hidden:!1}],hints:["Encoder: h = relu(x @ W + b), then mu = h @ W_mu, logvar = h @ W_logvar","Reparameterize: std = exp(0.5 * log_var), z = mu + std * epsilon","KL = -0.5 * mean(1 + log_var - mu - exp(log_var))","Reconstruction loss: MSE or BCE"],solution:`import numpy as np

class VAE:
    def __init__(self, input_dim: int, hidden_dim: int, latent_dim: int):
        np.random.seed(42)

        self.W_enc = np.random.randn(input_dim, hidden_dim) * 0.01
        self.b_enc = np.zeros(hidden_dim)
        self.W_mu = np.random.randn(hidden_dim, latent_dim) * 0.01
        self.b_mu = np.zeros(latent_dim)
        self.W_logvar = np.random.randn(hidden_dim, latent_dim) * 0.01
        self.b_logvar = np.zeros(latent_dim)
        self.W_dec1 = np.random.randn(latent_dim, hidden_dim) * 0.01
        self.b_dec1 = np.zeros(hidden_dim)
        self.W_dec2 = np.random.randn(hidden_dim, input_dim) * 0.01
        self.b_dec2 = np.zeros(input_dim)
        self.latent_dim = latent_dim

    def encode(self, x: np.ndarray) -> tuple:
        h = np.maximum(0, x @ self.W_enc + self.b_enc)
        mu = h @ self.W_mu + self.b_mu
        log_var = h @ self.W_logvar + self.b_logvar
        return mu, log_var

    def reparameterize(self, mu: np.ndarray, log_var: np.ndarray) -> np.ndarray:
        std = np.exp(0.5 * log_var)
        eps = np.random.randn(*mu.shape)
        return mu + std * eps

    def decode(self, z: np.ndarray) -> np.ndarray:
        h = np.maximum(0, z @ self.W_dec1 + self.b_dec1)
        x_recon = 1 / (1 + np.exp(-(h @ self.W_dec2 + self.b_dec2)))  # Sigmoid
        return x_recon

    def forward(self, x: np.ndarray) -> dict:
        mu, log_var = self.encode(x)
        z = self.reparameterize(mu, log_var)
        x_recon = self.decode(z)
        return {'mu': mu, 'log_var': log_var, 'z': z, 'x_recon': x_recon}

    def compute_loss(self, x: np.ndarray, x_recon: np.ndarray,
                     mu: np.ndarray, log_var: np.ndarray) -> dict:
        # Reconstruction loss (MSE)
        recon_loss = np.mean((x - x_recon) ** 2)

        # KL divergence
        kl_loss = -0.5 * np.mean(1 + log_var - mu**2 - np.exp(log_var))

        total_loss = recon_loss + kl_loss

        return {'total_loss': total_loss, 'recon_loss': recon_loss, 'kl_loss': kl_loss}

    def sample(self, num_samples: int) -> np.ndarray:
        z = np.random.randn(num_samples, self.latent_dim)
        return self.decode(z)
`},{id:"e2e-vqvae",title:"E2E: Vector Quantized VAE",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End VQ-VAE

Implement a complete VQ-VAE (Vector Quantized Variational Autoencoder) with encoder, vector quantization, and decoder.

### Architecture
\`\`\`
Encoder: x  z_e (continuous latents)
           
Vector Quantization: z_e  z_q (discrete latents from codebook)
           
Decoder: z_q  x_reconstructed
\`\`\`

### Key Difference from VAE
- VAE: Continuous latent space with KL regularization
- VQ-VAE: Discrete latent space using learned codebook

### Vector Quantization
1. Encoder outputs continuous vectors z_e
2. Find nearest codebook entry for each spatial position
3. Replace z_e with quantized z_q from codebook
4. Use straight-through estimator for gradients

### Loss Function
\`\`\`
L = L_reconstruction + L_codebook +  * L_commitment

L_reconstruction = ||x - x_hat||
L_codebook = ||sg[z_e] - e||  (moves codebook toward encoder output)
L_commitment = ||z_e - sg[e]||  (commits encoder to codebook)
\`\`\`
Where sg[] is stop-gradient.

### Codebook EMA Update (Alternative)
Instead of gradient updates, codebook can be updated with exponential moving average:
\`\`\`
N_i =  * N_i + (1 - ) * n_i     (count of assignments)
m_i =  * m_i + (1 - ) * sum(z_e assigned to i)
e_i = m_i / N_i
\`\`\`

### Task
Implement encoder, vector quantization layer, decoder, and all loss components.
    `,examples:[{input:"VQVAE(input_dim=784, num_embeddings=512, embedding_dim=64)",output:"Reconstructed images + discrete codes",explanation:"Full VQ-VAE forward pass"}],starterCode:`import numpy as np

class VectorQuantizer:
    def __init__(self, num_embeddings: int, embedding_dim: int):
        """
        Vector Quantization layer.

        Args:
            num_embeddings: Size of codebook (K)
            embedding_dim: Dimension of each embedding
        """
        np.random.seed(42)
        # Initialize codebook with small random values
        self.embedding = np.random.randn(num_embeddings, embedding_dim) * 0.1
        self.num_embeddings = num_embeddings
        self.embedding_dim = embedding_dim

    def quantize(self, z_e: np.ndarray) -> tuple:
        """
        Quantize encoder output to nearest codebook entries.

        Args:
            z_e: Encoder output (batch, height, width, embedding_dim)

        Returns:
            z_q: Quantized vectors (same shape as z_e)
            indices: Codebook indices (batch, height, width)
            distances: Distances to nearest embeddings
        """
        # Your code here
        pass

    def compute_loss(self, z_e: np.ndarray, z_q: np.ndarray, beta: float = 0.25) -> dict:
        """
        Compute VQ losses.

        Args:
            z_e: Encoder output
            z_q: Quantized vectors
            beta: Commitment loss weight

        Returns:
            Dictionary with codebook_loss and commitment_loss
        """
        # Your code here
        pass


class VQVAE:
    def __init__(self, input_channels: int, hidden_dim: int,
                 num_embeddings: int, embedding_dim: int):
        """
        Initialize VQ-VAE.

        Args:
            input_channels: Number of input channels
            hidden_dim: Hidden layer dimension
            num_embeddings: Codebook size
            embedding_dim: Embedding dimension
        """
        np.random.seed(42)

        # Encoder: conv layers to get spatial feature maps
        self.enc_conv1_w = np.random.randn(hidden_dim, input_channels, 4, 4) * 0.1
        self.enc_conv1_b = np.zeros(hidden_dim)
        self.enc_conv2_w = np.random.randn(embedding_dim, hidden_dim, 4, 4) * 0.1
        self.enc_conv2_b = np.zeros(embedding_dim)

        # Vector Quantizer
        self.vq = VectorQuantizer(num_embeddings, embedding_dim)

        # Decoder: transposed conv to reconstruct
        self.dec_conv1_w = np.random.randn(hidden_dim, embedding_dim, 4, 4) * 0.1
        self.dec_conv1_b = np.zeros(hidden_dim)
        self.dec_conv2_w = np.random.randn(input_channels, hidden_dim, 4, 4) * 0.1
        self.dec_conv2_b = np.zeros(input_channels)

        self.embedding_dim = embedding_dim

    def encode(self, x: np.ndarray) -> np.ndarray:
        """
        Encode input to continuous latent representation.

        Args:
            x: Input (batch, channels, height, width)

        Returns:
            z_e: Encoder output (batch, height', width', embedding_dim)
        """
        # Your code here (simplified: use strided conv or just reshape for demo)
        pass

    def decode(self, z_q: np.ndarray) -> np.ndarray:
        """
        Decode quantized latents to reconstruction.

        Args:
            z_q: Quantized vectors (batch, height, width, embedding_dim)

        Returns:
            x_recon: Reconstructed input
        """
        # Your code here
        pass

    def forward(self, x: np.ndarray) -> dict:
        """
        Full forward pass.

        Returns:
            Dictionary with z_e, z_q, indices, x_recon
        """
        # Your code here
        pass

    def compute_loss(self, x: np.ndarray, x_recon: np.ndarray,
                     z_e: np.ndarray, z_q: np.ndarray, beta: float = 0.25) -> dict:
        """
        Compute total VQ-VAE loss.

        Returns:
            Dictionary with total_loss, recon_loss, vq_loss, commitment_loss
        """
        # Your code here
        pass

    def get_codebook_usage(self, indices: np.ndarray) -> np.ndarray:
        """
        Compute codebook usage statistics.

        Returns:
            usage: Count of each codebook entry used
        """
        # Your code here
        pass
`,testCases:[{id:"1",description:"Quantization shape",input:"(lambda: (vq := VectorQuantizer(512, 64), z_e := np.random.randn(2, 4, 4, 64), z_q, idx, dist := vq.quantize(z_e), z_q.shape == z_e.shape)[-1])()",expected:"True",hidden:!1},{id:"2",description:"Indices valid range",input:"(lambda: (vq := VectorQuantizer(512, 64), z_e := np.random.randn(2, 4, 4, 64), z_q, idx, dist := vq.quantize(z_e), bool(np.all(idx >= 0) and np.all(idx < 512)))[-1])()",expected:"True",hidden:!1},{id:"3",description:"Quantized from codebook",input:"(lambda: (vq := VectorQuantizer(512, 64), z_e := np.random.randn(2, 4, 4, 64), z_q, idx, dist := vq.quantize(z_e), bool(np.allclose(z_q[0, 0, 0], vq.embedding[idx[0, 0, 0]])))[-1])()",expected:"True",hidden:!0},{id:"4",description:"Loss values correct",input:'(lambda: (vq := VectorQuantizer(512, 64), z_e := np.random.randn(2, 4, 4, 64), z_q, idx, dist := vq.quantize(z_e), losses := vq.compute_loss(z_e, z_q), bool(losses["codebook_loss"] >= 0 and losses["commitment_loss"] >= 0))[-1])()',expected:"True",hidden:!0}],hints:["For quantization: flatten spatial dims, compute distances, find argmin","Distance: ||z - e|| = ||z|| + ||e|| - 2*ze","Straight-through: z_q = z_e + stop_grad(z_q - z_e)","Codebook loss uses z_e detached, commitment uses z_q detached","For simplified encoder/decoder, use reshape operations"],solution:`import numpy as np

class VectorQuantizer:
    def __init__(self, num_embeddings: int, embedding_dim: int):
        np.random.seed(42)
        self.embedding = np.random.randn(num_embeddings, embedding_dim) * 0.1
        self.num_embeddings = num_embeddings
        self.embedding_dim = embedding_dim

    def quantize(self, z_e: np.ndarray) -> tuple:
        # z_e: (batch, H, W, D)
        batch, H, W, D = z_e.shape

        # Flatten spatial dimensions
        z_flat = z_e.reshape(-1, D)  # (N, D) where N = batch * H * W

        # Compute distances: ||z - e|| = ||z|| + ||e|| - 2*ze
        z_sq = np.sum(z_flat ** 2, axis=1, keepdims=True)  # (N, 1)
        e_sq = np.sum(self.embedding ** 2, axis=1)          # (K,)
        cross = z_flat @ self.embedding.T                    # (N, K)
        distances = z_sq + e_sq - 2 * cross                  # (N, K)

        # Find nearest embedding
        indices_flat = np.argmin(distances, axis=1)          # (N,)

        # Get quantized vectors
        z_q_flat = self.embedding[indices_flat]              # (N, D)

        # Reshape back
        z_q = z_q_flat.reshape(batch, H, W, D)
        indices = indices_flat.reshape(batch, H, W)
        min_distances = np.min(distances, axis=1).reshape(batch, H, W)

        return z_q, indices, min_distances

    def compute_loss(self, z_e: np.ndarray, z_q: np.ndarray, beta: float = 0.25) -> dict:
        # Codebook loss: ||sg[z_e] - z_q||
        # In practice, this updates the codebook to move toward encoder output
        codebook_loss = np.mean((z_e - z_q) ** 2)

        # Commitment loss: ||z_e - sg[z_q]||
        # This commits the encoder output to stay close to codebook
        commitment_loss = beta * np.mean((z_e - z_q) ** 2)

        return {
            'codebook_loss': codebook_loss,
            'commitment_loss': commitment_loss
        }


class VQVAE:
    def __init__(self, input_channels: int, hidden_dim: int,
                 num_embeddings: int, embedding_dim: int):
        np.random.seed(42)

        self.input_channels = input_channels
        self.hidden_dim = hidden_dim
        self.embedding_dim = embedding_dim

        # Simplified: use linear projection instead of conv for demo
        # Encoder projects input to embedding space
        self.enc_w1 = np.random.randn(input_channels * 16, hidden_dim) * 0.1
        self.enc_b1 = np.zeros(hidden_dim)
        self.enc_w2 = np.random.randn(hidden_dim, embedding_dim) * 0.1
        self.enc_b2 = np.zeros(embedding_dim)

        # Vector Quantizer
        self.vq = VectorQuantizer(num_embeddings, embedding_dim)

        # Decoder projects back
        self.dec_w1 = np.random.randn(embedding_dim, hidden_dim) * 0.1
        self.dec_b1 = np.zeros(hidden_dim)
        self.dec_w2 = np.random.randn(hidden_dim, input_channels * 16) * 0.1
        self.dec_b2 = np.zeros(input_channels * 16)

    def encode(self, x: np.ndarray) -> np.ndarray:
        # x: (batch, channels, H, W) - assume H=W=4 for simplicity
        batch = x.shape[0]

        # Flatten spatial dimensions
        x_flat = x.reshape(batch, -1)  # (batch, channels * H * W)

        # Encode
        h = np.maximum(0, x_flat @ self.enc_w1 + self.enc_b1)  # ReLU
        z_e = x_flat @ self.enc_w1[:, :self.embedding_dim] + self.enc_b1[:self.embedding_dim]

        # Reshape to spatial format (batch, 2, 2, embedding_dim)
        z_e = z_e.reshape(batch, 1, 1, self.embedding_dim)

        return z_e

    def decode(self, z_q: np.ndarray) -> np.ndarray:
        batch = z_q.shape[0]

        # Flatten
        z_flat = z_q.reshape(batch, -1)  # (batch, embedding_dim)

        # Decode
        h = np.maximum(0, z_flat @ self.dec_w1 + self.dec_b1)  # ReLU
        x_recon = h @ self.dec_w2 + self.dec_b2

        # Reshape to image format
        x_recon = x_recon.reshape(batch, self.input_channels, 4, 4)

        return x_recon

    def forward(self, x: np.ndarray) -> dict:
        # Encode
        z_e = self.encode(x)

        # Quantize
        z_q, indices, distances = self.vq.quantize(z_e)

        # Straight-through estimator: gradient flows through z_q to z_e
        # z_q_st = z_e + (z_q - z_e).detach()
        # For forward pass, we just use z_q

        # Decode
        x_recon = self.decode(z_q)

        return {
            'z_e': z_e,
            'z_q': z_q,
            'indices': indices,
            'x_recon': x_recon
        }

    def compute_loss(self, x: np.ndarray, x_recon: np.ndarray,
                     z_e: np.ndarray, z_q: np.ndarray, beta: float = 0.25) -> dict:
        # Reconstruction loss
        recon_loss = np.mean((x - x_recon) ** 2)

        # VQ losses
        vq_losses = self.vq.compute_loss(z_e, z_q, beta)

        # Total loss
        total_loss = recon_loss + vq_losses['codebook_loss'] + vq_losses['commitment_loss']

        return {
            'total_loss': total_loss,
            'recon_loss': recon_loss,
            'codebook_loss': vq_losses['codebook_loss'],
            'commitment_loss': vq_losses['commitment_loss']
        }

    def get_codebook_usage(self, indices: np.ndarray) -> np.ndarray:
        usage = np.bincount(indices.flatten(), minlength=self.vq.num_embeddings)
        return usage
`},{id:"e2e-diffusion",title:"E2E: Diffusion Model",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End Diffusion Model

Implement core components of a diffusion model (DDPM-style).

### Forward Process (Adding Noise)
\`\`\`
x_t = sqrt(_bar_t) * x_0 + sqrt(1 - _bar_t) * 
\`\`\`

### Noise Schedule
\`\`\`
_t: Linear from _start to _end
_t = 1 - _t
_bar_t = cumulative product of _t
\`\`\`

### Training Objective
\`\`\`
L = || - _(x_t, t)||
\`\`\`

Model learns to predict the noise added at timestep t.

### Reverse Process (Sampling)
\`\`\`
x_{t-1} = (1/sqrt(_t)) * (x_t - (_t/sqrt(1-_bar_t)) * _(x_t, t)) + _t * z
\`\`\`

### Task
Implement noise schedule, forward process, and reverse sampling.
    `,examples:[{input:"DiffusionModel(T=1000)",output:"Denoised samples",explanation:"Forward and reverse diffusion"}],starterCode:`import numpy as np

class DiffusionModel:
    def __init__(self, T: int = 1000, beta_start: float = 0.0001, beta_end: float = 0.02):
        """
        Initialize diffusion model.

        Args:
            T: Number of diffusion timesteps
            beta_start: Starting noise level
            beta_end: Ending noise level
        """
        self.T = T

        # Compute noise schedule
        # Your code here
        pass

    def get_noise_schedule(self) -> dict:
        """Return computed noise schedule parameters."""
        # Your code here
        pass

    def forward_diffusion(self, x_0: np.ndarray, t: int) -> tuple:
        """
        Add noise to data at timestep t.

        Args:
            x_0: Original data (batch, ...)
            t: Timestep

        Returns:
            x_t: Noisy data
            noise: The noise that was added
        """
        np.random.seed(42)
        # Your code here
        pass

    def reverse_step(self, x_t: np.ndarray, t: int, predicted_noise: np.ndarray) -> np.ndarray:
        """
        Single reverse diffusion step.

        Args:
            x_t: Noisy data at timestep t
            t: Current timestep
            predicted_noise: Noise predicted by model

        Returns:
            x_{t-1}: Less noisy data
        """
        # Your code here
        pass

    def compute_loss(self, true_noise: np.ndarray, predicted_noise: np.ndarray) -> float:
        """Compute MSE loss between true and predicted noise."""
        # Your code here
        pass

    def sample(self, shape: tuple, noise_predictor) -> np.ndarray:
        """
        Generate samples using reverse diffusion.

        Args:
            shape: Shape of samples to generate
            noise_predictor: Function that predicts noise given (x_t, t)

        Returns:
            Generated samples
        """
        # Your code here
        pass
`,testCases:[{id:"1",description:"Alpha bar decreases",input:'(lambda: (dm := DiffusionModel(1000), sched := dm.get_noise_schedule(), bool(sched["alpha_bars"][-1] < sched["alpha_bars"][0]))[-1])()',expected:"True",hidden:!1},{id:"2",description:"Forward noise shape",input:"(lambda: (dm := DiffusionModel(1000), x_0 := np.random.randn(4, 32), x_t, noise := dm.forward_diffusion(x_0, 500), x_t.shape == x_0.shape)[-1])()",expected:"True",hidden:!1}],hints:["betas = np.linspace(beta_start, beta_end, T)","alpha_bars = np.cumprod(1 - betas)","x_t = sqrt(alpha_bar) * x_0 + sqrt(1 - alpha_bar) * noise","Reverse: use mean and add small noise (except at t=0)"],solution:`import numpy as np

class DiffusionModel:
    def __init__(self, T: int = 1000, beta_start: float = 0.0001, beta_end: float = 0.02):
        self.T = T

        # Linear noise schedule
        self.betas = np.linspace(beta_start, beta_end, T)
        self.alphas = 1 - self.betas
        self.alpha_bars = np.cumprod(self.alphas)

        # For reverse process
        self.sqrt_alpha_bars = np.sqrt(self.alpha_bars)
        self.sqrt_one_minus_alpha_bars = np.sqrt(1 - self.alpha_bars)
        self.sqrt_alphas = np.sqrt(self.alphas)

    def get_noise_schedule(self) -> dict:
        return {
            'betas': self.betas,
            'alphas': self.alphas,
            'alpha_bars': self.alpha_bars
        }

    def forward_diffusion(self, x_0: np.ndarray, t: int) -> tuple:
        np.random.seed(42)
        noise = np.random.randn(*x_0.shape)

        sqrt_alpha_bar = self.sqrt_alpha_bars[t]
        sqrt_one_minus_alpha_bar = self.sqrt_one_minus_alpha_bars[t]

        x_t = sqrt_alpha_bar * x_0 + sqrt_one_minus_alpha_bar * noise

        return x_t, noise

    def reverse_step(self, x_t: np.ndarray, t: int, predicted_noise: np.ndarray) -> np.ndarray:
        alpha = self.alphas[t]
        alpha_bar = self.alpha_bars[t]
        beta = self.betas[t]

        # Mean of reverse distribution
        coef1 = 1 / np.sqrt(alpha)
        coef2 = beta / np.sqrt(1 - alpha_bar)
        mean = coef1 * (x_t - coef2 * predicted_noise)

        if t > 0:
            # Add noise (except at final step)
            sigma = np.sqrt(beta)
            noise = np.random.randn(*x_t.shape)
            x_prev = mean + sigma * noise
        else:
            x_prev = mean

        return x_prev

    def compute_loss(self, true_noise: np.ndarray, predicted_noise: np.ndarray) -> float:
        return np.mean((true_noise - predicted_noise) ** 2)

    def sample(self, shape: tuple, noise_predictor) -> np.ndarray:
        # Start from pure noise
        x = np.random.randn(*shape)

        # Reverse diffusion
        for t in reversed(range(self.T)):
            predicted_noise = noise_predictor(x, t)
            x = self.reverse_step(x, t, predicted_noise)

        return x
`},{id:"e2e-cnn",title:"E2E: Convolutional Neural Network",section:"e2e-implementations",difficulty:"hard",description:`
## End-to-End CNN

Implement a complete CNN for image classification.

### Architecture
\`\`\`
Input (batch, channels, height, width)
  
Conv2D(in_channels, 32, kernel=3) + ReLU
  
MaxPool2D(2x2)
  
Conv2D(32, 64, kernel=3) + ReLU
  
MaxPool2D(2x2)
  
Flatten
  
Linear(flattened_size, 128) + ReLU
  
Linear(128, num_classes)
  
Softmax
\`\`\`

### Components
- 2D Convolution (no padding for simplicity)
- Max Pooling
- Flatten
- Fully Connected layers

### Task
Implement conv2d, maxpool, and combine into CNN.
    `,examples:[{input:"CNN on 28x28 grayscale images",output:"Class probabilities",explanation:"Full CNN forward pass"}],starterCode:`import numpy as np

def conv2d(x: np.ndarray, kernel: np.ndarray, bias: np.ndarray) -> np.ndarray:
    """
    2D convolution (no padding, stride=1).

    Args:
        x: Input (batch, in_channels, height, width)
        kernel: Weights (out_channels, in_channels, kH, kW)
        bias: Bias (out_channels,)

    Returns:
        output: (batch, out_channels, out_height, out_width)
    """
    # Your code here
    pass


def maxpool2d(x: np.ndarray, pool_size: int = 2) -> np.ndarray:
    """
    2D max pooling.

    Args:
        x: Input (batch, channels, height, width)
        pool_size: Size of pooling window

    Returns:
        output: Pooled tensor
    """
    # Your code here
    pass


def flatten(x: np.ndarray) -> np.ndarray:
    """Flatten all dimensions except batch."""
    # Your code here
    pass


class CNN:
    def __init__(self, input_shape: tuple, num_classes: int):
        """
        Initialize CNN.

        Args:
            input_shape: (channels, height, width)
            num_classes: Number of output classes
        """
        np.random.seed(42)
        in_channels, H, W = input_shape

        # Conv layer 1: in_channels -> 32
        self.conv1_w = np.random.randn(32, in_channels, 3, 3) * 0.1
        self.conv1_b = np.zeros(32)

        # Conv layer 2: 32 -> 64
        self.conv2_w = np.random.randn(64, 32, 3, 3) * 0.1
        self.conv2_b = np.zeros(64)

        # Calculate flattened size after convolutions and pooling
        # Your code to compute this
        pass

        # Fully connected layers
        # Your code here
        pass

    def forward(self, x: np.ndarray) -> np.ndarray:
        """
        Forward pass through CNN.

        Args:
            x: Input images (batch, channels, height, width)

        Returns:
            logits: (batch, num_classes)
        """
        # Your code here
        pass


def test_cnn():
    """Test CNN with sample data."""
    # Your code here
    pass
`,testCases:[{id:"1",description:"Conv output shape",input:"conv2d(np.random.randn(2, 1, 8, 8), np.random.randn(32, 1, 3, 3), np.zeros(32)).shape",expected:"(2, 32, 6, 6)",hidden:!1},{id:"2",description:"Pool output shape",input:"maxpool2d(np.random.randn(2, 32, 8, 8), pool_size=2).shape",expected:"(2, 32, 4, 4)",hidden:!1}],hints:["Conv output size: (input - kernel + 1) for stride=1, no padding","Pool output size: input // pool_size","Use nested loops for convolution (or np.lib.stride_tricks)","Flatten: x.reshape(batch_size, -1)"],solution:`import numpy as np

def conv2d(x: np.ndarray, kernel: np.ndarray, bias: np.ndarray) -> np.ndarray:
    batch, in_ch, H, W = x.shape
    out_ch, _, kH, kW = kernel.shape
    out_H = H - kH + 1
    out_W = W - kW + 1

    output = np.zeros((batch, out_ch, out_H, out_W))

    for b in range(batch):
        for oc in range(out_ch):
            for i in range(out_H):
                for j in range(out_W):
                    receptive_field = x[b, :, i:i+kH, j:j+kW]
                    output[b, oc, i, j] = np.sum(receptive_field * kernel[oc]) + bias[oc]

    return output


def maxpool2d(x: np.ndarray, pool_size: int = 2) -> np.ndarray:
    batch, channels, H, W = x.shape
    out_H = H // pool_size
    out_W = W // pool_size

    output = np.zeros((batch, channels, out_H, out_W))

    for i in range(out_H):
        for j in range(out_W):
            h_start = i * pool_size
            w_start = j * pool_size
            output[:, :, i, j] = np.max(
                x[:, :, h_start:h_start+pool_size, w_start:w_start+pool_size],
                axis=(2, 3)
            )

    return output


def flatten(x: np.ndarray) -> np.ndarray:
    return x.reshape(x.shape[0], -1)


class CNN:
    def __init__(self, input_shape: tuple, num_classes: int):
        np.random.seed(42)
        in_channels, H, W = input_shape

        # Conv layers
        self.conv1_w = np.random.randn(32, in_channels, 3, 3) * 0.1
        self.conv1_b = np.zeros(32)
        self.conv2_w = np.random.randn(64, 32, 3, 3) * 0.1
        self.conv2_b = np.zeros(64)

        # Calculate size after convolutions and pooling
        # After conv1 (3x3): H-2, W-2
        # After pool1 (2x2): (H-2)//2, (W-2)//2
        # After conv2 (3x3): (H-2)//2 - 2, (W-2)//2 - 2
        # After pool2 (2x2): ((H-2)//2 - 2)//2, ((W-2)//2 - 2)//2
        h1 = (H - 2) // 2
        w1 = (W - 2) // 2
        h2 = (h1 - 2) // 2
        w2 = (w1 - 2) // 2
        flat_size = 64 * h2 * w2

        # FC layers
        self.fc1_w = np.random.randn(flat_size, 128) * 0.1
        self.fc1_b = np.zeros(128)
        self.fc2_w = np.random.randn(128, num_classes) * 0.1
        self.fc2_b = np.zeros(num_classes)

    def forward(self, x: np.ndarray) -> np.ndarray:
        # Conv block 1
        x = conv2d(x, self.conv1_w, self.conv1_b)
        x = np.maximum(0, x)  # ReLU
        x = maxpool2d(x)

        # Conv block 2
        x = conv2d(x, self.conv2_w, self.conv2_b)
        x = np.maximum(0, x)  # ReLU
        x = maxpool2d(x)

        # Flatten
        x = flatten(x)

        # FC layers
        x = np.maximum(0, x @ self.fc1_w + self.fc1_b)  # ReLU
        x = x @ self.fc2_w + self.fc2_b  # Logits

        return x


def test_cnn():
    # Test with MNIST-like data
    cnn = CNN(input_shape=(1, 28, 28), num_classes=10)
    x = np.random.randn(4, 1, 28, 28)
    logits = cnn.forward(x)
    print(f"Input shape: {x.shape}")
    print(f"Output shape: {logits.shape}")
    return logits.shape == (4, 10)
`}],M6=[{id:"rl-discounted-return",title:"Discounted Return",section:"reinforcement-learning",difficulty:"easy",description:`
## Discounted Return (Cumulative Reward)

Calculate the discounted return (cumulative reward) from a sequence of rewards.

### Formula
\`\`\`
G_t = r_t +  * r_{t+1} +  * r_{t+2} + ... + ^(T-t) * r_T
    = _{k=0}^{T-t} ^k * r_{t+k}
\`\`\`

Where:
- \`r_t\`: Reward at timestep t
- \`\` (gamma): Discount factor (0    1)
- \`T\`: Final timestep

### Why Discount?
- Future rewards are uncertain
- Prefer immediate rewards
-  = 0: Only care about immediate reward
-  = 1: All rewards equally important
- Typical values: 0.9 to 0.99

### Function Signature
\`\`\`python
def discounted_return(rewards: np.ndarray, gamma: float) -> float:
\`\`\`

Returns the total discounted return from timestep 0.
    `,examples:[{input:"rewards = [1, 1, 1, 1], gamma = 0.9",output:"3.439",explanation:"1 + 0.9*1 + 0.81*1 + 0.729*1 = 3.439"},{input:"rewards = [0, 0, 0, 10], gamma = 0.5",output:"1.25",explanation:"0 + 0 + 0 + 0.125*10 = 1.25"}],starterCode:`import numpy as np

def discounted_return(rewards: np.ndarray, gamma: float) -> float:
    """
    Calculate the discounted cumulative return.

    Args:
        rewards: Array of rewards [r_0, r_1, ..., r_T]
        gamma: Discount factor (0 <= gamma <= 1)

    Returns:
        Total discounted return G_0
    """
    rewards = np.array(rewards)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Constant rewards",input:"([1, 1, 1, 1], 0.9)",expected:"3.439",hidden:!1},{id:"2",description:"Delayed reward",input:"([0, 0, 0, 10], 0.5)",expected:"1.25",hidden:!1},{id:"3",description:"No discount",input:"([1, 2, 3, 4], 1.0)",expected:"10.0",hidden:!1},{id:"4",description:"Only immediate",input:"([5, 10, 15], 0.0)",expected:"5.0",hidden:!0}],hints:["Create an array of discount factors: [, , , ...]","Use np.arange to create exponents, then gamma ** exponents","Multiply rewards by discount factors and sum"],solution:`import numpy as np

def discounted_return(rewards: np.ndarray, gamma: float) -> float:
    """
    Calculate the discounted cumulative return.
    """
    rewards = np.array(rewards)
    T = len(rewards)

    # Create discount factors: [gamma^0, gamma^1, gamma^2, ...]
    discounts = gamma ** np.arange(T)

    # Compute discounted return
    G = np.sum(rewards * discounts)

    return round(G, 3)
`},{id:"rl-epsilon-greedy",title:"Epsilon-Greedy Policy",section:"reinforcement-learning",difficulty:"easy",description:`
## Epsilon-Greedy Policy

Implement the epsilon-greedy action selection policy, which balances exploration and exploitation.

### Algorithm
\`\`\`
With probability : choose random action (explore)
With probability 1-: choose action with highest Q-value (exploit)
\`\`\`

### Why Epsilon-Greedy?
- **Exploration**: Try new actions to discover better strategies
- **Exploitation**: Use known good actions to maximize reward
-  typically decays over time (start exploring, then exploit)

### Function Signature
\`\`\`python
def epsilon_greedy(q_values: np.ndarray, epsilon: float,
                   random_value: float) -> int:
\`\`\`

**Note**: We pass \`random_value\` (a number between 0-1) instead of generating it,
so tests are deterministic. In practice, you'd use \`np.random.random()\`.

### Expected Return
- If \`random_value < epsilon\`: return \`random_action\` (passed as floor of random_value * n_actions for testing)
- Else: return \`argmax(q_values)\`
    `,examples:[{input:"q_values = [1.0, 3.0, 2.0], epsilon = 0.1, random_value = 0.5",output:"1",explanation:"0.5 >= 0.1, so exploit: argmax([1,3,2]) = 1"},{input:"q_values = [1.0, 3.0, 2.0], epsilon = 0.9, random_value = 0.5",output:"1",explanation:"0.5 < 0.9, so explore: floor(0.5 * 3) = 1"}],starterCode:`import numpy as np

def epsilon_greedy(q_values: np.ndarray, epsilon: float,
                   random_value: float) -> int:
    """
    Select action using epsilon-greedy policy.

    Args:
        q_values: Q-values for each action [Q(a_0), Q(a_1), ...]
        epsilon: Exploration probability (0 <= epsilon <= 1)
        random_value: Pre-generated random number for deterministic testing

    Returns:
        Selected action index
    """
    q_values = np.array(q_values)
    n_actions = len(q_values)

    # Your code here
    # If random_value < epsilon: explore (return floor(random_value * n_actions))
    # Else: exploit (return argmax of q_values)
    pass
`,testCases:[{id:"1",description:"Exploit (greedy)",input:"([1.0, 3.0, 2.0], 0.1, 0.5)",expected:"1",hidden:!1},{id:"2",description:"Explore",input:"([1.0, 3.0, 2.0], 0.9, 0.5)",expected:"1",hidden:!1},{id:"3",description:"Always exploit (epsilon=0)",input:"([5.0, 2.0, 8.0, 1.0], 0.0, 0.99)",expected:"2",hidden:!1},{id:"4",description:"Explore with low random",input:"([1.0, 2.0, 3.0, 4.0], 0.5, 0.2)",expected:"0",hidden:!0}],hints:["Compare random_value to epsilon to decide explore vs exploit","For exploration, compute floor(random_value * n_actions)","For exploitation, use np.argmax(q_values)"],solution:`import numpy as np

def epsilon_greedy(q_values: np.ndarray, epsilon: float,
                   random_value: float) -> int:
    """
    Select action using epsilon-greedy policy.
    """
    q_values = np.array(q_values)
    n_actions = len(q_values)

    if random_value < epsilon:
        # Explore: random action
        return int(random_value * n_actions)
    else:
        # Exploit: greedy action
        return int(np.argmax(q_values))
`},{id:"rl-bellman-value",title:"Bellman Expectation (State Value)",section:"reinforcement-learning",difficulty:"easy",description:`
## Bellman Expectation Equation for State Value

Compute the value of a state given transition probabilities, rewards, and next-state values.

### Bellman Expectation Equation
\`\`\`
V(s) = _a (a|s) * _{s'} P(s'|s,a) * [R(s,a,s') +  * V(s')]
\`\`\`

For a fixed policy, this simplifies to:
\`\`\`
V(s) = _{s'} P(s'|s) * [R(s,s') +  * V(s')]
\`\`\`

### What It Means
The value of state s equals the expected:
- Immediate reward R
- Plus discounted value of next state V(s')

### Function Signature
\`\`\`python
def bellman_value(transitions: list, gamma: float,
                  next_values: np.ndarray) -> float:
\`\`\`

Where each transition is \`(probability, reward, next_state_index)\`.
    `,examples:[{input:"transitions=[(0.5, 1, 0), (0.5, 2, 1)], gamma=0.9, V=[5, 10]",output:"8.25",explanation:"0.5*(1 + 0.9*5) + 0.5*(2 + 0.9*10) = 0.5*5.5 + 0.5*11 = 8.25"}],starterCode:`import numpy as np

def bellman_value(transitions: list, gamma: float,
                  next_values: np.ndarray) -> float:
    """
    Compute state value using Bellman expectation equation.

    Args:
        transitions: List of (probability, reward, next_state_index) tuples
        gamma: Discount factor
        next_values: Array of values V(s') for each state

    Returns:
        Value V(s) for the current state
    """
    next_values = np.array(next_values)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Two transitions",input:"([(0.5, 1, 0), (0.5, 2, 1)], 0.9, [5, 10])",expected:"8.25",hidden:!1},{id:"2",description:"Deterministic transition",input:"([(1.0, 5, 0)], 0.9, [10])",expected:"14.0",hidden:!1},{id:"3",description:"Three outcomes",input:"([(0.2, 0, 0), (0.5, 1, 1), (0.3, 2, 2)], 0.9, [0, 5, 10])",expected:"6.05",hidden:!0}],hints:["Loop through each transition (p, r, s_next)","For each: add p * (r + gamma * V[s_next]) to the total","This is the expected value over all possible transitions"],solution:`import numpy as np

def bellman_value(transitions: list, gamma: float,
                  next_values: np.ndarray) -> float:
    """
    Compute state value using Bellman expectation equation.
    """
    next_values = np.array(next_values)

    value = 0.0
    for prob, reward, next_state in transitions:
        # V(s) =  P(s'|s) * [R +  * V(s')]
        value += prob * (reward + gamma * next_values[next_state])

    return round(value, 2)
`},{id:"rl-q-learning-update",title:"Q-Learning Update",section:"reinforcement-learning",difficulty:"medium",description:`
## Q-Learning Update Rule

Implement the Q-learning update rule, the core of this model-free RL algorithm.

### Q-Learning Update
\`\`\`
Q(s, a)  Q(s, a) +  * [r +  * max_a' Q(s', a') - Q(s, a)]
\`\`\`

Where:
- \`\`: Learning rate
- \`r\`: Reward received
- \`\`: Discount factor
- \`s'\`: Next state
- \`max_a' Q(s', a')\`: Best Q-value in next state

### Key Properties
- **Off-policy**: Updates use max Q-value, not the action actually taken
- **Model-free**: Doesn't need environment dynamics
- **Converges**: To optimal Q* under certain conditions

### Function Signature
\`\`\`python
def q_learning_update(Q: np.ndarray, state: int, action: int,
                      reward: float, next_state: int,
                      alpha: float, gamma: float) -> np.ndarray:
\`\`\`

Returns the updated Q-table.
    `,examples:[{input:"Q=[[0,0],[0,0]], s=0, a=1, r=1, s'=1, =0.1, =0.9",output:"Q[0,1] = 0.1",explanation:"Q[0,1] += 0.1 * (1 + 0.9*0 - 0) = 0.1"}],starterCode:`import numpy as np

def q_learning_update(Q: np.ndarray, state: int, action: int,
                      reward: float, next_state: int,
                      alpha: float, gamma: float) -> np.ndarray:
    """
    Perform one Q-learning update.

    Args:
        Q: Q-table of shape (n_states, n_actions)
        state: Current state index
        action: Action taken
        reward: Reward received
        next_state: Next state index
        alpha: Learning rate
        gamma: Discount factor

    Returns:
        Updated Q-table
    """
    Q = np.array(Q, dtype=float)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Simple update",input:"([[0, 0], [0, 0]], 0, 1, 1.0, 1, 0.1, 0.9)",expected:"[[0.0, 0.1], [0.0, 0.0]]",hidden:!1},{id:"2",description:"With existing values",input:"([[1, 2], [3, 4]], 0, 0, 5.0, 1, 0.5, 0.9)",expected:"[[4.8, 2.0], [3.0, 4.0]]",hidden:!1},{id:"3",description:"Terminal state (no future)",input:"([[0, 0], [0, 0]], 0, 0, 10.0, 1, 1.0, 0.0)",expected:"[[10.0, 0.0], [0.0, 0.0]]",hidden:!0}],hints:["Find the maximum Q-value in the next state: np.max(Q[next_state])","Compute TD target: reward + gamma * max_next_Q","Compute TD error: target - Q[state, action]","Update: Q[state, action] += alpha * td_error"],solution:`import numpy as np

def q_learning_update(Q: np.ndarray, state: int, action: int,
                      reward: float, next_state: int,
                      alpha: float, gamma: float) -> np.ndarray:
    """
    Perform one Q-learning update.
    """
    Q = np.array(Q, dtype=float)

    # Best Q-value in next state
    max_next_Q = np.max(Q[next_state])

    # TD target (Bellman optimality target)
    td_target = reward + gamma * max_next_Q

    # TD error
    td_error = td_target - Q[state, action]

    # Update Q-value
    Q[state, action] += alpha * td_error

    return np.round(Q, 1).tolist()
`},{id:"rl-sarsa-update",title:"SARSA Update",section:"reinforcement-learning",difficulty:"medium",description:`
## SARSA Update Rule

Implement SARSA (State-Action-Reward-State-Action), an on-policy TD control algorithm.

### SARSA Update
\`\`\`
Q(s, a)  Q(s, a) +  * [r +  * Q(s', a') - Q(s, a)]
\`\`\`

### SARSA vs Q-Learning
| Aspect | SARSA | Q-Learning |
|--------|-------|------------|
| Policy | On-policy | Off-policy |
| Next Q | Q(s', a') actual | max_a' Q(s', a') |
| Safety | More conservative | Can be risky |

### On-Policy Meaning
SARSA uses the **actual next action** a' that will be taken (following the current policy),
while Q-learning uses the **best possible** next action.

### Function Signature
\`\`\`python
def sarsa_update(Q: np.ndarray, state: int, action: int, reward: float,
                 next_state: int, next_action: int,
                 alpha: float, gamma: float) -> np.ndarray:
\`\`\`
    `,examples:[{input:"Q=[[1,2],[3,4]], s=0, a=0, r=5, s'=1, a'=0, =0.5, =0.9",output:"Q[0,0] = 4.35",explanation:"Q[0,0] += 0.5*(5 + 0.9*3 - 1) = 0.5*6.7 = 3.35, so 1+3.35=4.35"}],starterCode:`import numpy as np

def sarsa_update(Q: np.ndarray, state: int, action: int, reward: float,
                 next_state: int, next_action: int,
                 alpha: float, gamma: float) -> np.ndarray:
    """
    Perform one SARSA update.

    Args:
        Q: Q-table of shape (n_states, n_actions)
        state: Current state s
        action: Action taken a
        reward: Reward received r
        next_state: Next state s'
        next_action: Next action a' (will be taken)
        alpha: Learning rate
        gamma: Discount factor

    Returns:
        Updated Q-table
    """
    Q = np.array(Q, dtype=float)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Basic SARSA update",input:"([[1, 2], [3, 4]], 0, 0, 5.0, 1, 0, 0.5, 0.9)",expected:"[[4.35, 2.0], [3.0, 4.0]]",hidden:!1},{id:"2",description:"Different next action",input:"([[1, 2], [3, 4]], 0, 0, 5.0, 1, 1, 0.5, 0.9)",expected:"[[4.8, 2.0], [3.0, 4.0]]",hidden:!1},{id:"3",description:"From zero",input:"([[0, 0], [0, 0]], 0, 1, 1.0, 1, 0, 0.1, 0.9)",expected:"[[0.0, 0.1], [0.0, 0.0]]",hidden:!0}],hints:["The key difference from Q-learning: use Q[next_state, next_action] not max","TD target: reward + gamma * Q[next_state, next_action]","TD error: target - Q[state, action]","Update: Q[state, action] += alpha * td_error"],solution:`import numpy as np

def sarsa_update(Q: np.ndarray, state: int, action: int, reward: float,
                 next_state: int, next_action: int,
                 alpha: float, gamma: float) -> np.ndarray:
    """
    Perform one SARSA update.
    """
    Q = np.array(Q, dtype=float)

    # SARSA uses actual next action, not max
    next_Q = Q[next_state, next_action]

    # TD target
    td_target = reward + gamma * next_Q

    # TD error
    td_error = td_target - Q[state, action]

    # Update Q-value
    Q[state, action] += alpha * td_error

    return np.round(Q, 2).tolist()
`},{id:"rl-td0-prediction",title:"TD(0) Value Prediction",section:"reinforcement-learning",difficulty:"medium",description:`
## TD(0) Value Prediction

Implement TD(0), the simplest temporal difference learning algorithm for value estimation.

### TD(0) Update
\`\`\`
V(s)  V(s) +  * [r +  * V(s') - V(s)]
\`\`\`

### Key Concepts
- **TD Error ()**: \`r +  * V(s') - V(s)\`
- **Bootstrap**: Uses estimated V(s') rather than waiting for episode end
- **Online**: Updates after each step, not at episode end

### TD vs Monte Carlo
| Aspect | TD(0) | Monte Carlo |
|--------|-------|-------------|
| Update | Every step | End of episode |
| Bias | Some bias | Unbiased |
| Variance | Low variance | High variance |
| Bootstrap | Yes | No |

### Function Signature
\`\`\`python
def td0_update(V: np.ndarray, state: int, reward: float,
               next_state: int, alpha: float, gamma: float,
               done: bool = False) -> np.ndarray:
\`\`\`

If \`done=True\`, the next state is terminal (V(s')=0).
    `,examples:[{input:"V=[0,0,0], s=0, r=1, s'=1, =0.1, =0.9, done=False",output:"V=[0.1, 0, 0]",explanation:"V[0] += 0.1 * (1 + 0.9*0 - 0) = 0.1"}],starterCode:`import numpy as np

def td0_update(V: np.ndarray, state: int, reward: float,
               next_state: int, alpha: float, gamma: float,
               done: bool = False) -> np.ndarray:
    """
    Perform one TD(0) value update.

    Args:
        V: Value function array V(s) for each state
        state: Current state s
        reward: Reward received r
        next_state: Next state s'
        alpha: Learning rate
        gamma: Discount factor
        done: Whether next_state is terminal

    Returns:
        Updated value function
    """
    V = np.array(V, dtype=float)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Non-terminal transition",input:"([0, 0, 0], 0, 1.0, 1, 0.1, 0.9, False)",expected:"[0.1, 0.0, 0.0]",hidden:!1},{id:"2",description:"Terminal state",input:"([0, 0, 0], 0, 10.0, 1, 0.5, 0.9, True)",expected:"[5.0, 0.0, 0.0]",hidden:!1},{id:"3",description:"With existing values",input:"([5, 10, 15], 1, 2.0, 2, 0.1, 0.9, False)",expected:"[5.0, 10.55, 15.0]",hidden:!0}],hints:["If done=True, the next state value is 0 (terminal)","TD target: reward + gamma * V[next_state] (or just reward if done)","TD error: target - V[state]","Update: V[state] += alpha * td_error"],solution:`import numpy as np

def td0_update(V: np.ndarray, state: int, reward: float,
               next_state: int, alpha: float, gamma: float,
               done: bool = False) -> np.ndarray:
    """
    Perform one TD(0) value update.
    """
    V = np.array(V, dtype=float)

    # Next state value (0 if terminal)
    next_value = 0.0 if done else V[next_state]

    # TD target
    td_target = reward + gamma * next_value

    # TD error
    td_error = td_target - V[state]

    # Update value
    V[state] += alpha * td_error

    return np.round(V, 2).tolist()
`},{id:"rl-value-iteration",title:"Value Iteration Step",section:"reinforcement-learning",difficulty:"medium",description:`
## Value Iteration

Implement one step of the value iteration algorithm for solving MDPs.

### Bellman Optimality Update
\`\`\`
V(s) = max_a _{s'} P(s'|s,a) * [R(s,a,s') +  * V(s')]
\`\`\`

For each state, we find the action that maximizes expected value.

### Algorithm
1. For each state s:
   - For each action a, compute Q(s,a)
   - V(s) = max over all Q(s,a)
2. Repeat until convergence

### Function Signature
\`\`\`python
def value_iteration_step(V: np.ndarray, transitions: dict,
                         gamma: float) -> np.ndarray:
\`\`\`

Where \`transitions[s][a]\` is a list of \`(prob, reward, next_state)\` tuples.
    `,examples:[{input:"V=[0,0], transitions for 2-state MDP, gamma=0.9",output:"Updated V with optimal values",explanation:"Each state updated to max expected value over actions"}],starterCode:`import numpy as np

def value_iteration_step(V: np.ndarray, transitions: dict,
                         gamma: float) -> np.ndarray:
    """
    Perform one step of value iteration.

    Args:
        V: Current value function V(s) for each state
        transitions: Dict where transitions[s][a] = [(prob, reward, next_state), ...]
        gamma: Discount factor

    Returns:
        Updated value function
    """
    V = np.array(V, dtype=float)
    n_states = len(V)
    V_new = np.zeros(n_states)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Simple 2-state MDP",input:"([0.0, 0.0], {0: {0: [(1.0, 1.0, 0)], 1: [(1.0, 5.0, 1)]}, 1: {0: [(1.0, 2.0, 0)], 1: [(1.0, 0.0, 1)]}}, 0.9)",expected:"[5.0, 2.0]",hidden:!1},{id:"2",description:"With existing values",input:"([5.0, 2.0], {0: {0: [(1.0, 1.0, 0)], 1: [(1.0, 5.0, 1)]}, 1: {0: [(1.0, 2.0, 0)], 1: [(1.0, 0.0, 1)]}}, 0.9)",expected:"[6.8, 6.5]",hidden:!1}],hints:["For each state, compute the value of each action","Action value: sum over transitions of prob * (reward + gamma * V[next])","State value: max over all action values","Use the new values, not the old ones being updated"],solution:`import numpy as np

def value_iteration_step(V: np.ndarray, transitions: dict,
                         gamma: float) -> np.ndarray:
    """
    Perform one step of value iteration.
    """
    V = np.array(V, dtype=float)
    n_states = len(V)
    V_new = np.zeros(n_states)

    for s in range(n_states):
        if s not in transitions:
            continue

        # Compute Q-value for each action
        q_values = []
        for a in transitions[s]:
            q_sa = 0.0
            for prob, reward, next_state in transitions[s][a]:
                q_sa += prob * (reward + gamma * V[next_state])
            q_values.append(q_sa)

        # V(s) = max Q(s, a)
        V_new[s] = max(q_values) if q_values else 0.0

    return np.round(V_new, 1).tolist()
`},{id:"rl-policy-gradient",title:"REINFORCE Policy Gradient",section:"reinforcement-learning",difficulty:"hard",description:`
## REINFORCE (Monte Carlo Policy Gradient)

Implement the REINFORCE algorithm for computing policy gradient updates.

### Policy Gradient Theorem
\`\`\`
J() = E[_t log (a_t|s_t; ) * G_t]
\`\`\`

### REINFORCE Algorithm
1. Collect episode: (s_0, a_0, r_1, s_1, a_1, r_2, ...)
2. For each timestep t:
   - Compute return G_t (discounted sum of future rewards)
   - Compute gradient: log (a_t|s_t) * G_t
3. Update policy parameters

### Softmax Policy
\`\`\`
(a|s) = exp([s,a]) / _a' exp([s,a'])
\`\`\`

### Gradient of Log-Softmax
\`\`\`
_ log (a|s) = one_hot(a) - (|s)
\`\`\`
(1 for action taken, minus probability of each action)

### Function Signature
\`\`\`python
def reinforce_gradient(theta: np.ndarray, episode: list,
                       gamma: float) -> np.ndarray:
\`\`\`

Episode is list of (state, action, reward) tuples.

### Expected Return Format
Returns gradient array of same shape as theta (n_states, n_actions).
    `,examples:[{input:"theta (3x2), episode=[(0,1,1), (1,0,2)], gamma=0.9",output:"Gradient array (3x2)",explanation:"Gradient computed from policy gradient theorem"}],starterCode:`import numpy as np

def softmax(x):
    """Compute softmax probabilities."""
    exp_x = np.exp(x - np.max(x))
    return exp_x / np.sum(exp_x)

def reinforce_gradient(theta: np.ndarray, episode: list,
                       gamma: float) -> np.ndarray:
    """
    Compute REINFORCE policy gradient.

    Args:
        theta: Policy parameters (n_states, n_actions)
        episode: List of (state, action, reward) tuples
        gamma: Discount factor

    Returns:
        Gradient of same shape as theta
    """
    theta = np.array(theta, dtype=float)
    n_states, n_actions = theta.shape
    gradient = np.zeros_like(theta)

    # Your code here
    # 1. Compute returns G_t for each timestep
    # 2. For each (s, a, r), compute gradient contribution
    # 3. Gradient = (one_hot(a) - softmax(theta[s])) * G_t
    pass
`,testCases:[{id:"1",description:"Simple episode",input:"bool(np.allclose(reinforce_gradient(np.zeros((2, 2)), [(0, 1, 1.0), (1, 0, 1.0)], 0.9), [[-0.95, 0.95], [0.5, -0.5]], atol=0.01))",expected:"True",hidden:!1},{id:"2",description:"Single step episode",input:"bool(np.allclose(reinforce_gradient(np.zeros((2, 2)), [(0, 0, 5.0)], 0.9), [[2.5, -2.5], [0.0, 0.0]], atol=0.01))",expected:"True",hidden:!1}],hints:["First compute all returns: G_t = r_t + *r_{t+1} + *r_{t+2} + ...","For softmax policy: gradient = one_hot(action) - (|state)","Multiply gradient by return G_t and accumulate","Use backward iteration to compute returns efficiently"],solution:`import numpy as np

def softmax(x):
    """Compute softmax probabilities."""
    exp_x = np.exp(x - np.max(x))
    return exp_x / np.sum(exp_x)

def reinforce_gradient(theta: np.ndarray, episode: list,
                       gamma: float) -> np.ndarray:
    """
    Compute REINFORCE policy gradient.
    """
    theta = np.array(theta, dtype=float)
    n_states, n_actions = theta.shape
    gradient = np.zeros_like(theta)

    T = len(episode)
    if T == 0:
        return gradient

    # Compute returns for each timestep (backward)
    returns = np.zeros(T)
    G = 0
    for t in range(T - 1, -1, -1):
        _, _, reward = episode[t]
        G = reward + gamma * G
        returns[t] = G

    # Compute gradient
    for t in range(T):
        state, action, _ = episode[t]
        G_t = returns[t]

        # Policy probabilities for this state
        probs = softmax(theta[state])

        # Gradient of log (a|s) = one_hot(a) - (|s)
        grad_log_pi = -probs.copy()
        grad_log_pi[action] += 1.0

        # Accumulate: log (a|s) * G_t
        gradient[state] += grad_log_pi * G_t

    return np.round(gradient, 2)
`},{id:"rl-advantage-estimation",title:"Advantage Estimation (GAE)",section:"reinforcement-learning",difficulty:"hard",description:`
## Generalized Advantage Estimation (GAE)

Implement GAE, a crucial technique used in PPO and other policy gradient methods.

### Why Advantage?
The advantage function measures how much better an action is compared to average:
\`\`\`
A(s, a) = Q(s, a) - V(s)
\`\`\`

### GAE Formula
\`\`\`
_t = _{l=0}^{T-t} ()^l * _{t+l}
\`\`\`

Where _t is the TD error:
\`\`\`
_t = r_t +  * V(s_{t+1}) - V(s_t)
\`\`\`

### Lambda () Trade-off
-  = 0: Uses only one-step TD (low variance, high bias)
-  = 1: Uses full Monte Carlo return (high variance, low bias)
- Typical:  = 0.95

### Function Signature
\`\`\`python
def compute_gae(rewards: np.ndarray, values: np.ndarray,
                gamma: float, lam: float) -> np.ndarray:
\`\`\`

Where values has length T+1 (includes V(s_T+1), use 0 if terminal).
    `,examples:[{input:"rewards=[1,1,1], values=[0,0,0,0], gamma=0.99, lambda=0.95",output:"advantages=[2.9, 1.95, 1.0]",explanation:"GAE combines TD errors with exponential decay"}],starterCode:`import numpy as np

def compute_gae(rewards: np.ndarray, values: np.ndarray,
                gamma: float, lam: float) -> np.ndarray:
    """
    Compute Generalized Advantage Estimation.

    Args:
        rewards: Rewards r_0, r_1, ..., r_{T-1} (length T)
        values: Values V(s_0), V(s_1), ..., V(s_T) (length T+1)
                Last value is V(s_T) or 0 if terminal
        gamma: Discount factor
        lam: GAE lambda parameter

    Returns:
        Advantages _0, _1, ..., _{T-1} (length T)
    """
    rewards = np.array(rewards, dtype=float)
    values = np.array(values, dtype=float)
    T = len(rewards)
    advantages = np.zeros(T)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Zero values baseline",input:"bool(np.allclose(compute_gae([1, 1, 1], [0, 0, 0, 0], 0.99, 0.95), [2.9, 1.95, 1.0], atol=0.1))",expected:"True",hidden:!1},{id:"2",description:"With value estimates",input:"bool(np.allclose(compute_gae([1, 2, 3], [1, 2, 3, 0], 0.9, 0.9), [3.99, 2.7, 0.0], atol=0.1))",expected:"True",hidden:!1},{id:"3",description:"Single step",input:"bool(np.allclose(compute_gae([5], [1, 0], 0.99, 0.95), [4.0], atol=0.01))",expected:"True",hidden:!0}],hints:["Compute TD errors first: _t = r_t + *V(s_{t+1}) - V(s_t)","Work backwards from the last timestep","GAE formula: _t = _t + *_{t+1}","At the last timestep: _{T-1} = _{T-1}"],solution:`import numpy as np

def compute_gae(rewards: np.ndarray, values: np.ndarray,
                gamma: float, lam: float) -> np.ndarray:
    """
    Compute Generalized Advantage Estimation.
    """
    rewards = np.array(rewards, dtype=float)
    values = np.array(values, dtype=float)
    T = len(rewards)
    advantages = np.zeros(T)

    # Compute advantages backwards
    gae = 0.0
    for t in range(T - 1, -1, -1):
        # TD error: _t = r_t + *V(s_{t+1}) - V(s_t)
        delta = rewards[t] + gamma * values[t + 1] - values[t]

        # GAE: _t = _t + *_{t+1}
        gae = delta + gamma * lam * gae
        advantages[t] = gae

    return np.round(advantages, 2)
`},{id:"rl-ppo-clip",title:"PPO Clipped Objective",section:"reinforcement-learning",difficulty:"hard",description:`
## PPO Clipped Objective

Implement the clipped surrogate objective used in Proximal Policy Optimization (PPO).

### PPO Objective
\`\`\`
L^{CLIP}() = E[min(r_t() * A_t, clip(r_t(), 1-, 1+) * A_t)]
\`\`\`

Where:
- r_t() = _(a|s) / __old(a|s) is the probability ratio
- A_t is the advantage estimate
-  is the clipping parameter (typically 0.2)

### Why Clipping?
- Prevents too large policy updates
- Keeps new policy "close" to old policy
- More stable training than vanilla policy gradient

### Key Insight
- If A > 0 (good action): clip ratio to  1+
- If A < 0 (bad action): clip ratio to  1-

### Function Signature
\`\`\`python
def ppo_clip_objective(old_probs: np.ndarray, new_probs: np.ndarray,
                       advantages: np.ndarray, epsilon: float) -> float:
\`\`\`
    `,examples:[{input:"old_probs=[0.5], new_probs=[0.6], advantages=[1.0], epsilon=0.2",output:"1.0",explanation:"Ratio=1.2, clipped to 1.2, advantage positive: min(1.2, 1.2)*1=1.2, but capped at 1.0 example"}],starterCode:`import numpy as np

def ppo_clip_objective(old_probs: np.ndarray, new_probs: np.ndarray,
                       advantages: np.ndarray, epsilon: float) -> float:
    """
    Compute PPO clipped surrogate objective.

    Args:
        old_probs: _old(a|s) probabilities for taken actions
        new_probs: _new(a|s) probabilities for taken actions
        advantages: Advantage estimates A_t
        epsilon: Clipping parameter (e.g., 0.2)

    Returns:
        PPO clipped objective (scalar, should be maximized)
    """
    old_probs = np.array(old_probs, dtype=float)
    new_probs = np.array(new_probs, dtype=float)
    advantages = np.array(advantages, dtype=float)

    # Your code here
    pass
`,testCases:[{id:"1",description:"No clipping needed",input:"([0.5, 0.5], [0.5, 0.5], [1.0, -1.0], 0.2)",expected:"0.0",hidden:!1},{id:"2",description:"Positive advantage, ratio > 1",input:"([0.5], [0.7], [1.0], 0.2)",expected:"1.2",hidden:!1},{id:"3",description:"Negative advantage, ratio > 1",input:"([0.5], [0.7], [-1.0], 0.2)",expected:"-1.4",hidden:!1},{id:"4",description:"Clipping in action",input:"([0.3], [0.6], [2.0], 0.2)",expected:"2.4",hidden:!0}],hints:["Compute probability ratios: r = new_probs / old_probs","Compute clipped ratios: clip(r, 1-epsilon, 1+epsilon)","Unclipped term: r * advantages","Clipped term: clipped_r * advantages","Take element-wise minimum, then mean"],solution:`import numpy as np

def ppo_clip_objective(old_probs: np.ndarray, new_probs: np.ndarray,
                       advantages: np.ndarray, epsilon: float) -> float:
    """
    Compute PPO clipped surrogate objective.
    """
    old_probs = np.array(old_probs, dtype=float)
    new_probs = np.array(new_probs, dtype=float)
    advantages = np.array(advantages, dtype=float)

    # Probability ratios
    ratios = new_probs / (old_probs + 1e-8)

    # Clipped ratios
    clipped_ratios = np.clip(ratios, 1 - epsilon, 1 + epsilon)

    # Surrogate objectives
    surr1 = ratios * advantages
    surr2 = clipped_ratios * advantages

    # PPO objective: min of clipped and unclipped
    objective = np.mean(np.minimum(surr1, surr2))

    return round(objective, 2)
`},{id:"rl-n-step-return",title:"N-Step Return",section:"reinforcement-learning",difficulty:"medium",description:`
## N-Step Return

Implement n-step returns, which interpolate between TD(0) and Monte Carlo.

### N-Step Return Formula
\`\`\`
G_t^{(n)} = r_t + *r_{t+1} + ... + ^{n-1}*r_{t+n-1} + ^n * V(s_{t+n})
\`\`\`

### Trade-offs
| n | Method | Bias | Variance |
|---|--------|------|----------|
| 1 | TD(0) | High | Low |
| n | n-step | Medium | Medium |
|  | MC | None | High |

### Function Signature
\`\`\`python
def n_step_return(rewards: np.ndarray, values: np.ndarray,
                  t: int, n: int, gamma: float) -> float:
\`\`\`

Compute n-step return starting from timestep t.
    `,examples:[{input:"rewards=[1,2,3,4], values=[0,0,0,0,10], t=0, n=2, gamma=0.9",output:"2.8",explanation:"G_0^(2) = 1 + 0.9*2 + 0.81*0 = 2.8"}],starterCode:`import numpy as np

def n_step_return(rewards: np.ndarray, values: np.ndarray,
                  t: int, n: int, gamma: float) -> float:
    """
    Compute n-step return from timestep t.

    Args:
        rewards: All rewards [r_0, r_1, ..., r_{T-1}]
        values: All values [V(s_0), ..., V(s_T)]
        t: Starting timestep
        n: Number of steps
        gamma: Discount factor

    Returns:
        N-step return G_t^(n)
    """
    rewards = np.array(rewards, dtype=float)
    values = np.array(values, dtype=float)
    T = len(rewards)

    # Your code here
    pass
`,testCases:[{id:"1",description:"2-step return",input:"([1, 2, 3, 4], [0, 0, 0, 0, 10], 0, 2, 0.9)",expected:"2.8",hidden:!1},{id:"2",description:"3-step return with bootstrap",input:"([1, 1, 1, 1], [0, 0, 0, 5, 0], 0, 3, 0.9)",expected:"6.36",hidden:!1},{id:"3",description:"1-step (TD) return",input:"([5, 2, 3], [1, 10, 5, 0], 0, 1, 0.9)",expected:"14.0",hidden:!0}],hints:["Sum discounted rewards from t to min(t+n-1, T-1)","Bootstrap with V(s_{t+n}) if t+n <= T","Handle boundary: if t+n > T, just sum remaining rewards","Discounts: ^0, ^1, ..., ^{n-1} for rewards, ^n for value"],solution:`import numpy as np

def n_step_return(rewards: np.ndarray, values: np.ndarray,
                  t: int, n: int, gamma: float) -> float:
    """
    Compute n-step return from timestep t.
    """
    rewards = np.array(rewards, dtype=float)
    values = np.array(values, dtype=float)
    T = len(rewards)

    G = 0.0

    # Sum discounted rewards
    for k in range(n):
        if t + k < T:
            G += (gamma ** k) * rewards[t + k]

    # Bootstrap with value if we haven't reached terminal
    if t + n < len(values):
        G += (gamma ** n) * values[t + n]

    return round(G, 2)
`},{id:"rl-reward-modeling",title:"RLHF Reward Model Loss",section:"reinforcement-learning",difficulty:"hard",description:`
## RLHF Reward Model Loss

Implement the Bradley-Terry preference model loss used to train reward models in RLHF.

### Background
In RLHF (Reinforcement Learning from Human Feedback), we first train a reward model
on human preference data, then use it to fine-tune an LLM.

### Bradley-Terry Model
Given a pair of responses (y_w, y_l) where y_w is preferred (winner):
\`\`\`
P(y_w > y_l) = (r(y_w) - r(y_l))
\`\`\`

Where  is the sigmoid function and r(y) is the reward model output.

### Loss Function
\`\`\`
L = -E[log (r(y_w) - r(y_l))]
\`\`\`

We want to maximize the probability that the reward model correctly ranks preferences.

### Function Signature
\`\`\`python
def reward_model_loss(r_chosen: np.ndarray, r_rejected: np.ndarray) -> float:
\`\`\`

Where r_chosen and r_rejected are reward scores for preferred and rejected responses.
    `,examples:[{input:"r_chosen = [2.0, 1.5], r_rejected = [1.0, 0.5]",output:"0.313",explanation:"Low loss when chosen has higher reward than rejected"},{input:"r_chosen = [0.0], r_rejected = [0.0]",output:"0.693",explanation:"Equal rewards = 50% probability = -log(0.5) = 0.693"}],starterCode:`import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def reward_model_loss(r_chosen: np.ndarray, r_rejected: np.ndarray) -> float:
    """
    Compute RLHF reward model loss (Bradley-Terry).

    Args:
        r_chosen: Reward scores for preferred/chosen responses
        r_rejected: Reward scores for rejected responses

    Returns:
        Average negative log-likelihood loss
    """
    r_chosen = np.array(r_chosen, dtype=float)
    r_rejected = np.array(r_rejected, dtype=float)

    # Your code here
    # Loss = -E[log (r_chosen - r_rejected)]
    pass
`,testCases:[{id:"1",description:"Clear preference",input:"([2.0, 1.5], [1.0, 0.5])",expected:"0.313",hidden:!1},{id:"2",description:"Equal scores",input:"([0.0], [0.0])",expected:"0.693",hidden:!1},{id:"3",description:"Large margin",input:"([5.0, 4.0, 3.0], [0.0, 0.0, 0.0])",expected:"0.024",hidden:!0}],hints:["Compute the difference: r_chosen - r_rejected","Apply sigmoid to get probability","Take log of probability","Return negative mean (loss to minimize)"],solution:`import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def reward_model_loss(r_chosen: np.ndarray, r_rejected: np.ndarray) -> float:
    """
    Compute RLHF reward model loss (Bradley-Terry).
    """
    r_chosen = np.array(r_chosen, dtype=float)
    r_rejected = np.array(r_rejected, dtype=float)

    # Probability of correctly ranking: (r_chosen - r_rejected)
    logits = r_chosen - r_rejected
    probs = sigmoid(logits)

    # Negative log-likelihood
    loss = -np.mean(np.log(probs + 1e-10))

    return round(loss, 3)
`},{id:"rl-dpo-loss",title:"Direct Preference Optimization (DPO)",section:"reinforcement-learning",difficulty:"hard",description:`
## Direct Preference Optimization (DPO) Loss

Implement the DPO loss function, a simpler alternative to RLHF that doesn't require a separate reward model.

### Background
DPO directly optimizes the LLM policy using preference data, bypassing the reward modeling step.

### DPO Loss
\`\`\`
L_DPO = -E[log ( * (log _(y_w|x) - log _ref(y_w|x)
                    - log _(y_l|x) + log _ref(y_l|x)))]
\`\`\`

Simplified:
\`\`\`
L_DPO = -E[log ( * (_w - _l))]
\`\`\`
Where  = log _(y|x) - log _ref(y|x) (log-ratio of policy to reference)

### Parameters
- : Temperature parameter (typically 0.1 to 0.5)
- _: Policy being trained
- _ref: Reference policy (frozen)
- y_w: Preferred (winner) response
- y_l: Rejected (loser) response

### Function Signature
\`\`\`python
def dpo_loss(logp_chosen: np.ndarray, logp_rejected: np.ndarray,
             ref_logp_chosen: np.ndarray, ref_logp_rejected: np.ndarray,
             beta: float) -> float:
\`\`\`
    `,examples:[{input:"logp_chosen=[-1], logp_rejected=[-2], ref_logp_chosen=[-1.5], ref_logp_rejected=[-1.5], beta=0.1",output:"0.643",explanation:"Policy prefers chosen over reference"}],starterCode:`import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def dpo_loss(logp_chosen: np.ndarray, logp_rejected: np.ndarray,
             ref_logp_chosen: np.ndarray, ref_logp_rejected: np.ndarray,
             beta: float) -> float:
    """
    Compute Direct Preference Optimization (DPO) loss.

    Args:
        logp_chosen: Log prob of chosen response under policy _
        logp_rejected: Log prob of rejected response under policy _
        ref_logp_chosen: Log prob of chosen under reference _ref
        ref_logp_rejected: Log prob of rejected under reference _ref
        beta: Temperature parameter

    Returns:
        DPO loss
    """
    logp_chosen = np.array(logp_chosen, dtype=float)
    logp_rejected = np.array(logp_rejected, dtype=float)
    ref_logp_chosen = np.array(ref_logp_chosen, dtype=float)
    ref_logp_rejected = np.array(ref_logp_rejected, dtype=float)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Policy prefers chosen",input:"([-1.0], [-2.0], [-1.5], [-1.5], 0.1)",expected:"0.644",hidden:!1},{id:"2",description:"Equal preferences",input:"([-1.0, -1.0], [-1.0, -1.0], [-1.0, -1.0], [-1.0, -1.0], 0.5)",expected:"0.693",hidden:!1},{id:"3",description:"Strong preference signal",input:"([0.0], [-5.0], [-2.0], [-3.0], 0.1)",expected:"0.513",hidden:!0}],hints:["Compute log-ratios: _w = logp_chosen - ref_logp_chosen","Compute log-ratios: _l = logp_rejected - ref_logp_rejected","DPO logits:  * (_w - _l)","Loss: -mean(log(sigmoid(logits)))"],solution:`import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def dpo_loss(logp_chosen: np.ndarray, logp_rejected: np.ndarray,
             ref_logp_chosen: np.ndarray, ref_logp_rejected: np.ndarray,
             beta: float) -> float:
    """
    Compute Direct Preference Optimization (DPO) loss.
    """
    logp_chosen = np.array(logp_chosen, dtype=float)
    logp_rejected = np.array(logp_rejected, dtype=float)
    ref_logp_chosen = np.array(ref_logp_chosen, dtype=float)
    ref_logp_rejected = np.array(ref_logp_rejected, dtype=float)

    # Log-ratios (policy vs reference)
    chosen_logratios = logp_chosen - ref_logp_chosen
    rejected_logratios = logp_rejected - ref_logp_rejected

    # DPO logits
    logits = beta * (chosen_logratios - rejected_logratios)

    # Negative log-sigmoid loss
    loss = -np.mean(np.log(sigmoid(logits) + 1e-10))

    return round(loss, 3)
`},{id:"rl-kl-penalty",title:"KL Divergence Penalty (RLHF)",section:"reinforcement-learning",difficulty:"medium",description:`
## KL Divergence Penalty for RLHF

Compute the KL divergence penalty used in RLHF to keep the policy close to the reference model.

### Background
During RLHF fine-tuning, we add a KL penalty to prevent the policy from diverging
too far from the original pretrained model:

\`\`\`
reward_total = reward -  * KL(_ || _ref)
\`\`\`

### KL Divergence (per token)
\`\`\`
KL = E[log _(a|s) - log _ref(a|s)]
   = E[log(_/_ref)]
\`\`\`

For a sequence, we typically compute the average KL per token.

### Why KL Penalty?
- Prevents reward hacking
- Maintains model coherence
- Avoids mode collapse
- Keeps outputs in distribution

### Function Signature
\`\`\`python
def kl_penalty(logp_policy: np.ndarray, logp_reference: np.ndarray,
               beta: float) -> float:
\`\`\`

Returns: KL divergence multiplied by 
    `,examples:[{input:"logp_policy = [-1, -2], logp_reference = [-1.5, -2.5], beta = 0.1",output:"0.05",explanation:"KL = mean([0.5, 0.5]) = 0.5, penalty = 0.1 * 0.5 = 0.05"}],starterCode:`import numpy as np

def kl_penalty(logp_policy: np.ndarray, logp_reference: np.ndarray,
               beta: float) -> float:
    """
    Compute KL divergence penalty for RLHF.

    Args:
        logp_policy: Log probs from current policy _
        logp_reference: Log probs from reference policy _ref
        beta: KL penalty coefficient

    Returns:
        KL penalty =  * mean(KL divergence)
    """
    logp_policy = np.array(logp_policy, dtype=float)
    logp_reference = np.array(logp_reference, dtype=float)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Positive divergence",input:"([-1.0, -2.0], [-1.5, -2.5], 0.1)",expected:"0.05",hidden:!1},{id:"2",description:"No divergence",input:"([-1.0, -1.0], [-1.0, -1.0], 0.1)",expected:"0.0",hidden:!1},{id:"3",description:"Higher beta",input:"([-0.5, -1.0, -1.5], [-1.0, -1.5, -2.0], 0.5)",expected:"0.25",hidden:!0}],hints:["KL divergence per token: log(_) - log(_ref)","Take the mean over all tokens","Multiply by  to get the penalty","KL should be non-negative (though approximation may give small negatives)"],solution:`import numpy as np

def kl_penalty(logp_policy: np.ndarray, logp_reference: np.ndarray,
               beta: float) -> float:
    """
    Compute KL divergence penalty for RLHF.
    """
    logp_policy = np.array(logp_policy, dtype=float)
    logp_reference = np.array(logp_reference, dtype=float)

    # KL divergence: log(_/_ref) = log(_) - log(_ref)
    kl_div = logp_policy - logp_reference

    # Mean KL (per token)
    mean_kl = np.mean(kl_div)

    # KL penalty
    penalty = beta * mean_kl

    return round(penalty, 2)
`},{id:"rl-ppo-llm-objective",title:"PPO-RLHF Objective",section:"reinforcement-learning",difficulty:"hard",description:`
## PPO Objective for LLM Fine-tuning (RLHF)

Implement the full PPO-RLHF objective that combines the clipped surrogate, reward, and KL penalty.

### RLHF PPO Objective
\`\`\`
L = E[min(r_t * _t, clip(r_t, 1-, 1+) * _t) -  * KL]
\`\`\`

Where:
- r_t = _(a|s) / _old(a|s) is the probability ratio
- _t is the advantage (reward - baseline, typically from reward model)
-  is the PPO clipping parameter (0.2)
-  is the KL penalty coefficient
- KL = log _ - log _ref

### RLHF Advantage
In RLHF, the advantage is often simplified to:
\`\`\`
 = R(x, y) -  * KL(_ || _ref)
\`\`\`

### Function Signature
\`\`\`python
def ppo_rlhf_objective(old_logp: np.ndarray, new_logp: np.ndarray,
                       ref_logp: np.ndarray, rewards: np.ndarray,
                       epsilon: float, beta: float) -> dict:
\`\`\`

### Expected Return Format
Return a dictionary with:
- \`'objective'\`: The PPO-RLHF objective value
- \`'policy_loss'\`: Clipped policy loss component
- \`'kl_penalty'\`: KL penalty component
    `,examples:[{input:"old_logp=[-2], new_logp=[-1.8], ref_logp=[-2], rewards=[1.0], =0.2, =0.1",output:"{'objective': ..., 'policy_loss': ..., 'kl_penalty': ...}",explanation:"Combined objective with reward and KL penalty"}],starterCode:`import numpy as np

def ppo_rlhf_objective(old_logp: np.ndarray, new_logp: np.ndarray,
                       ref_logp: np.ndarray, rewards: np.ndarray,
                       epsilon: float, beta: float) -> dict:
    """
    Compute PPO-RLHF objective for LLM fine-tuning.

    Args:
        old_logp: Log probs from old policy (before update)
        new_logp: Log probs from current policy
        ref_logp: Log probs from reference (pretrained) model
        rewards: Rewards from reward model
        epsilon: PPO clipping parameter
        beta: KL penalty coefficient

    Returns:
        Dictionary with 'objective', 'policy_loss', 'kl_penalty'
    """
    old_logp = np.array(old_logp, dtype=float)
    new_logp = np.array(new_logp, dtype=float)
    ref_logp = np.array(ref_logp, dtype=float)
    rewards = np.array(rewards, dtype=float)

    # Your code here
    pass
`,testCases:[{id:"1",description:"Positive reward, small update",input:"(lambda r: bool(abs(r['objective'] - 1.18) < 0.1 and abs(r['kl_penalty'] - 0.02) < 0.01))(ppo_rlhf_objective([-2.0], [-1.8], [-2.0], [1.0], 0.2, 0.1))",expected:"True",hidden:!1},{id:"2",description:"No policy change",input:"(lambda r: bool(abs(r['objective'] - 1.0) < 0.01 and abs(r['kl_penalty']) < 0.01))(ppo_rlhf_objective([-1.0], [-1.0], [-1.0], [1.0], 0.2, 0.1))",expected:"True",hidden:!1}],hints:["Compute ratio: exp(new_logp - old_logp)","Compute KL: new_logp - ref_logp","Compute advantage: rewards - beta * KL","Apply PPO clipping to ratio * advantage","Final objective: clipped_objective - beta * KL"],solution:`import numpy as np

def ppo_rlhf_objective(old_logp: np.ndarray, new_logp: np.ndarray,
                       ref_logp: np.ndarray, rewards: np.ndarray,
                       epsilon: float, beta: float) -> dict:
    """
    Compute PPO-RLHF objective for LLM fine-tuning.
    """
    old_logp = np.array(old_logp, dtype=float)
    new_logp = np.array(new_logp, dtype=float)
    ref_logp = np.array(ref_logp, dtype=float)
    rewards = np.array(rewards, dtype=float)

    # Probability ratio
    ratio = np.exp(new_logp - old_logp)

    # KL divergence from reference
    kl = new_logp - ref_logp

    # KL penalty
    kl_penalty = beta * np.mean(kl)

    # Advantage: reward minus KL penalty
    advantage = rewards - beta * kl

    # Clipped ratio
    clipped_ratio = np.clip(ratio, 1 - epsilon, 1 + epsilon)

    # PPO surrogate objectives
    surr1 = ratio * advantage
    surr2 = clipped_ratio * advantage

    # Policy loss (take minimum for conservative update)
    policy_loss = np.mean(np.minimum(surr1, surr2))

    # Final objective (maximize policy_loss, minimize kl_penalty)
    objective = policy_loss

    return {
        'objective': round(float(objective), 2),
        'policy_loss': round(float(policy_loss), 2),
        'kl_penalty': round(float(kl_penalty), 2),
    }
`}],j6=[{id:"llm-temperature-scaling",title:"Temperature Scaling",section:"llm-generation",difficulty:"easy",description:`
## Temperature Scaling

Implement temperature scaling for LLM logits to control the randomness of generated text.

### How It Works
Before converting logits to probabilities via softmax, divide by a temperature parameter T:

\`\`\`
scaled_logits = logits / T
probs = softmax(scaled_logits)
\`\`\`

### Temperature Effects

| Temperature | Effect |
|-------------|--------|
| T < 1 | Sharper distribution (more confident, less random) |
| T = 1 | Original distribution (unchanged) |
| T > 1 | Flatter distribution (more random, more creative) |

### Softmax Reminder
\`\`\`
softmax(x_i) = exp(x_i) / sum(exp(x_j))
\`\`\`

For numerical stability, subtract the max before exponentiating:
\`\`\`
softmax(x_i) = exp(x_i - max(x)) / sum(exp(x_j - max(x)))
\`\`\`

### Interview Insight
Temperature scaling is the simplest decoding control. Interviewers expect you to know that T0 approaches greedy decoding (argmax) and T approaches uniform sampling.
    `,examples:[{input:"logits = [2.0, 1.0, 0.1], temperature = 0.5",output:"[0.8360, 0.1142, 0.0498]",explanation:"Low temperature makes the highest logit dominate"},{input:"logits = [2.0, 1.0, 0.1], temperature = 2.0",output:"[0.4566, 0.2784, 0.2650]",explanation:"High temperature flattens the distribution"}],starterCode:`import numpy as np

def temperature_scaling(logits, temperature=1.0):
    """
    Apply temperature scaling to logits and return probabilities.

    Args:
        logits: Raw logits from the model (vocab_size,)
        temperature: Temperature parameter (T > 0)

    Returns:
        probs: Probability distribution over vocabulary (vocab_size,)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Temperature=1 gives standard softmax",input:`(lambda: (
    logits := np.array([2.0, 1.0, 0.1]),
    probs := temperature_scaling(logits, 1.0),
    bool(np.allclose(probs, np.exp(logits - np.max(logits)) / np.sum(np.exp(logits - np.max(logits))), atol=1e-4))
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"Low temperature sharpens distribution",input:`(lambda: (
    logits := np.array([2.0, 1.0, 0.1]),
    probs_low := temperature_scaling(logits, 0.5),
    probs_high := temperature_scaling(logits, 2.0),
    bool(np.max(probs_low) > np.max(probs_high))
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Probabilities sum to 1",input:"bool(np.allclose(np.sum(temperature_scaling(np.array([1.0, 2.0, 3.0, 4.0]), 0.7)), 1.0))",expected:"True",hidden:!1},{id:"4",description:"Very low temperature approaches argmax",input:`(lambda: (
    probs := temperature_scaling(np.array([3.0, 1.0, 0.5]), 0.01),
    bool(probs[0] > 0.99)
)[-1])()`,expected:"True",hidden:!0}],hints:["Divide logits by temperature before applying softmax","For numerical stability, subtract the max of scaled logits before exp()","softmax(x) = exp(x - max(x)) / sum(exp(x - max(x)))"],solution:`import numpy as np

def temperature_scaling(logits, temperature=1.0):
    logits = np.array(logits, dtype=np.float64)
    # Scale logits by temperature
    scaled = logits / temperature
    # Numerically stable softmax
    shifted = scaled - np.max(scaled)
    exp_vals = np.exp(shifted)
    probs = exp_vals / np.sum(exp_vals)
    return probs
`},{id:"llm-top-k-sampling",title:"Top-k Sampling",section:"llm-generation",difficulty:"easy",description:`
## Top-k Sampling

Implement top-k sampling, which restricts token selection to the k most likely tokens.

### Algorithm
1. Compute probabilities from logits (via softmax)
2. Find the top-k tokens by probability
3. Zero out all other tokens
4. Re-normalize the remaining probabilities
5. Sample from the filtered distribution

### Why Top-k?
- Prevents sampling extremely unlikely tokens
- Reduces incoherent or nonsensical outputs
- Simple to implement and widely used (GPT-2 used k=40)

### Limitation
Fixed k doesn't adapt to the shape of the distribution:
- For a confident prediction (one token has 90% probability), k=50 still allows 49 unlikely tokens
- For a flat distribution, k=50 might cut off reasonable options

This motivates **nucleus (top-p) sampling**.

### Function Signature
\`\`\`python
def top_k_sampling(logits, k, temperature=1.0):
    # Returns: sampled_token_index, filtered_probs
\`\`\`
    `,examples:[{input:"logits = [5.0, 3.0, 2.0, 1.0, 0.1], k = 3",output:"Only top 3 tokens have non-zero probability",explanation:"Tokens at indices 0, 1, 2 are kept; indices 3, 4 are zeroed"}],starterCode:`import numpy as np

def top_k_sampling(logits, k, temperature=1.0):
    """
    Sample from the top-k most likely tokens.

    Args:
        logits: Raw logits (vocab_size,)
        k: Number of top tokens to keep
        temperature: Temperature for scaling (applied before filtering)

    Returns:
        token: Sampled token index (int)
        filtered_probs: Probability distribution after filtering (vocab_size,)
    """
    np.random.seed(42)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Only k tokens have non-zero probability",input:`(lambda: (
    _, probs := top_k_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 3),
    bool(np.sum(probs > 0) == 3)
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"Filtered probs sum to 1",input:`(lambda: (
    _, probs := top_k_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 3),
    bool(np.allclose(np.sum(probs), 1.0))
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Sampled token is within top-k",input:`(lambda: (
    logits := np.array([5.0, 3.0, 2.0, 1.0, 0.1]),
    top_k_indices := np.argsort(logits)[-3:],
    token, _ := top_k_sampling(logits, 3),
    bool(token in top_k_indices)
)[-1])()`,expected:"True",hidden:!1},{id:"4",description:"k=1 always picks the top token",input:`(lambda: (
    token, _ := top_k_sampling(np.array([1.0, 5.0, 2.0, 0.5]), 1),
    bool(token == 1)
)[-1])()`,expected:"True",hidden:!0}],hints:["Apply temperature scaling first: scaled_logits = logits / temperature","Use np.argsort or np.argpartition to find top-k indices","Set non-top-k logits to -inf (or a very large negative number) before softmax","Re-normalize by dividing by the sum of remaining probabilities","Use np.random.choice with the filtered probabilities to sample"],solution:`import numpy as np

def top_k_sampling(logits, k, temperature=1.0):
    np.random.seed(42)
    logits = np.array(logits, dtype=np.float64)

    # Apply temperature
    scaled = logits / temperature

    # Find top-k indices
    top_k_idx = np.argsort(scaled)[-k:]

    # Mask non-top-k to -inf
    filtered_logits = np.full_like(scaled, -np.inf)
    filtered_logits[top_k_idx] = scaled[top_k_idx]

    # Softmax over filtered logits
    shifted = filtered_logits - np.max(filtered_logits)
    exp_vals = np.exp(shifted)
    probs = exp_vals / np.sum(exp_vals)

    # Sample
    token = np.random.choice(len(probs), p=probs)
    return int(token), probs
`},{id:"llm-top-p-sampling",title:"Nucleus (Top-p) Sampling",section:"llm-generation",difficulty:"medium",description:`
## Nucleus (Top-p) Sampling

Implement nucleus sampling (also called top-p sampling), which dynamically selects the smallest set of tokens whose cumulative probability exceeds a threshold p.

### Algorithm
1. Compute probabilities from logits (with temperature)
2. Sort tokens by probability (descending)
3. Compute cumulative sum of sorted probabilities
4. Find the cutoff: smallest set where cumulative probability >= p
5. Zero out tokens below the cutoff
6. Re-normalize and sample

### Why Top-p?
Unlike top-k (fixed number of tokens), top-p **adapts** to the distribution:
- Confident prediction (one token at 95%): only 1-2 tokens kept
- Uncertain prediction (flat distribution): many tokens kept

### Common Values
- GPT-3/4: p = 0.9 or 0.95
- Creative writing: p = 0.95
- Factual tasks: p = 0.7

### Function Signature
\`\`\`python
def top_p_sampling(logits, p, temperature=1.0):
    # Returns: sampled_token_index, filtered_probs
\`\`\`
    `,examples:[{input:"probs = [0.5, 0.3, 0.1, 0.05, 0.05], p = 0.8",output:"Tokens with probs [0.5, 0.3] kept (cumsum = 0.8)",explanation:"Only 2 tokens needed to reach the 80% threshold"}],starterCode:`import numpy as np

def top_p_sampling(logits, p, temperature=1.0):
    """
    Nucleus (top-p) sampling from logits.

    Args:
        logits: Raw logits (vocab_size,)
        p: Cumulative probability threshold (0 < p <= 1)
        temperature: Temperature for scaling

    Returns:
        token: Sampled token index (int)
        filtered_probs: Probability distribution after filtering (vocab_size,)
    """
    np.random.seed(42)
    # Your code here
    pass
`,testCases:[{id:"1",description:"Filtered probs sum to 1",input:`(lambda: (
    _, probs := top_p_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 0.9),
    bool(np.allclose(np.sum(probs), 1.0))
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"p=1.0 keeps all tokens",input:`(lambda: (
    _, probs := top_p_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 1.0),
    bool(np.sum(probs > 0) == 5)
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Small p keeps fewer tokens",input:`(lambda: (
    _, probs_small := top_p_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 0.5),
    _, probs_large := top_p_sampling(np.array([5.0, 3.0, 2.0, 1.0, 0.1]), 0.95),
    bool(np.sum(probs_small > 0) <= np.sum(probs_large > 0))
)[-1])()`,expected:"True",hidden:!1},{id:"4",description:"Dominant token with very small p",input:`(lambda: (
    logits := np.array([10.0, 1.0, 0.5, 0.1]),
    _, probs := top_p_sampling(logits, 0.5),
    bool(np.sum(probs > 0) <= 2)
)[-1])()`,expected:"True",hidden:!0}],hints:["First compute softmax probabilities (with temperature)","Sort probabilities in descending order, keeping track of original indices","Compute cumulative sum of sorted probabilities","The cutoff is where cumsum first exceeds p  include that token too","Zero out all tokens not in the nucleus set, then re-normalize"],solution:`import numpy as np

def top_p_sampling(logits, p, temperature=1.0):
    np.random.seed(42)
    logits = np.array(logits, dtype=np.float64)

    # Apply temperature and compute softmax
    scaled = logits / temperature
    shifted = scaled - np.max(scaled)
    exp_vals = np.exp(shifted)
    probs = exp_vals / np.sum(exp_vals)

    # Sort descending
    sorted_idx = np.argsort(probs)[::-1]
    sorted_probs = probs[sorted_idx]

    # Cumulative sum
    cumsum = np.cumsum(sorted_probs)

    # Find cutoff: include tokens until cumsum >= p
    cutoff_idx = np.searchsorted(cumsum, p)
    # Include the token that crosses the threshold
    nucleus_indices = sorted_idx[:cutoff_idx + 1]

    # Filter
    filtered_probs = np.zeros_like(probs)
    filtered_probs[nucleus_indices] = probs[nucleus_indices]

    # Re-normalize
    filtered_probs = filtered_probs / np.sum(filtered_probs)

    # Sample
    token = np.random.choice(len(filtered_probs), p=filtered_probs)
    return int(token), filtered_probs
`},{id:"llm-repetition-penalty",title:"Repetition Penalty",section:"llm-generation",difficulty:"easy",description:`
## Repetition Penalty

Implement repetition penalty to discourage the model from generating repeated tokens.

### Algorithm (from Keskar et al., CTRL paper)
For each token that has already been generated:
- If the logit is **positive**, divide by the penalty factor
- If the logit is **negative**, multiply by the penalty factor

\`\`\`
for token_id in generated_tokens:
    if logits[token_id] > 0:
        logits[token_id] = logits[token_id] / penalty
    else:
        logits[token_id] = logits[token_id] * penalty
\`\`\`

### Why This Formula?
- Dividing positive logits makes repeated tokens less likely
- Multiplying negative logits makes them even more negative (also less likely)
- Both operations push repeated tokens toward lower probability

### Common Values
- penalty = 1.0: No effect
- penalty = 1.2: Mild repetition reduction
- penalty = 1.5: Strong repetition reduction
- penalty > 2.0: Can cause incoherent text

### Function Signature
\`\`\`python
def apply_repetition_penalty(logits, generated_tokens, penalty=1.2):
    # Returns: penalized_logits
\`\`\`
    `,examples:[{input:"logits = [2.0, -1.0, 3.0, 0.5], generated = [0, 1], penalty = 1.5",output:"[1.333, -1.5, 3.0, 0.5]",explanation:"Token 0 (positive): 2.0/1.5=1.333; Token 1 (negative): -1.0*1.5=-1.5"}],starterCode:`import numpy as np

def apply_repetition_penalty(logits, generated_tokens, penalty=1.2):
    """
    Apply repetition penalty to logits for previously generated tokens.

    Args:
        logits: Raw logits (vocab_size,)
        generated_tokens: List of previously generated token indices
        penalty: Repetition penalty factor (>= 1.0)

    Returns:
        penalized_logits: Logits with penalty applied (vocab_size,)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Positive logits are divided by penalty",input:`(lambda: (
    result := apply_repetition_penalty(np.array([2.0, 1.0, 3.0]), [0], 1.5),
    bool(np.allclose(result[0], 2.0 / 1.5))
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"Negative logits are multiplied by penalty",input:`(lambda: (
    result := apply_repetition_penalty(np.array([2.0, -1.0, 3.0]), [1], 1.5),
    bool(np.allclose(result[1], -1.0 * 1.5))
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Non-generated tokens unchanged",input:`(lambda: (
    result := apply_repetition_penalty(np.array([2.0, -1.0, 3.0]), [0], 1.5),
    bool(np.allclose(result[1], -1.0) and np.allclose(result[2], 3.0))
)[-1])()`,expected:"True",hidden:!1},{id:"4",description:"Penalty=1.0 has no effect",input:`(lambda: (
    logits := np.array([2.0, -1.0, 3.0, 0.5]),
    result := apply_repetition_penalty(logits, [0, 1, 2], 1.0),
    bool(np.allclose(result, logits))
)[-1])()`,expected:"True",hidden:!0}],hints:["Make a copy of logits to avoid modifying the input","Loop over each token in generated_tokens","Check if the logit at that index is positive or negative","Positive: divide by penalty; Negative: multiply by penalty"],solution:`import numpy as np

def apply_repetition_penalty(logits, generated_tokens, penalty=1.2):
    logits = np.array(logits, dtype=np.float64).copy()

    for token_id in generated_tokens:
        if logits[token_id] > 0:
            logits[token_id] = logits[token_id] / penalty
        else:
            logits[token_id] = logits[token_id] * penalty

    return logits
`},{id:"llm-kv-cache",title:"KV Cache for Efficient Generation",section:"llm-generation",difficulty:"medium",description:`
## KV Cache for Efficient Generation

Implement KV (Key-Value) caching to make autoregressive generation efficient.

### The Problem
In autoregressive generation, at each step we compute:
\`\`\`
Attention(Q, K, V) = softmax(Q @ K.T / sqrt(d_k)) @ V
\`\`\`

Without caching, we recompute K and V for ALL previous tokens at every step. For a sequence of length n, this is O(n) per token.

### The Solution: KV Cache
Cache the K and V projections from previous steps:
1. **First token**: Compute K, V for the prompt. Cache them.
2. **Each new token**: Compute K_new, V_new for only the new token. Append to cache.
3. **Attention**: Use Q_new (just the new token) with the full cached K, V.

### Implementation
\`\`\`
# Step t: generating token t
K_new = x_t @ W_K          # (1, d_k) - only new token
V_new = x_t @ W_V          # (1, d_v) - only new token
K_cache = concat(K_cache, K_new)  # (t, d_k)
V_cache = concat(V_cache, V_new)  # (t, d_v)

Q_t = x_t @ W_Q            # (1, d_k) - only new token
output = attention(Q_t, K_cache, V_cache)  # attend to all
\`\`\`

### Speedup
- Without cache: O(nd) total for n tokens
- With cache: O(nd) total for n tokens

### Function Signature
\`\`\`python
def kv_cache_attention(x_new, W_Q, W_K, W_V, k_cache, v_cache):
    # Returns: output, updated_k_cache, updated_v_cache
\`\`\`
    `,examples:[{input:"x_new (1, d_model), cache has 5 previous tokens",output:"output (1, d_v), caches now have 6 entries each",explanation:"New K,V appended; attention computed over all 6 tokens"}],starterCode:`import numpy as np

def kv_cache_attention(x_new, W_Q, W_K, W_V, k_cache=None, v_cache=None):
    """
    Compute attention with KV caching for efficient autoregressive generation.

    Args:
        x_new: New token embedding (1, d_model)
        W_Q: Query weight matrix (d_model, d_k)
        W_K: Key weight matrix (d_model, d_k)
        W_V: Value weight matrix (d_model, d_v)
        k_cache: Cached keys from previous steps (seq_len, d_k) or None
        v_cache: Cached values from previous steps (seq_len, d_v) or None

    Returns:
        output: Attention output for new token (1, d_v)
        k_cache: Updated key cache (seq_len+1, d_k)
        v_cache: Updated value cache (seq_len+1, d_v)
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Output shape is correct",input:`(lambda: (
    d_model, d_k, d_v := 8, 4, 4,
    x := np.random.randn(1, d_model),
    W_Q := np.random.randn(d_model, d_k) * 0.1,
    W_K := np.random.randn(d_model, d_k) * 0.1,
    W_V := np.random.randn(d_model, d_v) * 0.1,
    out, _, _ := kv_cache_attention(x, W_Q, W_K, W_V),
    out.shape
)[-1])()`,expected:"(1, 4)",hidden:!1},{id:"2",description:"Cache grows by 1 each step",input:`(lambda: (
    d := 4,
    x := np.random.randn(1, d),
    W := np.random.randn(d, d) * 0.1,
    _, k1, v1 := kv_cache_attention(x, W, W, W),
    _, k2, v2 := kv_cache_attention(x, W, W, W, k1, v1),
    _, k3, v3 := kv_cache_attention(x, W, W, W, k2, v2),
    k3.shape[0]
)[-1])()`,expected:"3",hidden:!1},{id:"3",description:"First step creates cache of length 1",input:`(lambda: (
    d := 4,
    x := np.random.randn(1, d),
    W := np.random.randn(d, d) * 0.1,
    _, k, v := kv_cache_attention(x, W, W, W),
    k.shape[0]
)[-1])()`,expected:"1",hidden:!1},{id:"4",description:"Attention output changes with more context",input:`(lambda: (
    np.random.seed(0),
    d := 4,
    x1 := np.random.randn(1, d),
    x2 := np.random.randn(1, d),
    W := np.random.randn(d, d) * 0.1,
    out1, k1, v1 := kv_cache_attention(x1, W, W, W),
    out2, k2, v2 := kv_cache_attention(x2, W, W, W, k1, v1),
    bool(not np.allclose(out1, out2))
)[-1])()`,expected:"True",hidden:!0}],hints:["Compute Q, K, V projections for the new token: Q_new = x_new @ W_Q","If cache is None, initialize K_cache and V_cache as the new K, V","Otherwise concatenate: K_cache = np.concatenate([k_cache, K_new], axis=0)","Compute attention: scores = Q_new @ K_cache.T / sqrt(d_k)","Apply softmax to scores, then output = softmax_scores @ V_cache"],solution:`import numpy as np

def kv_cache_attention(x_new, W_Q, W_K, W_V, k_cache=None, v_cache=None):
    # Project new token
    Q_new = x_new @ W_Q  # (1, d_k)
    K_new = x_new @ W_K  # (1, d_k)
    V_new = x_new @ W_V  # (1, d_v)

    # Update cache
    if k_cache is None:
        k_cache = K_new
        v_cache = V_new
    else:
        k_cache = np.concatenate([k_cache, K_new], axis=0)
        v_cache = np.concatenate([v_cache, V_new], axis=0)

    # Compute attention
    d_k = Q_new.shape[-1]
    scores = Q_new @ k_cache.T / np.sqrt(d_k)  # (1, seq_len)

    # Softmax
    scores = scores - np.max(scores, axis=-1, keepdims=True)
    attn_weights = np.exp(scores) / np.sum(np.exp(scores), axis=-1, keepdims=True)

    # Weighted sum of values
    output = attn_weights @ v_cache  # (1, d_v)

    return output, k_cache, v_cache
`},{id:"llm-beam-search",title:"Beam Search Decoding",section:"llm-generation",difficulty:"medium",description:`
## Beam Search Decoding

Implement beam search, which maintains multiple candidate sequences to find higher-probability outputs.

### Algorithm
1. Start with \`beam_width\` copies of the initial sequence
2. At each step, for each beam:
   - Get log-probabilities for next token
   - Consider top-k expansions
3. Keep only the \`beam_width\` sequences with highest total log-probability
4. Stop when all beams have generated the EOS token or hit max length

### Scoring
Use **log probabilities** (not raw probabilities) to avoid underflow:
\`\`\`
score(sequence) = sum of log P(token_i | tokens_<i)
\`\`\`

### Length Normalization
Beam search favors shorter sequences. Normalize by length:
\`\`\`
normalized_score = score / length^alpha
\`\`\`
where alpha is typically 0.6-0.7.

### Simplified Version
For this problem, implement a simplified beam search using a pre-computed log-probability matrix (no actual model). At each step, expand each beam with all possible next tokens, score them, and keep the top \`beam_width\`.

### Function Signature
\`\`\`python
def beam_search(log_probs, beam_width, max_length, eos_token=None):
    # log_probs: (max_length, vocab_size) - pre-computed log probs per step
    # Returns: best_sequence, best_score
\`\`\`
    `,examples:[{input:"log_probs (3 steps, 4 tokens), beam_width=2",output:"best sequence of length 3 with highest total log-prob",explanation:"Explores 2 paths at each step, returns the best one"}],starterCode:`import numpy as np

def beam_search(log_probs, beam_width, max_length=None, eos_token=None):
    """
    Beam search decoding over pre-computed log probabilities.

    Args:
        log_probs: Log probability matrix (num_steps, vocab_size).
                   log_probs[t] gives log probs for step t.
        beam_width: Number of beams to maintain
        max_length: Maximum sequence length (defaults to num_steps)
        eos_token: End-of-sequence token ID (optional)

    Returns:
        best_sequence: List of token indices for the best beam
        best_score: Total log-probability of the best sequence
    """
    # Your code here
    pass
`,testCases:[{id:"1",description:"Greedy path found with beam_width=1",input:`(lambda: (
    log_probs := np.log(np.array([[0.6, 0.3, 0.1], [0.2, 0.7, 0.1], [0.1, 0.3, 0.6]])),
    seq, score := beam_search(log_probs, 1),
    seq
)[-1])()`,expected:"[0, 1, 2]",hidden:!1},{id:"2",description:"Beam search score is log-probability sum",input:`(lambda: (
    log_probs := np.log(np.array([[0.6, 0.3, 0.1], [0.2, 0.7, 0.1], [0.1, 0.3, 0.6]])),
    seq, score := beam_search(log_probs, 1),
    round(score, 4)
)[-1])()`,expected:"-1.3783",hidden:!1},{id:"3",description:"Wider beam can find better path",input:`(lambda: (
    log_probs := np.log(np.array([[0.4, 0.35, 0.25], [0.1, 0.1, 0.8], [0.9, 0.05, 0.05]])),
    _, score1 := beam_search(log_probs, 1),
    _, score2 := beam_search(log_probs, 3),
    bool(score2 >= score1 - 1e-10)
)[-1])()`,expected:"True",hidden:!0},{id:"4",description:"Sequence length matches steps",input:`(lambda: (
    log_probs := np.log(np.array([[0.5, 0.5], [0.3, 0.7], [0.8, 0.2], [0.4, 0.6]])),
    seq, _ := beam_search(log_probs, 2),
    len(seq)
)[-1])()`,expected:"4",hidden:!1}],hints:["Maintain a list of (sequence, score) tuples for each beam","At each step, expand all beams with all possible next tokens","Score = previous score + log_probs[step][token]","Sort all candidates by score and keep top beam_width","After all steps, return the beam with the highest score"],solution:`import numpy as np

def beam_search(log_probs, beam_width, max_length=None, eos_token=None):
    log_probs = np.array(log_probs, dtype=np.float64)
    num_steps, vocab_size = log_probs.shape
    if max_length is None:
        max_length = num_steps

    # Initialize beams: (sequence, score)
    beams = [([], 0.0)]

    for step in range(min(max_length, num_steps)):
        all_candidates = []

        for seq, score in beams:
            # If this beam ended with EOS, carry it forward
            if eos_token is not None and len(seq) > 0 and seq[-1] == eos_token:
                all_candidates.append((seq, score))
                continue

            # Expand with all possible next tokens
            for token in range(vocab_size):
                new_seq = seq + [token]
                new_score = score + log_probs[step][token]
                all_candidates.append((new_seq, new_score))

        # Keep top beam_width candidates
        all_candidates.sort(key=lambda x: x[1], reverse=True)
        beams = all_candidates[:beam_width]

    # Return best beam
    best_seq, best_score = beams[0]
    return best_seq, round(best_score, 4)
`},{id:"llm-speculative-decoding",title:"Speculative Decoding",section:"llm-generation",difficulty:"hard",description:`
## Speculative Decoding

Implement the core verification step of speculative decoding, a technique that speeds up LLM inference by using a small "draft" model to propose tokens and a large "target" model to verify them.

### Overview
1. **Draft model** (small, fast): Generates K candidate tokens quickly
2. **Target model** (large, slow): Verifies all K tokens in **one forward pass**
3. **Accept/Reject**: Each draft token is accepted with probability min(1, p_target/p_draft)

### Verification Algorithm
For each draft token i = 0, 1, ..., K-1:
\`\`\`
r = uniform(0, 1)
if r < min(1, p_target[i] / p_draft[i]):
    accept token i
else:
    reject token i and all subsequent tokens
    resample from adjusted distribution: max(0, p_target - p_draft)
    break
\`\`\`

If all K tokens accepted, sample one more token from the target model's distribution for position K.

### Why It Works
- Draft model generates tokens cheaply (e.g., 10x faster)
- Target model verifies K tokens at once (parallel, not sequential)
- Accepted tokens are **exactly** distributed as if sampled from the target model
- Expected speedup: ~2-3x for well-matched draft/target pairs

### Function Signature
\`\`\`python
def speculative_decode(draft_probs, target_probs, draft_tokens):
    # Returns: accepted_tokens, num_accepted
\`\`\`

### Important
The output distribution is mathematically guaranteed to match the target model exactly. This is not an approximation.
    `,examples:[{input:"draft_probs=[0.8, 0.7], target_probs=[0.9, 0.3], draft_tokens=[5, 12]",output:"Token 5 likely accepted (0.9/0.8>1), Token 12 may be rejected (0.3/0.7<1)",explanation:"Higher target prob  more likely to accept"}],starterCode:`import numpy as np

def speculative_decode(draft_probs, target_probs, draft_tokens, target_dist_next=None):
    """
    Verify draft tokens using speculative decoding.

    Args:
        draft_probs: Probability the draft model assigned to each drafted token.
                     List of K floats.
        target_probs: Probability the target model assigns to each drafted token.
                      List of K floats.
        draft_tokens: The K token IDs proposed by the draft model.
                      List of K ints.
        target_dist_next: Full target distribution for position after last draft token.
                          Array of shape (vocab_size,) or None.

    Returns:
        accepted_tokens: List of accepted token IDs
        num_accepted: Number of accepted tokens (0 to K)
    """
    np.random.seed(42)
    # Your code here
    pass
`,testCases:[{id:"1",description:"All tokens accepted when target_prob >= draft_prob",input:`(lambda: (
    np.random.seed(0),
    tokens, n := speculative_decode([0.3, 0.3, 0.3], [0.9, 0.9, 0.9], [1, 2, 3]),
    bool(n == 3)
)[-1])()`,expected:"True",hidden:!1},{id:"2",description:"Accepted tokens are prefix of draft tokens",input:`(lambda: (
    np.random.seed(42),
    tokens, n := speculative_decode([0.5, 0.5, 0.5], [0.6, 0.6, 0.6], [10, 20, 30]),
    bool(tokens == [10, 20, 30][:n])
)[-1])()`,expected:"True",hidden:!1},{id:"3",description:"Returns between 0 and K accepted tokens",input:`(lambda: (
    np.random.seed(42),
    _, n := speculative_decode([0.8, 0.8, 0.8], [0.2, 0.2, 0.2], [1, 2, 3]),
    bool(0 <= n <= 3)
)[-1])()`,expected:"True",hidden:!1},{id:"4",description:"Deterministic acceptance when target prob much higher",input:`(lambda: (
    results := [speculative_decode([0.01], [0.99], [42])[1] for _ in range(10)],
    bool(all(r == 1 for r in results))
)[-1])()`,expected:"True",hidden:!0}],hints:["For each draft token, compute acceptance probability: min(1, target_prob / draft_prob)","Draw a uniform random number r. Accept if r < acceptance_probability","On first rejection, stop  do not check subsequent tokens","Return the prefix of draft_tokens up to the last accepted token","The acceptance criterion guarantees the output matches the target distribution"],solution:`import numpy as np

def speculative_decode(draft_probs, target_probs, draft_tokens, target_dist_next=None):
    np.random.seed(42)
    K = len(draft_tokens)
    accepted_tokens = []

    for i in range(K):
        # Acceptance probability
        if draft_probs[i] == 0:
            accept_prob = 1.0 if target_probs[i] == 0 else 1.0
        else:
            accept_prob = min(1.0, target_probs[i] / draft_probs[i])

        # Draw random number
        r = np.random.uniform()

        if r < accept_prob:
            accepted_tokens.append(draft_tokens[i])
        else:
            # Reject this and all subsequent tokens
            break

    return accepted_tokens, len(accepted_tokens)
`}],fT=[...k6,...E6,...T6,...S6,...C6,...I6,...A6,...P6,...R6,...N6,...L6,...D6,...O6,...z6,...M6,...j6];function V6(t){return fT.find(e=>e.id===t)}function F6(t){return fT.filter(e=>e.section===t)}function U6(){const{sectionId:t}=Tw(),{getProblemProgress:e,getSectionProgress:n}=Ol(),r=ei.find(u=>u.id===t),i=t?F6(t):[],[s,o]=z.useState(()=>t?localStorage.getItem(`section-intro-collapsed-${t}`)==="true":!1);z.useEffect(()=>{if(t){const u=localStorage.getItem(`section-intro-collapsed-${t}`);o(u==="true")}},[t]);const a=()=>{const u=!s;o(u),t&&localStorage.setItem(`section-intro-collapsed-${t}`,String(u))};if(!r)return h.jsxs("div",{className:"text-center py-12",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-dark-100 mb-4",children:"Section Not Found"}),h.jsx(Ft,{to:"/",className:"text-primary-500 hover:text-primary-400",children:"Return to Home"})]});const l=n(r.id,r.problems.length);return h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsx(Oo,{title:r.title,description:`${r.description} Learn ${r.title.toLowerCase()} with ${r.problems.length} hands-on coding problems.`,canonical:`/section/${r.id}`}),h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsx("div",{className:"w-14 h-14 bg-white dark:bg-dark-600 border border-gray-200 dark:border-dark-500 rounded-xl flex items-center justify-center text-3xl",children:r.icon}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-dark-100 tracking-tight",children:r.title}),h.jsx("p",{className:"text-gray-500 dark:text-dark-200",children:r.description})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 dark:bg-dark-500 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full progress-gradient transition-all duration-300 rounded-full",style:{width:`${l}%`}})}),h.jsxs("span",{className:"text-primary-600 dark:text-primary-300 font-medium font-mono text-sm",children:[l,"%"]})]})]}),h.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-xl p-6 mb-8 border border-gray-200 dark:border-dark-500",children:[h.jsxs("button",{onClick:a,className:"w-full flex items-center justify-between text-left",children:[h.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-dark-100",children:"Introduction"}),h.jsx("svg",{className:`w-5 h-5 text-gray-500 dark:text-dark-200 transition-transform duration-200 ${s?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!s&&h.jsx("div",{className:"prose prose-sm max-w-none mt-4",children:h.jsx(B2,{remarkPlugins:[hT],components:{h1:({children:u})=>h.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-dark-100 mt-0 mb-4",children:u}),h2:({children:u})=>h.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-dark-100 mt-6 mb-3",children:u}),h3:({children:u})=>h.jsx("h3",{className:"text-base font-medium text-gray-700 dark:text-dark-200 mt-4 mb-2",children:u}),p:({children:u})=>h.jsx("p",{className:"text-gray-600 dark:text-dark-200 mb-3 leading-relaxed",children:u}),pre:({children:u})=>h.jsx("pre",{className:"bg-gray-100 dark:bg-dark-900 rounded-lg p-4 overflow-x-auto my-3 text-sm text-gray-800 dark:text-dark-100",children:u}),code:({className:u,children:d})=>!u&&!String(d).includes(`
`)?h.jsx("code",{className:"bg-gray-100 dark:bg-dark-600 px-1.5 py-0.5 rounded text-primary-600 dark:text-primary-300 text-sm",children:d}):h.jsx("code",{className:"text-sm",children:d}),ul:({children:u})=>h.jsx("ul",{className:"list-disc list-inside text-gray-600 dark:text-dark-200 space-y-1 mb-3",children:u}),li:({children:u})=>h.jsx("li",{className:"text-gray-600 dark:text-dark-200",children:u}),strong:({children:u})=>h.jsx("strong",{className:"text-gray-900 dark:text-dark-100 font-semibold",children:u}),table:({children:u})=>h.jsx("div",{className:"overflow-x-auto my-4",children:h.jsx("table",{className:"min-w-full border-collapse border border-gray-300 dark:border-dark-500 text-sm",children:u})}),thead:({children:u})=>h.jsx("thead",{className:"bg-gray-100 dark:bg-dark-600",children:u}),tbody:({children:u})=>h.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-dark-500",children:u}),tr:({children:u})=>h.jsx("tr",{children:u}),th:({children:u})=>h.jsx("th",{className:"border border-gray-300 dark:border-dark-500 px-3 py-2 text-left font-semibold text-gray-700 dark:text-dark-200",children:u}),td:({children:u})=>h.jsx("td",{className:"border border-gray-300 dark:border-dark-500 px-3 py-2 text-gray-600 dark:text-dark-200",children:u})},children:r.introduction})})]}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-dark-100 mb-4",children:"Problems"}),h.jsx("div",{className:"space-y-3",children:i.map((u,d)=>{const p=e(r.id,u.id);return h.jsxs(Ft,{to:`/problem/${r.id}/${u.id}`,className:"flex items-center gap-4 bg-white dark:bg-dark-800 rounded-lg p-4 border border-gray-200 dark:border-dark-500 hover:border-primary-400 dark:hover:border-primary-500/30 hover:shadow-sm transition-all group",children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${p.status==="completed"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":p.status==="in_progress"?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-gray-100 text-gray-500 dark:bg-dark-600 dark:text-dark-200"}`,children:p.status==="completed"?"":d+1}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-gray-900 dark:text-dark-100 font-medium group-hover:text-primary-600 dark:group-hover:text-primary-300 transition-colors",children:u.title}),h.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[h.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${u.difficulty==="easy"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":u.difficulty==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:u.difficulty}),h.jsxs("span",{className:"text-gray-400 dark:text-dark-300 text-xs font-mono",children:[u.testCases.length," tests"]})]})]}),h.jsx("div",{className:"text-gray-400 dark:text-dark-300 group-hover:text-primary-500 dark:group-hover:text-primary-300 transition-colors",children:""})]},u.id)})})]})]})}var mT={exports:{}},q6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",B6=q6,W6=B6;function gT(){}function yT(){}yT.resetWarningCache=gT;var H6=function(){function t(r,i,s,o,a,l){if(l!==W6){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:yT,resetWarningCache:gT};return n.PropTypes=n,n};mT.exports=H6();var $6=mT.exports;const Ne=ps($6);var fn=typeof window<"u"?window:null,hy=fn===null,gl=hy?void 0:fn.document,In="addEventListener",An="removeEventListener",mh="getBoundingClientRect",da="_a",Pn="_b",fr="_c",Su="horizontal",Rn=function(){return!1},K6=hy?"calc":["","-webkit-","-moz-","-o-"].filter(function(t){var e=gl.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length}).shift()+"calc",_T=function(t){return typeof t=="string"||t instanceof String},$v=function(t){if(_T(t)){var e=gl.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},At=function(t,e,n){var r=t[e];return r!==void 0?r:n},Cu=function(t,e,n,r){if(e){if(r==="end")return 0;if(r==="center")return t/2}else if(n){if(r==="start")return 0;if(r==="center")return t/2}return t},Q6=function(t,e){var n=gl.createElement("div");return n.className="gutter gutter-"+e,n},G6=function(t,e,n){var r={};return _T(e)?r[t]=e:r[t]=K6+"("+e+"% - "+n+"px)",r},Y6=function(t,e){var n;return n={},n[t]=e+"px",n},Kv=function(t,e){if(e===void 0&&(e={}),hy)return{};var n=t,r,i,s,o,a,l;Array.from&&(n=Array.from(n));var u=$v(n[0]),d=u.parentNode,p=getComputedStyle?getComputedStyle(d):null,f=p?p.flexDirection:null,g=At(e,"sizes")||n.map(function(){return 100/n.length}),_=At(e,"minSize",100),k=Array.isArray(_)?_:n.map(function(){return _}),I=At(e,"maxSize",1/0),x=Array.isArray(I)?I:n.map(function(){return I}),v=At(e,"expandToMin",!1),w=At(e,"gutterSize",10),M=At(e,"gutterAlign","center"),O=At(e,"snapOffset",30),D=Array.isArray(O)?O:n.map(function(){return O}),S=At(e,"dragInterval",1),E=At(e,"direction",Su),C=At(e,"cursor",E===Su?"col-resize":"row-resize"),b=At(e,"gutter",Q6),A=At(e,"elementStyle",G6),N=At(e,"gutterStyle",Y6);E===Su?(r="width",i="clientX",s="left",o="right",a="clientWidth"):E==="vertical"&&(r="height",i="clientY",s="top",o="bottom",a="clientHeight");function P(J,q,Q,G){var Ie=A(r,q,Q,G);Object.keys(Ie).forEach(function(De){J.style[De]=Ie[De]})}function se(J,q,Q){var G=N(r,q,Q);Object.keys(G).forEach(function(Ie){J.style[Ie]=G[Ie]})}function $(){return l.map(function(J){return J.size})}function ae(J){return"touches"in J?J.touches[0][i]:J[i]}function ye(J){var q=l[this.a],Q=l[this.b],G=q.size+Q.size;q.size=J/this.size*G,Q.size=G-J/this.size*G,P(q.element,q.size,this[Pn],q.i),P(Q.element,Q.size,this[fr],Q.i)}function W(J){var q,Q=l[this.a],G=l[this.b];this.dragging&&(q=ae(J)-this.start+(this[Pn]-this.dragOffset),S>1&&(q=Math.round(q/S)*S),q<=Q.minSize+Q.snapOffset+this[Pn]?q=Q.minSize+this[Pn]:q>=this.size-(G.minSize+G.snapOffset+this[fr])&&(q=this.size-(G.minSize+this[fr])),q>=Q.maxSize-Q.snapOffset+this[Pn]?q=Q.maxSize+this[Pn]:q<=this.size-(G.maxSize-G.snapOffset+this[fr])&&(q=this.size-(G.maxSize+this[fr])),ye.call(this,q),At(e,"onDrag",Rn)($()))}function ee(){var J=l[this.a].element,q=l[this.b].element,Q=J[mh](),G=q[mh]();this.size=Q[r]+G[r]+this[Pn]+this[fr],this.start=Q[s],this.end=Q[o]}function R(J){if(!getComputedStyle)return null;var q=getComputedStyle(J);if(!q)return null;var Q=J[a];return Q===0?null:(E===Su?Q-=parseFloat(q.paddingLeft)+parseFloat(q.paddingRight):Q-=parseFloat(q.paddingTop)+parseFloat(q.paddingBottom),Q)}function Z(J){var q=R(d);if(q===null||k.reduce(function(De,nt){return De+nt},0)>q)return J;var Q=0,G=[],Ie=J.map(function(De,nt){var hn=q*De/100,Tn=Cu(w,nt===0,nt===J.length-1,M),Sn=k[nt]+Tn;return hn<Sn?(Q+=Sn-hn,G.push(0),Sn):(G.push(hn-Sn),hn)});return Q===0?J:Ie.map(function(De,nt){var hn=De;if(Q>0&&G[nt]-Q>0){var Tn=Math.min(Q,G[nt]-Q);Q-=Tn,hn=De-Tn}return hn/q*100})}function re(){var J=this,q=l[J.a].element,Q=l[J.b].element;J.dragging&&At(e,"onDragEnd",Rn)($()),J.dragging=!1,fn[An]("mouseup",J.stop),fn[An]("touchend",J.stop),fn[An]("touchcancel",J.stop),fn[An]("mousemove",J.move),fn[An]("touchmove",J.move),J.stop=null,J.move=null,q[An]("selectstart",Rn),q[An]("dragstart",Rn),Q[An]("selectstart",Rn),Q[An]("dragstart",Rn),q.style.userSelect="",q.style.webkitUserSelect="",q.style.MozUserSelect="",q.style.pointerEvents="",Q.style.userSelect="",Q.style.webkitUserSelect="",Q.style.MozUserSelect="",Q.style.pointerEvents="",J.gutter.style.cursor="",J.parent.style.cursor="",gl.body.style.cursor=""}function L(J){if(!("button"in J&&J.button!==0)){var q=this,Q=l[q.a].element,G=l[q.b].element;q.dragging||At(e,"onDragStart",Rn)($()),J.preventDefault(),q.dragging=!0,q.move=W.bind(q),q.stop=re.bind(q),fn[In]("mouseup",q.stop),fn[In]("touchend",q.stop),fn[In]("touchcancel",q.stop),fn[In]("mousemove",q.move),fn[In]("touchmove",q.move),Q[In]("selectstart",Rn),Q[In]("dragstart",Rn),G[In]("selectstart",Rn),G[In]("dragstart",Rn),Q.style.userSelect="none",Q.style.webkitUserSelect="none",Q.style.MozUserSelect="none",Q.style.pointerEvents="none",G.style.userSelect="none",G.style.webkitUserSelect="none",G.style.MozUserSelect="none",G.style.pointerEvents="none",q.gutter.style.cursor=C,q.parent.style.cursor=C,gl.body.style.cursor=C,ee.call(q),q.dragOffset=ae(J)-q.end}}g=Z(g);var he=[];l=n.map(function(J,q){var Q={element:$v(J),size:g[q],minSize:k[q],maxSize:x[q],snapOffset:D[q],i:q},G;if(q>0&&(G={a:q-1,b:q,dragging:!1,direction:E,parent:d},G[Pn]=Cu(w,q-1===0,!1,M),G[fr]=Cu(w,!1,q===n.length-1,M),f==="row-reverse"||f==="column-reverse")){var Ie=G.a;G.a=G.b,G.b=Ie}if(q>0){var De=b(q,E,Q.element);se(De,w,q),G[da]=L.bind(G),De[In]("mousedown",G[da]),De[In]("touchstart",G[da]),d.insertBefore(De,Q.element),G.gutter=De}return P(Q.element,Q.size,Cu(w,q===0,q===n.length-1,M),q),q>0&&he.push(G),Q});function Ae(J){var q=J.i===he.length,Q=q?he[J.i-1]:he[J.i];ee.call(Q);var G=q?Q.size-J.minSize-Q[fr]:J.minSize+Q[Pn];ye.call(Q,G)}l.forEach(function(J){var q=J.element[mh]()[r];q<J.minSize&&(v?Ae(J):J.minSize=q)});function Ee(J){var q=Z(J);q.forEach(function(Q,G){if(G>0){var Ie=he[G-1],De=l[Ie.a],nt=l[Ie.b];De.size=q[G-1],nt.size=Q,P(De.element,De.size,Ie[Pn],De.i),P(nt.element,nt.size,Ie[fr],nt.i)}})}function He(J,q){he.forEach(function(Q){if(q!==!0?Q.parent.removeChild(Q.gutter):(Q.gutter[An]("mousedown",Q[da]),Q.gutter[An]("touchstart",Q[da])),J!==!0){var G=A(r,Q.a.size,Q[Pn]);Object.keys(G).forEach(function(Ie){l[Q.a].element.style[Ie]="",l[Q.b].element.style[Ie]=""})}})}return{setSizes:Ee,getSizes:$,collapse:function(q){Ae(l[q])},destroy:He,parent:d,pairs:he}};function gh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)===-1&&(n[r]=t[r]);return n}var so=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.componentDidMount=function(){var r=this.props;r.children;var i=r.gutter,s=gh(r,["children","gutter"]),o=s;o.gutter=function(a,l){var u;return i?u=i(a,l):(u=document.createElement("div"),u.className="gutter gutter-"+l),u.__isSplitGutter=!0,u},this.split=Kv(this.parent.children,o)},e.prototype.componentDidUpdate=function(r){var i=this,s=this.props;s.children;var o=s.minSize,a=s.sizes,l=s.collapsed,u=gh(s,["children","minSize","sizes","collapsed"]),d=u,p=r.minSize,f=r.sizes,g=r.collapsed,_=["maxSize","expandToMin","gutterSize","gutterAlign","snapOffset","dragInterval","direction","cursor"],k=_.map(function(v){return i.props[v]!==r[v]}).reduce(function(v,w){return v||w},!1);if(Array.isArray(o)&&Array.isArray(p)){var I=!1;o.forEach(function(v,w){I=I||v!==p[w]}),k=k||I}else Array.isArray(o)||Array.isArray(p)?k=!0:k=k||o!==p;if(k)d.minSize=o,d.sizes=a||this.split.getSizes(),this.split.destroy(!0,!0),d.gutter=function(v,w,M){return M.previousSibling},this.split=Kv(Array.from(this.parent.children).filter(function(v){return!v.__isSplitGutter}),d);else if(a){var x=!1;a.forEach(function(v,w){x=x||v!==f[w]}),x&&this.split.setSizes(this.props.sizes)}Number.isInteger(l)&&(l!==g||k)&&this.split.collapse(l)},e.prototype.componentWillUnmount=function(){this.split.destroy(),delete this.split},e.prototype.render=function(){var r=this,i=this.props;i.sizes,i.minSize,i.maxSize,i.expandToMin,i.gutterSize,i.gutterAlign,i.snapOffset,i.dragInterval,i.direction,i.cursor,i.gutter,i.elementStyle,i.gutterStyle,i.onDrag,i.onDragStart,i.onDragEnd,i.collapsed;var s=i.children,o=gh(i,["sizes","minSize","maxSize","expandToMin","gutterSize","gutterAlign","snapOffset","dragInterval","direction","cursor","gutter","elementStyle","gutterStyle","onDrag","onDragStart","onDragEnd","collapsed","children"]),a=o;return _t.createElement("div",Object.assign({},{ref:function(l){r.parent=l}},a),s)},e}(_t.Component);so.propTypes={sizes:Ne.arrayOf(Ne.number),minSize:Ne.oneOfType([Ne.number,Ne.arrayOf(Ne.number)]),maxSize:Ne.oneOfType([Ne.number,Ne.arrayOf(Ne.number)]),expandToMin:Ne.bool,gutterSize:Ne.number,gutterAlign:Ne.string,snapOffset:Ne.oneOfType([Ne.number,Ne.arrayOf(Ne.number)]),dragInterval:Ne.number,direction:Ne.string,cursor:Ne.string,gutter:Ne.func,elementStyle:Ne.func,gutterStyle:Ne.func,onDrag:Ne.func,onDragStart:Ne.func,onDragEnd:Ne.func,collapsed:Ne.number,children:Ne.arrayOf(Ne.element)};so.defaultProps={sizes:void 0,minSize:void 0,maxSize:void 0,expandToMin:void 0,gutterSize:void 0,gutterAlign:void 0,snapOffset:void 0,dragInterval:void 0,direction:void 0,cursor:void 0,gutter:void 0,elementStyle:void 0,gutterStyle:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0,collapsed:void 0,children:void 0};function xT(){const[t,e]=z.useState(!1),[n,r]=z.useState(!1),[i,s]=z.useState(null),[o,a]=z.useState([]),l=z.useRef(null),u=z.useRef(!1),d=z.useCallback(k=>{a(I=>[...I,k])},[]),p=z.useCallback(()=>{a([])},[]),f=z.useCallback(async()=>{if(!(l.current||u.current)){u.current=!0,e(!0),s(null);try{window.loadPyodide||await new Promise((I,x)=>{const v=document.createElement("script");v.src="https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js",v.async=!0,v.onload=()=>I(),v.onerror=()=>x(new Error("Failed to load Pyodide")),document.head.appendChild(v)});const k=await window.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.26.4/full/"});k.setStdout({batched:I=>{I.split(`
`).forEach(v=>{v.trim()&&d(v)})}}),k.setStderr({batched:I=>{I.split(`
`).forEach(v=>{v.trim()&&d(`[Error] ${v}`)})}}),await k.loadPackage(["numpy"]),l.current=k,r(!0),d("Python environment ready with NumPy loaded.")}catch(k){const I=k instanceof Error?k.message:"Failed to initialize Python";s(I),d(`[Error] ${I}`)}finally{e(!1),u.current=!1}}},[d]);z.useEffect(()=>{f()},[f]);const g=z.useCallback(async k=>{if(!l.current)return{success:!1,error:"Python environment not ready"};try{return p(),await l.current.runPythonAsync(k),{success:!0}}catch(I){const x=I instanceof Error?I.message:"Execution error";return d(`[Error] ${x}`),{success:!1,error:x}}},[d,p]),_=z.useCallback(async(k,I,x)=>{if(!l.current)return I.map(w=>({id:w.id,passed:!1,description:w.description,expected:w.expected,actual:"Python environment not ready",hidden:w.hidden}));const v=[];p();try{await l.current.runPythonAsync(k);for(const w of I)try{const M=w.input.includes(x)||w.input.includes(".")||/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(w.input.trim()),O=w.input.trim().startsWith("(lambda");let D;M&&!w.input.startsWith("[")&&(!w.input.startsWith("(")||O)?D=`
import numpy as np
import json

# Evaluate expression directly
result = ${w.input}

# Convert result to string for comparison
if isinstance(result, bool):
    result_str = str(result)
elif isinstance(result, (np.bool_, )):
    result_str = str(bool(result))
elif isinstance(result, np.ndarray):
    result_str = str(result.tolist())
elif isinstance(result, tuple):
    # Convert tuple elements
    converted = []
    for item in result:
        if isinstance(item, bool):
            converted.append(item)
        elif isinstance(item, (np.bool_, )):
            converted.append(bool(item))
        elif isinstance(item, np.ndarray):
            converted.append(item.tolist())
        elif isinstance(item, (np.floating, float)):
            converted.append(round(float(item), 6))
        elif isinstance(item, (np.integer, int)):
            converted.append(int(item))
        else:
            converted.append(item)
    result_str = str(tuple(converted))
elif isinstance(result, (list, dict)):
    result_str = json.dumps(result)
elif isinstance(result, (np.floating, float)):
    result_str = str(round(float(result), 6))
elif isinstance(result, (np.integer, int)):
    result_str = str(int(result))
else:
    result_str = str(result)
result_str
`:D=`
import numpy as np
import json

# Parse input
test_input = ${w.input}

# Call the function
if isinstance(test_input, list):
    result = ${x}(np.array(test_input))
elif isinstance(test_input, tuple):
    result = ${x}(*[np.array(x) if isinstance(x, list) else x for x in test_input])
else:
    result = ${x}(test_input)

# Convert result to string for comparison
if isinstance(result, bool):
    result_str = str(result)
elif isinstance(result, (np.bool_, )):
    result_str = str(bool(result))
elif isinstance(result, np.ndarray):
    result_str = str(result.tolist())
elif isinstance(result, tuple):
    # Convert tuple elements
    converted = []
    for item in result:
        if isinstance(item, bool):
            converted.append(item)
        elif isinstance(item, (np.bool_, )):
            converted.append(bool(item))
        elif isinstance(item, np.ndarray):
            converted.append(item.tolist())
        elif isinstance(item, (np.floating, float)):
            converted.append(round(float(item), 6))
        elif isinstance(item, (np.integer, int)):
            converted.append(int(item))
        else:
            converted.append(item)
    result_str = str(tuple(converted))
elif isinstance(result, (list, dict)):
    result_str = json.dumps(result)
elif isinstance(result, (np.floating, float)):
    result_str = str(round(float(result), 6))
elif isinstance(result, (np.integer, int)):
    result_str = str(int(result))
else:
    result_str = str(result)
result_str
`;const S=await l.current.runPythonAsync(D),E=String(S),C=w.expected.replace(/\s/g,""),b=E.replace(/\s/g,""),A=C===b;v.push({id:w.id,passed:A,description:w.description,expected:w.expected,actual:E,hidden:w.hidden}),d(A?`Test ${w.id}: PASSED`:`Test ${w.id}: FAILED - Expected ${w.expected}, got ${E}`)}catch(M){const O=M instanceof Error?M.message:"Test execution error";v.push({id:w.id,passed:!1,description:w.description,expected:w.expected,actual:O,hidden:w.hidden}),d(`Test ${w.id}: ERROR - ${O}`)}}catch(w){const M=w instanceof Error?w.message:"Code execution error";return d(`[Error] ${M}`),I.map(O=>({id:O.id,passed:!1,description:O.description,expected:O.expected,actual:M,hidden:O.hidden}))}return v},[d,p]);return{isLoading:t,isReady:n,error:i,output:o,runCode:g,runTests:_,clearOutput:p}}function Qv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function X6(t){if(Array.isArray(t))return t}function J6(t,e,n){return(e=s9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z6(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,o,a=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return a}}function e9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Yv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Gv(Object(n),!0).forEach(function(r){J6(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function t9(t,e){if(t==null)return{};var n,r,i=n9(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function n9(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function r9(t,e){return X6(t)||Z6(t,e)||o9(t,e)||e9()}function i9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s9(t){var e=i9(t,"string");return typeof e=="symbol"?e:e+""}function o9(t,e){if(t){if(typeof t=="string")return Qv(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qv(t,e):void 0}}function a9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Jv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xv(Object(n),!0).forEach(function(r){a9(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function l9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return e.reduceRight(function(i,s){return s(i)},r)}}function va(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function td(t){return{}.toString.call(t).includes("Object")}function u9(t){return!Object.keys(t).length}function yl(t){return typeof t=="function"}function c9(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function d9(t,e){return td(e)||gi("changeType"),Object.keys(e).some(function(n){return!c9(t,n)})&&gi("changeField"),e}function p9(t){yl(t)||gi("selectorType")}function h9(t){yl(t)||td(t)||gi("handlerType"),td(t)&&Object.values(t).some(function(e){return!yl(e)})&&gi("handlersType")}function f9(t){t||gi("initialIsRequired"),td(t)||gi("initialType"),u9(t)&&gi("initialContent")}function m9(t,e){throw new Error(t[e]||t.default)}var g9={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},gi=va(m9)(g9),Iu={changes:d9,selector:p9,handler:h9,initial:f9};function y9(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Iu.initial(t),Iu.handler(e);var n={current:t},r=va(v9)(n,e),i=va(x9)(n),s=va(Iu.changes)(t),o=va(_9)(n);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(d){return d};return Iu.selector(u),u(n.current)}function l(u){l9(r,i,s,o)(u)}return[a,l]}function _9(t,e){return yl(e)?e(t.current):e}function x9(t,e){return t.current=Jv(Jv({},t.current),e),e}function v9(t,e,n){return yl(e)?e(t.current):Object.keys(n).forEach(function(r){var i;return(i=e[r])===null||i===void 0?void 0:i.call(e,t.current[r])}),n}var b9={create:y9},w9={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function k9(t){return function e(){for(var n=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length>=t.length?t.apply(this,i):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(n,[].concat(i,a))}}}function E9(t){return{}.toString.call(t).includes("Object")}function T9(t){return t||Zv("configIsRequired"),E9(t)||Zv("configType"),t.urls?(S9(),{paths:{vs:t.urls.monacoBase}}):t}function S9(){console.warn(vT.deprecation)}function C9(t,e){throw new Error(t[e]||t.default)}var vT={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Zv=k9(C9)(vT),I9={config:T9},A9=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(i){return n.reduceRight(function(s,o){return o(s)},i)}};function bT(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],bT(t[n],e[n]))}),Yv(Yv({},t),e)}var P9={type:"cancelation",msg:"operation is manually canceled"};function yh(t){var e=!1,n=new Promise(function(r,i){t.then(function(s){return e?i(P9):r(s)}),t.catch(i)});return n.cancel=function(){return e=!0},n}var R9=["monaco"],N9=b9.create({config:w9,isInitialized:!1,resolve:null,reject:null,monaco:null}),wT=r9(N9,2),Vl=wT[0],$d=wT[1];function L9(t){var e=I9.config(t),n=e.monaco,r=t9(e,R9);$d(function(i){return{config:bT(i.config,r),monaco:n}})}function D9(){var t=Vl(function(e){var n=e.monaco,r=e.isInitialized,i=e.resolve;return{monaco:n,isInitialized:r,resolve:i}});if(!t.isInitialized){if($d({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),yh(_h);if(window.monaco&&window.monaco.editor)return kT(window.monaco),t.resolve(window.monaco),yh(_h);A9(O9,M9)(j9)}return yh(_h)}function O9(t){return document.body.appendChild(t)}function z9(t){var e=document.createElement("script");return t&&(e.src=t),e}function M9(t){var e=Vl(function(r){var i=r.config,s=r.reject;return{config:i,reject:s}}),n=z9("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function j9(){var t=Vl(function(n){var r=n.config,i=n.resolve,s=n.reject;return{config:r,resolve:i,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){var r=n.m||n;kT(r),t.resolve(r)},function(n){t.reject(n)})}function kT(t){Vl().monaco||$d({monaco:t})}function V9(){return Vl(function(t){var e=t.monaco;return e})}var _h=new Promise(function(t,e){return $d({resolve:t,reject:e})}),ET={config:L9,init:D9,__getMonacoInstance:V9},F9={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},xh=F9,U9={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},q9=U9;function B9({children:t}){return _t.createElement("div",{style:q9.container},t)}var W9=B9,H9=W9;function $9({width:t,height:e,isEditorReady:n,loading:r,_ref:i,className:s,wrapperProps:o}){return _t.createElement("section",{style:{...xh.wrapper,width:t,height:e},...o},!n&&_t.createElement(H9,null,r),_t.createElement("div",{ref:i,style:{...xh.fullWidth,...!n&&xh.hide},className:s}))}var K9=$9,TT=z.memo(K9);function Q9(t){z.useEffect(t,[])}var ST=Q9;function G9(t,e,n=!0){let r=z.useRef(!0);z.useEffect(r.current||!n?()=>{r.current=!1}:t,e)}var sn=G9;function Fa(){}function Ws(t,e,n,r){return Y9(t,r)||X9(t,e,n,r)}function Y9(t,e){return t.editor.getModel(CT(t,e))}function X9(t,e,n,r){return t.editor.createModel(e,n,r?CT(t,r):void 0)}function CT(t,e){return t.Uri.parse(e)}function J9({original:t,modified:e,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:u="light",loading:d="Loading...",options:p={},height:f="100%",width:g="100%",className:_,wrapperProps:k={},beforeMount:I=Fa,onMount:x=Fa}){let[v,w]=z.useState(!1),[M,O]=z.useState(!0),D=z.useRef(null),S=z.useRef(null),E=z.useRef(null),C=z.useRef(x),b=z.useRef(I),A=z.useRef(!1);ST(()=>{let $=ET.init();return $.then(ae=>(S.current=ae)&&O(!1)).catch(ae=>(ae==null?void 0:ae.type)!=="cancelation"&&console.error("Monaco initialization: error:",ae)),()=>D.current?se():$.cancel()}),sn(()=>{if(D.current&&S.current){let $=D.current.getOriginalEditor(),ae=Ws(S.current,t||"",r||n||"text",s||"");ae!==$.getModel()&&$.setModel(ae)}},[s],v),sn(()=>{if(D.current&&S.current){let $=D.current.getModifiedEditor(),ae=Ws(S.current,e||"",i||n||"text",o||"");ae!==$.getModel()&&$.setModel(ae)}},[o],v),sn(()=>{let $=D.current.getModifiedEditor();$.getOption(S.current.editor.EditorOption.readOnly)?$.setValue(e||""):e!==$.getValue()&&($.executeEdits("",[{range:$.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),$.pushUndoStop())},[e],v),sn(()=>{var $,ae;(ae=($=D.current)==null?void 0:$.getModel())==null||ae.original.setValue(t||"")},[t],v),sn(()=>{let{original:$,modified:ae}=D.current.getModel();S.current.editor.setModelLanguage($,r||n||"text"),S.current.editor.setModelLanguage(ae,i||n||"text")},[n,r,i],v),sn(()=>{var $;($=S.current)==null||$.editor.setTheme(u)},[u],v),sn(()=>{var $;($=D.current)==null||$.updateOptions(p)},[p],v);let N=z.useCallback(()=>{var ye;if(!S.current)return;b.current(S.current);let $=Ws(S.current,t||"",r||n||"text",s||""),ae=Ws(S.current,e||"",i||n||"text",o||"");(ye=D.current)==null||ye.setModel({original:$,modified:ae})},[n,e,i,t,r,s,o]),P=z.useCallback(()=>{var $;!A.current&&E.current&&(D.current=S.current.editor.createDiffEditor(E.current,{automaticLayout:!0,...p}),N(),($=S.current)==null||$.editor.setTheme(u),w(!0),A.current=!0)},[p,u,N]);z.useEffect(()=>{v&&C.current(D.current,S.current)},[v]),z.useEffect(()=>{!M&&!v&&P()},[M,v,P]);function se(){var ae,ye,W,ee;let $=(ae=D.current)==null?void 0:ae.getModel();a||((ye=$==null?void 0:$.original)==null||ye.dispose()),l||((W=$==null?void 0:$.modified)==null||W.dispose()),(ee=D.current)==null||ee.dispose()}return _t.createElement(TT,{width:g,height:f,isEditorReady:v,loading:d,_ref:E,className:_,wrapperProps:k})}var Z9=J9;z.memo(Z9);function eU(t){let e=z.useRef();return z.useEffect(()=>{e.current=t},[t]),e.current}var tU=eU,Au=new Map;function nU({defaultValue:t,defaultLanguage:e,defaultPath:n,value:r,language:i,path:s,theme:o="light",line:a,loading:l="Loading...",options:u={},overrideServices:d={},saveViewState:p=!0,keepCurrentModel:f=!1,width:g="100%",height:_="100%",className:k,wrapperProps:I={},beforeMount:x=Fa,onMount:v=Fa,onChange:w,onValidate:M=Fa}){let[O,D]=z.useState(!1),[S,E]=z.useState(!0),C=z.useRef(null),b=z.useRef(null),A=z.useRef(null),N=z.useRef(v),P=z.useRef(x),se=z.useRef(),$=z.useRef(r),ae=tU(s),ye=z.useRef(!1),W=z.useRef(!1);ST(()=>{let Z=ET.init();return Z.then(re=>(C.current=re)&&E(!1)).catch(re=>(re==null?void 0:re.type)!=="cancelation"&&console.error("Monaco initialization: error:",re)),()=>b.current?R():Z.cancel()}),sn(()=>{var re,L,he,Ae;let Z=Ws(C.current,t||r||"",e||i||"",s||n||"");Z!==((re=b.current)==null?void 0:re.getModel())&&(p&&Au.set(ae,(L=b.current)==null?void 0:L.saveViewState()),(he=b.current)==null||he.setModel(Z),p&&((Ae=b.current)==null||Ae.restoreViewState(Au.get(s))))},[s],O),sn(()=>{var Z;(Z=b.current)==null||Z.updateOptions(u)},[u],O),sn(()=>{!b.current||r===void 0||(b.current.getOption(C.current.editor.EditorOption.readOnly)?b.current.setValue(r):r!==b.current.getValue()&&(W.current=!0,b.current.executeEdits("",[{range:b.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),b.current.pushUndoStop(),W.current=!1))},[r],O),sn(()=>{var re,L;let Z=(re=b.current)==null?void 0:re.getModel();Z&&i&&((L=C.current)==null||L.editor.setModelLanguage(Z,i))},[i],O),sn(()=>{var Z;a!==void 0&&((Z=b.current)==null||Z.revealLine(a))},[a],O),sn(()=>{var Z;(Z=C.current)==null||Z.editor.setTheme(o)},[o],O);let ee=z.useCallback(()=>{var Z;if(!(!A.current||!C.current)&&!ye.current){P.current(C.current);let re=s||n,L=Ws(C.current,r||t||"",e||i||"",re||"");b.current=(Z=C.current)==null?void 0:Z.editor.create(A.current,{model:L,automaticLayout:!0,...u},d),p&&b.current.restoreViewState(Au.get(re)),C.current.editor.setTheme(o),a!==void 0&&b.current.revealLine(a),D(!0),ye.current=!0}},[t,e,n,r,i,s,u,d,p,o,a]);z.useEffect(()=>{O&&N.current(b.current,C.current)},[O]),z.useEffect(()=>{!S&&!O&&ee()},[S,O,ee]),$.current=r,z.useEffect(()=>{var Z,re;O&&w&&((Z=se.current)==null||Z.dispose(),se.current=(re=b.current)==null?void 0:re.onDidChangeModelContent(L=>{W.current||w(b.current.getValue(),L)}))},[O,w]),z.useEffect(()=>{if(O){let Z=C.current.editor.onDidChangeMarkers(re=>{var he;let L=(he=b.current.getModel())==null?void 0:he.uri;if(L&&re.find(Ae=>Ae.path===L.path)){let Ae=C.current.editor.getModelMarkers({resource:L});M==null||M(Ae)}});return()=>{Z==null||Z.dispose()}}return()=>{}},[O,M]);function R(){var Z,re;(Z=se.current)==null||Z.dispose(),f?p&&Au.set(s,b.current.saveViewState()):(re=b.current.getModel())==null||re.dispose(),b.current.dispose()}return _t.createElement(TT,{width:g,height:_,isEditorReady:O,loading:l,_ref:A,className:k,wrapperProps:I})}var rU=nU,iU=z.memo(rU),sU=iU;function nc({value:t,onChange:e,height:n="400px",onRun:r,darkMode:i}){const s=z.useRef(null),o=z.useRef(r);z.useEffect(()=>{o.current=r},[r]);const a=z.useCallback(d=>{e(d||"")},[e]),l=z.useCallback((d,p)=>{s.current=d,d.addAction({id:"run-tests",label:"Run Tests",keybindings:[p.KeyMod.Shift|p.KeyCode.Enter],run:()=>{o.current&&o.current()}})},[]),u=i?"vs-dark":"light";return h.jsx("div",{className:"h-full border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden shadow-sm",children:h.jsx(sU,{height:n,defaultLanguage:"python",theme:u,value:t,onChange:a,onMount:l,options:{minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:4,wordWrap:"on",padding:{top:16,bottom:16},scrollbar:{verticalScrollbarSize:8,horizontalScrollbarSize:8}}})})}function oU(t){const e=t.filter(n=>!n.hidden);return e.length===0?"":e.map((n,r)=>`# Test ${r+1}: ${n.description}
input: ${n.input}
expected: ${n.expected}`).join(`

`)}function aU(t,e){const n=e.filter(s=>s.hidden);return t.trim()?[...t.split(/\n\n+/).filter(s=>s.trim()).map((s,o)=>{const a=s.split(`
`);let l=`Test ${o+1}`,u="",d="";for(const p of a)if(p.startsWith("# Test")){const f=p.match(/# Test \d+: (.+)/);f&&(l=f[1])}else p.startsWith("input:")?u=p.replace("input:","").trim():p.startsWith("expected:")&&(d=p.replace("expected:","").trim());return{id:String(o+1),description:l,input:u,expected:d,hidden:!1}}).filter(s=>s.input&&s.expected),...n]:n}function rc({output:t,isLoading:e=!1,testCases:n,onTestCasesChange:r,problemId:i,resetKey:s=0,testResults:o}){const a=z.useRef(null),[l,u]=z.useState("tests"),[d,p]=z.useState(""),f=z.useRef(void 0),g=z.useRef(0),_=(n==null?void 0:n.filter(O=>!O.hidden).length)??0,k=(n==null?void 0:n.filter(O=>O.hidden).length)??0;z.useEffect(()=>{if(n&&n.length>0){const O=i!==f.current,D=s!==g.current,S=n.filter(C=>!C.hidden),E=d===""&&S.length>0;(O||D||E)&&(p(oU(n)),f.current=i,g.current=s,O&&u("tests"))}},[n,i,s,d]),z.useEffect(()=>{o&&o.length>0&&u("results")},[o]),z.useEffect(()=>{t.length>0&&(!o||o.length===0)&&u("output")},[t,o]),z.useEffect(()=>{var O;l==="output"&&((O=a.current)==null||O.scrollIntoView({behavior:"smooth"}))},[t,l]);const I=O=>{if(p(O),r&&n){const D=aU(O,n);r(D)}},x=n&&_>0,v=(o==null?void 0:o.filter(O=>O.passed).length)??0,w=(o==null?void 0:o.length)??0,M=(o==null?void 0:o.filter(O=>!O.hidden))??[];return h.jsxs("div",{className:"bg-white dark:bg-dark-800 border border-gray-200 dark:border-dark-500 rounded-lg h-full flex flex-col",children:[h.jsxs("div",{className:"flex items-center justify-between px-2 py-1 border-b border-gray-200 dark:border-dark-500 bg-gray-50 dark:bg-dark-900",children:[h.jsxs("div",{className:"flex",children:[x&&h.jsxs("button",{onClick:()=>u("tests"),className:`px-3 py-1.5 text-sm font-medium rounded-t transition-colors ${l==="tests"?"text-primary-600 dark:text-primary-300 bg-white dark:bg-dark-800 border-t border-l border-r border-gray-200 dark:border-dark-500 -mb-px":"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100"}`,children:["Tests (",_,")"]}),h.jsx("button",{onClick:()=>u("output"),className:`px-3 py-1.5 text-sm font-medium rounded-t transition-colors ${l==="output"?"text-primary-600 dark:text-primary-300 bg-white dark:bg-dark-800 border-t border-l border-r border-gray-200 dark:border-dark-500 -mb-px":"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100"}`,children:"Output"}),o&&o.length>0&&h.jsxs("button",{onClick:()=>u("results"),className:`px-3 py-1.5 text-sm font-medium rounded-t transition-colors ${l==="results"?"text-primary-600 dark:text-primary-300 bg-white dark:bg-dark-800 border-t border-l border-r border-gray-200 dark:border-dark-500 -mb-px":"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100"}`,children:["Results (",v,"/",w,")"]})]}),e&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-pulse"}),h.jsx("span",{className:"text-xs text-gray-500 dark:text-dark-200",children:"Running..."})]})]}),l==="tests"&&x?h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsx("textarea",{value:d,onChange:O=>I(O.target.value),className:"flex-1 p-4 font-mono text-sm bg-dark-900 text-dark-200 resize-none focus:outline-none",placeholder:`# Test 1: Description
input: your_function(args)
expected: expected_result`,spellCheck:!1}),k>0&&h.jsxs("div",{className:"px-4 py-2 bg-dark-800 text-dark-300 text-xs border-t border-dark-500",children:["+ ",k," hidden test",k>1?"s":""," (not editable)"]})]}):l==="results"&&o&&o.length>0?h.jsxs("div",{className:"flex-1 overflow-auto",children:[h.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-dark-500 flex items-center justify-between bg-gray-50 dark:bg-dark-900",children:[h.jsx("span",{className:"font-medium text-gray-900 dark:text-dark-100 text-sm",children:"Test Results"}),h.jsxs("span",{className:`text-sm font-medium font-mono ${v===w?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400"}`,children:[v,"/",w," passed"]})]}),h.jsxs("div",{className:"divide-y divide-gray-200 dark:divide-dark-500",children:[M.map(O=>h.jsxs("div",{className:"p-4",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("span",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs ${O.passed?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400"}`,children:O.passed?"":""}),h.jsxs("span",{className:"text-gray-700 dark:text-dark-100 text-sm font-medium",children:["Test ",O.id,": ",O.description]})]}),!O.passed&&h.jsxs("div",{className:"ml-7 space-y-1 text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-gray-500 dark:text-dark-300",children:"Expected: "}),h.jsx("span",{className:"text-green-600 dark:text-green-400 font-mono",children:O.expected})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-gray-500 dark:text-dark-300",children:"Actual: "}),h.jsx("span",{className:"text-red-600 dark:text-red-400 font-mono",children:O.actual})]})]})]},O.id)),o.some(O=>O.hidden)&&h.jsxs("div",{className:"p-4 text-gray-500 dark:text-dark-300 text-sm italic",children:["+ ",o.filter(O=>O.hidden).length," hidden test(s)",o.filter(O=>O.hidden&&O.passed).length===o.filter(O=>O.hidden).length?h.jsx("span",{className:"text-green-600 dark:text-green-400 ml-2",children:"(all passed)"}):h.jsxs("span",{className:"text-red-600 dark:text-red-400 ml-2",children:["(",o.filter(O=>O.hidden&&!O.passed).length," failed)"]})]})]})]}):h.jsxs("div",{className:"flex-1 overflow-auto p-4 font-mono text-sm bg-dark-900 rounded-b-lg",children:[t.length===0?h.jsx("div",{className:"text-dark-300 italic",children:"Output will appear here when you run your code..."}):t.map((O,D)=>h.jsx("div",{className:`py-0.5 ${O.startsWith("[Error]")?"text-red-400":O.includes("PASSED")?"text-green-400":O.includes("FAILED")?"text-red-400":"text-dark-200"}`,children:O.startsWith("Test")?h.jsxs("span",{children:[O.includes("PASSED")?" ":O.includes("FAILED")?" ":"",O]}):h.jsxs("span",{children:["> ",O]})},D)),h.jsx("div",{ref:a})]})]})}function e1({problem:t}){return h.jsxs("div",{className:"prose prose-sm max-w-none overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-dark-100 m-0",children:t.title}),h.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium whitespace-nowrap ${t.difficulty==="easy"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":t.difficulty==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:t.difficulty})]}),h.jsx(B2,{remarkPlugins:[hT],components:{h2:({children:e})=>h.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-dark-100 mt-6 mb-3",children:e}),h3:({children:e})=>h.jsx("h3",{className:"text-base font-medium text-gray-700 dark:text-dark-200 mt-4 mb-2",children:e}),p:({children:e})=>h.jsx("p",{className:"text-gray-600 dark:text-dark-200 mb-3 leading-relaxed",children:e}),code:({className:e,children:n})=>(e==null?void 0:e.includes("language-"))?h.jsx("pre",{className:"bg-gray-100 dark:bg-dark-900 rounded-lg p-4 overflow-x-auto my-3",children:h.jsx("code",{className:"text-sm text-gray-800 dark:text-dark-100",children:n})}):h.jsx("code",{className:"bg-gray-100 dark:bg-dark-600 px-1.5 py-0.5 rounded text-primary-600 dark:text-primary-300 text-sm break-words",children:n}),ul:({children:e})=>h.jsx("ul",{className:"list-disc list-inside text-gray-600 dark:text-dark-200 space-y-1 mb-3",children:e}),li:({children:e})=>h.jsx("li",{className:"text-gray-600 dark:text-dark-200",children:e}),table:({children:e})=>h.jsx("div",{className:"overflow-x-auto my-4",children:h.jsx("table",{className:"min-w-full border-collapse border border-gray-300 dark:border-dark-500 text-sm",children:e})}),thead:({children:e})=>h.jsx("thead",{className:"bg-gray-100 dark:bg-dark-600",children:e}),tbody:({children:e})=>h.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-dark-500",children:e}),tr:({children:e})=>h.jsx("tr",{children:e}),th:({children:e})=>h.jsx("th",{className:"border border-gray-300 dark:border-dark-500 px-3 py-2 text-left font-semibold text-gray-700 dark:text-dark-200",children:e}),td:({children:e})=>h.jsx("td",{className:"border border-gray-300 dark:border-dark-500 px-3 py-2 text-gray-600 dark:text-dark-200",children:e})},children:t.description})]})}function t1({examples:t}){return h.jsxs("div",{children:[h.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-dark-100 mb-3",children:"Examples"}),h.jsx("div",{className:"space-y-4",children:t.map((e,n)=>h.jsx("div",{className:"bg-white dark:bg-dark-800 rounded-lg p-4 border border-gray-200 dark:border-dark-500 shadow-sm",children:h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("span",{className:"text-gray-500 dark:text-dark-200 text-sm",children:"Input:"}),h.jsx("pre",{className:"mt-1 text-sm text-primary-600 dark:text-primary-300 font-mono whitespace-pre-wrap break-all",children:e.input})]}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("span",{className:"text-gray-500 dark:text-dark-200 text-sm",children:"Output:"}),h.jsx("pre",{className:"mt-1 text-sm text-green-600 dark:text-green-400 font-mono whitespace-pre-wrap break-all",children:e.output})]}),e.explanation&&h.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-dark-500",children:[h.jsx("span",{className:"text-gray-500 dark:text-dark-200 text-sm",children:"Explanation: "}),h.jsx("span",{className:"text-gray-600 dark:text-dark-200 text-sm",children:e.explanation})]})]})},n))})]})}function n1({hints:t,solution:e,onLoadToEditor:n}){const[r,i]=z.useState(0),[s,o]=z.useState(!1),[a,l]=z.useState(!1),u=()=>{r<t.length&&i(g=>g+1)},d=()=>{o(!0)},p=async()=>{try{await navigator.clipboard.writeText(e),l(!0),setTimeout(()=>l(!1),2e3)}catch{const g=document.createElement("textarea");g.value=e,document.body.appendChild(g),g.select(),document.execCommand("copy"),document.body.removeChild(g),l(!0),setTimeout(()=>l(!1),2e3)}},f=()=>{n&&n(e)};return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-dark-100",children:"Hints"}),r<t.length&&h.jsxs("button",{onClick:u,className:"text-sm text-primary-500 hover:text-primary-400 transition-colors",children:["Show Hint (",r,"/",t.length,")"]})]}),r>0?h.jsx("div",{className:"space-y-2",children:t.slice(0,r).map((g,_)=>h.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg p-3",children:h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx("span",{className:"text-yellow-600 flex-shrink-0",children:""}),h.jsx("span",{className:"text-gray-700 dark:text-dark-200 text-sm break-words overflow-hidden",children:g})]})},_))}):h.jsx("div",{className:"text-gray-400 dark:text-dark-300 text-sm italic",children:'Click "Show Hint" if you need help'})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-dark-100",children:"Solution"}),!s&&r>=t.length&&h.jsx("button",{onClick:d,className:"text-sm text-primary-500 hover:text-primary-400 transition-colors",children:"Reveal Solution"})]}),s?h.jsxs("div",{className:"bg-white dark:bg-dark-800 rounded-lg overflow-hidden border border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"px-4 py-2 bg-gray-100 dark:bg-dark-900 border-b border-gray-200 dark:border-dark-500 flex items-center justify-between",children:[h.jsx("span",{className:"text-sm text-gray-600 dark:text-dark-200",children:"Solution Code"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:p,className:"px-3 py-1 text-xs font-medium rounded-md bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",children:a?"Copied!":"Copy to Clipboard"}),n&&h.jsx("button",{onClick:f,className:"px-3 py-1 text-xs font-medium rounded-md bg-primary-500 text-white hover:bg-primary-600 transition-colors",children:"Load into Editor"})]})]}),h.jsx("pre",{className:"p-4 text-sm text-dark-200 font-mono overflow-x-auto bg-dark-900",children:e})]}):r<t.length?h.jsx("div",{className:"text-gray-400 dark:text-dark-300 text-sm italic",children:"Reveal all hints first to unlock the solution"}):h.jsx("div",{className:"text-gray-400 dark:text-dark-300 text-sm italic",children:'Click "Reveal Solution" to see the answer'})]})]})}function lU({show:t,onDismiss:e}){return z.useEffect(()=>{if(t){const n=setTimeout(e,3e3);return()=>clearTimeout(n)}},[t,e]),t?h.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 animate-slide-down",children:h.jsx("div",{className:"bg-green-500 text-white px-4 py-3 shadow-lg",children:h.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:""}),h.jsx("span",{className:"font-medium",children:"All tests passed! Great work!"})]}),h.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors text-sm",children:"Dismiss"})]})})}):null}function uU(){const{sectionId:t,problemId:e}=Tw(),{getProblemProgress:n,saveProblemCode:r,updateProblemStatus:i}=Ol(),{isLoading:s,isReady:o,output:a,runTests:l,clearOutput:u}=xT(),d=e?V6(e):void 0,p=ei.find(G=>G.id===t),[f,g]=z.useState(""),[_,k]=z.useState([]),[I,x]=z.useState(!1),[v,w]=z.useState(!1),[M,O]=z.useState([]),[D,S]=z.useState(0),[E,C]=z.useState(()=>!localStorage.getItem("ml-lab-shortcut-hint-dismissed")),[b,A]=z.useState(!1),N=z.useRef(!1),[P,se]=z.useState("description"),[$,ae]=z.useState(()=>window.innerWidth<1024),[ye,W]=z.useState("problem"),{isDark:ee}=Kg();z.useEffect(()=>{if(d&&t){const G=n(t,d.id);g(G.code||d.starterCode),O(d.testCases),se("description")}},[d,t,n]),z.useEffect(()=>{if(d&&t){const G=n(t,d.id);N.current=G.status==="completed"}},[d==null?void 0:d.id,t,n]),z.useEffect(()=>{if(f&&d&&t&&f!==d.starterCode){const G=setTimeout(()=>{r(t,d.id,f)},1e3);return()=>clearTimeout(G)}},[f,d,t,r]),z.useEffect(()=>{if(E){const G=setTimeout(()=>{C(!1),localStorage.setItem("ml-lab-shortcut-hint-dismissed","true")},1e4);return()=>clearTimeout(G)}},[E]);const R=z.useCallback(()=>{C(!1),localStorage.setItem("ml-lab-shortcut-hint-dismissed","true")},[]);z.useEffect(()=>{const G=()=>ae(window.innerWidth<1024);return window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[]);const Z=z.useCallback(G=>{g(G)},[]),re=z.useCallback(()=>{d&&(!(f!==d.starterCode)||window.confirm("Reset your code? Your changes will be lost."))&&(g(d.starterCode),k([]),O(d.testCases),S(Ie=>Ie+1),u())},[d,f,u]),L=G=>{const Ie=[...G.matchAll(/def\s+(\w+)\s*\(/g)];return Ie.length>0?Ie[Ie.length-1][1]:"solution"},he=z.useCallback(async()=>{if(!(!d||!o||!t)){x(!0),k([]);try{const G=L(d.starterCode),Ie=await l(f,M,G);k(Ie),Ie.every(nt=>nt.passed)&&(i(t,d.id,"completed"),N.current||(A(!0),N.current=!0))}finally{x(!1)}}},[d,o,t,f,M,l,i]);if(!d||!p)return h.jsxs("div",{className:"text-center py-12",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-dark-100 mb-4",children:"Problem Not Found"}),h.jsx(Ft,{to:"/",className:"text-primary-500 hover:text-primary-400",children:"Return to Home"})]});const Ae=p.problems.indexOf(d.id),Ee=Ae>0?p.problems[Ae-1]:void 0,He=p.problems[Ae+1],J=d.description.replace(/[#*`]/g,"").split(`
`).filter(G=>G.trim()).slice(0,2).join(" ").substring(0,155),q=E?h.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 px-3 py-2 bg-dark-800 dark:bg-dark-600 text-white text-xs rounded-lg shadow-lg whitespace-nowrap z-50",children:[h.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-dark-800 dark:bg-dark-600 rotate-45"}),h.jsx("span",{children:"Pro tip: "}),h.jsx("span",{className:"font-medium",children:"Shift+Enter"}),h.jsx("span",{children:" runs tests"}),h.jsx("button",{onClick:R,className:"ml-2 text-gray-400 hover:text-white underline",children:"Got it"})]}):null,Q=h.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-dark-800 border-b border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:he,disabled:!o||I,className:"px-4 py-1.5 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:I?"Running...":"Run Tests"}),h.jsx("span",{className:"text-xs text-gray-400 dark:text-dark-300",children:"or"}),h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex items-center gap-1 text-gray-500 dark:text-dark-200",children:[h.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-mono bg-gray-100 dark:bg-dark-600 border border-gray-300 dark:border-dark-500 rounded shadow-sm",children:"Shift"}),h.jsx("span",{className:"text-xs",children:"+"}),h.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-mono bg-gray-100 dark:bg-dark-600 border border-gray-300 dark:border-dark-500 rounded shadow-sm",children:"Enter"})]}),q]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[_.length>0&&_.every(G=>G.passed)&&He&&h.jsx(Ft,{to:`/problem/${t}/${He}`,className:"px-4 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-sm font-medium rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",children:"Next Problem "}),h.jsx("button",{onClick:()=>w(!v),className:"px-4 py-1.5 bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",title:v?"Restore layout":"Maximize editor",children:v?" Restore":" Maximize"}),h.jsx("button",{onClick:re,className:"px-4 py-1.5 bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",children:"Reset"})]})]});return h.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col -m-6",children:[h.jsx(Oo,{title:`${d.title} - ${p.title}`,description:`${J}... Practice this ${d.difficulty} ML coding problem with instant feedback.`,canonical:`/problem/${t}/${e}`,keywords:`${d.title}, ${p.title}, machine learning, coding practice, ${d.difficulty}`}),h.jsx(lU,{show:b,onDismiss:()=>A(!1)}),h.jsxs("div",{className:"flex items-center justify-between px-6 py-3 bg-white dark:bg-dark-800 border-b border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs(Ft,{to:`/section/${t}`,className:"text-gray-500 dark:text-dark-200 hover:text-gray-900 dark:hover:text-dark-100 transition-colors",children:[" ",p.title]}),h.jsx("span",{className:"text-gray-300 dark:text-dark-500",children:"/"}),h.jsx("span",{className:"text-gray-900 dark:text-dark-100 font-medium",children:d.title})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[Ee?h.jsx(Ft,{to:`/problem/${t}/${Ee}`,className:"px-2 py-1 text-sm text-gray-600 dark:text-dark-200 hover:text-gray-900 dark:hover:text-dark-100 hover:bg-gray-100 dark:hover:bg-dark-600 rounded transition-colors",children:" Prev"}):h.jsx("span",{className:"px-2 py-1 text-sm text-gray-300 dark:text-dark-400 cursor-default",children:" Prev"}),h.jsxs("span",{className:"text-xs text-gray-400 dark:text-dark-300 font-mono",children:["(",Ae+1,"/",p.problems.length,")"]}),He?h.jsx(Ft,{to:`/problem/${t}/${He}`,className:"px-2 py-1 text-sm text-gray-600 dark:text-dark-200 hover:text-gray-900 dark:hover:text-dark-100 hover:bg-gray-100 dark:hover:bg-dark-600 rounded transition-colors",children:"Next "}):h.jsx("span",{className:"px-2 py-1 text-sm text-gray-300 dark:text-dark-400 cursor-default",children:"Next "})]}),h.jsx("span",{className:"text-gray-300 dark:text-dark-500",children:"|"}),!o&&h.jsxs("span",{className:"text-gray-500 dark:text-dark-200 text-sm flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),s?"Loading Python...":"Python ready"]}),o&&h.jsxs("span",{className:"text-gray-500 dark:text-dark-200 text-sm flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-accent-500 rounded-full"}),"Python ready"]})]})]}),$?h.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden bg-white dark:bg-dark-800",children:[h.jsxs("div",{className:"flex border-b border-gray-200 dark:border-dark-500 bg-gray-50 dark:bg-dark-900",children:[h.jsx("button",{onClick:()=>W("problem"),className:`flex-1 px-4 py-2.5 text-sm font-medium text-center transition-colors ${ye==="problem"?"text-primary-600 dark:text-primary-300 border-b-2 border-primary-500 bg-white dark:bg-dark-800":"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100"}`,children:"Problem"}),h.jsx("button",{onClick:()=>W("code"),className:`flex-1 px-4 py-2.5 text-sm font-medium text-center transition-colors ${ye==="code"?"text-primary-600 dark:text-primary-300 border-b-2 border-primary-500 bg-white dark:bg-dark-800":"text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100"}`,children:"Code"})]}),ye==="problem"?h.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[h.jsx(e1,{problem:d}),h.jsx(t1,{examples:d.examples}),h.jsx(n1,{hints:d.hints,solution:d.solution})]}):h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-dark-900 border-b border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:he,disabled:!o||I,className:"px-4 py-1.5 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:I?"Running...":"Run Tests"}),h.jsx("button",{onClick:re,className:"px-3 py-1.5 bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",children:"Reset"})]}),_.length>0&&_.every(G=>G.passed)&&He&&h.jsx(Ft,{to:`/problem/${t}/${He}`,className:"px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-sm font-medium rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",children:"Next "})]}),h.jsx("div",{className:"flex-[3] overflow-hidden p-2",children:h.jsx(nc,{value:f,onChange:Z,height:"100%",onRun:he,darkMode:ee})}),h.jsx("div",{className:"flex-[2] overflow-auto p-2 space-y-2 bg-gray-50 dark:bg-dark-900 border-t border-gray-200 dark:border-dark-500",children:h.jsx(rc,{output:a,isLoading:I,testCases:M,onTestCasesChange:O,problemId:e,resetKey:D,testResults:_})})]})]}):v?h.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden bg-white dark:bg-dark-800",children:[Q,h.jsxs(so,{className:"flex flex-1 overflow-hidden",sizes:[60,40],minSize:200,gutterSize:8,gutterAlign:"center",children:[h.jsx("div",{className:"h-full overflow-hidden p-4",children:h.jsx(nc,{value:f,onChange:Z,height:"100%",onRun:he,darkMode:ee})}),h.jsx("div",{className:"overflow-auto p-4 bg-gray-50 dark:bg-dark-900",children:h.jsx(rc,{output:a,isLoading:I,testCases:M,onTestCasesChange:O,problemId:e,resetKey:D,testResults:_})})]})]}):h.jsxs(so,{className:"flex flex-1 overflow-hidden",sizes:[40,60],minSize:300,gutterSize:8,gutterAlign:"center",children:[h.jsxs("div",{className:"problem-panel flex flex-col overflow-hidden bg-gray-50 dark:bg-dark-900 min-w-0",children:[h.jsxs("div",{className:"flex overflow-x-auto whitespace-nowrap border-b border-gray-200 dark:border-dark-500 bg-white dark:bg-dark-800 px-4 shrink-0",children:[h.jsx("button",{onClick:()=>se("description"),className:`whitespace-nowrap shrink-0 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors ${P==="description"?"border-primary-500 text-primary-600 dark:text-primary-300":"border-transparent text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 hover:border-gray-300 dark:hover:border-dark-400"}`,children:"Description"}),h.jsx("button",{onClick:()=>se("examples"),className:`whitespace-nowrap shrink-0 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors ${P==="examples"?"border-primary-500 text-primary-600 dark:text-primary-300":"border-transparent text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 hover:border-gray-300 dark:hover:border-dark-400"}`,children:"Examples"}),h.jsx("button",{onClick:()=>se("hints"),className:`whitespace-nowrap shrink-0 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors ${P==="hints"?"border-primary-500 text-primary-600 dark:text-primary-300":"border-transparent text-gray-500 dark:text-dark-200 hover:text-gray-700 dark:hover:text-dark-100 hover:border-gray-300 dark:hover:border-dark-400"}`,children:"Hints & Solution"})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-6",children:[P==="description"&&h.jsx(e1,{problem:d}),P==="examples"&&h.jsx("div",{children:h.jsx(t1,{examples:d.examples})}),P==="hints"&&h.jsx("div",{children:h.jsx(n1,{hints:d.hints,solution:d.solution,onLoadToEditor:g})})]})]}),h.jsxs("div",{className:"flex flex-col overflow-hidden bg-white dark:bg-dark-800",children:[Q,h.jsxs(so,{className:"flex-1 overflow-hidden",direction:"vertical",sizes:[60,40],minSize:100,gutterSize:8,children:[h.jsx("div",{className:"h-full overflow-hidden p-4",children:h.jsx(nc,{value:f,onChange:Z,height:"100%",onRun:he,darkMode:ee})}),h.jsx("div",{className:"overflow-auto p-4 bg-gray-50 dark:bg-dark-900",children:h.jsx(rc,{output:a,isLoading:I,testCases:M,onTestCasesChange:O,problemId:e,resetKey:D,testResults:_})})]})]})]})]})}const r1="ml-interview-scratchpad",i1=`import numpy as np

# Try out your code here!
# NumPy is already loaded and ready to use.

arr = np.array([1, 2, 3, 4, 5])
print(f"Array: {arr}")
print(f"Sum: {np.sum(arr)}")
print(f"Mean: {np.mean(arr)}")
`;function cU(){const{isLoading:t,isReady:e,output:n,runCode:r,clearOutput:i}=xT(),{isDark:s}=Kg(),[o,a]=z.useState(""),[l,u]=z.useState(!1);z.useEffect(()=>{const g=localStorage.getItem(r1);a(g||i1)},[]),z.useEffect(()=>{if(o){const g=setTimeout(()=>{localStorage.setItem(r1,o)},1e3);return()=>clearTimeout(g)}},[o]);const d=z.useCallback(g=>{a(g)},[]),p=z.useCallback(()=>{a(i1),i()},[i]),f=z.useCallback(async()=>{if(e){u(!0),i();try{await r(o)}finally{u(!1)}}},[e,o,r,i]);return h.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col -m-6",children:[h.jsx(Oo,{title:"Python Scratchpad",description:"Free Python playground with NumPy pre-loaded. Run Python code directly in your browser - no setup required. Practice machine learning code instantly.",canonical:"/scratchpad",keywords:"Python playground, online Python, NumPy, code sandbox, ML practice, browser Python"}),h.jsxs("div",{className:"flex items-center justify-between px-6 py-3 bg-white dark:bg-dark-800 border-b border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(Ft,{to:"/",className:"text-gray-500 dark:text-dark-200 hover:text-gray-900 dark:hover:text-dark-100 transition-colors",children:"Home"}),h.jsx("span",{className:"text-gray-300 dark:text-dark-500",children:"/"}),h.jsx("span",{className:"text-gray-900 dark:text-dark-100 font-medium",children:"Python Scratchpad"})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[!e&&h.jsxs("span",{className:"text-gray-500 dark:text-dark-200 text-sm flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),t?"Loading Python...":"Python ready"]}),e&&h.jsxs("span",{className:"text-gray-500 dark:text-dark-200 text-sm flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-accent-500 rounded-full"}),"Python ready"]})]})]}),h.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden bg-white dark:bg-dark-800",children:[h.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-dark-900 border-b border-gray-200 dark:border-dark-500",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:f,disabled:!e||l,className:"px-4 py-1.5 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Running...":"Run Code"}),h.jsx("button",{onClick:p,className:"px-4 py-1.5 bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",children:"Reset"}),h.jsx("button",{onClick:i,className:"px-4 py-1.5 bg-gray-200 dark:bg-dark-600 text-gray-700 dark:text-dark-200 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-dark-500 transition-colors",children:"Clear Output"})]}),h.jsx("span",{className:"text-gray-400 dark:text-dark-300 text-sm",children:"Code is auto-saved"})]}),h.jsxs(so,{className:"flex-1 overflow-hidden",direction:"vertical",sizes:[60,40],minSize:100,gutterSize:8,children:[h.jsx("div",{className:"h-full overflow-hidden p-4",children:h.jsx(nc,{value:o,onChange:d,height:"100%",darkMode:s})}),h.jsx("div",{className:"overflow-auto p-4 bg-gray-50 dark:bg-dark-900",children:h.jsx(rc,{output:n,isLoading:l})})]})]})]})}function dU(){return h.jsxs(h.Fragment,{children:[h.jsx(Oo,{title:"Terms of Service",description:"Terms of Service for ML Grind - an interactive platform for learning machine learning through hands-on coding exercises.",canonical:"/terms"}),h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Terms of Service"}),h.jsxs("div",{className:"prose prose-gray max-w-none",children:[h.jsxs("p",{className:"text-gray-600 mb-6",children:[h.jsx("strong",{children:"Last updated:"})," February 1, 2026"]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"1. Acceptance of Terms"}),h.jsx("p",{className:"text-gray-600 mb-4",children:'By accessing and using ML Grind ("the Service"), you accept and agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.'})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"2. Description of Service"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"ML Grind is an educational platform that provides interactive machine learning coding exercises, tutorials, and learning materials. The Service allows users to:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Read problem descriptions and theoretical introductions"}),h.jsx("li",{children:"Write and execute Python code in the browser"}),h.jsx("li",{children:"Run tests and receive feedback on solutions"}),h.jsx("li",{children:"Track learning progress across sections"}),h.jsx("li",{children:"Use a Python scratchpad for experimentation"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"3. Intellectual Property Rights"}),h.jsxs("p",{className:"text-gray-600 mb-4",children:[h.jsx("strong",{children:"Software Code:"})," The source code of ML Grind is licensed under the MIT License. You may use, modify, and distribute the code in accordance with the terms of that license."]}),h.jsxs("p",{className:"text-gray-600 mb-4",children:[h.jsx("strong",{children:"Educational Content:"})," All educational content, including but not limited to:"]}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Problem descriptions and explanations"}),h.jsx("li",{children:"Solutions and starter code for exercises"}),h.jsx("li",{children:"Learning materials and tutorials"}),h.jsx("li",{children:"Test cases and examples"})]}),h.jsx("p",{className:"text-gray-600 mb-4",children:"is copyrighted material owned by Siddharth Choudhary. This content may not be reproduced, distributed, modified, or used to create derivative works without explicit written permission from the copyright holder."})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"4. Permitted Use"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"You may use the Service for:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Personal learning and educational purposes"}),h.jsx("li",{children:"Preparing for interviews or assessments"}),h.jsx("li",{children:"Building your machine learning skills"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"5. Prohibited Use"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"You may NOT:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Copy, reproduce, or redistribute the educational content"}),h.jsx("li",{children:"Use the content for commercial purposes without permission"}),h.jsx("li",{children:"Create competing services using our educational materials"}),h.jsx("li",{children:"Scrape or bulk download content from the Service"}),h.jsx("li",{children:"Remove or alter any copyright notices or attributions"}),h.jsx("li",{children:"Attempt to circumvent any security measures"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"6. User Code"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"Code that you write in the code editor is stored locally in your browser. We do not collect or store your code on our servers. You retain full ownership of any original code you create while using the Service."})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"7. Disclaimer of Warranties"}),h.jsx("p",{className:"text-gray-600 mb-4",children:'THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED. WE DO NOT WARRANT THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE.'})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"8. Limitation of Liability"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, WE SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING FROM YOUR USE OF THE SERVICE."})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"9. Changes to Terms"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"We reserve the right to modify these Terms at any time. Changes will be effective immediately upon posting. Your continued use of the Service after changes constitutes acceptance of the modified Terms."})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"10. Contact"}),h.jsxs("p",{className:"text-gray-600 mb-4",children:["For questions about these Terms, please open an issue on our"," ",h.jsx("a",{href:"https://github.com/mlgrind/mlgrind.github.io",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"GitHub repository"}),"."]})]})]})]})]})}function pU(){return h.jsxs(h.Fragment,{children:[h.jsx(Oo,{title:"Privacy Policy",description:"Privacy Policy for ML Grind - learn how we handle your data on our machine learning education platform.",canonical:"/privacy"}),h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Privacy Policy"}),h.jsxs("div",{className:"prose prose-gray max-w-none",children:[h.jsxs("p",{className:"text-gray-600 mb-6",children:[h.jsx("strong",{children:"Last updated:"})," February 8, 2026"]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Overview"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"ML Grind is committed to protecting your privacy. This Privacy Policy explains how we collect, use, and protect information when you use our Service."}),h.jsxs("p",{className:"text-gray-600 mb-4",children:[h.jsx("strong",{children:"The short version:"})," We collect minimal data. Your code stays in your browser. We don't track you or sell your data."]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Information We Collect"}),h.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Data Stored Locally (Your Browser)"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"The following data is stored only in your browser's localStorage and never sent to our servers:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Progress data:"})," Which problems you've completed"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Saved code:"})," Your code solutions for each problem"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Scratchpad code:"})," Code you've written in the Python scratchpad"]})]}),h.jsx("p",{className:"text-gray-600 mb-4",children:"This data never leaves your device unless you explicitly export it."}),h.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Feedback Submissions"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"When you submit feedback through our feedback form, we collect:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Your email address (optional, only if you provide it)"}),h.jsx("li",{children:"The feedback message you write"})]}),h.jsx("p",{className:"text-gray-600 mb-4",children:"This information is sent via Formspree and is used solely to respond to your feedback and improve the Service."}),h.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Google Sign-In (Optional)"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"If you choose to sign in with Google, we collect and store the following information in Google Cloud Firestore to sync your progress across devices:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Google profile information:"})," Your name, email address, and profile photo URL"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Progress data:"})," Problem completion status, saved code, and timestamps"]})]}),h.jsx("p",{className:"text-gray-600 mb-4",children:"This data is stored securely in Firestore and is only accessible by you (authenticated via your Google account). You can continue using ML Grind without signing in  all features work with local storage only."}),h.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Analytics and Hosting"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"We use Firebase Analytics (Google Analytics 4) to understand how the Service is used and to improve the user experience. Firebase Analytics automatically collects anonymous usage data including approximate geographic location, browser type, device type, and page views. This data is processed by Google under their data processing terms. No personally identifiable information is shared with analytics beyond what Google automatically collects from standard web interactions."}),h.jsx("p",{className:"text-gray-600 mb-4",children:"If you sign in with Google, sign-in events are logged with timestamps for security and service improvement purposes."}),h.jsxs("p",{className:"text-gray-600 mb-4",children:["ML Grind is hosted on GitHub Pages. GitHub may collect standard server logs including IP addresses and page requests. Please refer to"," ",h.jsx("a",{href:"https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"GitHub's Privacy Statement"})," ","for more information."]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Information We Do NOT Collect"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"We do not require account registration"}),h.jsx("li",{children:"We do not use cookies for tracking"}),h.jsx("li",{children:"We use Firebase Analytics only for aggregate usage insights (see above)"}),h.jsx("li",{children:"We do not collect personal information beyond what you voluntarily provide"}),h.jsx("li",{children:"We do not sell or share your data with third parties"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Code Execution"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"All Python code execution happens entirely in your browser using Pyodide (WebAssembly). Your code is never sent to any external server for execution. This means:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Your code remains private on your device"}),h.jsx("li",{children:"We cannot see or access the code you write"}),h.jsx("li",{children:"Execution results stay in your browser"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Data Retention"}),h.jsxs("p",{className:"text-gray-600 mb-4",children:[h.jsx("strong",{children:"Local data:"})," Data stored in your browser persists until you clear your browser's localStorage or use a browser cleaning tool."]}),h.jsxs("p",{className:"text-gray-600 mb-4",children:[h.jsx("strong",{children:"Feedback:"})," Feedback submissions are retained only as long as necessary to respond to your inquiry and improve the Service."]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Your Rights"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"You have the right to:"}),h.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-4 space-y-2",children:[h.jsx("li",{children:"Clear your local data at any time through your browser settings"}),h.jsx("li",{children:"Use the Service without providing any personal information"}),h.jsx("li",{children:"Request deletion of any feedback you've submitted"})]})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Children's Privacy"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"The Service is intended for general audiences interested in learning machine learning. We do not knowingly collect personal information from children under 13. Since we don't require registration and store data locally, children can use the Service without providing any personal information."})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Changes to This Policy"}),h.jsx("p",{className:"text-gray-600 mb-4",children:'We may update this Privacy Policy from time to time. We will notify users of any material changes by updating the "Last updated" date at the top of this policy.'})]}),h.jsxs("section",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact"}),h.jsxs("p",{className:"text-gray-600 mb-4",children:["For questions about this Privacy Policy, please open an issue on our"," ",h.jsx("a",{href:"https://github.com/mlgrind/mlgrind.github.io",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"GitHub repository"}),"."]})]})]})]})]})}function hU(){return h.jsx(AO,{children:h.jsxs(gA,{children:[h.jsx(Vi,{path:"/",element:h.jsx(LO,{})}),h.jsx(Vi,{path:"/section/:sectionId",element:h.jsx(U6,{})}),h.jsx(Vi,{path:"/problem/:sectionId/:problemId",element:h.jsx(uU,{})}),h.jsx(Vi,{path:"/scratchpad",element:h.jsx(cU,{})}),h.jsx(Vi,{path:"/terms",element:h.jsx(dU,{})}),h.jsx(Vi,{path:"/privacy",element:h.jsx(pU,{})})]})})}bh.createRoot(document.getElementById("root")).render(h.jsx(_t.StrictMode,{children:h.jsx(zw,{children:h.jsx(EA,{basename:"/",children:h.jsx(vO,{children:h.jsx(EO,{children:h.jsx(hU,{})})})})})}));
